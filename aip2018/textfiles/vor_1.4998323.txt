Properties of field functionals and characterization of local functionals
Functionals (i.e., functions of functions) are widely used in quantum field theory and solid-state physics. In this paper, functionals are given a rigorous mathematical framework and their main properties are described. The choice of the proper space of test functions (smooth functions) and of the relevant concept of differential (Bastiani differential) are discussed. The relation between the multiple derivatives of a functional and the corresponding distributions is described in detail. It is proved that, in a neighborhood of every test function, the support of a smooth functional is uniformly compactly supported and the order of the corresponding distribution is uniformly bounded. Relying on a recent work by Dabrowski, several spaces of functionals are furnished with a complete and nuclear topology. In view of physical applications, it is shown that most formal manipulations can be given a rigorous meaning. A new concept of local functionals is proposed and two characterizations of them are given: the first one uses the additivity (or Hammerstein) property, the second one is a variant of Peetre’s theorem. Finally, the first step of a cohomological approach to quantum field theory is carried out by proving a global Poincaré lemma and defining multi-vector fields and graded functionals within our framework.
I. MOTIVATION
Functionals (i.e., functions of functions) are mathematical objects successfully applied in many areas of physics. Since Schwinger’s ground-breaking papers [1,2], Green functions of quantum field theory are obtained as functional derivatives of the generating functional Z(j) with respect to the functions j (external sources). In solid-state and molecular physics, the exchange and correlation potential of density functional theory is computed from the functional derivative of the total energy E(ρ) with respect to the electron density ρ [3,4]. In perturbative algebraic quantum field theory (pAQFT), the observables are functionals F(φ) of the classical field φ [5]. This formulation was possible due to the crucial result [6] that allowed us to realize abstract quantum fields as concrete functionals on the space of classical configurations. This viewpoint is not only simplifying computations but also allows us to construct new perturbative and exact models of QFT’s [7,8]. It is, therefore, crucial to understand the functional analytic properties of classical functionals to be able to use these in quantization and obtain even more models. The importance of this endeavour is justified by the fact that presently we do not know any exact interacting QFT models in 4 spacetime dimensions.
Functionals are also used in pure mathematics, for example, loop space cohomology [9] and infinite dimensional integrable systems: the hierarchy of commuting Hamiltonians for the Korteweg–de Vries equation is, for instance, made of functionals [10].
In all these fields, the concept of locality is fundamental: the Lagrangian of quantum field theory is local and the counterterms of the renormalization process have to be local, the approximations of E(ρ) used in practice are local, and it is an open question whether the true density functional E(ρ) is local or not. Therefore, it is crucial to determine precisely what is meant by a local functional. According to the standard definition [11–14], if φ is a classical field (i.e., a smooth section of a vector bundle over M and we momentarily consider M=R^{d} for notational convenience), then a functional F(φ) is local if it is of the form
where f is a smooth compactly supported function with a finite number of arguments.
However, this definition of local functionals is not very handy in practice because it is global and sometimes too restrictive. For example, general relativity has no local gauge-invariant observables in the sense of Eq. (1), whereas it has local gauge-invariant observables when the concept of locality is slightly generalized, as discussed in Ref [7] (see also the parallel work [15]). Note that the concept of locality presented in the present paper gives a proper topological framework for local functionals as understood by Refs [16–18].
The present paper puts forth the following formulation of the concept of locality:
Definition I.1. Let M be a manifold [19].Let U be an open subset of C^{∞}(M). A smooth functionalF:U→K(whereK=RorC) is said to be local if, for every φ ∈ U, there is a neighborhood V of φ, an integer k, an open subsetV⊂J^{k}M, and a smooth functionf∈C^{∞}(V)such thatx∈M↦f(jxkψ)is supported in a compact subset K ⊂ M and
whenever φ + ψ ∈ V and wherejxkψdenotes the k-jet of ψ at x.In other words, we require F to be local in the sense of Eq. (1), but only around each φ ∈ U because the integer k and the function f can depend on the neighborhood V. In short, our local functionals are local in the “traditional sense,” but only locally in the configuration space (i.e., in a neighborhood of each φ). We do not need global locality to apply variational methods and derive Euler-Lagrange equations. We will show by exhibiting an example that this concept of locality is strictly more general than the traditional one. Our first main result is a simple characterization of local functionals in the sense of Definition 1.1:
Theorem I.2. Let U be an open subset of C^{∞}(M). A smooth functionalF:U→K(whereK=RorC) is local if and only if we have the following:
1. F is additive [i.e., it satisfies F(φ_{1} + φ_{2} + φ_{3}) = F(φ_{1} + φ_{2}) + F(φ_{2} + φ_{3}) − F(φ_{2}) whenever supp φ_{1} ∩ supp φ_{3} = ∅].
2. For every φ ∈ U, the differential DF_{φ}of F at φ is a distribution with empty wave front set. Thus, it can be represented by a function∇F_{φ}∈D(M)[withD(M)the space of compactly supported smooth functions on M, i.e., “test functions”].
3. The mapU→D(M)defined by φ ↦ ∇F_{φ}is smooth (in the sense of Bastiani).Our characterization of locality is inspired by the microlocal functionals proposed by Brunetti, Fredenhagen, and Ribeiro [20]. However, the proof of their Proposition 2.3.12 is not complete because the application of the Fubini theorem and the second use of the fundamental theorem of calculus are not justified. Our condition 3 solves that problem. On the other hand, we do not need their assumption that F is compactly supported.Let us stress that the notion of locality is quite subtle and depends strongly on the functional analytic setting. A functional characterization of a notion of local functionals on measurable functions might not be valid anymore when applied to smooth functions as is shown by the simple counterexample of Sec. V B. We also make a conjecture as to how to generalize our main result to multi-vector fields and graded functionals, which is required for a rigorous version of the Batalin-Vilkovisky approach to gauge field theory and quantum gravity. The second main result is a proof of the global Poincaré lemma (in our context), which is crucial to set up the BRST (Becchi, Rouet, Stora, Tyutin) and variational complexes. The last one is another characterization of local (and multilocal) functionals in the form of a Peetre’s theorem.Along the way to these results, we prove interesting properties of general functionals that we briefly describe now. In Sec. II, we explain why we choose test functions that are only smooth instead of smooth and compactly supported, we describe the topology of the space of test functions, and we present the concept of Bastiani differentiability and its main properties. In Sec. III, we show that a smooth functional is locally compactly supported (i.e., in a neighborhood of every test function) and we prove that the kth derivative of a functional defines a continuous family of distributions whose order is locally bounded. Section IV, which relies heavily on Dabrowski’s work [21,22], describes in detail a nuclear and complete topology on several spaces of functionals used in quantum field theory. Section V discusses the concept of additivity that characterizes local functionals. Sections VI and VII prove the main results discussed above. Note that the present paper has a somewhat foundational character, in as much as the choice of test-functions, additivity property, and differential are carefully justified from the physical and mathematical points of view. It contributes to the formulation of a mathematically rigorous basis on which the quantum field theory of gauge fields and gravitation can be built.Note also that this paper aims at both functional analysts and theoretical physicists. Because of this dual readership, the proofs are often more detailed than what would be required for experts in functional analysis.
II. FUNCTIONALS AND THEIR DERIVATIVES
To set up a mathematical definition of functionals, we need to determine precisely which space of test functions (i.e., classical fields and sources) we consider and what we mean by a functional derivative.
A. The space of classical fields
Propagators and Green functions of quantum fields in flat spacetimes are tempered distributions [23,24] and the corresponding test functions are rapidly decreasing. Tempered distributions are computationally convenient because they have Fourier transforms. However, tempered distributions cannot be canonically extended to curved spacetimes (i.e., smooth Lorentzian manifolds) because the rapid decrease of test functions at infinity is controlled by some Euclidian distance which is not canonically defined on general spacetime manifolds (Ref [25], p. 339).
The most natural spaces of test functions on a general spacetime M are the space C^{∞}(M) of real valued smooth functions on M and its subspace D(M) of compactly supported functions. These two spaces are identical when M is compact, but physically relevant spacetimes are not compact because they are globally hyperbolic, and a choice must be made.
In this paper, we choose C^{∞}(M) [or the set Γ(M, B) of smooth sections of a vector bundle B]. There is a strong physical reason for this [26]: in the quantization process, we must be able to deal with on-shell fields φ that are smooth solutions to normally hyperbolic equations and as such cannot be compactly supported. Therefore, the domain of the functionals can be C^{∞}(M) but not D(M). There are also good mathematical arguments for this choice: Indeed, C^{∞}(M) is a Fréchet space and its pointwise multiplication is continuous (Ref [27], p. 119). Moreover, the Fréchet property of C^{∞}(M) saves us the trouble of distinguishing Bastiani from convenient differentiability which is treated in Ref [28].
The choice of C^{∞}(M) has, however, several drawbacks: (i) Since smooth functions are generally not integrable over M, the Lagrangian density L(φ) must be multiplied by a smooth compactly supported function g so that L(φ)g is integrable over M [29]. As a result, long-range interactions are suppressed and infrared convergence is enforced. This simplifies the problem but makes it difficult to deal with the physics of infrared divergence. (ii) The function g breaks the diffeomorphism invariance of the Einstein-Hilbert action. (iii) The effect of a perturbation φ + ϵψ is easier to deal with when ψ is compactly supported because it avoids the presence of boundary terms. This problem can be solved by considering C^{∞}(M) as a manifold modeled on D(M) [5,20], but this is an additional complication.
B. Locally convex spaces
The spaces of test functions and functionals considered in the paper are all locally convex. The most pedagogical introduction to locally convex spaces is probably Horvath’s book [30], so we refer the reader to it for more details.
We describe now the topology of the spaces of test functions that we use. For the space of smooth test functions C^{∞}(R^{d}), the topology is defined by the seminorms
where f∈C^{∞}(R^{d}), m is an integer, K is a compact subset of R^{d}, α = (α_{1}, …, α_{d}) is a d-tuple of non-negative integers, with |α| = α_{1} +⋯+ α_{d} and ∂^{α}=∂1α_{1}…∂dα_{d}, with ∂_{i} = ∂/∂x^{i} being the derivative with respect to the ith coordinate of x (Ref [27], p. 88).
If U is open in R^{d}, we denote by C^{∞}(U) the space of all functions defined on U which possess continuous partial derivatives of all orders. We equip C^{∞}(U) with the topology defined by the seminorms π_{m,K} where K runs now over the compact subsets of U (Ref [30], p. 89). For every open set U⊂R^{d}, the space C^{∞}(U) is Fréchet, reflexive, Montel, barrelled (Ref [30], p. 239), bornological (Ref [30], p. 222), and nuclear (Ref [31], p. 530).
We define now C^{∞}(M), where M is a d-dimensional manifold (tacitly smooth, Hausdorff, paracompact, and orientable) described by charts (U_{α}, ψ_{α}). If for every U_{α} ⊂ M we are given a smooth function g_{α} ∈ C^{∞}(ψ_{α}(U_{α})) such that g_{β}=g_{α}◦ψ_{α}◦ψβ−1 on ψ_{β}(U_{α} ∩ U_{β}), we call the system g_{α} a smooth function g on M. The space of smooth functions on M is denoted by C^{∞}(M) (Ref [32], p. 143). This definition is simple, but to describe the topological properties of C^{∞}(M), the following more conceptual definition is useful.
Let M be a manifold and B → M be a smooth vector bundle of rank r over M with projection π. Let E = Γ(M, B) be the space of smooth sections of B equipped with the following topology [28]:
Definition II.1. The topology on Γ(M, B) is defined as follows. Choose a chart(Uα,ψα){α}and a trivialization mapΦ_{α}:π^{−1}(U_{α})→Ω×R^{r}, where Ω is a fixed open set inR^{d}. Then the map Φ_{α}allows us to identify Γ(U_{α}, B) withC^{∞}(Ω,R^{r})byΦ_{α}:π^{−1}U_{α}→Ω×R^{d}such that
where
The topology on Γ(M, B) is the weakest topology making all the maps K_{α}continuous.This topology does not depend on the choice of charts or trivialization maps (Ref [28], p. 294). To interpret this topology, denote by ρ_{α}:s∈Γ(M,B)↦s|_{Uα}∈Γ(U_{α},B) the restriction map of sections on open sets of our open cover (Uα){α∈I} of M. The space Γ(M, B) fits into the following complex of vector spaces:
The topology on Γ(U_{α}, B) is given by the isomorphism Γ(U_{α},B)≃C^{∞}(Ω,R^{r}), hence it is nuclear Fréchet. The countable products ∏_{α∈I}Γ(U_{α}, B) and ∏_{(α,β)∈I^{2}}Γ(U_{α}∩U_{β},B) are therefore nuclear Fréchet. For every pair (α, β) of distinct elements of I, the difference of restriction maps ρ_{α} − ρ_{β} is continuous and the topology on Γ(M, B) is the weakest topology which makes the above complex topological, which implies that it is nuclear Fréchet as the kernel of ∏_{α≠β}ρ_{α} − ρ_{β}.Locally convex spaces are very versatile and they are the proper framework to define spaces of smooth functionals, i.e., smooth functions on a space of functions (or sections of a bundle). The first step towards this goal is to provide a rigorous definition of functional derivatives.
C. Functional derivatives
To define the space of functionals, we consider the main examples Z(j) and F(φ). These two functionals send smooth classical fields to K, where K=R or K=C. Moreover, the functional derivatives of Z and F of all orders are required to obtain the Green functions from Z(j) and to quantize the product F(φ)G(φ). Therefore, we must define the derivative of a function f:E→K, where E is the space of classical fields.
It will be useful to generalize the problem to functions f between arbitrary locally convex spaces E and F. To define such a derivative, we start from
Definition II.2. Let U be an open subset of a Hausdorff locally convex space E and let f be a map from U to a Hausdorff locally convex space F. Then f is said to have a derivative at x ∈ U in the direction ofv ∈ E if the following limit exists [33]:
One can also consider the same definition restricted to t > 0 [34]. A function f is said to have a Gâteaux differential [35,36] (or a Gâteaux variation [37]) at x if Df_{x}(v) exists for every v ∈ E. However, this definition is far too weak for our purpose because Df_{x}(v) is generally neither linear nor continuous in v and it can be linear without being continuous and continuous without being linear (Ref [38], p. 7). Therefore, we will use a stronger definition, namely, Bastiani differentiability [39], which is the fundamental concept of differentiability used throughout the paper:
Definition II.3. Let U be an open subset of a Hausdorff locally convex space E and let f be a map from U to a Hausdorff locally convex space F. Then f is Bastiani differentiable on U [denoted by f ∈ C^{1}(U)] if f has a Gâteaux differential at every x ∈ U and the map Df: U × E → F defined by Df(x, v) = Df_{x}(v) is continuous on U × E.With this definition, most of the properties used in physics textbooks (e.g., chain rule, Leibniz rule, and linearity) are mathematically valid.
1. Examples
We shall consider several examples of functions from C^{∞}(M) to R or C, where M=R^{d},
where f, g, and h are smooth compactly supported functions and where g is a symmetric function of its arguments. Further examples can be found in Refs [17] and  [40]. It is immediate to check that
2. Historical remarks
Definition II.3 is due to Bastiani [39,41] and looks quite natural. In fact, it is not so. For a long time, many different approaches were tried. For any reasonable definition of differentiability, the map Df_{x}: E → F is linear and continuous so that Df_{x} ∈ L(E, F). If E and F are Banach spaces, then a map f: E → F is defined to be continuously (Fréchet) differentiable if the map x → Df_{x} is continuous from U to L_{c}(E, F), where L_{c}(E, F) is the set of continuous maps from E to F equipped with the operator norm topology. But Fréchet differentiability is strictly stronger than Bastiani’s differentiability specialized to Banach spaces [42]. This is why Bastiani’s definition was often dismissed in the literature [43] and, for locally convex spaces that are not Banach, the map Df was generally required to be continuous from U to L(E, F) equipped with some well-chosen topology. However, when E is not normable, no topology on L(E, F) provides the nice properties of Bastiani’s definition (Ref [44], p. 6) [Hamilton (Ref [40], p. 70) gives a simple example of a map which is continuous U × E → E but such that the corresponding map U → L(E, E) is not continuous]. Thus, L(E, F) was equipped with various non-topological convergence structures (Ref [44], p. 23). The result is an impressive zoology of differentiabilities. Twenty-five of them were reviewed and classified by Averbukh and Smolyanov [45]. Still more can be found in the extensive lists given by Gähler [46] and Ver Eecke [47] covering the period up to 1983 (see also Refs [38],  [44], and  [48]).
Nowadays, essentially two concepts of differentiability survive: Bastiani’s and the so-called convenient approach developed by Kriegl–Michor in the reference monograph [28], which is weaker than Bastiani’s for general Hausdorff locally convex spaces. In particular, on any locally convex space that is not bornological, there is a conveniently smooth map that is not continuous (Ref [41], p. 19). However, a nice feature of both approaches is that for a Fréchet space E, a function f:E→K is smooth in the sense of Bastiani if and only if it is smooth in the sense of the convenient calculus [49]. Bastiani differentiability became widespread after it was used by Michor [50], Hamilton [40] (for Fréchet spaces), and Milnor [51] and it is now vigorously developed by Glöckner and Neeb (see also Ref [52]).
To complete this section, we would like to mention that the Bastiani differential is sometimes called the Michal-Bastiani differential [53–55] (or even Michel-Bastiani differential [54]). This is not correct. The confusion comes from the fact that Bastiani defines her differentiability in several steps. She starts from the Gâteaux derivability and then she says that a map f: U → F is differentiable at x (see Ref [41], p. 18 and Ref [39], p. 18) if (i) Df_{x} is linear and continuous from E to F and (ii) the map m_{x}:R×E→F defined by
for x+tv∈U, is continuous at (0, v) for all v∈E. This differentiability at x is indeed equivalent to the differentiability defined by Michal [56] in 1938, as proved in Refs [45] and  [57], Ref [44], p. 72, and Ref [47], p. 202. What we call Bastiani differentiability is called differentiability on an open set by Bastiani (see Ref [41], p. 25 and Ref [39], p. 44) and is strictly stronger than Michal differentiability.
The same distinction between Michal-Bastiani differentiability and Bastiani differentiability is made by Keller (Ref [44], p. 72) in his thorough review. Bastiani’s differentiability is denoted by Cc1 by Keller [44], who also attributes the definition equivalent to Cc1 to Bastiani alone (Ref [44], p. 11).
In her Ph.D. thesis, Andrée Bastiani developed her concept of differentiability to define distributions on a locally convex space E with values in a locally convex space F. She started from Schwartz’ remark that a distribution is, locally, the derivative of a continuous function. She used her differential D to define F-valued distributions over E [58]. A drawback of Bastiani’s framework with respect to the convenient framework is that her category is not Cartesian closed for locally convex spaces that are not Fréchet.
D. Properties of the differential
We review now some of the basic properties of functional derivatives which will be used in the sequel. We strongly recommend Hamilton’s paper [40], adapted to locally convex spaces by Neeb [42].
1. Continuity
We characterize continuous (nonlinear) maps between two locally convex spaces.
Lemma II.4. Let E and F be locally convex spaces whose topology is defined by the families of seminorms(pi){i∈I}and(qj){j∈J}, respectively. Then f is continuous at x if and only if, for every seminorm q_{j}of F and every ϵ > 0, there is a finite number{p_{i1},…,p_{ik}}of seminorms of E and k strictly positive numbers η_{1}, …, η_{k}such thatp_{i1}(x−y)<η_{1},…,p_{ik}(x−y)<η_{k}implyq_{j}f(y)−f(x)<ϵ.
Proof. This is just the translation in terms of seminorms of the fact that f is continuous at x if, for every open set V containing f(x), there is an open set U containing x such that f(U) ⊂ V (Ref [59], p. 86).When the seminorms of E are saturated (Ref [30], p. 96), as the seminorms π_{m,K} of C^{∞}(R^{d}), the condition becomes simpler: a map f:C^{∞}(R^{d})→K is continuous at x if and only if, for every ϵ > 0, there is a seminorm π_{m,K} and an η > 0 such that π_{m,K}(x − y) < η implies |f(y) − f(x)| < ϵ. Since Fréchet spaces are metrizable, we can also use the following characterization of continuity (Ref [60], p. 154):
Proposition II.5. Let E be a metrizable topological space and F be a topological space. Then, a map f: E → F is continuous at a point x if and only if, whenever a sequence(xn){n∈N}converges to x in E, the sequencef(xn){n∈N}converges to f(x) in F.Another useful theorem is (Ref [61], p. III.30)
Proposition II.6. Let E and F be two Fréchet spaces and G be a locally convex space. Every separately continuous bilinear mapping from E × F to G is continuous.This result extends to multilinear mappings from a product E_{1} ×⋯× E_{n} of Fréchet spaces to a locally convex space [62,63].
2. The fundamental theorem of calculus
The fundamental theorem of calculus for functionals reads
Theorem II.7. Let f be a Bastiani differentiable map between two Hausdorff locally convex spaces E and F. Let U be an open set in E, x in U, andvin E such that (x + tv) ∈ U for every t in an open neighborhood I of [0, 1] so that g: t ↦ f(x + tv) is a map from I to F. Then,
To give a meaning to Eq. (4), we need to define an integral of a function taking its values in a locally convex space. To cut a long story short [64,65]:
Definition II.8. Let X be a locally compact space (for example,R^{d}or some finite dimensional manifold), μ be a measure on X, and F be a Hausdorff locally convex space. Let f be a compactly supported continuous function from X to F. Let F′ be the topological dual of F (i.e., the space of continuous linear maps from F toK). If there is an element y ∈ F such that
for every α ∈ F′, where ⟨·, ·⟩ denotes the duality pairing, then we say that f has a weak integral and we denote y by ∫_{X}fdμ.The uniqueness of the weak integral follows from the fact that F is Hausdorff. In general, the existence of a weak integral requires some completeness property for F (Ref [64], p. 79). However, this is not the case for the fundamental theorem of calculus (Ref [41], p. 27). This point was stressed by Glöckner [66].
3. Additional properties
For maps between locally convex spaces, the linearity of the differential is not completely trivial [40].
Proposition II.9. Let E and F be locally convex spaces and f be a Bastiani differentiable map from an open subset U of E to F. Then, for every x ∈ U, the differential Df_{x}: E → F is a linear map.The chain rule for Bastiani-differentiable functions was first proved by Bastiani herself [41]^{,} [39] (see also Ref [53]).
Proposition II.10. Assume that E, F, G are locally convex spaces, U ⊂ E and V ⊂ F are open subsets, and f: V → G and g: U → V are two Bastiani-differentiable maps. Then, the composite map f ○ g: U → G is Bastiani differentiable and D(f ○ g)_{x} = Df_{g(x)} ○ Dg_{x}.By using these properties, the reader can prove that our examples are all Bastiani differentiable.
E. Smooth functionals
To define smooth functionals, we first define multiple derivatives.
Definition II.11. Let U be an open subset of a locally convex space E and f be a map from U to a locally convex space F. We say that f is k-times Bastiani differentiable on U if we have the following:
• The k-th Gâteaux differential
wheret= (t_{1}, …, t_{k}), exists for every x ∈ U and everyv_{1}, …,v_{k}∈ E.
• The map D^{k}f: U × E^{k}→ F is continuous.Notice that for a function f assumed to be k-times Bastiani differentiable, the restriction to any finite dimensional affine subspace is not only k-times differentiable (in the usual sense) but indeed of class C^{k}. The set of k-times Bastiani differentiable functions on U is denoted by C^{k}(U) or C^{k}(U, F) when the target space F has to be specified. Bastiani gives an equivalent definition, called k-times differentiability on U (Ref [41], p. 40), which is denoted by Cck by Keller [44].
Definition II.12. Let U be an open subset of a locally convex space E and f be a map from U to a locally convex space F. We say that f is smooth on U if f ∈ C^{k}(U, F) for every integer k.We now list a number of useful properties of the kth Bastiani differential:
Proposition II.13. Let U be an open subset of a locally convex space E and f ∈ C^{k}(U, F), where F is a locally convex space, then we have the following:
1. D^{k}f_{x}(v_{1}, …, v_{k}) is a k-linear symmetric function ofv_{1}, …, v_{k}(Ref [40], p. 84).
2. The function f is of class C^{m}for all 0 ≤ m ≤ k (Ref [41], p. 40). In particular, f is continuous.
3. The compositions of two functions in C^{k}is in C^{k}and the chain rule holds (Ref [41], p. 51 and Ref [40], p. 84).
4. The map D^{m}f is in C^{k−m}(U, L(E^{m}, F)) (Ref [41], p. 40) where L(E^{m}, F) is the space of jointly continuous m-linear maps from E to F, equipped with the locally convex topology of uniform convergence on the compact sets of E, i.e., the topology generated by the seminorms
where C = C_{1} ×⋯× C_{m}, C_{i}runs over the compact sets of E and(qj){j∈J}is a family of seminorms defining the topology of F.
5. If E is metrizable, then f ∈ C^{k}(U, F) if and only if f belongs to C^{k−1}(U, F) and D^{k−1}f: U → L(E^{k−1}, F) is Bastiani differentiable (Ref [41], p. 43). Here the metrizability hypothesis is used to obtain a canonical injection from C(U × E, L(E^{k−1}, F)) to C(U × E^{k}, F).We refer the reader to Refs [40] and  [42] and Bastiani’s cited studies for the proofs. Other results on C^{k}(U) functions can be found in Keller’s book [44]. All the statements of Proposition II.13 are valid for k = ∞, i.e., smooth functions. Bastiani also defines jets of smooth functions between locally convex spaces (Ref [41], p. 52 and Ref [39], p. 75).Note that Neeb [67] and Glöckner [68] agree with Bastiani for the definition of the first derivative but they use an apparently simpler definition of higher derivatives by saying that f is C^{k} if and only if f is C^{k−1} and d^{k−1}f is C^{1}. However, this definition is less natural because, for example, f ∈ C^{2} if df: U × E → F is C^{1}. In the definition of the first derivative, U is now replaced by U × E and E by E × E. In other words, d^{2} is a continuous map from U × E^{3} to F. More generally d^{k} is a continuous map from U×E^{2k−1} to F (Ref [68], p. 20). Moreover, according to Proposition 1.3.13 (Ref [68], p. 23), a map f belongs to C^{k} if and only if it belongs to C^{k}(U) is the sense of Bastiani, and Bastiani’s D^{k}f is denoted by d^{(k)}f by Glöckner (Ref [68], p. 23) and called the kth differential of f. The kth derivatives d^{k}f and d^{(k)}f = D^{k}f are not trivially related. For example (Ref [68], p. 24), d^{2}f(x, h_{1}, h_{2}, h_{3}) = D^{2}f(x, h_{1}, h_{2}) + Df(x, h_{3}).The Taylor formula with remainder for a function in C^{n+1}(U) reads (Ref [41], p. 44)
Taylor’s formula with remainder is a very important tool to deal with smooth functions on locally convex spaces.The reader can check that all our examples are smooth functionals in the sense of Bastiani,
for k ≤ n and D^{k}F_{φ} = 0 for k > n, and
for k ≤ n and D^{k}G_{φ} = 0 for k > n. Recall that g is a symmetric, smooth compactly supported function of its arguments. The functional H has only two non-zero derivatives and
The example I has an infinite number of nonzero derivatives,
Finally
The functionals F, G, and H are polynomials in the sense of Bastiani (Ref [41], p. 53):
Definition II.14. Let E and F be locally convex spaces. A polynomial of degree n on E is a smooth function f: E → F such that D^{k}f = 0 for all k > n.Let u be a distribution in D^{′}(M^{k}), then the functional f:D(M)→K defined by f(φ) = u(φ^{⊗k}) is polynomial in the sense of Bastiani and its k-derivative is
where σ runs over the permutations of {1, …, k} and the canonical inclusion D(M){⊗k}⊂D(M^{k}) was used.If F and G are smooth maps from E to K, we can compose the smooth map φ↦F(φ),G(φ) and the multiplication in K to show that
Proposition II.15. Let E be a locally convex space and U be an open set in E. Then the space of smooth functionals from U toKis a sub-algebra of the algebra of real valued functions.
III. PROPERTIES OF FUNCTIONALS
We now prove important properties of smooth functionals. We first investigate the support of a functional. The fact that DF_{φ} is continuous from C^{∞}(M) to K exactly means that DF_{φ} is a compactly supported distribution for every φ. The support of F is then essentially the union over φ of the supports of DF_{φ}. We prove that, for any smooth functional and any φ ∈ C^{∞}(M), there is a neighborhood V of φ such that F|_{V} is compactly supported.
The second property that we investigate is required to establish a link with quantum field theory. In this paper, we deal with functionals that are smooth functions F on an open subset U of E = Γ(M, B), where Γ(M, B) is the space of smooth sections of some finite rank vector bundle B on the manifold M. There is a discrepancy between D^{k}F_{φ}, which is a continuous multilinear map from E^{k} to K, and the quantum field amplitudes (e.g., represented pictorially by Feynman diagrams) that are continuous linear maps from E^{⊗^πk}=Γ(M^{k},B^{⊠k}) to K, i.e., elements of the space Γ^{′}(M^{k},(B*){⊠k}) of compactly supported distributions with values in the kth external tensor power of the dual bundle B*. It is easy to see that there is a canonical correspondence between D^{k}F_{φ} and its associated distribution on E^{⊗^πk}, which we denote by Fφ(k). However, the equivalence between the continuity of D^{k}F on U × E^{k} and the continuity of F^{(k)} on U×E^{⊗^πk} requires a proof.
Finally, we show that the order of F^{(k)} is locally bounded.
A. Support of a functional
Brunetti, Dütsch, and Fredenhagen proposed to define the support of a functional F by the property that if the support of the smooth function ψ does not meet the support of F, then F(φ + ψ) = F(φ) for all φ. More precisely [17],
Definition III.1. LetF:U→Kbe a Bastiani smooth function, with U being a subset of C^{∞}(M). The support of F is the set of points x ∈ M such that, for every open setU_{x}containing x, there is a φ ∈ U and a ψ in C^{∞}(M) with φ + ψ ∈ U such thatsuppψ⊂U_{x}and F(φ + ψ) ≠ F(φ).We want to relate this definition of the support of F with the support of D_{φ}F, which is compactly supported as every distribution over C^{∞}(M) [32]. To do so, we need a technical lemma about connected open subsets in locally convex spaces.
Lemma III.2. Let U be a connected open set in a locally convex space E, then any pair (x, y) ∈ U^{2}can be connected by a piecewise affine path.
Proof. Define the equivalence relation ∼ in E as follows: two elements (x, y) are equivalent if and only if they are connected by a piecewise affine path. Let us prove that this equivalence relation is both open and closed, hence any non-empty equivalence class for ∼ is both open and closed in U and hence is equal to U.Let x ∈ U, then there exists a convex neighborhood V of x in U which means that every element in V lies in the class of x, and the relation is open. Conversely let y be in the closure of the equivalence class of x, then any neighborhood V of y contains an element equivalent to x. Choose some convex neighborhood V, then we find z ∈ V such that z ∼ x, but z ∼ y hence x ∼ z ∼ y and we just proved that the equivalence class of x was closed.We can now prove an alternative formula due to Brunetti, Fredenhagen, and Ribeiro [20].
Lemma III.3. For every Bastiani smooth functionF:U→K, with U being a connected open subset of C^{∞}(M),
Proof. Using the result of Lemma III.2, we may reduce to the case where U is an open convex set. We prove that both sets ⋃_{φ}suppDF_{φ}¯ and supp F as defined in Definition III.1 have identical complements. Indeed, for every point x ∈ M, x ∉ supp F means by definition of the support that there exists an open neighborhood Ω of x such that ∀(ψ,φ)∈D(Ω)×C^{∞}(M), F(φ + ψ) = F(φ). It follows that for all ψ∈D(Ω), there exists ε > 0 such that |t|⩽ε⇒φ+tψ∈U and t ∈ [−ε, ε] ↦ F(φ + tψ) is a constant function of t; therefore, dF(φ+tψ)dt|_{t=0}=DF_{φ}(ψ)=0. This means that for all φ ∈ U, the support of DF_{φ}∈E^{′}(M) does not meet Ω since Ω lies in the complement of ∪_{φ∈U}supp (DF_{φ}) and therefore x ∈ Ω does not meet the closure ∪_{φ∈U}supp(DF_{φ})¯.Conversely if x does not meet the closure ∪_{φ∈U}supp(DF_{φ})¯, then there is some neighborhood Ω of x which does not meet ∪_{φ∈U}supp (DF_{φ}); therefore, for all (φ,ψ)∈U×D(Ω) such that φ + ψ ∈ U, the whole straight path [φ, φ + ψ] lies in U (by convexity of U) and hence
and by the fundamental theorem of calculus, F(φ + ψ) = F(φ).Now we show that any smooth functional is locally compactly supported.
Proposition III.4. LetF:U↦Kbe a Bastiani smooth function, where U is an open connected subset of E = C^{∞}(M). For every φ ∈ U, there is a neighborhood V of φ in U and a compact subset K ⊂ M such that the support of F restricted to V is contained in K. Moreover for all integers n and all φ ∈ U, the distributional supportsuppD^{n}F_{φ}is contained in K^{n}⊂ M^{n}.
Proof. By definition of the support of a functional, it is enough to show that, for every φ ∈ V, supp DF_{φ} ⊂ K. If F is smooth, then DF:U×E→K is continuous. Thus, it is continuous in the neighborhood of (φ_{0}, 0) for every φ_{0} ∈ U. In other words, for every ϵ > 0, there is a neighborhood V of φ_{0}, a seminorm π_{m,K}, and an η > 0 such that |DF_{φ}(χ)| < ϵ for every φ ∈ V and every χ ∈ E such that π_{m,K}(χ) < η. Now, for every ψ ∈ E such that π_{m,K}(ψ) ≠ 0, we see that χ = ψη/(2π_{m,K}(ψ)) satisfies π_{m,K}(χ) < η. Thus, |DF_{φ}(χ)| < ϵ for every φ ∈ V and, by linearity, |DF_{φ}(ψ)| < (2ϵ/η)π_{m,K}(ψ). On the other hand, if π_{m,K}(ψ) = 0, then for any μ > 0 ψ_{m,K}(μψ) = 0 < η so that |DF_{φ}(μψ)| < ϵ. By linearity, |DF_{φ}(ψ)| < ϵ/μ for any μ > 0 and we conclude that |DF_{φ}(ψ)| = 0. Thus, for every φ ∈ V and every ψ ∈ E,
Of course, this inequality implies that DF_{φ}(ψ) = 0 when ψ is identically zero on the compact subset K.Let us show that this implies that the support of DF_{φ} is contained in K. To avoid possible problems at the boundary, take any compact neighborhood K′ of K. Now, take an open set Ω in M such that Ω ∩ K′ = ∅. Then, for every smooth function ψ supported in Ω, we have π_{m,K}(ψ) = 0 because the seminorm π_{m,K} takes only into account the points of K. As a consequence, the restriction of DF_{φ} to Ω is zero, which means that Ω is outside the support of DF_{φ} for every φ ∈ V. Thus, supp F|_{V} ⊂ K because, for every φ ∈ V, the support of DF_{φ} is included in every compact neighborhood of K. Finally we show that if F is compactly supported, then all D^{n}F_{φ} are compactly supported with supp D^{n}F_{φ} ⊂ (supp F)^{×n}. This is easily seen by the following cutoff function argument: if F is compactly supported, then for every cutoff function χ equal to 1 on an arbitrary compact neighborhood of supp F, we have F(φ) = F(χφ), ∀φ ∈ E. Then it is immediate by definition of D^{n}F_{φ} that
thus supp D^{n}F_{φ} ⊂ supp χ^{×n} for all test function χ such that χ|_{suppF} = 1 and therefore supp D^{n}F_{φ} ⊂ (supp F)^{×n} since ⋂χ|_{suppF}=1suppχ=suppF.
B. A multilinear kernel theorem with parameters
We work with M a smooth manifold and B → M a smooth vector bundle of finite rank over M. Let E = Γ(M, B) be its space of smooth sections and U be an open subset of E. We consider smooth maps F:E↦K where K is the field R or C. In this section, we relate the Bastiani derivatives D^{k}F, which are k-linear on Γ(M, B) to the distributions used in quantum field theory, which are linear on Γ(M^{k}, B^{⊠k}). Since the kth derivative D^{k}F of a smooth map is multilinear and continuous in the last k variables, we can use the following result (Ref [69], p. 471 and Ref [70], p. 259):
Lemma III.5. Let E be a Hausdorff locally convex space. There is a canonical isomorphism between any k-linear mapf:E^{k}→Kand the mapf¯:E^{⊗k}→K, where ⊗ is the algebraic tensor product, which is linear and defined as follows: ifχ=∑_{j}χ1j⊗⋯⊗χkjis a finite sum of tensor products, then
Let us give a topological version of this lemma, using the projective topology. We recall the definition of a family of seminorms defining the projective topology on tensor powers of locally convex spaces following (Ref [71], p. 23). For arbitrary seminorms p_{1}, …, p_{k} on E, there exists a seminorm p_{1} ⊗⋯⊗ p_{k} on E^{⊗k} defined for every ψ ∈ E^{⊗k} by
where the infimum is taken over the representations of ψ as finite sums: ψ = ∑_{n}e_{1,n} ⊗⋯⊗ e_{k,n}. Following Köthe (Ref [72], p. 178), one can prove that p_{1} ⊗⋯⊗ p_{k} is the largest seminorm on E^{⊗k} such that
for all x_{1}, …, x_{k} in E. More precisely, if p is a seminorm on E^{⊗k} satisfying Eq. (8), then p(X) ⩽ (p_{1} ⊗⋯⊗ p_{k})(X) for every X ∈ E^{⊗k}.The projective topology on E^{⊗k} is defined by the family of seminorms p_{1} ⊗⋯⊗ p_{k} where each p_{i} runs over a family of seminorms defining the topology of E (Ref [71], p. 24).When E is Fréchet, its topology is defined by a countable family of seminorms and it follows that the family of seminorms p_{1} ⊗⋯⊗ p_{k} on E^{⊗k} is countable. Hence they can be used to construct a metric on E^{⊗k} which defines the same topology as the projective topology and E^{⊗^πk} is defined as the completion of E^{⊗k} relative to this metric or equivalently with respect to the projective topology. A fundamental property of the projective topology is that f:E^{k}→K is (jointly) continuous if and only if f¯:E^{⊗k}→K and still defined by Eq. (7) is continuous with respect to the projective topology (Ref [73], p. I-50). Then f¯ extends uniquely to a continuous map (still denoted by f¯) on the completed tensor product E^{⊗^πk} (Ref [61], p. III.15).If E = C^{∞}(M), then E^{⊗^πk}=C^{∞}(M^{k}) (Ref [31], p. 530), and f¯ becomes a compactly supported distribution on M^{k}. More generally, if E = Γ(M, B), then E is Fréchet nuclear and E^{⊗^πk}=Γ(M^{k},E^{⊠k}) (Ref [74], p. 72). Thus, f¯ becomes a compactly supported distributional section on M^{k}. If f = D^{k}F_{φ}, we denote f¯ by Fφ(k).Recall that if U is an open subset of a Hausdorff locally convex space E, a map F:U→K is smooth if and only if every D^{k}F is continuous from U × E^{k} to K. According to the previous discussion, continuity on E^{k} is equivalent to continuity on E^{⊗^πk}. Therefore, it is natural to wonder when joint continuity on U × E^{k} is equivalent to joint continuity on U×E^{⊗^πk}. This is the subject of the next paragraphs.We now prove an equicontinuity lemma.
Lemma III.6. Let E be a Fréchet space, U be open in E, andF:U×E^{k}↦K be a continuous map, multilinear in the last k variables. Then for every φ_{0} ∈ U, there exist a neighborhood V of φ_{0}, a seminorm q ofE^{⊗^πk}, and a constant C > 0 such that
Proof. By continuity of F:U×E^{k}↦K, for every ϵ > 0, there exist a neighborhood V of φ_{0} and neighborhoods U_{1}, …, U_{k} of zero such that φ ∈ V and e_{i} ∈ U_{i} for i = 1, …, k imply |F(φ, e_{1}, …, e_{k})| ≤ ϵ. Since E is locally convex, there are continuous seminorms p_{1}, …, p_{k} on E and strictly positive numbers η_{1}, …, η_{k} such that e_{i} ∈ U_{i} if p_{i}(e_{i}) ≤ η_{i}. Consider now arbitrary elements e_{1}, …, e_{k} of E such that p_{i}(e_{i}) ≠ 0. Then, if f_{i} = e_{i}η_{i}/p_{i}(e_{i}), we have p_{i}(f_{i}) ≤ η_{i}. Thus, |F(φ, f_{1}, …, f_{k})| < ϵ and, by multilinearity, |F(φ, e_{1}, …, e_{k})| < Mp_{1}(e_{1})…p_{k}(e_{k}) where M = ϵ/(η_{1}, …, η_{k}). The argument in the proof of Proposition III.4 shows that |F(φ, e_{1}, …, e_{k})| = 0 if p_{i}(e_{i}) = 0. Therefore, for every φ ∈ V and every e_{1}, …, e_{k} in E, |F(φ, e_{1}, …, e_{k})| ≤ Mp_{1}(e_{1})…p_{k}(e_{k}). By defining C = 2 M, we obtain for every φ ∈ V and every (e_{1}, …, e_{k}) ∈ E^{k}
By definition of F¯, for all (φ, ψ) ∈ V × E^{⊗k},
for all representations of ψ as finite sum ψ = ∑_{n}e_{1,n} ⊗⋯⊗ e_{k,n}. Taking the infimum over such representations yields the estimate
for the seminorm q = p_{1} ⊗⋯⊗ p_{k} on E^{⊗πk} and the above inequality extends to any ψ of E^{⊗^πk} since, in a Fréchet space, ψ can be approximated by a convergent sequence of elements in E^{⊗k} by the density of E^{⊗k} in E^{⊗^πk} and by the continuity of the seminorm p_{1} ⊗⋯⊗ p_{k} for the topology of E^{⊗^πk}.Another way to state the previous result is to say that the family of linear maps {F(φ, ·), φ ∈ V}, is equicontinuous (Ref [61], p. II.6).
1. Proof of the main result
We are now ready to prove
Proposition III.7. Let E be a Fréchet space and U ⊂ E be an open subset. ThenF:U×E^{k}↦K, multilinear in the last k variables, is jointly continuous if and only if the corresponding mapF¯:U×E^{⊗^πk}→Kis jointly continuous.
Proof. One direction of this theorem is straightforward and holds if E is any locally convex space. Indeed, by definition of the projective tensor product, the canonical multilinear mapping E^{k}→E^{⊗^k} is continuous (Ref [73], p. I-50). Therefore, if F¯ is continuous on U×E^{⊗^k}, then, by composition with the canonical multilinear mapping, F is continuous on U × E^{k}.Let us prove that the continuity of F implies the continuity of F¯. According to Lemma II.4, we have to show that, for every φ_{0} ∈ U and every ε > 0, there exist a finite number of continuous seminorms q_{i} on E^{⊗^πk}, a neighborhood V of φ_{0}, and η_{i} > 0 such that if φ belongs to V and ψ∈E^{⊗^πk} satisfies q_{i}(ψ−ψ_{0})⩽η_{i}, then |F¯(φ,ψ)−F¯(φ_{0},ψ_{0})|⩽ε.In order to bound F¯(φ,ψ)−F¯(φ_{0},ψ_{0}), we cut it into three parts:
where ψ_{k} is some element of the algebraic tensor product E^{⊗k} close enough to ψ_{0} that we choose now. The equicontinuity lemma III.6 yields a neighborhood V_{2} of φ_{0}, a constant C > 0, and a continuous seminorm q_{2} on E^{⊗^πk} so that
Now we use the fact that the algebraic tensor product E^{⊗k} is everywhere dense in E^{⊗^πk}, hence there is some element ψ_{k} in the algebraic tensor product E^{⊗k} such that q_{2}(ψ_{0}−ψ_{k})⩽η_{2} with η_{2}≔ε6C.Now that ψ_{k} is chosen, we can bound the second term of the sum (11), namely, F¯(φ,ψ−ψ_{k})−F¯(φ_{0},ψ−ψ_{k}). From the previous relation, for every φ ∈ V_{2} and every ψ such that q_{2}(ψ − ψ_{0}) ≤ η_{2}, the triangle inequality for q_{2}(ψ − ψ_{k}) gives us
We continue by bounding the last term F¯(φ_{0},ψ)−F¯(φ_{0},ψ_{0}) in the sum (11). Since φ_{0} is fixed, the map ψ↦F¯(φ_{0},ψ) is continuous in ψ because, since F¯(φ_{0},⋅) is continuous on E^{⊗πk}, its extension to the completion E^{⊗^πk}, also denoted by F¯(φ_{0},⋅), is continuous. It follows that there is some seminorm q_{1} of E^{⊗^πk} and a number η_{1} > 0 such that if ψ ∈ U satisfies q_{1}ψ−ψ_{0}⩽η_{1}, then
To bound the first term F¯(φ,ψ_{k})−F¯(φ_{0},ψ_{k}) in the sum (11), we use the fact that ψ_{k} ∈ E^{⊗k}. Thus, ψ_{k}=∑j=1p(e_{1,j}⊗⋯⊗e_{k,j}) for some (e_{1,j}, …, e_{k,j}) ∈ E^{k}. By definition of F¯,
By continuity of F in the first factor, the finite sum ∑j=1pF(φ,e_{1,j},…,e_{k,j}) is continuous in φ and there is some neighborhood V_{3} of φ_{0} such that for all φ ∈ V_{3} the following bound
holds true.Finally we found some neighborhood V = V_{2} ∩ V_{3} of φ_{0}, two seminorms q_{1} and q_{2} of E^{⊗^πk}, and two numbers η_{1} > 0 and η_{2} = ϵ/6C such that q_{1}(ψ − ψ_{0}) < η_{1} and q_{2}(ψ − ψ_{0}) < η_{2} imply
The proposition is proved.Now we can specialize our result to the space of smooth sections of vector bundles. We recall a fundamental result on the projective tensor product of sections (Ref [74], p. 72):
Proposition III.8. Let Γ(M, B) be the space of smooth sections of some smooth finite rank vector bundle B → M on a manifold M. ThenΓ(M,B){⊗^πk}=Γ(M^{k},B^{⊠k}).Note that we could remove the index π in ⊗^{π} because we saw that Γ(M, B) is nuclear. If we specialize Proposition III.7 to sections of vector bundles (which is a Fréchet space), we obtain
Theorem III.9. Let E = Γ(M, B) be the space of smooth sections of some smooth finite rank vector bundle B → M. ThenF:U×E^{k}→Kmultilinear in the last k variables is jointly continuous if and only if the corresponding mapF¯:U×Γ(M^{k},B^{⊠k})→Kis jointly continuous.
Proof. The proof is an immediate consequence of the fact that E^{⊗^πk}=Γ(M^{k},B^{⊠k}) and Proposition III.7.The definition of a Bastiani smooth functional implies the following corollary:
Theorem III.10. Let E = Γ(M, B) be the space of smooth sections of some smooth finite rank vector bundle B → M. A mapF:U→K, where U is open in E, is Bastiani smooth if and only if the mapsF^{(k)}:U×Γ(M^{k},B^{⊠k})→Kare (jointly) continuous for every k ≥ 1.To interpret Theorem III.7 in terms of distributional kernels, let B → M denote a smooth vector bundle of finite rank over a manifold M equipped with a fixed density |dx| and B* → M denote the corresponding dual bundle. Recall that Γ(M,B){′}≃Γ(M,B^{*})⊗_{C^{∞}(M)}E^{′}(M) [75], where Γ(M,B^{*})⊗_{C^{∞}(M)}E^{′}(M) denotes the compactly supported distributional sections of the dual bundle B*. In global analysis, to every continuous linear map L: Γ(M, B) → Γ(M, B)′, we associate the continuous bilinear map B:(φ_{1},φ_{2})∈Γ(M,B){2}↦⟨φ_{1},Lφ_{2}⟩∈K where the pairing is understood as a pairing between a smooth function and a distribution once the smooth density on M is fixed.The usual kernel theorem of the theory of distributions states that a bilinear map can be represented by a distribution K_{L}∈E^{′}(M×M)⊗_{C^{∞}(M^{2})}Γ(M^{2},B^{*}⊠B^{*}) living on configuration space M^{2} such that, for every (φ_{1}, φ_{2}) ∈ Γ(M, B)^{2},
where Γ_{2} = Γ(M^{2}, B ⊠ B). Theorem III.7 generalizes the kernel theorem by using multilinear maps instead of the bilinear ones and by considering that these multilinear maps depend continuously and non-linearly on a parameter φ.
C. Order of distributions
If F is a Bastiani smooth map from an open subset U of E = C^{∞}(M) to K, then, for every φ ∈ U, D^{k}F_{φ} is a compactly supported distribution. Therefore, the order of Fφ(k) is finite (Ref [27], p. 88). For some applications, for example, to local functionals, it is important to require the order of Fφ(k) to be locally bounded.
Proposition III.11. Let E = C^{∞}(M) andF:E→Kbe a smooth functional on an open subset U of E. Then, for every φ_{0}∈ U and every integer k, there is a neighborhood V of φ_{0}, an integer m, and a compact K ⊂ M^{k}such that, for every φ ∈ V, the order ofFφ(k) is smaller than m and Fφ(k) is supported in K.
Proof. According to Lemma III.6, for every φ_{0} in U, there is a neighborhood V of φ_{0}, a constant C, and a seminorm π_{n,K} of C^{∞}(M) such that
This means that the order of Fφ(k)−Fφ_{0}(k) is bounded by n (Ref [27], p. 64), and the order of Fφ(k) is bounded by n plus the order of Fφ_{0}(k). Moreover, if supp ψ ∩ K =∅, then π_{n,K}(ψ) = 0 and Fφ(k)(ψ)−Fφ_{0}(k)(ψ)=0. This means that the support of Fφ(k)−Fφ_{0}(k) is contained in K and the support of Fφ(k)(ψ) is contained in the compact K∪suppFφ_{0}(k).Note also that, in general, the order of the distributions is not bounded on U.
Lemma III.12. Letg∈D(R)and(χn){n∈Z}be a sequence of functions such thatχ_{n}∈D([n−1,n+1])and∑_{n∈Z}χ_{n}=1. Then, the functional
is Bastiani smooth onC^{∞}(R)but the order of F^{(k)}is not bounded onC^{∞}(R).
Proof. The functional F is smooth because, for every φ_{0}∈C^{∞}(R), we can define a neighborhood of φ_{0} by V = {φ; π_{0,K}(φ − φ_{0}) < ϵ}, where K is a compact neighborhood of the support of g. Let N be the smallest integer strictly greater than π_{0,K}(φ_{0}) + ϵ. Then, − N < φ(x) < N for every φ ∈ V and every x ∈ K and
is a finite sum of smooth functionals.However, the order of
is not bounded on C^{∞}(R). Indeed, for any positive integer n, we can find a smooth function φ such that χ_{n}φ(x)g(x)≠0 for some x ∈ supp g. Since Fφ(1)(ψ) contains a factor ψ^{(n)}(x), it is at least of order n.
D. Derivatives as smooth functionals
In Sec. IV, we equip several spaces of functionals with a topology. As a warm-up exercise, we show here that the maps F^{(k)} are smooth functionals from C^{∞}(M) to E^{′}(M^{k}).
We adapt to the case of functionals the general result given in item 4 of Proposition II.13 stating that if F is a smooth functional on U, then D^{k}F is a Bastiani smooth map from U to L(E^{k},K). We need to identify the topology of L(E^{k},K) used by Bastiani. Let us start with L(E,K). Bastiani furnishes E with the topology of convergence on all compact sets of E. In other words, the seminorms that define the topology of L(E,K) are p_{C}(u)=supf∈C|⟨u,f⟩|, where C runs over the compact subsets of C^{∞}(M). Since C^{∞}(M) is a Montel space (Ref [30], p. 239), the topology of uniform convergence on compact sets is the same as the strong topology (Ref [30], p. 235). This means that L(E,K) is the space E^{′}(M) of compactly supported distributions with its usual topology. Similarly, L(E^{k},K) can be identified to a subset of E^{′}(M^{k}) with its usual topology. We just obtained the following result:
Proposition III.13. Let U be an open subset of C^{∞}(M) andF:U→Kbe a Bastiani smooth functional. Then, for every integer k, the mapF^{(k)}:U→E^{′}(M^{k})is smooth in the sense of Bastiani.
IV. TOPOLOGIES ON SPACES OF FUNCTIONALS
We need to define a topology on the various spaces of functionals used in quantum field theory. The general idea is to define seminorms on F and its derivatives F^{(k)}. The topology proposed by Brunetti, Dütsch, and Fredenhagen [17] is the initial topology of all the maps F→Fφ(k), where each Fφ(k) belongs to a nuclear space determined by a wavefront set condition. This topology is nuclear, but the absence of a control of the dependence on φ makes it generally not complete. We then describe Bastiani’s topology, which is complete but has two drawbacks: it does not take wavefront set conditions into account and it is generally not nuclear. Finally we shall describe the family of topologies proposed by Dabrowski [21] which are both nuclear and complete.
A. Bastiani’s topology
Bastiani defines several topologies on the space of Bastiani smooth maps between two locally convex spaces (Ref [41], p. 65). For the case of functionals, we consider the topology defined by the following seminorms:
where C = C_{1} ×⋯× C_{k} and C_{i} runs over the compact sets of Γ(M, B). By using Bastiani’s results (Ref [41], p. 66), we obtain
Proposition IV.1. LetB→πMbe a finite rank vector bundle over the manifold M and Γ(M, B) be the space of smooth sections of B. Then, with the seminorms defined above, the space of smooth functionals on Γ(M, B) is a complete locally convex space.A similar topology was used by Glöckner (Ref [76], p. 367) and Wockel (Ref [77], p. 29 and Ref [78], p. 12).
B. Nuclear and complete topologies
Quantum field theory uses different spaces of functionals defined by conditions on the wave front set of Fφ(k). Recall that the wave front set describes the points and the directions of singularity of a distribution [79]. Dabrowski [21] recently described nuclear and complete topologies for spaces of functionals with wave front set conditions. We present some of his topologies for several common spaces of functionals.
Dabrowski’s definition differs from Bastiani in two respects. To describe the first difference, recall that, according to Proposition III.13, if F:U→R is a smooth functional, then the derivatives F^{(k)}:U→E^{′}(M^{k}) are smooth functionals. To add the wave front set conditions, Dabrowski requires F^{(k)} to be smooth from U to EΓ_{k}′(M^{k}), which is the space of compactly supported distributions whose wave front sets are included in Γ_{k}, a cone in T*M^{k}. In fact, Dabrowski supplements this definition with a more refined wave front set (the dual wave front set) which enables him to equip EΓ_{k}′(M^{k}) with a Montel, complete, ultrabornological, and nuclear topology. He also considers support conditions which are different from compact.
To describe the second difference, recall that Bastiani’s topology gives a locally convex space that is complete. However it is generally not nuclear. This is due to a theorem by Colombeau and Meise [80] which says, broadly speaking, that a function space over a Fréchet space cannot be nuclear for the topology of convergence over some balanced, convex, compact sets of infinite dimension. To avoid that problem, the variable φ is made to run over finite dimensional compact sets. More precisely, Dabrowski considers compact sets in R^{m} for any finite value of m and smooth maps f from R^{m} to an open subset of C^{∞}(M). He defines two families of seminorms:
where K is a compact subset of R^{m} for some m and C is an equicontinuous subset of the dual of the space of distributions to which Fφ(n) belong. Dabrowski proved that, with this family of seminorms, the space of functionals F is a complete locally convex nuclear space [22].
We describe now several types of functionals that have been used in the literature and we specify more precisely their topologies.
C. The regular functionals
A polynomial functional of the form
where the sum over n is finite and f_{n}∈D(M^{n}), is called a regular functional [81] because all its derivatives are smooth functions [82], i.e., the wave front set of Fφ(k) is empty. More generally, we define the space F_{reg}(M) of regular functionals to be the set of Bastiani smooth functionals F such that WF(F^{(n)}) = ∅ for every n > 0. Thus, F^{(n)}∈E∅′(M^{n})=D(M^{n}) and the sets C in Eq. (13) are the equicontinuous sets of D^{′}(M^{n}). By a general theorem (Ref [30], p. 200), the topology of uniform convergence on the equicontinuous sets of D^{′}(M^{n}) is equivalent to the topology given by the seminorms of its dual D(M^{n}). In other words, the topology of F_{reg}(M) is defined by the seminorms [22]
where p_{α,n} runs over a defining family of seminorms of D(M^{n}) [83]. With this topology, F_{reg}(M) is nuclear and complete.
Note that the tensor product of elements of D(M^{m}) with elements of D(M^{n}) is not continuous in D(M^{m+n}) [84]. Thus, the product in F_{reg}(M) is hypocontinuous but not continuous.
D. The microcausal functionals
It is possible to describe quantum field theory (up to renormalization) as the deformation quantization of classical field theory [26]. For the deformation quantization of the product FG of two functionals to first order in ℏ, we need to evaluate ⟨DF_{φ} ⊗ DG_{φ}, Δ_{+}⟩, where Δ_{+} is a singular distribution (the Wightman propagator) and ⟨·, ·⟩ is an extension of the duality pairing between distributions and test functions [85]. For this pairing to be meaningful to all orders in ℏ, the wave front set of Δ_{+} imposes that the wave front set of Dφ(k) must not meet the cone Γ_{k} defined as follows [26].
Let M be a Lorentzian manifold with pseudo-metric g. Let Vx+ (respectively, Vx−) be the set of (x;ξ)∈Tx*M such that g^{μν}(x)ξ_{μ}ξ_{ν} ≥ 0 and ξ_{0} ≥ 0 (respectively, ξ_{0} ≤ 0), where we assume that g^{00} > 0. We define the closed cone
where Ṫ{*}M^{n} is the cotangent bundle T*M^{n} without its zero section. The space F_{mc} of microcausal functionals was originally defined as the set of Bastiani smooth functionals such that Fφ(n)∈EΞ_{n}′(M^{n}) for every φ, where Ξ_{n} = Ṫ{*}M^{n}∖Γ_{n} is an open cone [16,17,20,26,81,86,87].
However, the space EΞ_{n}′(M^{n}) being not even sequentially complete [85], it is not suitable to define a complete space of functionals. Therefore, Dabrowski defines the space F_{mc} of microcausal functionals to be the set of Bastiani smooth functionals such that Fφ(n)∈EΞ_{n},Ξ¯{n}′(M^{n}), which is the completion of EΞ_{n}′(M^{n}). Dabrowski proved that EΞ_{n},Ξ¯{n}′(M^{n}) is the set of compactly supported distributions u∈E^{′}(M^{n}) such that the dual wavefront set of u is in Ξ_{n} and the wavefront set of u is in its closure Ξ¯{n} (see Ref [21] for a precise definition of these concepts and of the topology). This completion is not only complete but even Montel and nuclear [21]. According to the general results of Ref [21], the sets C are now equicontinuous sets of the bornologification of the normal topology of DΓ_{n}′. However, it was shown [21] that these equicontinuous sets are the same as the bounded sets of DΓ_{n}′ with its normal topology. Therefore, the sets C are the well-known bounded sets of DΓ_{n}′ [85].
With this topology, the space F_{mc} is a complete nuclear algebra with hypocontinuous product.
E. Local functionals
As discussed in the Introduction, local functionals are the basic building block (Lagrangian) of quantum field theory. We shall see that local functionals are a closed subset of the set of smooth functionals such that Fφ(1) can be identified with an element of D(M) that we denote by ∇F_{φ} and the wave front set of Fφ(k) is included in the conormal C_{k} of D_{k} = {(x_{1}, …, x_{k}) ∈ M^{k}; x_{1} =⋯= x_{k}}. Recall that the conormal of D_{k} is the set of (x_{1}, …, x_{k}; ξ_{1}, …, ξ_{k}) ∈ T*M^{k} such that x_{1} =⋯= x_{k} and ξ_{1} +⋯+ ξ_{k} = 0.
Since the additivity property (defined in Sec. V C) of local functionals complicates the matter, we follow Dabrowski [21] and, for any open set Ω ⊂ M, we first define F_{C}(Ω) to be the set of smooth maps such that φ ↦ ∇F_{φ} is Bastiani smooth from C^{∞}(Ω) to D(M) and, for every integer k, φ↦Fφ(k) is Bastiani smooth from C^{∞}(Ω) to EC_{k}′(M^{k}) [we do not need to index E^{′}(M^{k}) with two cones because C_{k} is closed [21]]. The set F_{loc}(Ω) of local functionals is then the subset of F_{C}(Ω) satisfying the addivity condition.
The topology of F_{C} is induced by the family of seminorms given by Eq. (15) that depend on the equicontinuous sets of the dual DΛ_{k},Λ¯{k}′(M^{k}) of DC_{k}′(M^{k}), where Λ_{k} = Ṫ{*}M^{k}∖C_{k}. They were determined by Dabrowski (Ref [21], Lemma 28).
Proposition IV.2. A subset B ofDΛ_{k}′(M^{k})is equicontinuous if and only if there is a closed cone Γ ⊂ Λ_{k}such that WF(u) ⊂ Γ for every u ∈ B and B is bounded inDΓ′(M^{k}).The bounded sets of DΓ′(M^{k}) are characterized in detail in Ref [85]. The topology of DΛ_{k}′(M^{k}), where Λ_{k} is open, can be described as a non-countable inductive limit as follows. Write the complement Λkc=∪Γ_{n}, where each Γ_{n} is a compactly supported closed set. We write the open set Γnc as a countable union of closed sets Γnc=∪_{m}Λ_{n,m} so that Γ_{n}=∩_{m}Λn,mc and Λkc=∪_{n}∩_{m}Λn,mc is a countable union of countable intersections of open sets. We obtain Λ_{k} = ∩_{n} ∪_{m}Λ_{n,m}. We define for a sequence α the closed set Π_{α} = ∩_{n}Λ_{n,α(n)} such that α ≤ β implies Π_{α} ⊂ Π_{β}. Then Λ = ∪_{α}Π_{α} is a non-countable inductive limit of closed cones from which we can define the topology of DΛ_{k}′(M^{k}) as a non-countable inductive limit of DΠ_{α}′(M^{k}).The space F_{C} furnished with the topology induced by the seminorms defined by Eqs. (12) and (13) is complete and nuclear. The space F_{loc} of local functionals is the closed subset of F_{C} defined by the additivity condition defined in Sec. V. As a closed subspace of a nuclear complete space, the space of local functionals is nuclear and complete.Further examples of spaces of functionals are given by Dabrowski [22].
V. ADDITIVITY
The characterization of local functionals is a long-standing mathematical problem. According to Rao [88], the first criterium was proposed by Pinsker in 1938 and called partial additivity [89]. This criterium is also used in physics, but we shall see that it is not what we need by exhibiting a partially additive functional which is not local. Then, we shall discuss a more stringent criterium that is exactly what we need.
A. Partial additivity
When looking for an equation to characterize functionals having the form of Eq. (1), one can make the following observation. Let φ_{1} and φ_{2} be two smooth functions with disjoint supports K_{1} and K_{2} and assume that f(x, φ(x), …) = 0 if φ = 0 on a neighborhood of x [89] so that F(0) = 0. Then, since the support of φ_{1} + φ_{2} is included in K_{1} ∪ K_{2},
Therefore, it is tempting to use the condition of locality,
for φ_{1} and φ_{2} with disjoint support and functionals F such that F(0) = 0. And indeed, many authors since 1938, including Gelfand and Vilenkin (Ref [90], p. 275), used condition (16), but with disjoint support replaced by φ_{1}φ_{2} = 0 and smooth functions by measurable functions (see Ref [88] for a review). In perturbative quantum field theory, partial additivity in our sense is also used when the function f in Eq. (1) is polynomial [17,91,92] because, in that case, partial additivity is equivalent to locality in the sense of Eq. (1) [17].
However, this definition of locality does not suit our purpose, essentially because the set of functions φ that can be written as φ = φ_{1} + φ_{2} (with supp φ ∩ supp φ_{2} = ∅) is not dense in the space of smooth functions. We show this now and we construct a partially additive functional which is not local.
B. A non-local partially additive functional
We work in the space C^{∞}(S^{1}) of smooth functions on the unit circle. We denote by I the subset of functions f = φ_{1} + φ_{2} which are sums of the two elements of C^{∞}(S^{1}) whose supports are disjoint. It is not a vector subspace of C^{∞}(S^{1}).
The idea of the construction is the following. In the metric space C^{∞}(S^{1}), we will show that the subset I is bounded away from the constant function f = 1. This means that the functional equation (16) only concerns the restriction F|_{I} to a subset which is bounded away from 1. Therefore there is some open neighborhood of f = 1 which does not meet I. Then we use Sobolev norms to build some cutoff function χ to glue a local functional near I with a nonlocal functional near f = 1.
Lemma V.1. The constant function f = 1 is bounded away fromIinC^{∞}(S^{1}): iff∈I, then||f−1||_{C^{0}}=sup_{x∈S^{1}}|f(x)−1|≥1.
Proof. Let us denote by ‖.‖{C^{0}} the norm ‖f‖{C^{0}}=sup_{x∈S^{1}}|f(x)|. It is a continuous norm for the Fréchet topology of C^{∞}(S^{1}) because ||f||_{C^{0}}=π_{0,S^{1}}(f). Then, if supp φ_{1} ∩ supp φ_{2} = ∅, we have ‖φ_{1}+φ_{2}−1‖{C^{0}}⩾1. Indeed, the supports of φ_{1} and φ_{2} being compact, the fact that they do not meet implies that they are at a finite distance. Thus, there is a point x∈S^{1} such that φ_{1}(x) = φ_{2}(x) = 0. Hence, |φ_{1}(x) + φ_{2}(x) − 1| = 1 and sup_{x∈S^{1}}|φ_{1}(x)+φ_{2}(x)−1|≥1.The second step is to build a smooth function χ such that χ(1) = 1 and χ_{I}=0.
Lemma V.2. There is a smooth functionχ:C^{∞}(S^{1})→Rsuch that χ = 1 on a neighborhood of f = 1 and χ(f) = 0 if||f−1||_{C^{0}}≥1. In particular,χ_{I}=0.
Proof. First recall that the Sobolev norm H^{2k} on S^{1} is defined as
where the last representation uses the Fourier series f(x)=∑_{n}f^(n)e^{inx}. By the Sobolev injections, H^{2}(S^{1}) injects continuously in C^{0}(S^{1}). In other words, there is a constant C > 0 such that ‖f‖{C^{0}}⩽C‖f‖{H^{2}} for every f∈C^{∞}(S^{1}).Now we take a function g∈C^{∞}(R) such that g(t) = 1 when t ≤ 1/3C^{2} and g(t) = 0 when t ≥ 1/2C^{2} and we define χ:C^{∞}(S^{1})→R by composing g with the square of the Sobolev norm,
If ‖1−f‖{C^{0}}⩾1 (in particular, if f∈I by Lemma V.1), the Sobolev injection leads to
hence g‖1−f‖H^{2}2=0 by definition of g.On the other hand, ‖1−f‖{H^{2}}⩽13C means that f belongs to the neighborhood of the constant function f = 1 defined by V={f;‖1−f‖{H^{2}}⩽1/3C}. On this neighborhood, g‖1−f‖H^{2}2=1. The smoothness of χ is an immediate consequence of the chain rule, the smoothness of g and of the squared Sobolev norm ‖.‖H^{2}(S^{1})2.We are now ready to define our counterexample:
Theorem V.3. The functional F_{nl}onC^{∞}(S^{1})defined for any integer N > 1 by
is partially additive but not local.
Proof. For every (φ_{1},φ_{2})∈C^{∞}(S1){2} whose supports are disjoint, f=φ_{1}+φ_{2}∈I, hence χ(f) = 0 by Lemma V.2. Moreover, we saw that if supp φ_{1} ∩ supp φ_{2} = ∅, then there is a point x∈S^{1} such that φ_{1}(x) = φ_{2}(x) = 0. Thus, ||1−φ_{1}||_{C^{0}}≥1 and ||1−φ_{2}||_{C^{0}}≥1. As a consequence, χ(φ_{1}) = χ(φ_{2}) = 0 by Lemma V.2 and F_{nl}(φ_{1}+φ_{2})=∫_{S^{1}}(φ_{1}(x)+φ_{2}(x))dx=F_{nl}(φ_{1})+F_{nl}(φ_{2}).On the other hand, in the neighborhood V of f = 1 given by Lemma V.2, χ(f) = 1 hence F_{nl}(f)=∫S1f(x)dx{N} which is not local. It is even a typical example of a multilocal functional [16].Since partial additivity is equivalent to locality for polynomial functions, the non-locality of F_{nl} can be considered to be non-perturbative. Moreover, the fact that the derivatives D^{n}F_{nl} calculated at f = 0 are supported in the thin diagonal of (S1){n}, although F_{nl} is not local, means that locality cannot be controlled by the support of differentials taken at a single function f. We come now to the property that is relevant for quantum field theory.
C. Additive functionals
In 1965, Chacon and Friedman [93] introduced a more stringent concept of additivity that meets our needs.
Definition V.4. We say that a Bastiani smooth mapF:C^{∞}(M)→Kis additive if, for every triple (φ_{1}, φ_{2}, φ_{2}) of smooth functions on M, the property supp φ_{1} ∩ supp φ_{3} = ∅implies the property
In the literature, the additivity equation (19) is also called the Hammerstein property [94–99]. The additivity property is equivalent to the fact that the functional derivatives are supported on the thin diagonal D_{n} = {(x_{1}, …, x_{n}) ∈ M^{n}; x_{1} =⋯= x_{n}} [17,92].
Proposition V.5. A smooth functional F on C^{∞}(M) is additive if and only ifsuppFφ(2)⊂D_{2}for every φ ∈ C^{∞}(M), where D_{2} = {(x, y) ∈ M^{2}; x = y}. If F is an additive functional, thensuppFφ(n)⊂D_{n}for every φ ∈ C^{∞}(M), where D_{n} = {(x_{1}, …, x_{n}) ∈ M^{n}; x_{1} =⋯= x_{n}}.
Proof. We first prove that the second derivative of an additive functional is localized on the diagonal [17]. If we use the additivity property with φ_{1} = λψ, φ_{3} = μχ and supp ψ ∩ supp χ =∅, then
Since no term on the right-hand side of this equation depends on both λ and μ, we have
This equation, being true for every φ_{2}, can be written as Fφ(2)(ψ⊗χ)=0 for every φ and every pair (ψ, χ) with disjoint supports. Now for every point (x, y) ∈ M^{2} such that x ≠ y, there are two open sets U_{x} containing x and U_{y} containing y such that U_{x} ∩ U_{y} =∅. Then, any pair of functions ψ and χ supported in U_{x} and U_{y} satisfies Fφ(2)(ψ⊗χ)=0. Since the functions ψ ⊗ χ are dense in D(M^{2}), this implies that every test functions f∈D(M^{2}) supported in U_{x} × U_{y} satisfies Fφ(2)(f)=0. Thus (x,y)∉suppFφ(2) and suppFφ(2)⊂D_{2}. To determine the support of Fφ(n), consider a point (x_{1}, …, x_{n}) which is not in D_{n}. Then, there are two indices i and j such that x_{i} ≠ x_{j}. Denote by U_{x} an open neighborhood of x_{i} and by U_{y} an open neighborhood of x_{j} and repeat the previous proof to obtain Fφ(2)(ψ⊗χ)=0 for every φ and every pair (ψ, χ) with supports in U_{x} and U_{y}. Now, rewrite φ = φ_{0} + ∑λ_{k}ψ_{k}, where ψ_{k}(x_{k}) ≠ 0 and the sum is over all integers from 1 to n except i and j. Then, the derivatives with respect to λ_{k} are all zero and we find again with the same argument that (x_{1}, …, x_{n}) is not in the support of Fφ(n) for every φ.Conversely [20,92], assume that suppFφ(2)⊂D_{2} for every φ. As we have seen in the first part of the proof, this means that if ψ and χ have disjoint support, then D^{2}F_{φ}(ψ,χ)=Fφ(2)(ψ⊗χ)=0. By the fundamental theorem of calculus,
Thus,
The last term is zero because D^{2}F_{φ}(ψ, χ) = 0 and the second term is F(φ + χ) − F(φ). We recover the additivity condition.Finally, additivity is stronger than partial additivity because the latter corresponds to the case φ_{2} = 0 and F(0) = 0. It is strictly stronger because F_{nl} is not additive.
VI. CHARACTERIZATION OF SMOOTH LOCAL FUNCTIONALS
In this section, we give a characterization of local functionals inspired by the topology described in Sec. IV E. In the sequel, we shall deal with compactly supported distributions u with empty wavefront sets. We repeat the definition of local functionals in terms of jets.
Definition VI.1. Let U be an open subset of C^{∞}(M). A Bastiani smooth functionalF:U→Kis said to be local if, for every φ ∈ U, there is a neighborhood V of φ, an integer k, an open subsetV⊂J^{k}M, and a smooth functionf∈C^{∞}(V)such thatx∈M↦f(jxkψ)is supported in a compact subset K ⊂ M and
whenever φ + ψ ∈ V and wherejxkψdenotes the k-jet of ψ at x.We invite the reader not familiarized with jet bundles to have a look at Sec. VI A, where these objects are carefully defined. Note that the representation of F by f is not unique: adding the total derivative of a function does not change the result. We shall see that f belongs to a unique cohomology class for some specific cohomology theory on the space of local functionals.Before we state the main theorem of this section, let us start by some useful definition—lemma:
Lemma VI.2. Let U be an open subset of C^{∞}(M) andF:U→Kbe Bastiani smooth. For every φ such that the distributionDF_{φ}∈E^{′}(M)has an empty wave front set, there exists aunique function∇F_{φ}∈D(M)such that
Proof. Once a density dx is fixed on M, functions in Lloc1(M) [in particular in C^{∞}(M)] can be identified with distributions by the map
and Ref [32], Theorem 1.2.4, shows that the distribution is uniquely defined when f is continuous hence when f is smooth.Since WF(DF_{φ}) =∅, there exists a unique C^{∞} function ∇F_{φ} which represents the distribution DF_{φ}∈E^{′}(M) by integration on M against dx.The main theorem of this section is
Theorem VI.3. Let U be an open subset of C^{∞}(M) andF:U→Kbe Bastiani smooth. Then, F is local if and only if the following two conditions are satisfied:
1. F is additive.
2. For every φ ∈ U, the differentialDF_{φ}=Fφ(1)of F at φ has an empty wave front set and the map φ ↦ ∇F_{φ}is Bastiani smooth from U toD(M).Note that our definition of locality is strictly more general than the usual one because the counterexample described in Lemma III.12 is local in our sense but not in the sense of Eq. (1) since its order is infinite.The proof is delayed to Sec. VI C. Since this theorem deals with jets, we start with a short presentation of the jet bundle. Our point of view on jets is based on the concept of infinitesimal neighborhoods due to Grothendieck and is closely related to several expositions in the literature [100–102].
A. The manifold of jets of functions on a manifold
Let M be a manifold. For every smooth real-valued function φ on M, we call k-jet of φ at a point x ∈ M the class jxk(φ) of φ in the quotient C^{∞}(M)/Ixk+1, with the understanding that Ixk+1 stands for the (k + 1)-th power of the ideal I_{x} of smooth functions on M vanishing at x ∈ M. Recall that Ixk+1 coincides with the ideal of smooth functions on M whose k + 1 first derivatives vanish at the point x.
For all x ∈ M, the space Jxk(M) of all k-jets of functions on M at x coincides with C^{∞}(M)/Ixk+1 and is called the space of k-jets at x. It is clearly a vector space. The disjoint union J^{k}(M)≔∐_{x∈M}Jxk(M) is a smooth vector bundle over M called the bundle of kth jets. Consider the map
where i_{x}:M→M×M is the map y ↦ (x, y). It is known that J_{Δ} is surjective onto the space of smooth sections of J^{k}(M) and its kernel is the (k + 1)-th power of the ideal I_{Δ} of functions on M × M vanishing on the diagonal.
Last, the projection p_{1}: M × M → M onto the first component dualizes in an algebra morphism φ↦p1*φ from C^{∞}(M) to C^{∞}(M × M) which endows C^{∞}(M × M) with a C^{∞}(M)-module structure. The space of sections of J^{k}(M) is also a C^{∞}(M)-module, and it is routine to check that J_{Δ} is a morphism of C^{∞}(M)-modules. Therefore, the space of sections of J^{k}(M) is, as a C^{∞}(M)-module, isomorphic to the quotient C^{∞}(M×M)/IΔk+1 and Γ(J^{k}(M)) fits into the following exact sequence of C^{∞}(M)-modules:
And the map that to f associates its k-jet reads
The purpose of the rest of this section is to prove the technical proposition VI.4, the statement of which we now explain. For all integers k∈N, there is a natural vector bundle morphism J^{k} from the trivial bundle over M with typical fiber E = C^{∞}(M) to the bundle J^{k}(M) → M of k-jets. This morphism simply consists in assigning to a pair (f, x) in E × M → M the k-jet of f at x. In equation,
The result goes as follows.
Proposition VI.4. Let E = C^{∞}(M), V ⊂ E be an open subset, andk∈Nbe an integer.
1. The subsetJ^{k}(V×M)is an open subset of j^{k}(M).
2. Let c be a smoothK-valued function on V × M, with V ⊂ E being an open subset. Assume that c(f, x) depends only on the k-jet of the function f at the point x. Then there exists a unique smoothK-valued functionc̃on the open subsetJ^{k}(V×M)⊂j^{k}(M)that makes the following diagram commutative:
i.e., such that the relationc(f,x)=c̃(jxk(f))holds for all f ∈ V and x ∈ M.When V = E, Proposition VI.4 specializes to the following easier statement:
Corollary VI.5. Let c be a smooth function from E × M toK. Assume that there exists an integer k such that c(f, x) depends only on the k-jet of the function f at the point x. Then there exists a unique smoothK-valued functionc̃on j^{k}(M) such that the following diagram commutes:
i.e., such that the relationc(f,x)=c̃(jxk(f))holds for all f ∈ E and x ∈ M.Before establishing these results, we shall need several lemmas.
Lemma VI.6. The vector bundle morphismJ^{k}described in(21)is surjective and admits a smooth sections^{k}.
Proof. The section s^{k}, when it exists, is by construction a right inverse of J^{k}, the latter is surjective. It suffices therefore to prove the existence of s^{k}.We first prove that the lemma holds true for M an open subset V of R^{d}. In that case, the bundle of k-jets jxk(V) is isomorphic to the trivial bundle over V with a typical fiber, the space of polynomials of degree less or equal to k. There is an obvious candidate for the section of J^{k}: it consists in mapping α_{x}∈jxk(V) to the unique polynomial of degree k whose k-jet at x ∈ V is α. The henceforth obtained assignment, which we denote by sVk, is a smooth vector bundle morphism from j^{k}(V) → V to the trivial bundle C^{∞}(V) × V → V. It is by construction a section of J^{k}.We now go back to the general case of an arbitrary manifold M. For every point x ∈ M, choose V_{x} a coordinate neighborhood and let χ be a smooth function with compact support on V_{x} which is identically equal to 1 in a neighborhood Vx′⊂V_{x} of x. Since V_{x} is a coordinate neighborhood, it can be identified with an open subset of R^{d}, which allows us to consider
as in the previous paragraph. We can then consider the composition of vector bundle morphisms over V_{x},
where j^{k}(M){Vx}≃j^{k}(V_{x}) is the obvious identification of the k-jet bundle of V_{x} to the restriction to V_{x} of the k-jet bundle on M and where m_{χ} is the smooth linear map from C^{∞}(V_{x}) to E = C^{∞}(M) defined by m_{χ}(f) = fχ. Since χ is identically equal to 1 on Vx′, the restriction to Vx′ of this vector bundle morphism is by construction a section of the restriction of J^{k} to Vx′.Since the manifold M is paracompact, [103] the latter point implies that the manifold M can be covered by open subsets (Ui){i∈I} such that the restriction of J^{k} to U_{i} admits a section sik. Without any loss of generality, we can assume the existence of a smooth partition of unity (χi){i∈I} relative to this open cover. A global smooth section of J^{k} is then given by the explicit formula s^{k}=∑_{i∈I}χ_{i}sik, as follows from the obvious computation:
where we used the fact that j^{k} commutes with multiplications by χ_{i} since j^{k}:E×M↦J^{k}M is a vector bundle morphism. This completes the proof.Since c:V×M→K is only defined on the open subset V × M of E × M, we need the following refinement of Lemma VI.6 where the local sections txk of J^{k} are valued in V × M:
Lemma VI.7. For every (f, x) ∈ E × M, the vector bundle morphismJ^{k}described in(21)admits a smooth sectiont^{k}through [104] (f, x).
Proof. Notice that Lemma VI.7 can be derived from Lemma VI.6 for any vector bundle morphism over the identity of M. A careful check shows that the arguments below are absolutely general and indeed show that for any two vector bundles E_{1}, E_{2} over M, any vector bundle morphism E_{1} ↦ E_{2} over M that admits a section is a submersion and admits a section through every point of E_{1}.We prefer to do it, however, in our particular setting—since one of the bundles is infinite dimensional and requires careful attention.Let s^{k} be a section of J^{k} as in Lemma VI.6. Consider the smooth map defined at all points y ∈ M by
This map is smooth by construction. It is again a section J^{k}, as follows from the following computation, valid for all y∈M,β∈jyk(M):
Then the section t^{k} above satisfies by construction
This completes the proof.Lemma VI.7 has the following immediate consequence.
Lemma VI.8. The vector bundle morphismJ^{k}described in(21)is a submersion.
Proof. For every (f, x) in E × M, let us choose t^{k} to be a section through (f, x) as in Lemma VI.7. By construction, the differential of J^{k} at (f, x) admits the differential of t^{k} at J^{k}(f,x) as right inverse, so it is surjective.We can now prove Proposition VI.4.
Proof. Since the vector bundle morphism J^{k} described in (21) is a submersion by Lemma VI.8 and since V × M is open in E × M, the subset J^{k}(V×M) is an open subset of j^{k}(M). This proves the first item in Proposition VI.4.Let us now prove the second item. Assume that we are given a function c:V×M↦K such that the value c(f, x) at an arbitrary f ∈ E and x ∈ M depends only the k-jet of f at x. The existence of an unique function c̃ from j^{k}(M) to K making the diagram (22) commute is simply a set-theoretic property: the difficulty is to show that this function c̃ is smooth.When V = E (i.e., under the assumptions of Corollary VI.5), the smoothness of c̃ follows directly from Lemma VI.6, which implies that the commutative diagram (23) can be completed to
which amounts to say that the following relation holds:
The latter formula and the smoothness of s^{k} implies that when c is assumed to be a smooth function, so is the function c̃ by composition. This proves Corollary VI.5.For the general case, we have to choose, for all α∈J^{k}(V×M), a section t^{k} of J^{k} such that t^{k}(α)∈V×M. Such a section t^{k} always exists by Lemma VI.7. Since t^{k} is smooth, there exists a neighborhood W_{α} of α in J^{k}(V×M) on which t^{k} takes values in the domain of definition V × M of c, which implies that the commutative diagram (22) can be completed to
In turn, the commutativity of this diagram gives the explicit description of c̃ through the following formula, valid on W_{α}:
Formula (25) and the smoothness of t^{k} imply that when c is assumed to be a smooth function, so is, by composition, the restriction to W_{α} of the function c̃. Since every α∈J^{k}(V×M) admits a neighborhood on which the restriction of c̃ is smooth, the function c̃ is a smooth function. This completes the proof.
B. Properties of Fϕ(2)
We first show that the two assumptions of our theorem are equivalent to some strong assumptions on the second derivative of F:
Lemma VI.9. Let U be an open subset of C^{∞}(M) andF:U→Kbe Bastiani smooth. Assume that for every φ ∈ U, the differentialDF_{φ}=Fφ(1)of F at φ has no wave front set, i.e.,WF(Fφ(1))=∅. Then the two following properties are equivalent:
1. F is additive and the map φ ↦ ∇F_{φ}is Bastiani smooth from U toD(M).
2. For every φ_{0} ∈ U, there is a neighborhood V of φ_{0}, a compact K ⊂ M, and a finite family of Bastiani smooth mapsf_{α}:V→D(K)with|α|⩽ksuch that in any system of local coordinates (x, y) on M^{2},
for every φ ∈ V.In particular, both conditions imply that D^{2}F_{φ} is represented by a distribution Fφ(2) whose wave front set is the conormal bundle of the diagonal in M^{2} (Ref [105], p. 32).In the sequel, we shall often use the following simple lemma:
Lemma VI.10. Let E, F, and G be locally convex spaces. If f: E → F is Bastiani smooth and ℓ: F → G is linear and continuous, then ℓ ○ f: E → G is Bastiani smooth and D^{k}(ℓ ○ f) = ℓ ○ D^{k}f.
Proof. This is a consequence of three facts: the map ℓ is Bastiani smooth because it is linear and continuous, ℓ ○ f is Bastiani smooth because it is the composition of two Bastiani smooth maps, and the chain rule.We also need the following lemma in the proof of Lemma VI.9:
Lemma VI.11. Let U be a convex open subset of E = C^{∞}(M) containing the origin and F: U → E be a Bastiani smooth map. Then, G: U → E defined byG(φ)=∫01F(sφ)dsis Bastiani smooth.
Proof. The first step is to define a candidate for the Bastiani differential D^{k}G by determining D^{k}G(x) pointwise in x ∈ M. For every (t_{1}, …, t_{k}, x) ∈ [0, 1]^{k} × M and (φ, ψ_{1}, …, ψ_{k}) ∈ U × E^{k}, the function (t_{1},…,t_{k},x)↦∫01dsF(s(φ+t_{1}ψ_{1}+⋯+t_{k}ψ_{k}))(x) is smooth in (t_{1}, …, t_{k}, x) by dominated convergence theorem since x can always be restricted to some compact subset K ⊂ M to obtain uniform bounds. We can differentiate in (t_{1}, …, t_{k}) outside and inside the integral and both differentials coincide. Therefore, for every x ∈ M, the Bastiani kth-differential D^{k}G(x) of G(x)=∫01dsF(sφ(x)) exists and satisfies the relation D^{k}G_{φ}(ψ_{1},…,ψ_{k})(x)=∫01dss^{k}D^{k}F_{sφ}(ψ_{1},…,ψ_{k})(x). Let us show that D^{k}G: U × E^{k} ↦ E is jointly continuous in (φ, ψ_{1}, …, ψ_{k}).We know that the map χ: (s, φ, ψ_{1}, …, ψ_{k}) ∈ [0, 1] × U × E^{k} ↦ s^{k}D^{k}F_{sφ}(ψ_{1}, …, ψ_{k}) ∈ E is continuous by joint continuity of D^{k}F: U × E^{k} ↦ E and composition of the continuous maps
where ψ = (ψ_{1}, …, ψ_{k}). Then by Ref [40], Theorem 2.1.5, p. 72, applied to the function χ, the integrated map (φ,ψ_{1},…,ψ_{k})↦∫01dss^{k}D^{k}F_{sφ}(ψ_{1},…,ψ_{k}) is continuous and the proof is complete because continuity holds true for every k.Let us now prove Lemma VI.9.
Proof. First of all, by Proposition V.5, F is additive if and only if its second derivative is represented by a distribution supported in the diagonal. We start by proving the direct sense assuming that φ ∈ U ↦ ∇F_{φ} ∈ C^{∞}(M) is Bastiani smooth.We first show that item 1 implies item 2 in Lemma VI.9. Since F is Bastiani smooth for any φ_{0} ∈ U, we already know by Proposition III.4 that there is some neighborhood V of φ_{0} on which F|_{V} has fixed compact support that we denote by K. Therefore, ∇F_{φ} belongs to D(K) for every φ ∈ V and Fφ(2) is supported in K × K. Since Fφ(2) is also supported in the diagonal of M^{2} by Proposition V.5, the support of Fφ(2) is contained in the diagonal of K × K which can be identified with K itself.Since DF_{φ} has an empty wavefront set by assumption, its singular support is empty and it can be represented by a unique smooth compactly supported function ∇F_{φ} (Ref [32], p. 37) such that
The main step is to represent Fφ(2) as the Bastiani differential of ∇F_{φ} by calculating the second derivatives in two different ways. The Bastiani smoothness of F yields
where we used the Schwarz lemma and Eq. (27). To justify switching ddt_{2} and integration over M, observe that the map φ∈U↦∇F_{φ}∈D(M) is Bastiani smooth, hence C^{1}. It follows by the chain rule that t↦ddt∇F_{φ+tg} is a C^{0} map valued in D(M). Since ∇F_{φ} is actually in D(K) for every φ ∈ V and the topology induced by D(M) on D(K) is the usual Fréchet topology of D(K), the map ∇F is smooth from V to the Fréchet space D(K).Since D(K) injects continuously in (C^{0}(K), π_{0,K}), this implies that (t,x)∈[−1,1]×K↦ddt∇F_{φ+tg}(x)∈C^{0}([−1,1]×K). Hence the integrand ddt_{2}∇F_{φ+t2g}(x)h(x) is in C^{0}([−1, 1] × K) and is bounded on the integration domain. A continuous map u: t ∈ [−1, 1] ↦ u(t, .) ∈ (C^{0}(K), π_{0,K}) corresponds to a map also denoted by u ∈ C^{0}([−1, 1] × K). Indeed for every convergent sequence (t_{n},x_{n})→n→∞(t,x) in [−1, 1] × K, the simple estimate |u(t,x)−u(t_{n},x_{n})|⩽|u(t,x)−u(t,x_{n})|+|u(t,x_{n})−u(t_{n},x_{n})|⩽|u(t,x)−u(t,x_{n})|+π_{0,K}(u(t_{n},.)−u(t,.)) shows that u(t_{n},x_{n})→n→∞u(t,x).By the dominated convergence theorem, we can differentiate under the integral sign,
By definition ddt_{2}∇F_{φ+t2g}|_{t2=0} is only the Bastiani derivative
where D∇F is a Bastiani smooth map since ∇F is Bastiani smooth.Note also that by Theorem III.9, the second derivative D^{2}F_{φ}(g, h) can be represented by a map φ∈U↦Fφ(2)∈E^{′}(M^{2}) such that ∀(φ,g,h)∈U×C^{∞}(M){2},D^{2}F_{φ}(g,h)=Fφ(2),g⊗h, which means that Fφ(2) is the distributional kernel of the second derivative D^{2}F_{φ}. We now arrive at the following equality that identifies two different representations of the second derivative. For every (φ, g, h) ∈ U × C^{∞}(M)^{2},
By the same theorem III.9 and the chain rule, D∇F_{φ}[g](y) = ev_{y}D∇F_{φ}[g] is linear continuous in g ∈ C^{∞}(M), hence there is a distribution, denoted by D∇F_{φ}(x, y), such that ∫_{M}D∇F_{φ}(x, y)g(x)dx = D∇F_{φ}[g](y) and ∫_{M}D∇F_{φ}(x, y)g(x)dx is in D(K) by Eq. (28). Since the above identity holds for all (g, h) ∈ C^{∞}(M)^{2}, we have in the sense of distributions that Fφ(2)(x,y)=D∇F_{φ}(x,y) where the map
is Bastiani smooth.It suffices to do the last part of the proof, which is local in nature, on M=R^{d}. We now represent Fφ(2)(x,y) as a C^{∞}(M)-linear combination of derivatives of Dirac distributions concentrated on the diagonal. By Proposition V.5, the additive property satisfied by F implies that the distribution F^{(2)} associated with the second derivative D^{2}F is supported in the diagonal D_{2} ⊂ M × M. By Proposition III.11, the kernel Fφ(2)(x,y)∈E^{′}(M×M) has bounded distributional order uniformly in φ ∈ V. Schwartz’ theorem on distributions supported on a submanifold (Ref [27], p. 101) states that in local coordinates, there exists a finite sequence of distributions φ∈V↦fα(φ,.)∈D(K){|α|⩽k} such that Fφ(2)=∑_{|α|⩽k}f_{α}(φ,x)∂yαδ(x−y). We denote the distributions f_{α}(φ) by f_{α}(φ, x) because we shall show that φ ↦ f_{α}(φ) is Bastiani smooth from V to D(K).By Eq. (30), we know that for every (φ, g) ∈ V × C^{∞}(M) the map from V × C^{∞}(M) to D(K) defined by
is smooth. Choosing g to be equal to the Fourier oscillatory function e^{−i⟨ξ.x⟩}, we obtain by the chain rule the maps that send (φ, ξ) to
is Bastiani smooth. Moreover, since the image of the map in Eq. (30) is in D(K) for every smooth g, we obtain that ∑_{|α|⩽k}(−1){|α|}f_{α}(φ,⋅)(−iξ){α} is in D(K) for every ξ. This is only possible if f_{α}(φ)∈D(K) for every |α|⩽k. Therefore φ↦f_{α}(φ)=(iddξ){α}∫_{M}Fφ(2)(.,y)e^{−i⟨ξ.y⟩}dy|_{ξ=0} is Bastiani smooth from V to D(K) and the proof of the direct sense is complete.Conversely, we want to prove that if there is a neighborhood V of φ_{0}, a compact K ⊂ M, and a finite family of smooth maps φ↦f_{α}(φ)∈D(K),|α|⩽k, such that in any system of local coordinates (x, y) on M^{2},
then φ↦∇F_{φ}∈D(M) is Bastiani smooth. Without loss of generality, we assume that V is convex. By the Taylor formula with remainder for Bastiani smooth functions, for every (φ, ψ_{1}, ψ_{2}) ∈ V × C^{∞}(M)^{2},
for s_{1} and s_{2} small enough. It follows by the fundamental theorem of calculus and by evaluating at s_{1} = 0 the previous relation that
where by assumption DF_{φ}(ψ_{1}) is represented by integration against a smooth function
and Fφ+sψ(2) is supported on a subset of the diagonal D_{2} ⊂ M × M that can be identified with K. Hence, for ψ ∈ C^{∞}(M) such that φ + ψ ∈ V,
To show that the map χ:V→D(K) defined by χ(ψ) = ∇F_{φ+ψ} is smooth, we notice that, according to the last equation, ∇F_{φ+ψ} is the sum of the constant (i.e. independent of ψ) ∇F_{φ} and a finite linear combination of products of ψ ↦ ∂^{α}ψ by an integral over s. The integrand f_{α}(φ + sψ) is smooth by assumption. Therefore, the map
is smooth by Lemma VI.11 and the fact that the topology induced on D(K) by the topology of C^{∞}(M) is the standard topology of D(K). The map ψ ↦ ∂^{α}ψ is smooth because it is linear and continuous. Finally, the product of the integral by ∂^{α}ψ is smooth by a trivial extension of Lemma VI.15. This completes the proof of Lemma VI.9.We are now ready to prove Theorem VI.3 characterizing local functionals.
C. Proof of Theorem VI.3
Let us start by proving the converse where we assume that F is the integral of some local function on jet space. Let φ ∈ U and V be some neighborhood of φ such that F(φ+ψ)=∫_{M}f(x,jxkψ)dx for every ψ ∈ V where jxkψ is the k-jet of ψ at x and where f is smooth and compactly supported in the variable x in some fixed compact K ⊂ M. Without loss of generality, we can restrict the support K of f by a smooth partition of unity and assuming that K is contained in some open chart of M, we may reduce to the same problem for f ∈ C^{∞}(Ω) where Ω is some open set in R^{d} and K ⊂ Ω.
We choose a smooth compactly supported function χ∈D(Ω) such that χ = 1 on a compact neighborhood of K with supp χ ⊂ Ω and we observe that
is linear continuous hence Bastiani smooth. We need a simple
Lemma VI.12. Let Ω be an open set inR^{d}then the map
is Bastiani smooth.
Proof. The first Bastiani differential DΦ_{φ}(h) can be identified with the smooth function x ↦ (0, h(x)), which is linear continuous in h and does not depend on φ. It is thus smooth and so is Φ.Therefore, the composition
defined by
is Bastiani smooth and finally
is Bastiani smooth by the chain rule, and since the last integration map is linear continuous thus Bastiani smooth.Now let us prove the direct sense of Theorem VI.3, where we start from a functional characterization of F and end up with a representation as a function F(φ+ψ)=∫_{M}f(x,jxkψ)dx on jet space, for φ + ψ in a neighborhood V of φ, that we assume convex. We start by deriving a candidate for the function f. According to the fundamental theorem of calculus,
As discussed at the beginning of this section, since we assume that WF(Fφ(1))=∅ for every φ ∈ U, there exists a unique smooth compactly supported function x ↦ ∇F_{φ}(x) such that
Therefore Eq. (31) reads
We show that Fubini’s theorem can be applied to the function χ: (x, t) ↦ ∇_{φ+tψ}F(x)ψ(x). By Proposition III.4, F^{(1)} is locally compactly supported so that there is a convex neighborhood V of φ and a compact subset K of Ω such that Fφ+ψ(1) is supported in K for every φ + ψ ∈ V. The function χ is defined on [0, 1] × K and supported on K for fixed t ∈ [0, 1]. Moreover, by imposing the additional assumption carried by item 2 in Theorem VI.3, namely, that φ ↦ ∇F_{φ} be Bastiani smooth from U to D(M), the support property of F implies that the image of ∇F_{φ+tψ} is actually in D(K) and ∇F is smooth from V to D(K) because the topology induced on D(K) by D(M) is the Fréchet topology of D(K) determined by the seminorms π_{m,K} (Ref [30], p. 172). Since D(K) injects continuously in (C^{0}(K), π_{0,K}), φ ↦ D_{φ}F is a continuous (C^{0}(K), π_{0,K})-valued map. This implies that (t, x) ↦ ∇F_{φ+tψ}(x) is continuous as a K-valued function on [0, 1] × K. Hence so is the integrand of (33), and the Fubini theorem holds and we obtain
Lemma VI.13. Let U be an open subset of E = C^{∞}(M) andF:E→Kbe Bastiani smooth. Assume that for every φ ∈ U, WF(Fφ(1))=∅andF^{(1)}:U→D(M)is Bastiani smooth, then, for every φ ∈ U, there is a convex neighborhood V of φ such that if φ + ψ ∈ V, then
From now on, we consider φ ∈ U to be fixed. Our candidate for f(jxkψ) is
By definition and Lemma VI.13, for all ψ such that φ + ψ ∈ V,
To show that c_{ψ}(x) is the right candidate, we first need
Proposition VI.14. The function c_{ψ}depends only on a finite jet of ψ. More precisely, for every φ ∈ U, if there is a convex neighborhood V of φ and an integer k ≥ 0 such that, for all x ∈ M, for every ψ_{1}and ψ_{2}such that φ + ψ_{1}and φ + ψ_{2}are in V andjxkψ_{1}=jxkψ_{2}, thenc_{ψ1}(x)=c_{ψ2}(x).The beginning of the proof is inspired by Ref [20]. For fixed φ ∈ U, by Proposition III.11, there exist an integer k, a compact K, and a convex neighborhood V of φ such that the order of Fφ+ψ(2) is smaller than k and the support of DF_{φ+ψ} is in K if φ + ψ ∈ V.Let us choose some point x_{0} ∈ M. Consider a pair ψ_{1}, ψ_{2} of smooth functions such that ψ_{1}(x_{0}) = ψ_{2}(x_{0}). Then,
We use the fundamental theorem of analysis again for DF_{φ}(h) = ∫_{M}dx∇F_{φ}(x)h(x) for an arbitrary h ∈ C^{∞}(M) to get
Now we take a sequence of smooth functions (hn){n∈N} which converges to δ_{x0} in D^{′}(M) when n goes to infinity and show that both the left- and right-hand sides have limits. For the left-hand side, the distribution DF_{φ+tψi} being smooth, it defines the continuous form u↦DF_{φ+tψi}(u) on D^{′}(M) by duality pairing. By continuity, DF_{φ+tψi}(h_{n})→DF_{φ+tψi}(δ_{x0}) and Eq. (32) yields
For the right-hand side, we know by Lemma VI.9 that for every s ∈ [0, 1], the wave front set of the distribution Fφ+tψ_{1}+st(ψ_{2}−ψ_{1})(2) is in the conormal C_{2} and the sequence (ψ_{2} − ψ_{1}) ⊗ h_{n} converges to (ψ_{2}−ψ_{1})⊗δ_{x0} in DN^{*}M×{x_{0}}′, where N^{*}M×{x_{0}} is the conormal of the submanifold M × {x_{0}}⊂ M × M in T^{*}M×M. Therefore, by transversality of the wave front sets and hypocontinuity of the duality pairings, [106] the following limit exists:
Moreover, still by Lemma VI.9, we have for φ + ψ ∈ V,
for every (g, h) ∈ C^{∞}(M)^{2} and all θψα belong to D(K). An integration by parts yields
where fψα=∑_{β}βα∂^{β−α}θψβ and the sum is over the multi-indices such that β ≥ α and |β|⩽k.As a consequence, for φ + ψ_{1} + ψ_{2} in the convex neighborhood V,
If, at the point x_{0}, jx_{0}kψ_{1}=jx_{0}kψ_{2}, then
We showed that c_{ψ} depends only on the k-jet of ψ at x_{0}. Moreover, the number k depends only on V and not on x_{0} so that c_{ψ} depends on the k-jet for every x ∈ M. In other words, there is an integer k and a function f such that c_{ψ}(x) = f(x, ψ(x), …, ∂^{α}ψ(x)) for every x ∈ M, where 1 ≤ |α| ≤ k.We want to show that f is smooth in its arguments, hence we now investigate in which manner c_{ψ} depends on ψ. This suggests to study the regularity of the D(K)-valued function ψ ↦ ∇F_{φ+tψ}ψ. More precisely, we need to show that the map ψ ↦ ∇F_{φ+tψ}ψ is Bastiani smooth from U to D(K). This is not completely trivial because the map x ↦ ∇F_{φ+tψ}(x) is in D(K) and ψ is in C^{∞}(M) and we must check that the product of a function in D(K) by a function in C^{∞}(M) is continuous (Ref [27], p. 119).
Lemma VI.15. If U is an open set in C^{∞}(M) andF:U→D(K)is a compactly supported Bastiani-smooth map, then the functionG:U→D(M)defined by G(φ) = F(φ)φ is compactly supported Bastiani-smooth with the same support as F.
Proof. Dabrowski pointed out to us the following fact. For any compact subset K of Ω, both D(Ω) and C^{∞}(Ω) induce on D(K) the usual Fréchet topology of D(K) (Ref [30], p. 172). Thus to establish the smoothness of G, it suffices to show that the multiplication (u,v)∈D(K)×C^{∞}(M)↦D(K) is continuous and then it would be Bastiani smooth, and by the chain rule it follows that φ ↦ (F(φ), φ) ↦ F(φ)φ is smooth. Since both D(K) and C^{∞}(M) are Fréchet, the product D(K)×C^{∞}(M) endowed with the product topology is metrizable and it is enough to prove that the product is sequentially continuous. Indeed, let (u_{n}, v_{n}) → (u, v) in D(K)×C^{∞}(M), we can find some cutoff function χ∈D(M) such that χ = 1 on the support of all u_{n}, and for all m, by (Ref [85], p. 1351)
Hence G is smooth.This implies that ψ↦c_{ψ}=∫01∇F_{φ+tψ}ψdt is smooth since the above lemma shows the smoothness of a(t, ψ) ↦ ∇F_{φ+tψ}ψ and integration over t conserves smoothness by Lemma VI.11. At this point, Theorem VI.3 follows directly from Proposition VI.4.
D. Representation theory of local functionals
In this section, we discuss the issue of representation of our local functionals and the relations between the functionals (c_{ψ},∇F,f(jxkψ)) which are defined or constructed in the course of our proof of Theorem VI.3. In the sequel, we assume that our manifold M is connected, oriented without boundary, hence we can fix a density dx on M which is also a differential form on M of top degree.
In the sequel, we shall work out all explicit formulas in local charts which means without loss of generality that we work on R^{d}, and the reference density dx is chosen to be the standard Lebesgue measure. We will denote by (x,u,u^{α}){|α|⩽k} where α are multi-indices, some local coordinates on the jet bundle J^{k}(R^{d}). Introduce the vertical Euler vector field ρ=∑u^{(α)}∂∂u^{(α)} on the bundle J^{k}(R^{d}). In the manifold case if we work on J^{k}(M), this vector field is intrinsic since it generates scaling in the fibers of J^{k}(M). For all multi-index (α) = (α_{1}…α_{p}), α_{i} ∈ {1, …, d}, introduce the operators ∂^{(α)}=∂^{α1}…∂^{αp} where ∂^{i}=∂∂x^{i}+∑_{α}u^{(αi)}∂∂u^{(α)} and the Euler–Lagrange operator EL=u∂∂u+∑_{α}(−1){|α|}∂^{(α)}u^{(α)}∂∂u^{(α)}. Let us discuss the nature of the objects involved, ρ is a vertical vector field and acts on C^{∞}(J^{k}M) as a C^{∞}(M) linear map, for χ∈C^{∞}(R^{d}),f∈C^{∞}(J^{k}R^{d}), ρ(χf) = χ(ρf). For every i ∈{1, …, d}, ∂^{i} is a vector field on J^{k}R^{d} but it has a horizontal component; therefore, it is not C^{∞}(R^{d}) linear and the Euler–Lagrange operator is not C^{∞}(R^{d}) linear either.
What follows is a definition—proposition—where we give an intrinsic and global definition of the Euler–Lagrange operator in terms of the operator ∇F associated with a functional.
Proposition VI.16 (Euler-Lagrange operator is intrinsic). Let U be an open subset of C^{∞}(M) andF:U→Kbe a Bastiani smooth local functional. For φ ∈ U, if there is an integer k, a neighborhood V of φ, an open subsetVof J^{k}M, andf∈C^{∞}(V)such thatx↦f(jxkψ)is compactly supported and
whenever φ + ψ ∈ V, then in every local chart
whereEL(f)(ψ)=∑_{|α|⩽k}(−1){|α|}∂^{(α)}∂f∂u^{(α)}(jxkψ)and EL(f)(ψ) is uniquely determined by F.The above proposition means that EL(f) does not depend on the choice of representative f and is intrinsic (i.e., it does not depend on the choice of a local chart).
Proof. Indeed, assume that we make a small perturbation φ + ψ of the background field φ by ψ which is compactly supported in some open chart U of M. Then a local calculation yields
where we used an integration by parts to recover the Euler-Lagrange operator and all boundary terms vanish since f is compactly supported in x and ψ∈D(U). We have just proved that for all open charts U ⊂ M, ∇F_{φ}|_{U} = EL(f)|_{U}. But ∇F_{φ} is intrinsically defined on M therefore so is EL(f) and we have the equality ∇F = EL(f). The unique determination of ∇F_{φ} follows from Lemma VI.2.
Theorem VI.17 [Global Poincaré]. Assume that M is a smooth, connected, oriented manifold without boundary. Let U be an open subset of C^{∞}(M) andF:U→Kbe a Bastiani smooth local functional. Then the following statements are equivalent:
• Two functions,(f_{1},f_{2})∈C^{∞}(V)forVan open subset of the jet space J^{k}M, are two representations of F in a neighborhood V of φ ∈ U,
whenever φ + ψ ∈ V.
• For all ψ ∈ V − φ,
whereβ(jx2kψ)∈Ωcd−1(M)is a differential form of degree d − 1 whose value at a point x depends only on the 2k-jet of ψ at x.Let us stress that we do not need to constraint the topology of M in the above theorem and only the compactness of the support of f_{i}(jxkψ)dx,i∈{1,2} really matters.
Proof. One sense of the equivalence is trivial since the integral of a compactly supported exact form on M always vanishes. By Proposition VI.4, we know that the map ψ ∈ V − φ ↦ j^{k}ψ has an open image in J^{k}(M) denoted V and we only need (f_{1}, f_{2}) to be defined on V. Recall we denote by (x,u,u^{α}){|α|⩽k} where α are multi-indices, some local coordinates on the jet bundle J^{k}(R^{d}). We use the vertical Euler vector field ρ=∑u^{(α)}∂∂u^{(α)} on the bundle J^{k}(R^{d}). For every multi-index (α) = (α_{1}…α_{p}), α_{i} ∈ {1, …, d}, introduce the operators ∂^{(α)}=∂^{α1}…∂^{αp} where ∂^{i}=∂∂x^{i}+∑_{α}u^{(αi)}∂∂u^{(α)} and the Euler–Lagrange operator reads EL=u∂∂u+∑_{α}(−1){|α|}∂^{(α)}u^{(α)}∂∂u^{(α)}.We shall prove two related identities, in local chart,
For all (f,g)∈C^{∞}(JkRd){2} and all multi-indices α, the generalized Leibniz-like identity holds true,
where the second term is a sum of total derivatives. Using this, we derive the following key identity which is valid on jet spaces. For all fdx∈C^{∞}(J^{k}R^{d})⊗Ω^{d}(R^{d}),
where j_{μ}∈C^{∞}(J^{2k}R^{d}) is a local functional.To prove the second identity, we shall use the fundamental theorem of calculus and the first identity,
To prove the claim of the lemma is equivalent to show the following statement: if a local functional F is locally constant, i.e., F(φ + ψ) = F(φ) whenever φ + ψ ∈ V, then F(φ+ψ)=F(φ)+∫_{M}dβ(jx2kψ) and β(jx2kψ)∈Ωcn−1(M) is a compactly supported n − 1 form. For all ψ in V − φ,
This means that EL(f) = 0 and therefore on any open chartU (U is contractible), Eq. (39) yields
We want to prove that EL(f)=0⇒f(jxk(ψ))dx−f(0)dx|_{Mp+1}=dβ(j^{2k}ψ), where β ∈ C^{∞}(J^{2p}(M)) knowing that this holds true on any local chart and that EL(f) = 0 is equivalent to assuming that F(φ+ψ)≔∫_{M}f(jxkψ)dx is locally constant. We cover M by some countable union ∪_{i∈N}U_{i} of contractible open charts such that every element x ∈ M belongs to a finite number of charts U_{i}, set M_{p}=U_{1}∪⋯∪U_{p}, and arrange the cover in such a way that M_{p} ∩ U_{p+1} ≠∅for all p which is always possible. Assume by induction on p that EL(f) = 0 and supp (f) ⊂ M_{p} implies
where β∈C^{∞}(J^{2p}(M))⊗Ωcd−1(M_{p}).We want to prove that EL(f)=0,supp(f)⊂M_{p+1}⇒f(jxk(ψ))dx−f(0)dx|_{Mp+1}=dβ(j^{2k}ψ), where β∈C^{∞}(J^{2p}(M))⊗Ωcd−1(M_{p+1}). Choosing a partition of unity (χ, 1 − χ) subordinated to M_{p} ∪ U_{p+1}, the key idea is to decompose the variation ψ of the background field φ as the sum of two components χψ + (1 − χ)ψ where χψ (respectively, (1 − χ)ψ) vanishes outside U_{p} (resp U_{p+1}) which yields
The second idea is to note that for every fixed ψ, the new functional
has the trivial Euler–Lagrange equation EL(f̃)(j^{k}ϕ)=EL(f)(j^{k}(χϕ+(1−χ)ψ))=0 since EL(f) = 0 and its support is contained in M_{p}. Therefore,
by the inductive assumption. To treat the term under brace, define a new functional
whose support is contained in U_{p+1} and whose Euler-Lagrange equation vanishes, EL(g) = 0 again by the fact that EL(f) = 0. Since U_{p+1} is contractible, we know that f(j^{k}((1 − χ)ψ)) − f(0) = dα(j^{2k}ψ) where α∈C^{∞}(J^{2k}M)⊗Ωcd−1(U_{p+1}) and therefore we found that
where β∈C^{∞}(J^{2k}M)⊗Ωcd−1(M_{p+1}). Therefore for all ψ ∈ V − φ, f(jxk(ψ))dx=dβ(j^{2k}ψ)+f(0)dx. Now we conclude by using the fact that F is a constant functional, thus 0=F(φ+ψ)−F(φ)=∫_{M}f(0)dx+dβ(j^{2k}ψ)=∫_{M}f(0)dx. But f(0)dx is a top form in Ωcd(M) which does not depend on ψ and whose integral over M vanishes, hence f(0)dx = dk for some k∈Ωcd−1(M) since Hcd(M,R)≃R for the top de Rham cohomology with compact support when M is connected (Ref [107], Theorem 17.30, p. 454).The next theorem summarizes the above results.
Theorem VI.18. Let U be an open subset of C^{∞}(M) andF:U→Kbe a Bastiani smooth local functional. For φ ∈ U, if there is an integer k, a neighborhood V of φ, an open subsetVof J^{k}M, andf∈C^{∞}(V)such that x ↦ f(j^{k}ψ_{x}) is compactly supported and
whenever φ + ψ ∈ V, then in every local chart
whereEL(f)(ψ)=∑_{|α|⩽k}(−1){|α|}∂^{(α)}∂f∂u^{(α)}(jxkψ) is the Euler–Lagrange operator and EL(f)(ψ) is uniquely determined by F.Furthermore, we find that
Moreoverf(jxkψ)−∫01dtψEL(f)(tψ)ψdx=dβ(jx2kψ)whereβ(jx2kψ)∈Ωcd−1(M)is a compactly supported d − 1 form.
1. Explicit forms
In this section, we derive the explicit expression of ∇F_{φ} and F^{(α)}(φ) in terms of f when M=R^{d}. Since the general expression is not very illuminating, let us start with the following simple example:
where h and g^{μν} are smooth and compactly supported and g^{μν} is symmetric. We compute
where we used integration by parts. Thus,
Moreover,
To write this as a distribution, we need to integrate over two variables:
Now we can use integration by parts over y to recover v(y),
where the non-zero f^{α}(φ) are
More generally,
Proposition VI.19. If
then
Proof. The proof is a straightforward generalization of the example. Indeed,
where we used an integration by parts to recover the Euler–Lagrange operator. The second derivative is
We write this as a double integral
A first integration by parts gives us
A second integration by parts isolates v(y),
If we calculate higher differentials D^{k}F_{φ}(u_{1}, …, u_{k}), we see that we always obtain products of smooth functions by derivatives of products of delta functions. This shows that the wavefront set of Fφ(k) is in the conormal C_{k}.
VII. PEETRE THEOREM FOR LOCAL AND MULTILOCAL FUNCTIONALS
In this section, we propose an alternative characterization of local functionals in terms of a nonlinear Peetre theorem. We do not characterize the locality of the action F but the locality of the Lagrangian density, which we denoted ∇F in Sec. IV D. We first state our theorems for local functionals and then we prove them for the case of multilocal functionals, which are a natural generalization of local functionals in quantum field theory. Our proof is inspired by recent studies on the Peetre theorem [108,109]; however, it is formulated in the language of Bastiani smoothness and uses simpler assumptions than Slovák’s paper. [110]
A. Peetre theorem for local functionals
Let Ω be some open set in a manifold M. We first begin with an alternative definition of a local map from C^{∞}(Ω) to itself, which we call Peetre local.
Definition VII.1. A map F: C^{∞}(Ω) → C^{∞}(Ω) is Peetre local for every x ∈ Ω; if φ_{1} = φ_{2}on some neighborhood of x, then F(φ_{1})(x) = F(φ_{2})(x).The relation with the additivity condition is given by
Proposition VII.2. Let F: C^{∞}(Ω) → C^{∞}(Ω) be Peetre local. For every (φ_{1}, φ_{2}) ∈ C^{∞}(Ω)^{2}if supp φ_{1}and supp φ_{2}do not meet, then for every x ∈ Ω and for all φ,
Proof. If x∉suppφ_{1}∪suppφ_{2}, then φ_{1} = φ_{2} = 0 in some neighborhood of x it follows that F(φ_{1} + φ_{2} + φ)(x) = F(0 + 0 + φ)(x) = F(φ)(x) and F(φ_{1} + φ)(x) + F(φ_{2} + φ)(x) − F(φ)(x) = 2F(φ)(x) − F(φ)(x) = F(φ)(x) and hence Eq. (41) holds true.If x ∈ supp φ_{1}, then necessarily there is some neighborhood U of x on which φ_{2}|_{U} = 0 and hence φ_{1} + φ_{2} + φ|_{U} = φ_{1} + φ|_{U} and F(φ_{1} + φ_{2} + φ)(x) = F(φ_{1} + φ)(x). Also F(φ_{1} + φ)(x) + F(φ_{2} + φ)(x) − F(φ)(x) = F(φ_{1} + φ)(x) + F(φ)(x) − F(φ)(x) = F(φ_{1} + φ)(x), hence again Eq. (41) holds true. The case where x ∈ supp φ_{2} can be treated by similar methods which yields the final result.The Peetre theorem for local functionals is
Theorem VII.3. Let F: C^{∞}(Ω) → C^{∞}(Ω) be a Bastiani smooth Peetre local map. Then, for every φ ∈ C^{∞}(Ω), there is a neighborhood V of φ in C^{∞}(Ω) and an integer k such that for all ψ such that φ + ψ ∈ V, F(φ + ψ)(x) = c(j^{k}ψ_{x}) for some smooth function c on J^{k}Ω.In other words, if F is a Bastiani smooth Peetre local map, then, for every g∈D(M), ∫_{M}F(φ)g is a Bastiani smooth local map in the sense of the rest of the paper. This relation between a priori different concepts of locality strongly supports the idea that our definition is a natural one.If F is only assumed to be a continuous local map, then a similar theorem exists for which the function c is not necessarily smooth. These theorems are proved in the Sec. VII B for the more general case of multilocal functionals.
B. Multilocal functionals and first Peetre theorem
By generalizing Definition VII.1 of local maps, we can define multilocal maps. These maps appear naturally in quantum field theory as the product of several Lagrangian densities L(x_{1})…L(x_{k}).
Definition VII.4. Let k be an integer. A map F: C^{∞}(Ω) → C^{∞}(Ω^{k}) is k-local for every (x_{1}, …, x_{k}) ∈ Ω^{k}; if φ_{1} = φ_{2}on some neighborhood of {x_{1}, …, x_{k}}⊂ Ω, then F(φ_{1})(x_{1}, …, x_{k}) = F(φ_{2})(x_{1}, …, x_{k}).The multilocal maps are the maps that are k-local for some k. We emphasize that Peetre local maps in the sense of Definition VII.1 correspond with 1-local maps in the above sense. For M a smooth manifold, we denote by J^{p}M^{⊠k} the bundle over M^{k} whose fiber over a k-tuple of points (x_{1}, …, x_{k}) ∈ M^{k} is J^{p}M_{x1}×⋯×J^{p}M_{xk}.
Theorem VII.5. Let F: C^{∞}(Ω) → C^{∞}(Ω^{k}) be a continuous k-local map. Then, for every φ ∈ C^{∞}(Ω), there is a neighborhood V of φ in C^{∞}(Ω), p∈N, such that for all ψ such that φ + ψ ∈ V,
for some functionc:J^{p}M^{⊠k}|_{(M^{k}\Dk)}→M^{k}, where M^{k}∖D_{k}denotes the configuration space M^{k}minus all diagonals.
Proof. Fix a k-tuple of points (x_{1}, …, x_{k}) ∈ Ω^{k} and some compact neighborhood K of (x_{1}, …, x_{k}) in Ω^{k}. Continuity of F implies that for all ε > 0, there exists η > 0 and a seminorm π_{m,K^{′}} of C^{∞}(Ω) such that π_{m,K^{′}}(φ_{1}−φ_{2})⩽η implies
Assume that (φ_{1}, φ_{2}) have the same (m + 1)-jets at {x_{1}, …, x_{k}}. Let (χλ){λ} be the family of compactly supported cutoff functions equal to 1 in some neighborhood of X = {x_{1}, …, x_{k}} defined in Lemma VII.6. It follows that φ_{1,λ} = φ_{1}χ_{λ} (respectively, φ_{2,λ} = φ_{2}χ_{λ}) coincides with φ_{1} (respectively, φ_{2}) near {x_{1}, …, x_{k}}. Hence, for all λ > 0, F(φ_{1,λ})(x_{1}, …, x_{k}) = F(φ_{1})(x_{1}, …, x_{k}) and F(φ_{2,λ})(x_{1}, …, x_{k}) = F(φ_{2})(x_{1}, …, x_{k}). Set ε_{n}=12^{n}, then there exists η_{n} such that π_{m,K^{′}}(ψ_{1}−ψ_{2})⩽η_{n} implies
Therefore it suffices to find some sequence λ_{n} → 0 such that π_{m,K^{′}}(φ_{1,λn}−φ_{2,λn})⩽η_{n}. Since φ_{1} − φ_{2} vanishes at order m + 1 on the set X = {x_{1}, …, x_{k}}, Lemma VII.6 yields the estimate
which implies that
Finally, we obtain that if φ_{1}, φ_{2} have the same (m + 1)-jet at X = {x_{1}, …, x_{k}}, then for all n > 0,
which implies F(φ_{1})(x_{1}, …, x_{k}) = F(φ_{2})(x_{1}, …, x_{k}).
Lemma VII.6. Let X be any closed subset ofR^{d}. LetI^{m+1}(X,R^{d})denote the closed ideal of functions of regularity C^{m+1}which vanish at order m + 1 on X. Then there is a functionχ_{λ}∈C^{∞}(R^{d})parametrized by λ ∈ (0, 1] such that χ_{λ} = 1 (respectively, χ_{λ} = 0) whend(x,X)⩽λ8[respectively,d(x,X)⩾λ] such that for all compact subsetK⊂R^{d}, there is a constantC̃such that for every λ ∈ (0, 1] and everyφ∈I^{m+1}(X,R^{d}),
Proof. Choose ϕ⩾0 such that ∫_{R^{d}}ϕ(x)d^{d}x=1 and ϕ = 0 if |x|⩾38. Set ϕ_{λ} = λ^{−d}ϕ(λ^{−1}.), and set α_{λ} to be the characteristic function of the set {xs.t.d(x,X)⩽λ2}, then the convolution product χ_{λ} = ϕ_{λ}*α_{λ} satisfies χ_{λ}(x) = 1 if d(x,X)⩽λ8 and χ_{λ}(x) = 0 if d(x,X)⩾λ. Since by the Leibniz rule one has
it suffices to estimate each term ∂^{k}χ_{λ}∂^{α−k}φ(x) of the above sum. For every multi-index k, there is some constant C_{k} such that ∀x∈R^{d}\X,|∂xkχ_{λ}|⩽C_{k}λ^{|k|} and supp∂xkχ_{λ}⊂{d(x,X)⩽λ}. Therefore for all φ∈I^{m+1}(X,R^{d}), for all x∈supp∂xkχ_{λ}∂^{α−k}φ, and for y ∈ X such that d(x, X) = |x − y|, we find that ∂^{α−k}φ vanishes at y at order |k| + 1. Indeed φ vanishes at order m + 1, hence ∂^{α−k}φ vanishes at order m+1−|α|+k⩾k+1 since |α|⩽m. Therefore,
where the right-hand side is just the integral remainder in Taylor’s expansion of ∂^{α−k}φ around y. Hence,
It is easy to see that R_{β} only depends on the jets of φ of order ⩽m+1. Hence
and the conclusion follows easily.
C. The second Peetre theorem
Theorem VII.7. Let F: C^{∞}(Ω) → C^{∞}(Ω^{k}) be a Bastiani smooth k-local map. Then, for every φ ∈ C^{∞}(Ω), there is a neighborhood V of φ in C^{∞}(Ω), p∈N, such that for all ψ such that φ + ψ ∈ V,
for some smooth function c onJ^{p}M^{⊠k}|_{(M^{k}\Dk)}where M^{k}∖D_{k}denotes the configuration space M^{k}minus all diagonals.
Proof. Without loss of generality, we may assume that M=R^{d}, and to go back to arbitrary manifolds, we use partitions of unity as in the proof of Lemma VI.6. The coordinates on the jet space J^{p}(R^{d}) are denoted by (x,p^{α}){|α|⩽p}. Let (U_{1}, …, U_{k}) be two by two disjoint open subsets of R^{d}, then U_{1} ×⋯× U_{k} is an open subset of (Rd){k}\D_{k}. We define the smooth map Φ:(x_{1},…,x_{k};p_{1},…,p_{k})∈J^{p}(Rd){⊠k}|_{U1×⋯×Uk}↦(∑_{1⩽i⩽k}p_{i,α}α!(.−xi){α}χ_{i}(.−x_{i}))∈C^{∞}(R^{d}), where the functions χ_{i}∈Cc∞(R^{d}) are cutoff functions equal to 1 near 0 and such that for all (x_{1}, …, x_{k}) ∈ U_{1} ×⋯× U_{k}, the support of the functions χ_{i}(. − x_{i}) are disjoint on R^{d}. Then the map sending (x_{1}, …, x_{k}; p_{1}, …, p_{k}), (y_{1}, …, y_{k}) to F(φ + Φ(x_{1}, …, x_{k}; p_{1}, …, p_{k}))(y_{1}, …, y_{k}) is smooth by smoothness of F and Φ. Hence, its pull-back on the diagonal x_{1} = y_{1}, …, x_{k} = y_{k} is also smooth and reads
as the composition of smooth functions and it follows that c is smooth on J^{p}M^{⊠k}|_{U1×⋯×Uk}.
VIII. MULTI-VECTOR FIELDS AND GRADED FUNCTIONALS
In the quantum theory of gauge fields, especially in the Batalin-Vilkovisky approach, it is necessary to deal not only with functionals as discussed above but also with multi-vector fields on the configuration space E (assumed to be the space of sections of some vector bundle B) [16]. Such multi-vector fields can be seen as functionals on the graded space T*[1]E ≐ E ⊕ E*[1], where E* ≐ Γ(M, B*) is the space of smooth sections. To make this notion precise, we use the ideas presented in Ref [111] and characterize the “odd” space E*[1] through the space of functions on it, understood as multilinear smooth, totally antisymmetric, functionals. Then we shall make a conjectural claim on the meaning of locality in that context.
A. Locality of functionals on graded space
We consider a graded space E_{0} ⊕ E_{1}[1], where E_{0} = Γ(M, B_{0}) and E_{1} = Γ(M, B_{1}) are spaces of smooth sections of finite rank vector bundles B_{0} and B_{1} over M, respectively. Before giving formal definitions, let us explain the idea of our construction. We will first define the space O(E_{0}⊕E_{1}[1]) to be space of maps from E_{0} to A, where
satisfying an appropriate smoothness condition. Let us clarify the notation Γa′. We first define the iterated wedge product of k elements u_{1},…,u_{k} of the space of distributional sections Γ′(M, B_{1}) by
where h_{1},…,h_{k} are sections in Γ(M, B_{1}) and σ runs over the permutations of {1, …, k}. Then, the kth exterior power Λ^{k}Γ′(M, B_{1}) is the vector space of finite sums of such iterated wedge products and Γa′(M^{k},B1⊠k) is the completion of Λ^{k}Γ′(M, B_{1}) with respect to the topology of Γ^{′}(M,B1){⊗^πk}≅Γ^{′}(M^{k},B1⊠k) where all the duals are strong. The subscript “a” stands for antisymmetry.
In the case of multilinear symmetric functions, we can identify a k-linear map f(h_{1}, …, h_{k}) of k variables with a polynomial map of one variable f(h, …, h) by using the polarization identity. There is no polarization identity in the antisymmetric case and we must consider a function F:E_{0}→A^{k} as a function of one variable φ_{0} in E_{0} and k variables (h_{1}, …, h_{k}) in E_{1} (or a variable in H∈E1⊗^{π}k). Then, we can identify a function F:E_{0}→A^{k} and the function F̃:E_{0}×E1⊗^{π}k→K defined by
This motivates the following:
Definition VIII.1. Let M be a smooth manifold, (B_{0}, B_{1}) are smooth vector bundles on M, and E_{0} = Γ(M, B_{0}), E_{1} = Γ(M, B_{1}) are spaces of smooth sections of the respective bundles. We say that a function F from E_{0}toA^{k}is an element ofO^{k}(E_{0}⊕E_{1}[1])if there exists a Bastiani smooth mapF̃:E_{0}×E1⊗^{π}k→Kwhich is linear inE1⊗^{π}kandantisymmetricwith respect to the natural action of permutations onE1⊗^{π}ksuch that
We denote byO(E_{0}⊕E_{1}[1])the direct product of allO^{k}(E_{0}⊕E_{1}[1]), overk∈N_{0}and setO^{0}(E_{0}⊕E_{1}[1])≡K.Let us now discuss the notion of derivative for the type of functionals introduced above. Clearly, if F belongs to O(E_{0}⊕E_{1}[1]), there are two natural ways to differentiate it. In the first instance, we can differentiate F̃ in the sense of Bastiani in the first variable (φ ∈ E_{0}) and we denote this derivative as
where u∈E1⊗^{π}k→K, g ∈ E_{0}, or δδφ_{0}F.
B. The contraction operation
Let us now consider contraction of the graded part with some h ∈ E_{1}, sometimes referred to as derivations with respect to odd variables. This concept is needed in order to define the Koszul complex and the Chevalley-Eilenberg complex in the Batalin–Vilkovisky formalism in infinite dimension. The definition is spelled out below.
Definition VIII.2. LetF∈O^{k}(E_{0}⊕E_{1}[1]), h ∈ E_{1}. The contraction of F by h is defined, for every integer k > 0 andu∈E1⊗k−1, by
In particular,ι_{h}F=F̃,hifF∈A^{1}. We extend this definition toAby linearity.In view of (43) and the definition of O^{k}(E_{0}⊕E_{1}[1]), it is clear that ι_{h}F∈O^{k−1}(E_{0}⊕E_{1}[1]) for all F∈O^{k}(E_{0}⊕E_{1}[1]). Equation (43) allows us also to make sense of a second important operation on O(E_{0}⊕E_{1}[1]).
Definition VIII.3. The wedge product∧:O^{k}(E_{0}⊕E_{1}[1])×O^{k′}(E_{0}⊕E_{1}[1])→O^{k+k′}(E_{0}⊕E_{1}[1])is defined by
(where the sum runs over k − k′ shuffles) and extended by linearity onO(E_{0}⊕E_{1}[1])×O(E_{0}⊕E_{1}[1]).Again, in view of (43) and the definition of O(E_{0}⊕E_{1}[1]), it is clear that the wedge product of an element in O^{k}(E_{0}⊕E_{1}[1]) with an element in O^{k′}(E_{0}⊕E_{1}[1]) is an element in O^{k+k′}(E_{0}⊕E_{1}[1]). The contraction and wedge product satisfy the following relation on O(E_{0}⊕E_{1}[1]):
Lemma VIII.4. The contraction satisfies the graded Leibniz rule ifF∈O^{k}(E_{0}⊕E_{1}[1]), G∈O(E_{0}⊕E_{1}[1])and h ∈ E_{1}, then
Let us now discuss the notion of support which is the appropriate generalization of the notion of support for graded functionals, generalizing the definitions in Sec. III A.
Definition VIII.5. LetF∈O^{k}(U⊕E_{1}[1])be a graded functional, with U being an open subset of E_{0}. The support of F is defined bysuppF=A∪B¯, where
C. Some conjectures on local graded functionals
Let F∈O^{k}(E_{0}⊕E_{1}[1]) be such that the WF set of both ι_{h1}…ι_{hk}Fφ(1) and ι_{h1}…ι_{hk−1}F(φ,.) is empty for all φ ∈ U and (h_{1},…,h_{k})∈E1k. We conjecture that some version of Lemmas VI.2 and VI.9 should hold in the graded case. The “standard” characterization of locality for a functional F∈O^{k}(E_{0}⊕E_{1}[1]) is the requirement that F is compactly supported, and for each (φ;u_{1},…,u_{k})∈E_{0}×E1k, there exists i_{0},…,i_{k}∈N such that
where α is a density-valued function on the jet bundle. To conclude, we conjecture some graded analog of Theorem VI.3 whose formulation would be as follows: Let U be an open subset of E_{0} and F∈O^{k}(U⊕E_{1}[1]) be a graded functional. Assume that we have the following:
1. F is additive in some suitable sense, still to be written with care (conceivably this would be additivity of F̃ as a function of several variables).
2. ι_{h1}…ι_{hk}Fφ(1) and ι_{h1}…ι_{hk−1}F(φ,.) have an empty wave front set for all φ ∈ U and (h_{1},…,h_{k})∈E1k, and the maps (φ,u)↦ι_{h1}…ι_{hk}Fφ(1),ι_{h1}…ι_{hk−1}F(φ,.) are Bastiani smooth from U×⊕_{k∈N}E1⊗^{π}k to Γ_{c}(M,B0*) and Γ_{c}(M,B1*), respectively. Here B0* and B1* denote dual bundles.Then, for every φ ∈ U, u∈⊕_{k∈N}E1⊗^{π}k, there is a neighborhood V of the origin in E_{0}, an integer N, and a smooth K-valued function f on the N-jet bundle such that
for every ψ ∈ V and some i_{0}, …, i_{k} < N.

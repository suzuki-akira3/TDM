Improvements to the ion Doppler spectrometer diagnostic on the HIT-SI experiments
An ion Doppler spectrometer diagnostic system measuring impurity ion temperature and velocity on the HIT-SI and HIT-SI3 spheromak devices has been improved with higher spatiotemporal resolution and lower error than previously described devices. Hardware and software improvements to the established technique have resulted in a record of 6.9 μs temporal and ≤2.8 cm spatial resolution in the midplane of each device. These allow Ciii and Oii flow, displacement, and temperature profiles to be observed simultaneously. With 72 fused-silica fiber channels in two independent bundles, and an f/8.5 Czerny-Turner spectrometer coupled to a video camera, frame rates of up to ten times the imposed magnetic perturbation frequency of 14.5 kHz were achieved in HIT-SI, viewing the upper half of the midplane. In HIT-SI3, frame rates of up to eight times the perturbation frequency were achieved viewing both halves of the midplane. Biorthogonal decomposition is used as a novel filtering tool, reducing uncertainty in ion temperature from ≲13 to ≲5 eV (with an instrument temperature of 8-16 eV) and uncertainty in velocity from ≲2 to ≲1 km/s. Doppler shift and broadening are calculated via the Levenberg-Marquardt algorithm, after which the errors in velocity and temperature are uniquely specified. Axisymmetric temperature profiles on HIT-SI3 for Ciii peaked near the inboard current separatrix at ≈40 eV are observed. Axisymmetric plasma displacement profiles have been measured on HIT-SI3, peaking at ≈6 cm at the outboard separatrix. Both profiles agree with the upper half of the midplane observable by HIT-SI. With its complete midplane view, HIT-SI3 has unambiguously extracted axisymmetric, toroidal current dependent rotation of up to 3 km/s. Analysis of the temporal phase of the displacement uncovers a coherent structure, locked to the applied perturbation. Previously described diagnostic systems could not achieve such results.
I. MOTIVATION
Accurate measurements of ion velocity and temperature play an important role in understanding fusion plasma experiments. In the HIT-SI and HIT-SI3 spheromak devices, it is anticipated that the MHD dynamo term (E = −v × B in Ohm’s law) will play a large role in the magnetic self-organization process [1]. Furthermore, toroidal ion rotation and radial velocity shear both play important roles in stabilization and the suppression of instabilities in the plasma. Ion temperature is necessary to calculate β_{plasma} (β_{p}=P_{thermal}B^{2}/2μ_{o}) and for the calculation of various characteristic time scales. It is anticipated from numerical simulation [1] that the chord-averaged ion velocities will be of order 10 km/s and from both simulation and Langmuir probe measurements that the ion temperatures will be of order 10 eV. Because the signal to noise ratio (SNR) in this regime is likely to be small, characterization of error is required, as in signal filtering. The demands on spatio-temporal resolution are set by the period of the imposed magnetic perturbation (69 μs) and relatively small major radius (55 cm). Temporally, data must be collected for the majority of the discharge (shot), at sub-perturbation resolution. Spatially, we wish to observe as much of the toroidal midplane as possible, with multiple spatial chords. Previously reported diagnostic systems cannot fulfill these demands simultaneously: Cothran [2] describes an Ion Doppler Spectrometer (IDS) diagnostic on the SSX spheromak with 1 μs temporal resolution and low error (≤6 km/s, ≤7 eV), but only one spatial channel. Baciero [3] describes an IDS system on TJ-II with 8 chords at ≤5 cm spatial resolution across the entire poloidal plane, but only 15 ms temporal resolution. Bamford [4] on the COMPASS-C tokamak and Den Hartog [5] on the MST RFP are further examples of systems with insufficient spatio-temporal resolution. None employ significant filtering or parameter-resolved error-characterization (going beyond unitless global metrics such as χ^{2}). The IDS diagnostic reported here addresses these requirements. An overview of the experimental and diagnostic hardware will be presented, followed by the analysis and filtering techniques used in profile calculation.
II. THE HIT-SI AND HIT-SI3 DEVICES
The HIT-SI [6] and HIT-SI3 [7] experiments study spheromak sustainment via the injection of magnetic helicity into a simply connected flux conserver. The helicity injectors (Fig. 1) are driven at a fixed frequency (the “perturbation frequency”) and phased such that the rate of helicity injection is constant. In the data presented here, phasing is set to Δϕ = 120° for HIT-SI3 and Δϕ = 90° for HIT-SI, and both are driven at 14.5 kHz. The theoretical basis for steady state spheromak sustainment is given by the theory of “Imposed Dynamo Current Drive.” [8] The experiments’ diagnostic set includes a far-infrared laser interferometer (reporting 1 × 10^{19} ≲ n_{e} ≲ 8 × 10^{19} m^{−3}) [9], a Langmuir probe (reporting electron temperatures T_{e} ≲ 10 eV) [10], and an array of toroidal and poloidal magnetic field probes in the wall [11], which allow mode reconstruction up to toroidal Fourier number n = 7. Gas fueling is controlled by solenoid valves. Characteristic toroidal current, injected power, helicity injection rate, and electron density are shown in Fig. 2. The flux conservers for both experiments are shown in Fig. 1.
III. DIAGNOSTIC PROCESS
The use of IDS diagnostics for fusion plasma experiments is common [5]. The Doppler shift and broadening of impurity ion spectral lines from the plasma are correlated to the velocity and thermal motion, respectively, along the viewing chord. Formally,
where Δλ is the shift in wavelength away from a calibration value λ_{0} and σ is the line width. The passive IDS system described here is in contrast to active systems, such as Fonck [12]. This study primarily looks at line radiation from the 1s^{2}2s3P{3}P⇒1s^{2}2s3s{3}S 464.74 nm Ciii (triplet) transition, and the 2s^{2}2p^{2}({3}P)3p{4}D^{0}⇒2s^{2}2p^{2}{3}P3s{4}P 464.91 nm Oii (quartet) transition. These impurity ions are commonly observed due to their relative abundance across all impact parameters in medium-temperature plasmas [2]. The HIT-SI and HIT-SI3 experiments follow similar IDS studies in assuming that ||E→|| and ||B→|| are sufficiently low that the Stark, Zeeman, and other higher order effects will not measurably affect the spectral profile. For Ciii, the shifts become relevant only at two and three orders of magnitude higher than observed density [13] and field [14]^{,} respectively. For Oii, the limits are three orders of magnitude higher in both density [13] and field [15].
IV. EXPERIMENTAL SETUP
A. Optical hardware
The IDS hardware has been used on both iterations of the HIT-SI experiment. The following is quoted at length from Hossack [16]. The spectrometer itself is a one-meter focal length Ritsu Ohyo Kogaku model MC-100N Czerny-Turner configuration grating monochromator. The wavelength range is 250-700 nm and the focal ratio is f/8.5. The manually adjustable grating is blazed at 250 nm and has a groove density of 1800/mm. The adjustable entrance slit width is usually kept at 80 μm.
Light is gathered by two linear bundles of 36 channels, each 3 m long and insertable into several reentrant ports on the vacuum vessel. Plasma light is imaged onto the fibers by a wide angle “Micro Video Lens” from Edmund Optics, with a focal length of 2.2 mm. Each fiber channel therefore collects a conical volume of plasma light of diameter 5.1 cm at the vacuum vessel wall (diameter ∼110 cm). The chords are separated by 2.95°.
The spatial extent of the IDS light collection optics is significantly larger and more mutable than that of previously described experiments (such as Cothran [2], Baciero [3], or Den Hartog [5]). Figure 3 shows the configurations used in this report. Light is collected from impact parameter R = 0–47 cm, where “impact parameter” refers to the distance of closest approach between a viewing chord and the geometric axis. There exists radial and opposing poloidal viewports as well. The ability to view the upper and lower halves of the toroidal midplane simultaneously is an improvement not reported on similar IDS diagnostics.
B. Camera and calibration
The output of the spectrometer is optically coupled to a Phantom v710 fast camera. Previous studies found the trade-off between temporal resolution and detection channels in photomultiplier tubes (PMTs) vs. semiconductors [such as charged coupled device (CCD) or complementary metal–oxide–semiconductor (CMOS)] respectively not favorable. Bamford [4] on the COMPASS-C tokamak utilizes both to circumvent this, for example. The limitation does not hold in the HIT-SI parameter regime. The camera has been run up to 145 000 pictures/s (10 frames per injector cycle, 6.9 μs exposure) for high-current discharges, with acceptably low error (see Sec. VI).
A mercury lamp, viewed through a ground glass diffuser, is used to evenly illuminate the fibers for calibration. Spectral lines close to the plasma impurity lines of interest are chosen (in this case, the doublet 434.75 and 435.84 nm) to account for nonlinearity in the grating. An elliptical Gaussian of the form in Eq. (2) is fit to the brightest line,
where x and y are the spatial and wavelength directions, respectively, and “a” encapsulates the parameters: σ_{x} is the spatial width, σ_{y} is the wavelength width, x_{0} and y_{0} are the spatial and wavelength centers, respectively, and f_{0} is the background (continuum) offset level. This is done to calibrate the instrument function (σ_{y}, corresponding to an instrument temperature between 8 and 16 eV for Ciii), position (x_{0}, y_{0}), and relative intensity (V). By tuning the spectrometer with a stepper motor, the doublet can be used to calculate the dispersion (wavelength-per-pixel). To avoid nonlinearity in the exit optics, only dispersion values near the center of the CCD are used. Because the calibration line is not at the plasma lines (∼465 nm), the absolute velocity cannot be established with this calibration. An example of the raw data collected by the camera is given in Fig. 4. Detector sensitivity is measured by modulating the calibration lamp signal. No dependence is found on intensity and/or pixel location, outside a 95% confidence interval. This motivates our use of an unweighted fit in Sec. VI B.
V. BIORTHOGONAL DECOMPOSITION FILTERING OF RAW DATA
The low SNR in Fig. 4 motivates the use of a filtering algorithm. Because the temporal evolution of the data is not known a priori, it is preferable to use a method which does not impose pre-determined basis functions (such as the Fourier transform). Singular Value Decomposition (SVD) meets this requirement. The technique has been applied frequently to the decomposition of MHD mode activity from magnetic field measurements (first by de Wit [17], first on HIT-SI by Victor [18]) but has been used on IDS systems as well [19]. The technique, frequently referred to as Biorthogonal Decomposition (BD), is unique in that the basis functions are determined by the data itself. Each frame on the CCD is collapsed into a single vector, and these vectors are concatenated to convert the 3D data of dimensions wavelength × space × time into a 2D matrix of dimension pixel × time, which can then be analyzed. It can be shown [20] that any matrix B is guaranteed a singular value decomposition, resulting in the following equation:
The traditional SVD notation is given on the right and the BD notation in the middle. The data can be fully reconstructed by summing over all K “modes,” where ϕ and U are the orthonormal spatial basis structures (“topos”), A and Σ are the diagonal matrix of singular values (“weights”), and ψ^{T} and V^{*} are the orthonormal temporal basis structures (“cronos”). The decomposition is given conveniently in the Matlab package svd. While other experiments have studied these structures themselves [19] [such as the “cronos” given in Fig. 5(b)], this paper uses BD as solely a filtering tool, in which the data is reconstructed from a minimum number of modes. Figure 5(a) shows the magnitudes of the weights. We truncate the dataset at the tenth mode (in ϕ, Σ, and ψ, following Fenzi [19] and Classen [21] directly) with the rest of the modes being considered noise (other studies have proposed data reconstruction with even fewer modes [22]). We can capture up to approximately 80% of the modal energy (calculated as Ak2) [17] in this way. This has a significant effect on the uncertainty in velocity and temperature (calculated in Sec. VI), shown in Fig. 6. A comparison of the raw data and reconstruction is shown in Fig. 7. Filtering algorithms modify the spatial and temporal profiles by design but are predicated on the assumption that the rejected dynamics constitute solely noise. To qualitatively confirm that valuable data are not being suppressed, a reconstruction is made from the discarded modes, a frame from which is plotted in Fig. 8. No residual structure is observed there or in Fig. 9. Quantitatively, the filtered profiles in Fig. 10 were found to agree within one or one and a half of the (larger) error units of the pre-filtered original data. This distance decreased with the duration analyzed, for all but the weakest channels.
VI. FITTING TO THE DATA
A. Fit function
An elliptical Gaussian function of the form of Eq. (2) is fit to each channel at each time point. It should be noted that in similar spectroscopic studies, fitting to a 1D Gaussian is typical. For studies using a CCD (such as Den Hartog [5], Rapisarda [23], or Bamford [4]), where light falls onto a 2D grid of pixels, signals are either binned in the spatial direction or treated as if light falls only on a single column of pixels. In this system, light for each channel covers 2-3 pixels spatially and may overlap slightly (Fig. 4). We can more uniquely define each channel and account for slight variations in x_{0} off of calibration (due to spectrometer vibration) by using a 2D function and allowing x_{0} to vary as a free parameter. Δx_{0} corrections of up to ±26% of σ_{x} are observed.
B. Fitting algorithm
The model function f(x, y, a) [Eq. (2)] is fit to the data using the Levenberg-Marquardt Method (LMM). This has been used in other plasma diagnostics to fit nonlinear or convolved models to data (see Refs [24–29] or Ref [30]). The LMM, as derived independently by Levenberg [31] and Marquardt [32], combines the classical minimization techniques of linearization and gradient descent. The unweighted LMM algorithm is implemented in the following equation following Press [33] and Nocedal [34]:
The iteration proceeds with an initial λ = 0.001, increasing or decreasing by a factor of ten if the new value of χ^{2} is greater or smaller than the previous, respectively. The updated parameter is δa, α is a constant, and J is the Jacobian matrix.
A further attractive property of this implementation of the LMM is that it lends itself readily to the calculation of errors, not only of the overall model but the standard parameter error as well. This ability to individually specify the errors in temperature and velocity represents a significant improvement over previous error propagation schemes in many IDS instruments, which appear limited to root-mean-square (RMS) error or S/N values. This is accomplished by approximating the covariance matrix of the final fit f′. Here, the Hessian matrix H is approximated by [J^{T}J] (where J has already been calculated), assuming small higher order residuals [35],
The sensitivity of the model with respect to each parameter is scaled by the overall RMS error of the fit, producing standard parameter errors. The above are all conveniently implemented in the lm Matlab package. Oii (the noisier line) has bounding parameter errors of roughly ≲10 eV and ≲2 km/s in the temporal regions of interest for noisier HIT-SI shot 129496. Noisier HIT-SI3 shot 160728013 has ≲7 eV and ≲1 km/s error. The Ciii line tends to have errors of less than half of these values, and error decreases with increasing light emission (correlated with the toroidal current).
VII. CALCULATION AND ANALYSIS
A. Fitting to the velocity data
An example of the velocity and temperature data returned by applying Eq. (1) to the Gaussian fits is shown in Fig. 11 for HIT-SI and HIT-SI3. Most experiments cited previously, including HIT-SI [7], have focused their analysis on the raw velocity and temperature data to extract flow and temperature profiles. This study improves upon this by isolating the component of the ion motion oscillating at the helicity injection frequency by fitting with a sinusoidal function, Eq. (6). The initial parameter estimate is generated by a Fast Fourier Transform (FFT) of the data. Note that in contrast to BD, the dominant basis functions of velocity are expected to be periodic (if not sinusoidal), based on the periodic perturbation applied by the injectors. The data can be reconstructed and additional information is extracted, such as the temporal phase. The functional form of the ith channel reconstructed velocity is
where O_{i} is the offset velocity, A_{i} is the amplitude, f_{inj} is the injector frequency, and ϕ_{i} is the temporal phase offset. These quantities are illustrated in Fig. 12, which shows the sine-fit of the velocity data for corresponding chords at impact parameter ±32.8 cm for HIT-SI3 shot 160728011. The differences in velocity offset, temporal phase, and amplitude are visible. While the injector frequency-correlated component of the signal in both temperature and velocity is obvious in Fig. 11, the validity of a single frequency fit is determined from the Fourier power spectrum of this component and its higher harmonics relative to all others, as shown in Fig. 13. The dominance of the injector mode in the power spectrum motivates our fitting scheme.
B. Cycle-averaged calculated quantities
From reconstructed data, the magnitude of the plasma displacement can be calculated from the magnitude of the velocity oscillation by analytic integration,
Offset velocity O_{i} is related to the toroidal flow but can also be affected by calibration errors in y_{0} from Eq. (2). On HIT-SI3, the dual-fiber views (Fig. 3) allow the axisymmetric flow to be calculated as half the difference between velocity offsets of corresponding impact parameter above and below the geometric axis. HIT-SI did not have the lower viewport installed and so the velocity after injector shutoff was used to define “zero velocity.”
The temporal phase ϕ describes the relationship between ion motion and injector current. On HIT-SI, the phase is referenced from the zero crossing of the “X” injector [Fig. 1(b)]. On HIT-SI3, it is referenced from that of the “A” injector [Fig. 1(a)]. Phase correlations between channels suggest the extent of coherent structures in the plasma. In other words, regions of constant phase indicate that the plasma responds to the perturbation simultaneously. In this analysis, two manipulations of the temporal displacement phase are performed. First, the phase of the upper fiber (the only array on HIT-SI) is decreased by π, so that the phase is now describing displacement in the positive toroidal direction rather than with respect to the detector. Second, the phase for negative current shots is decreased by π for all channels so that the phase is now describing plasma displacement in the toroidal current direction.
The cycle-averaged temperature is given simply as the mean temperature as output by the Levenberg-Marquardt fitting to the raw data. The temperature also evolves in a semi-periodic fashion [Fig. 11(a)] but no analysis of this oscillation has yet been attempted.
C. Error analysis
The errors associated with the temperature, flow, and displacement profiles are calculated directly [Eq. (8)] from the parameter error output by the Levenberg-Marquardt algorithm (Sec. VI B), and the RMS error associated with the sine-fit [Eq. (6)],
where T is the number of time points where the fit is performed over, σ_{v,i,j,k} is the LM calculated error associated with velocity for corresponding impacts j from fiber array k of K (K = 1 for HIT-SI) at time point i, σ_{Ti,j} is the LM calculated error associated with temperature for chord j and time point i, and σ_{RMS} is the RMS error associated with the sine function fit.
We include the standard deviation of the temperature as an uncertainty to show the oscillation on top of the time-averaged profile. The addition of the sine fit RMS error extends the error bars in Figs. 14 and 10 slightly beyond the raw data error from Sec. VI B. This is done to show the temporal persistence of the profiles and fit. The 1/T term (where T is 59 for the HIT-SI shots and 46 for the HIT-SI3 shots analyzed here) damps the errors and is primarily responsible for the error bars in Figs. 14 and 10 appearing small. The data in Fig. 14 (though not Fig. 10) have been previously published by Hossack [7]; however, the error analysis techniques employed here are improved. The error associated with phase does not appear well-calculated by the lm package and is instead calculated perturbatively.
VIII. RESULTS
The results of these operations are plotted to compare ion species (Fig. 14 for Ciii, Fig. 10 for Oii) and toroidal current direction (shots 129499 and 160726013 are positive, 129496 and 160728012 are negative) for both experiments. Other diagnostic traces for these shots are given in Fig. 2. The Ciii and Oii lines listed on the plots are the 464.7 and 464.9 nm lines shown in Fig. 4. The Oii line is weaker, resulting in noisier data. Ion toroidal displacement phase, flow velocity, maximum displacement, and temperature profile are calculated as in Sec. VII B, with error calculated as in Sec. VII C. The HIT-SI3 lower fiber array (Fig. 3) is plotted with dashed lines. The temporal phases of the injectors are given alongside the phase of the displacement.
The peaked temperature profile in Ciii varying between 10 and 40 eV is observed for both experiments. Furthermore, in HIT-SI3, the overlap of the upper and lower fiber arrays indicates an axisymmetric mean temperature profile, roughly 8 eV hotter in positive toroidal current shots than negative shots of similar current magnitude. The shape of the Oii temperature profile cannot be determined above the error for HIT-SI or HIT-SI3 but is lower than Ciii for both.
The HIT-SI velocity profile cannot be determined for Ciii or Oii due to high relative error. For HIT-SI3, however, we find a small but statistically significant axisymmetric flow of ≈3 km/s in negative current shots vs. ≈1 km/s for positive current shots.
In HIT-SI, a relatively flat displacement phase region (Δϕ ≤ 30°) is observed for positive current and both ion species, between 20 ≲ R ≲ 40 cm. On HIT-SI3, a similar “flat” region is observed in the lower array (dashed lines), but not as much in the upper array. The inboard phase transition is not nearly as pronounced as in HIT-SI and only appears in the upper array. On the outboard side, the two arrays show ion displacement locked to an injector (Fig. 3).
IX. DISCUSSION
The disparity in temperature between Ciii and Oii on both experiments may indicate that the ion species density profile is not uniform, i.e., Oii may be relatively concentrated near the wall (due to its lower ionization energy) and Ciii may be concentrated near the core.
A strong peak in the ion displacement of approximately 6 cm around impact parameter 40 cm is observed for Ciii and of approximately 4 cm for Oii in both experiments. This is roughly consistent with the expected outboard separatrix location [16]. The decrease in displacement magnitude may be due to the decreased charge-to-mass ratio of Oii vs Ciii.
The implications of the displacement phase are more complex. The “flat” phase region in HIT-SI (positive shot 129499) and the lower array in HIT-SI3 (both shots) indicate that the spheromak is responding in a coherent manner to the applied perturbation. The almost 180° phase transition between the inboard separatrix and the geometric axis on HIT-SI suggests that the spheromak is displacing the injector-linked plasma in the core as it moves. These trends are not observed as clearly in Oii due to noise. The phase behavior in HIT-SI appears to be flipped in the negative shot (129496). This implies that the opposite-current spheromak is responding in the opposite manner to injector flux which may be taking the same path. In HIT-SI3, the region of coherence is more pronounced in the upper fiber in the negative shot (160728012). The injector-locked motion between the geometric axis and the inner separatrix suggests that the observed displacement is either plasma being pulled around by the injector-linking plasma or is the injector plasma itself.
The temporal persistence of these profiles is indicated by relatively low RMS error in the sine fit and the FFT spectrum (Fig. 13). The determination of chord and time-averaged mean ion temperature gradient (found on HIT-SI3 to be axisymmetric), the plasma displacement profile, and the temporal phase profile can be observed only due to the improved spatiotemporal resolution, and wide spatial extent. Prior IDS diagnostics could not fully resolve these profiles.
X. CONCLUSIONS
An ion Doppler spectroscopy diagnostic system has been constructed which fulfills the requirements of sub-perturbation temporal resolution and high spatial resolution and extent on the HIT-SI and HIT-SI3 devices. Sub-injector timescale frame rates (up to 10 × 14.5 kHz) on HIT-SI and full mid-plane viewing on HIT-SI3 with up to seventy-two spatial channels (≤2.8 cm spatial resolution) have been produced for Ciii and Oii impurities. Calibration, filtering, and fitting methods allow errors to be specified at ≲1 km/s and ≲5 eV, with an instrument temperature of 8-16 eV for Ciii. These improvements allow the determination of peaked, axisymmetric, chord-averaged temperature and displacement profiles on HIT-SI3, which agree with regions accessible to HIT-SI. Further, axisymmetric, current-dependent flow profiles have been found on HIT-SI3 of up to 3 km/s. Finally, coherent toroidal plasma displacement, locked to the applied perturbations, is seen in both experiments. Full midplane viewing, with high spatiotemporal resolution and parameter error analysis is not reported by other IDS devices, making the accurate simultaneous observation of these profiles impossible. Future work includes moving the fiber arrays further out to the edge to better capture the edge-core transition. It is hoped that the advances in acquisition and analysis techniques presented here will prove beneficial to future researchers.
FIG. 1. 
HIT-SI3 (left) and HIT-SI (right) flux conservers cut away at the toroidal midplane. Helicity injectors are shown, with flux coils (blue on HIT-SI and white on HIT-SI3) and voltage coils (red on HIT-SI and multicolored on HIT-SI3) shown separately. On HIT-SI, the second injector (“Y”) opposes the pictured one (“X”), rotated 90° toroidally. On HIT-SI3, all injectors (“A,” “B,” and “C”) are pictured.
FIG. 2. 
Operating parameters of shots shown in Figs. 14 and 10. Toroidal current [(a) and (e)], injector power [(b) and (f)], helicity injection rate [(c) and (g)], and electron density [(d) and (h)] given. Data from similar shots substituted were unavailable in original, with small timebase shifts for consistency. Black line represents signal boxcar smoothed at the injector frequency.
FIG. 3. 
Midplane fiber arrays: only the upper (green) array was installed on HIT-SI. HIT-SI3 can view above and below the geometric axis. Chords are superposed over the HIT-SI3 injectors, with “A” vertical on the right, “B” on the upper left, and “C” on the lower left. The red ring is the approximate magnetic axis.
FIG. 4. 
Raw CCD image from HIT-SI shot 129499, Ciii and Oii. Pictured data from upper half midplane port (Fig. 3). Second array (in poloidal port) not shown. Intensity units arbitrary.
FIG. 5. 
BD weights 1-30 (a). Dominant “cronos” showing background and oscillating modes (b). HIT-SI shot: 129499 [16].
FIG. 6. 
(a) Post BD filtering reduction in temperature and (b) velocity uncertainty. HIT-SI shot: 129499 [16].
FIG. 7. 
Raw CCD before (a) and after (b) BD filtering, HIT-SI shot: 129499, time 1.437 ms [16]. Intensity units arbitrary.
FIG. 8. 
Noise reconstruction CCD frame, HIT-SI shot 129499, time 1.437 ms [16]. Intensity units arbitrary.
FIG. 9. 
Data fit and normalized residuals for a Gaussian centroid 1D slice in time and λ-space, HIT-SI shot 129499. Above: raw data (blue), Post-BD filtering data (red), and Gaussian fit [Eq. (2)] (cyan). Below: normalized fit residuals. Intensity units arbitrary. X_{0}, Y_{0} = {88, 39}.
FIG. 10. 
Comparison the effect of toroidal current direction in observed profiles for HIT-SI [(a)–(d)], and HIT-SI3 [(e)–(h)], Oii ion. Maximum displacement [(a) and (e)], toroidal displacement phase [(b) and (f)], net toroidal flow [(c) and (g)] and temperature profile [(d) and (h)] are calculated in Sec. VII B and plotted against the impact parameter. The upper array is plotted with a solid line, and for HIT-SI3, the lower array is given with a dashed line. Phase of helicity injectors and shot toroidal current sign given in plot. Errors are calculated in Sec. VII C.
FIG. 11. 
(a) Raw temperature from HIT-SI3 shot 160728013 Ciii ion with toroidal and injector currents for reference. (b) Raw velocity from HIT-SI shots 129499 (red) and 129496 (blue), Ciii ion, with toroidal and injector currents for reference. Black lines mark zero velocity for each chord. Data are missing where a Gaussian could not be fit. Dynamics visualized more easily in Figs. 14 and 10.
FIG. 12. 
Velocity reconstruction and visualization of analyzed quantities for HIT-SI3 shot 160728011, impact parameter +32.8 cm (blue) and −32.8 cm (orange). Solid lines are raw data, dashed line is functional fit. Horizontal black line is sine fit offset, vertical black line is phase offset.
FIG. 13. 
Mode reconstruction validity: percentage of the total FFT power contained at the injector frequency and up to three higher harmonics. For all points above the gray dashed line, the injector modes are dominant. All shots reported in Figs. 14 and 10 shown, Ciii in (a), Oii in (b) for HIT-SI upper array and both HIT-SI3 arrays.
FIG. 14. 
Comparison the effect of toroidal current direction in observed profiles for HIT-SI [(a)–(d)], and HIT-SI3 [(e)–(h)], Ciii ion. Maximum displacement [(a) and (e)], toroidal displacement phase [(b) and (f)], net toroidal flow [(c) and (g)] and temperature profile [(d) and (h)] are calculated in Sec. VII B and plotted against impact parameter. The upper array is plotted with a solid line, and for HIT-SI3 the lower array is given with a dashed line. Phase of helicity injectors and shot toroidal current sign given in plot. Error calculated in Sec. VII C.

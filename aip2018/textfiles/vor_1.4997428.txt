Ground states for exponential random graphs
We propose a perturbative method to estimate the normalization constant in exponential random graph models as the weighting parameters approach infinity. As an application, we give evidence of discontinuity in natural parametrization along the critical directions of the edge-triangle model.
I. INTRODUCTION
Over the last decades, the availability of network data on typically very large scales has created the impetus for the development of new theories and methods for modeling and describing the properties of large networks. The introduction of exponential random graphs has aided in this pursuit as they are able to capture a wide variety of common network tendencies by representing a complex global structure through a set of tractable local features. From the point of view of extremal combinatorics and statistical mechanics, investigations have been focused on the variational principle of the limiting normalization constant, concentration of the limiting probability distribution, phase transitions, and asymptotic structures. See, for example, Chatterjee and Varadhan [14], Chatterjee and Diaconis [13], Radin and Yin [32], Lubetzky and Zhao [25,26], Radin and Sadun [30,31], Radin et_al [29], Kenyon et_al [20], Yin [34], Kenyon and Yin [22], Aristoff and Zhu [5], and Chatterjee and Dembo [12]. The main techniques used in these papers are variants of statistical physics, but the elegant theory of graph limits as developed by Lovász and co-authors [9–11,23,24], also plays an important role in the interdisciplinary inquiry. Building on earlier work of Aldous [2] and Hoover [18], the graph limit theory connects sequences of graphs to a unified graphon space equipped with a cut metric. Though the theory itself is tailored to dense graphs, parallel theories for sparse graphs are likewise emerging. See Benjamini and Schramm [6], Aldous and Steele [4], Aldous and Lyons [3], and Lyons [27] where the notion of local weak convergence is discussed and the recent studies of Borgs et_al [7,8] that are making progress towards enriching the existing L^{∞} theory of dense graph limits by developing a limiting object for sparse graph sequences based on L^{p} graphons.
In this paper, we study the “standard” family of exponential graph models in the asymptotic regime as the exponential parameters approach infinity. As the model name indicates, we are associating exponential weights to graphical ensembles. For each n, let G_{n} be the ensemble of simple graphs on n vertices and let G=∪_{n}G_{n} be the collection on all simple graphs. The exponential weights are defined in terms of subgraph densities. For any H∈G, the homomorphism density of H in a graph G∈G is defined as the probability that a random map on the vertex set of H into the vertex set of G, V (H) → V (G) is edge preserving. We write the homomorphism density as
Now, for all n, we define a probability distribution on G_{n} in terms of the homomorphism density. Let H_{1}, …, H_{d} be a given selection of simple graphs, where H_{1} is an edge: H_{1} = K_{2}. Let T:G_{n}→[0,1]{d}, where the components of T are homomorphism densities {T(Gn)}{i}=t(H_{i},G_{n}). Given β∈R^{d}, define the functional on G_{n}∈G_{n},
and weight G_{n}∈G_{n} by e^{n2Tβ(Gn)}. The normalization constant for the ensemble G_{n} is then given by the partition function,
The terminology for the partition function is borrowed from thermodynamics. In this context, |β| is the inverse temperature. Renormalizing T^{β} in (2) and fixing β/|β|, one obtains a Hamiltonian H(G_{n})=−n^{2}|β|T^{β}(G_{n}). As n → ∞, the major contribution to the partition function concentrates around the thermal states (labeled by f^{β}), in a manner analogous to standard thermodynamic models (see Sec. I B). These thermal states are well understood in the large temperature regime |β| → 0. For any selection of subgraphs H_{1}, …, H_{d} and |β| sufficiently small, the associated thermal state lies in the replica symmetric phase [13], i.e., f^{β} ≡ ρ. On the other hand, the ground states, which are defined as the limit of the thermal states f^{β} as |β| → ∞, are not so simple. In some cases, the ground state is known to be in the replica symmetric phase [13], while in other cases, the ground state concentrates around a simple graph in G [35].
Our motivation for this paper comes from the edge-triangle model, obtained by setting d = 2 and H_{2} a triangle: H_{2} = K_{3}. It was shown in Ref [35] that there are countably many critical directions of β, along which the ground state of the model is chosen from finitely many simple graphs with some unknown distribution, and our goal is to develop a mechanism that determines which of these simple graphs is the proper ground state.
A. Graphon topology
The thermal states f^{β} belong to the space of graph functions “graphons” which may be understood as generalizations of graphs. The set of graphs G may be embedded into the space of graphons which consist of symmetric measurable functions from [0, 1]^{2} into [0, 1],
For any n and a graph G_{n}∈G_{n}, the graphon representation is the function
where the interval [0, 1] may be intuitively thought of as a “continuum” of graph vertices. The distance between graphons is given in terms of the “cut distance,” defined for f,h∈W, as
However, a nontrivial difficulty arises from the arbitrary labeling of vertices as they are embedded in [0, 1]. Thus we introduce the equivalence f ∼ f_{σ}, where f_{σ}(x, y) = f(σx, σy), where σ: [0, 1] → [0, 1] is any measure preserving bijection. We write the quotient space of graphons under the equivalence ∼ as W̃, and the equivalence class under ∼ of f∈W as f̃. Incorporating the equivalence relation ∼ yields a distance
where the infimum ranges over all measure preserving bijections σ_{1} and σ_{2}, making (W̃,δ_{□}) a compact metric space (see Sec. 9.3 of Lovász [23]). With some abuse of notation, we also refer to δ_{□} as the “cut distance.”
All graphons arise as the limit of some sequence of graphs. Given a graphon f∈W, one may construct a graph G_{n} = G(n, f) by selecting independent identically distributed (iid) points x_{1}, …, x_{n} uniformly from [0, 1] which represent the vertices of G_{n}, and then connect vertices i, j with probability f(x_{i}, x_{j}). In this context, the expected subgraph density is given by the graphon homomorphism density
which generalizes (1) and is continuous in metric δ_{□}. Indeed, for any graph H, the subgraph homomorphism density of random graphs selected by the above construction converges almost surely to the graphon homomorphism density,
B. Exponential random graphs
As discussed above, we will define measures on G_{n} in terms of subgraph densities. For G_{n}∈G_{n}, define the probability
where we have introduced the normalization constant (free energy density),
By replacing the subgraph homomorphism density (1) with graphon homomorphism density (8) in (2), T^{β} extends naturally to (W̃,δ_{□}). Since T^{β} is continuous and bounded on the compact set W̃, there is a nonempty compact subset K^{β} of W̃ so that T^{β} is maximized on K^{β}. Take I:[0,1]→R as
and then extend the domain of I to W̃ by
where f is any representative element of f̃. It follows from Lemma 2.1 in the work of Chaterjee and Varadhan [14] that ψ^{β}(f̃)≔T^{β}(f̃)−I(f̃) is well defined on W̃ and upper semi-continuous under the cut metric δ_{□}. Let F^{β} be the subset of W̃ where ψ^{β} is maximized. Then like K^{β}, F^{β} is a nonempty compact subset of W̃.
For the purpose of this paper, two theorems from the work of Chatterjee and Diaconis [13] (both based on the large deviation result in Ref [14]) merit some special attention. Together they connect the occurrence of a phase transition in the exponential random graph model with the solution of a certain maximization problem. The first theorem (Theorem 3.1 in Ref [13]) states that for any β, the limiting normalization constant lim_{n→∞}ψnβ of the exponential random graph always exists and is equal to ψ^{β}. The second theorem (Theorem 3.2 in Ref [13]) states that in the large n limit, the quotient image f̃{Gn} of a random graph G_{n} drawn from (10) must lie close to F^{β} with high probability,
Since the limiting normalization constant ψ^{β} is the generating function for the limiting expectations of other random variables on the graph space such as expectations and correlations of homomorphism densities, a phase transition occurs when ψ^{β} is non-analytic or when F^{β} is not a singleton set. Although it is difficult to evaluate ψ^{β} and determine the maximizing set F^{β} for most β, we will derive an efficient method to approximate F^{β} and estimate ψ^{β} for β sufficiently far from the origin.
II. THE APPROXIMATION SCHEME
Take a finite simple graph H with vertex set V(H) and edge set E(H). Consider a graphon f∈W. For each (r, s) ∈ E(H) and each pair of points x_{r}, x_{s} ∈ [0, 1], define
The above definition appears rather complicated, but in essence may be identified with the homomorphism density (8), if we remove edge (r, s) from H and do not integrate out the associated vertices x_{r} and x_{s}. For (x, y) ∈ [0, 1], define
which corresponds to the total homomorphism density generated after all possible ways of removing one edge from H. We give some examples to illustrate this idea. When H is an edge, Δ_{H}f(x, y) ≡ 1. When H is a triangle, by symmetry, Δ_{H}f(x,y)=3∫_{[0,1]}f(x,z)f(y,z)dz.
A. Motivation
We will consider as a motivating example the edge-triangle model, which is a 2-parameter exponential random graph model obtained from (10) by setting H_{1} to an edge and H_{2} to a triangle. Take β = ru for u=(u_{1},u_{2})∈S. Suppose that u_{1} > 0 and u_{2} < 0, i.e., the 2-dimensional parameter vector u is pointing towards the 4th quadrant. Then K^{u} (which agrees with K^{β}) consists of graphons f that minimize (u_{1}/u_{2})e + t, where e = t(H_{1}, f) denotes the edge density and t = t(H_{2}, f) denotes the triangle density of f, respectively. This implies that f, the maximizers of T^{u} (and hence of T^{β}) must lie on the Razborov curve, which is the lower boundary of the feasible region R of edge-triangle homomorphism densities. As u_{1}e + u_{2}t is a linear function, f must minimize over the convex hull P of R. Since R and P only intersect at the points corresponding to Turán graphons, f must be a Turán graphon. This important fact about the structure of K^{β} was further used to derive the maximizing graphons of F^{β} in Ref [35]. Using the boundedness of I, we found that F^{β} consists of graphons that can be made arbitrarily close to Turán graphons when the magnitude of β is sufficiently large, and exactly which Turán graphon is favored by F^{β} depends on the direction of β. However, as nice as these results are, there is ambiguity concerning the optimal Turán graphon along the critical directions of β, which correspond to normal lines of the convex hull P. The subtlety might be due to the fact that Turán graphons, though close to our optimal graphons in cut distance, are not best approximations to the maximizing set F^{β}. Generalizing from Turán graphons [16], we say that a graphon f is random-free if f = χ_{A} for some symmetric measurable subset A of [0, 1]^{2}. When β is finite, Chatterjee and Diaconis [13] showed that the maximizing graphons in F^{β} are almost nowhere random-free—that is, the set {x ∈ [0, 1]^{2}: f(x) ∈{0, 1}} has zero measure. We are thus interested in finding coarse-grained graphons that are not random-free but close to F^{β} in cut distance as they are sufficient to distinguish between candidates for the ground state. Resorting to a perturbation analysis in the |β| → ∞ regime, we will propose a method that keeps track of only the most significant characteristics of the maximizing graphons and demonstrates their effectiveness.
B. Assumptions
Let R denote the range of T in R^{d} and suppose that the boundary ∂R is piecewise analytic. For w∈∂R, let F_{R}(w) denote the set of all feasible directions of R at w so that v∈F_{R}(w) implies that there is ϵ > 0 with w + ϵv ∈ R. The (internal) tangent cone C_{R}(w) of R at w is then given by the closure of F_{R}(w). See Fig. 1 for an illustration of this concept in the edge-triangle model. Let β = ru for u∈S^{d−1}, where r is sufficiently large. Suppose that T^{u} (and hence T^{β} as |β| → ∞) is maximized at a set of random-free graphons f = χ_{A}, i.e., K^{u} (which agrees with K^{β}) consists of random-free graphons only. Further suppose that f∈K^{u} has the property that
where Δ_{Hi}f is defined as in (16) and B≔[0, 1]^{2}A. We remark that these nice properties that we assumed are enjoyed beyond the edge-triangle model. Denote by K_{k} a complete graph on k vertices. Since the vertices of the convex hull P of R for K_{2} and K_{n} (any n), not just K_{2} and K_{3} as in the edge-triangle case, are given by Turán graphons, our argument will run through without much modification in these cases. Utilizing geometry of their respective convex hull [15], a similar analysis may be extended to more general models. We point out in particular that if f is a Turán graphon, then (17) holds for any H_{i} due to symmetry.
C. Perturbation of random-free graphons
Consider a maximizing graphon h∈F^{β}. When the magnitude of β is sufficiently large, since T^{β} diverges while I stays bounded, F^{β} and K^{β} can be made arbitrarily close in the cut metric. From our assumptions in Sec. II B, there thus exists a random-free graphon f = χ_{A} that is close to h under the cut distance. We will further construct a non-random-free graphon X_{h} that is close to h, simple enough, and yet still retains important information of h. Most importantly, we will show that for any finite simple graph H_{i}, t(H_{i}, X_{h}) approximates t(H_{i}, h) at least as well as t(H_{i}, f) asymptotically. The following proposition is specific for random-free graphons and will be useful for our investigation.
Proposition II.1. Let ||⋅||_{1}denote the L^{1}-norm. For a random-free graphon f, d_{□}(f, h) = O(||f − h||_{1}).
Proof. By (6), it is clear that d_{□}(f, h) ≤ ||f − h||_{1}. For the other direction, suppose f = χ_{A} for some symmetric measurable subset A ⊂ [0, 1]^{2}. If A is a rectangle, then ||f − h||_{1} ≤ 2d_{□}(f, h). The general conclusion follows once we recognize that any subset A of [0, 1]^{2} may be approximated within ϵ > 0 by a finite union of disjoint rectangles.Let us first expand t(H_{i}, h) around f. Denote a perturbation of f by g = h − f. Corresponding to the regime |β| → ∞, as explained earlier, f may be chosen so that |g|∈W. We have
Under our assumption (17), we compute the first variation,
Define
Using that f = χ_{A} and g = h − f, (19) reduces to
The remainder terms (if they exist) give the homomorphism density after all possible ways of removing at least two edges from H_{i} and so are bounded above by either ∫_{[0,1]{3}}|g(x,y)||g(x,z)|dxdydz or ∫_{[0,1]{4}}|g(x,y)||g(u,v)|dxdydudv. Estimating the latter is easy,
which is of negligible asymptotic order when compared to the first variation (19). The former corresponds to the 2-star density of a graphon |g| with edge density ||g||_{1}. By Ref [1], for small ||g||_{1}, the 2-star density is bounded below by ||g||12 and above by ||g||_{1}/2+O(||g||12), and the upper bound is achieved when |g| is an anticlique of the form
where c=1−1−||g||_{1}. The lower bound for this remainder term is of desirable asymptotic order, but the upper bound is of the same order as the first variation. Recall that the maximizing graphon h for a finite β is uniformly bounded away from 0 and 1 [13]. The graphon |g| = |h − f| is thus likely quite different from an anticlique. This implies that the 2-star density of |h − f| is of higher order than ||h − f||_{1} and does not achieve the upper bound. The phenomenon was confirmed, for example, by simulations for the edge-triangle model [21].Define the averaged perturbation by X_{h} = aχ_{A} + bχ_{B}, where a and b are given in (20). X_{h} may be viewed as a flattened out version of h. Since
X_{h} is close to f (and hence h) under the L^{1} distance, and by Proposition II.1, also under the cut distance. Denote by g′ = X_{h} − f. We perform the same expansion for t(H_{i}, X_{h}) around f as in the last paragraph,
Following similar reasoning as in (19) and using the definition of X_{h},
This says that t(H_{i}, h) and t(H_{i}, X_{h}) agree except for the remainder terms. As for t(H_{i}, h), the remainder terms for t(H_{i}, X_{h}) (if they exist) are bounded above by either ∫_{[0,1]{3}}|g^{′}(x,y)||g^{′}(x,z)|dxdydz or ∫_{[0,1]{4}}|g^{′}(x,y)||g^{′}(u,v)|dxdydudv. Since ||g′||_{1} = ||g||_{1} = (1 − a)|A| + b|B| by (24), the latter is of asymptotic order ||g||12, while the former gives
and so is also of asymptotic order ||g||12. We conclude that t(H_{i}, X_{h}) gives at least as good an asymptotic approximation for t(H_{i}, h) as t(H_{i}, f) and a better one when the error term related to the 2-star density of |h − f| may be dropped.
D. Maximizing graphons
Let β = ru for u∈R^{d} and ∥u∥ = 1. Under our assumptions, K^{u} (which agrees with K^{β}) is a set of random-free graphons. Take h∈F^{β}. Then for ϵ > 0 and r large (corresponding to |β| → ∞), d_{□}(f, h) < ϵ for some f∈K^{u}, i.e., f = χ_{A} for some symmetric measurable subset A of [0, 1]^{2}. By (18) and following analysis,
Similarly, by (25) and following analysis,
In both equations above, the entropy I is bounded in contrast with the energy contribution T^{β}. Except that h is close to f (and hence X_{h}) in cut distance, we do not have enough information regarding the structure of h. Rather than maximizing ψ^{β}(h) over all possible graphons h directly, we will maximize ψ^{β}(X_{h}) over 2-parameter families 0 ≤ a, b ≤ 1. From the heuristics in Sec. II C, this is an effective method to approximate the optimal graphon. More than that, in certain situations (for example, the edge-triangle model to be discussed in detail in Sec. III), we will see that keeping 2 parameters is not only effective but also sufficient. Notice that
We rewrite X_{h} as follows:
Maximizing each first variation term, we have
Under this choice of a and b and provided we can ignore the remainder terms, ψ^{β}(X_{h}) is strictly bigger than rT^{u}(f), which is the random-free graphon approximation corresponding to a = 1 and b = 0. Let us verify that ψ^{β}(X_{h}) is indeed strictly bigger than rT^{u}(f) by rigorously managing the error term in (31). As shown earlier in Sec. II C, the remainder terms are of higher order,
For any ϵ > 0, there exists large enough r so that ||X_{h} − f||_{1} is sufficiently small, making 0 < 1 − a < ϵ and 0 < b < ϵ. Applying these ϵ bounds in (33) gives
Maximizing each first variation term as previously, this yields ψ^{β}(X_{h}) > rT^{u}(f). We conclude that, as expected, the addition of one more parameter improves the random-free graphon estimation.
III. THE EDGE-TRIANGLE MODEL
Denote by K_{k} a complete graph on k vertices. The edge-triangle model is a 2-parameter exponential random graph model obtained by taking H_{1} an edge (K_{2}) and H_{2} a triangle (K_{3}) in (10). Consider the set R={(t(K_{2},f),t(K_{3},f)),f∈W} of all realizable values of the edge (e) and triangle (t) homomorphism densities as the graphon f varies over the entire graphon space W. See Fig. 1. The upper boundary curve of R is given by the equation t = e^{3/2} and can be derived using the Kruskal-Katona theorem (see Sec. 16.3 of Ref [23]). The lower boundary curve is trickier. The trivial lower bound of t = g_{1}(e) ≔ 0, corresponding to the horizontal segment, is attainable at any 0 ≤ e ≤ 1/2 by graphons describing the possibly asymptotic edge density of subgraphs of complete bipartite graphs (Turán graphon with 2 classes). For e ≥ 1/2, the optimal bound was obtained by Razborov [33], who established, using the flag algebra calculus, that for (k − 1)/k ≤ e ≤ k/(k + 1) with k ≥ 2,
All the curve segments g_{k}(e) describing the nontrivial part of the lower boundary of R are strictly concave. For k = 1, 2, …, we set v_{k}≔(e_{k},t_{k})=(t(K_{2},f^{Kk+1}),t(K_{3},f^{Kk+1})), where explicitly,
is the Turán graphon with k + 1 classes. Thus
For k = 1, 2, …, let L_{k} be the line segment joining vertices v_{k} and v_{k+1} of neighboring Turán graphons. These infinitely many line segments form the convex hull P of R, and the length of L_{k} decreases monotonically to zero as k gets large.
The normal vectors to L_{k},
are the critical directions of the edge-triangle model. Let β = ro_{k} and take r → ∞. While the vectors o_{k} (38) are not normalized as in our derivation (see Sec. II), this can be easily adjusted by adapting r. Then Turán graphons with k + 1 and k + 2 classes both belong to K^{ok} (which agrees with K^{β}), and we concluded in Ref [35] that a typical graph sampled from the model may behave like either a Turán graphon with k + 1 classes or a Turán graphon with k + 2 classes, with no clear preference. Though already quite informative, as explained earlier in Sec. II A, this result remains somewhat unsatisfactory because it does not indicate whether both such graphons are actually realizable in the limit and in what manner. Notice that underneath our investigation, there is an ordered double asymptotic framework, in the sense that the network size n goes to infinity first followed by the divergence of the parameters β. In hope of resolving this rather subtle ambiguity within the edge-triangle model, the “other” order was also examined in Ref [35], where we first let the magnitude of β increase to infinity so as to isolate a simpler sub-model and then study its limiting properties as n grows. Both ordered asymptotics imply a nearly identical convergence in probability in the cut metric along the noncritical directions. Under the “original” as well as the “reversed” order, there exist (possibly different) subsequences of the form {n_{i}, β_{1,}_{i}, β_{2,}_{i}}, with n_{i} → ∞, β_{1,i} → ∞, and β_{2,i} → −∞ for i = 1, 2, …, where the edge-triangle model converges to some Turán graphon specified by the direction of the parameters (β_{1}, β_{2}). Additionally, under the “reversed” asymptotics, a detailed categorization of the limiting behavior of the edge-triangle model was obtained: When β diverges along the critical direction o_{k}, a typical sampled graph more likely resembles a Turán graphon with k + 2 classes than with k + 1 classes. Now that we are equipped with a refined perturbation analysis, we would like to sharpen our results under the “original” asymptotics and inquire whether the same type of discontinuity in natural parametrization exists.
Let us make a further remark before carrying out the detailed calculations. In the physics literature, people are often interested in cases where the parameter β depends on n (some averages need to be satisfied for every n). In these models, in place of the normalization constant (free energy density), the relative entropy plays a central role. Analogous (but more complicated) maximization problems and concentration of measure results have been established, which lead to classifications of ensemble equivalence between the microcanonical ensemble and the canonical ensemble. The perturbative methods explored in the current paper are expected to apply in these general parameter situations. In some cases, the perturbation would still be around random-free graphons, and our argument will run through without much adaptation [17]. In some other cases however, the perturbation would be around graphons admitting more intricate structures, and serious future work is needed [19,28].
A. Perturbation analysis
Let β = ro_{k}. We will compare ψ^{β}(X) and ψ^{β}(Y), where X is the flattened out graphon close to f^{Kk+1} (Turán graphon with k + 1 classes) and Y is the flattened out graphon close to f^{Kk+2} (Turán graphon with k + 2 classes). Both X and Y are constructed with the optimal perturbation values (32). We set u = o_{k} in our calculations below. For i = 1, 2, we compute aiX, biX, aiY, and biY for f^{Kk+1} and f^{Kk+2} in (17), where H_{1} = K_{2} and H_{2} = K_{3}. As pointed out earlier in Sec. II, a1X=b1X=a1Y=b1Y=1. For notational convenience, from now on, we denote f^{Kk+1} by T_{k} and χ_{[0,1]{2}}−f^{Kk+1} by D_{k}. Then T_{k} and D_{k} are indicator functions associated with sets of measure k/(k + 1) and 1/(k + 1), respectively. Reconfirming our assumption in (17),
which gives
This yields
We check the remainder terms for ψ^{β}(X) after first order perturbation. A similar analysis will work for ψ^{β}(Y) and we skip the details. Consider the (internal) tangent cone C_{R}(v_{k}), consisting of graphons of the type X_{h} = aT_{k} + bD_{k}. See Fig. 2. Then
For (x, y) ∈ [0, 1]^{2}, we have
which implies that
This yields
Using (32) and (41) for a and b, (45) gives ψ^{β}(X). After first order perturbation as in (31), the remainder terms are bounded by
The following lemma is useful for our asymptotic derivation.
Lemma III.1. Let I be defined as in(12). As x → ∞,
and as x → −∞,
Proof. We recognize that after simplification, the left-hand side of (47) becomes log(1 + e^{−x})/2, and the left-hand side of (48) becomes x/2 + log(1 + e^{−x})/2. The rest is immediate.Applying Lemma III.1 to the first order perturbation terms, we see that conforming to our heuristic analysis in Secs. II C and II D, the remainder terms are indeed of negligible order. For r large enough, we have
Since ∑i=12biXu_{i}=−1/(3k+5) has the smallest absolute value among all equations in (41), ψ^{β}(X) > ψ^{β}(Y) both in terms of first order perturbation (49) and the exact value.Denote by ψoptβ(X_{h}) and ψoptβ(Y_{h}) the exact optimal value of ψ^{β} within the (internal) tangent cone C_{R}(v_{k}) and C_{R}(v_{k+1}), respectively. Let us compare ψoptβ(X_{h}) with ψoptβ(Y_{h}). From our heuristic argument, for any ϵ > 0 and r large enough, (34) is satisfied,
Following similar reasoning, we also find a bound in the other direction,
Maximizing each first variation term and applying Lemma III.1 as previously, this says that ψ^{β}(X_{h}) is asymptotically bounded below by
and above by
A similar analysis works for ψ^{β}(Y_{h}) and we skip the details. Since ϵ > 0 can be taken arbitrarily small and ∑i=12biXu_{i}=−1/(3k+5) has the smallest absolute value among all equations in (41), ψoptβ(X_{h})>ψoptβ(Y_{h}). As discussed earlier in Sec. I, by Theorems 3.1 and 3.2 in the work of Chatterjee and Diaconis [13], we conclude that when β diverges along the critical direction o_{k}, a typical sampled graph more likely resembles a Turán graphon with k + 1 classes than with k + 2 classes. See Table I and Fig. 3.
Theorem III.2. Consider the edge-triangle exponential random graph model, obtained by setting in(10)H_{1}an edge and H_{2}a triangle. For k ≥ 1, let β = ro_{k}, where o_{k}is the critical direction(38)and r is sufficiently large. Then in the large n limit, a typical graph drawn from the model behaves like a Turán graphon with k + 1 classes,
B. Geometric interpretation
We proceed further and examine the effect of infinitesimal perturbation on the associated edge and triangle densities. From (42) and (44),
Let us present another perspective on this calculation incorporating assumption (17), which may be employed to derive infinitesimal variations for more complicated homomorphism densities. The idea appeared in our heuristic analysis before and we make it explicit here. For any H_{i} so that (17) is satisfied,
Using a_{1} = b_{1} = 1, a_{2} = 3(k − 1)/(k + 1), and b_{2} = 3k/(k + 1) (40), we recover the partial derivatives calculated above. In particular, we recognize that −(a_{1}, a_{2}) points along the left tangent line and (b_{1}, b_{2}) points along the right tangent line, while the critical direction u = o_{k} is the normal vector to the line segment L_{k} that connects neighboring vertices v_{k} and v_{k+1}. This offers a geometric justification of the (±) signs in (41).
Recall that the lower boundary of attainable edge-triangle densities is a piecewise algebraic curve with infinitely many concave pieces g_{k} (35), and the connection point of g_{k} and g_{k+1} is v_{k} = (e_{k}, t_{k}). See Fig. 1. We compute
which implies that the left- and right-hand side derivatives at e_{k} = k/(k + 1) are, respectively, given by
The partial derivative vectors in (55) thus delineate the boundary of the (internal) tangent cone C_{R}(v_{k}). In other words, C_{R}(v_{k}) spans all possible infinitesimal variations at the Turán graphon with k + 1 classes. See Fig. 2. Since the optimizing graphon associated with large enough β must lie within the tangent cone of some Turán graphon, it may be represented by a linear combination of Erdős-Rényi and Turán graphons. Even though the graphon representation may not be unique, optimizing over all possible combinations provides an insight into the structure of the maximizing set. Keeping track of the Erdős-Rényi and Turán characteristics in the edge-triangle model is thus not only an effective but also sufficient method to estimate the normalization constant and gives evidence of discontinuity of the natural parametrization along the critical directions o_{k} in the limit as n and then r tend to infinity. This demonstrates the occurrence of discontinuous phase transitions in the edge-triangle model.
TABLE I. 
Asymptotic comparison for perturbation around neighboring Turán graphons, where β = (10, −7.5) diverges along the critical direction o_{1} = (1, −0.75). a, b, and ψ^{β} are calculated from (32) and (49) with first order perturbation; a_{opt}, b_{opt}, and ψoptβ are based on numerical optimization for (45). The bipartite feature is associated with a bigger limiting normalization constant and is favored, matching the asymptotic predictions of Theorem III.2.
TABLE I. -body
	a	b	ψ^{β}	a_{opt}	b_{opt}	ψoptβ
Bipartite	0.999 999 998	0.075 9	5.0197	Almost 1	0.069	5.019
Tripartite	0.993 3	0.000 045 4	5.0022	0.9943	0.000 064	5.0021
FIG. 1. 
Region of attainable edge (e) and triangle (t) densities for graphons. The upper boundary is the curve t = e^{3/2}, and the lower boundary is a piecewise algebraic curve with infinitely many concave pieces; see Ref [33]. The tangent cones at complete bipartite graphon (Turán graphon with 2 classes) and complete tripartite graphon (Turán graphon with 3 classes) are displayed.
FIG. 2. 
The (internal) tangent cone C_{R}(v_{k}), consisting of graphons of the type X_{h} = aT_{k} + bD_{k}. Taking a = 1, b = 0 gives the Turán graphon with k + 1 classes, whose edge-triangle densities are v_{k} = (e_{k}, t_{k}). Here gk′(e_{k}−0) and gk′(e_{k}+0) indicate the left- and right-hand side derivatives of g_{k} (35) at e_{k}, respectively.
FIG. 3. 
A simulated realization of the exponential random graph model on 60 nodes with edges and triangles as sufficient statistics, where β = (10, −7.5) diverges along the critical direction o_{1} = (1, −0.75). n is of much bigger magnitude than β in reflection of the double asymptotic order. The simulated graph displays bipartite feature with edge density 0.557, matching the asymptotic predictions of Theorem III.2.

Pedestals and feedback in fusion-plasma relevant sandpile models
We present modifications to the sandpile model [Chapman, Phys. Rev. E 62, 1905 (2000)] (Classic Model). A feedback loop is added to the Classic Model, elements of which may have relevance to the behaviour of a fusion plasma. Those elements include variation of the total energy of the system in proportion to a proxy for the Larmor radius, ρ, and resulting variations in mass loss event (MLE) size and waiting times between MLEs. We also show other variants of the Classic Model which produce pedestals, without introducing feedback. The modifications produce a pedestal similar to that seen in a fusion plasma, as well as feedback effects. We observe that maximum MLE sizes, and maximum waiting times between MLEs, grow with pedestal size only in the presence of feedback. If, as we purport, the edge localised mode (ELM) process is captured by an MLE model with feedback, then a conclusion is that ELMs can be reduced if feedback effects are reduced.
I. INTRODUCTION
Sandpile models [1] are commonly [2–11] used to provide simple models of plasma behaviour. The sandpile model introduced by Chapman [12], whose behaviour is determined by a fluidization length, L_{f}, which controls the mixing behaviour of avalanches, has been applied to fusion plasmas in a number of contexts [6,9], most recently to model the time series of edge localised modes (ELMs) in a H-mode fusion plasma [13]. In this paper, we demonstrate variations of that model in which a significant pedestal appears in the sandpile, including a model in which feedback effects are introduced.
The distinctive feature of H-mode is that a pedestal appears in the plasma pressure and temperature profiles. The pedestal develops during the transition from L-mode to H-mode, with a gradual steepening of the edge pressure gradient. The development of the pedestal is believed to result from shear flow in the plasma which breaks up micro-instabilities [14–16]. The shear flow is, in turn, thought to be caused by a radial electric field, to which several contributions have been identified [14,17–19]. Burrell [16] points out that “since sheared E × B flow also affects turbulence and transport, there are several feedback loops where E_{r} and its shear can change.”
In turn, with the H-mode, ELMs develop, caused by a peeling-ballooning mode within a H-mode plasma. The main mechanism responsible for the production of ELMs is thought to be the coupling of pressure-gradient-driven “ballooning” modes and current-density-driven “peeling” modes [20]. These so-called “peeling-ballooning” modes represent a spectrum of modes ranging from highly localised peeling modes to more extended ballooning modes, and modes formed from a significant coupling of each [21].
Several mechanisms have been employed to suppress ELMs, notably resonant magnetic perturbation (RMP) and pellet pacing. In the case of the RMP, there is some suggestion that it is the linear edge-localised peeling response of the RMP field inside the plasma that controls the efficacy of mitigating or suppressing large ELMs [22]. Pellet pacing reduces ELM size by triggering the instability through an external perturbation at a higher rate than the natural ELM frequency [23]. These strategies are not synchronized with the ELM, and we do not seek to model their behaviour here.
The pedestal size in H-mode is thought to be proportional to the Larmor radius of the ions, ρ, and various models have been considered for the relationship, from ρ^{1/2} up to linear scaling [24–27]. The Larmor radius is also proportional to the particle velocity (and accordingly the square root of the energy) in accordance with
The edge pedestal width increases with isotope mass [26], as ρ increases with isotope mass, and the frequency of ELMs decreases with increasing isotope mass [26]. Isotope scaling in JET is discussed by Cordey et_al [28] and it is observed that while the overall confinement time is not mass dependent, confinement in the core decreases with increasing mass, and confinement in the edge pedestal increases almost linearly with increasing mass. It is further observed [28] that the fraction of input power lost due to ELMs decreases with increasing isotope mass. Righi et_al [29] observed an inverse scaling of the H-mode threshold with increasing isotopic mass. It is also thought that there is an isotopic mass dependence of several ELM characteristics, including a reduction in the ELM frequency with increasing mass [24,25] (so that ELM waiting times increase with increasing mass), an increase in edge pedestal pressure with increasing mass [24,25], and an increase in the drop in the electron temperature at the occurrence of ELMs, again with increasing mass [25]. For the JET plasmas analysed by Bhatnagar et_al [25], proportionality between ρ and the edge pedestal width was found to be supported by the scaling for the critical edge pressure. ELM energy increases with normalised ρ^{*}=ρ/a [30], increasing pedestal size and energy [30,31], and increasing mass [25]. For particular machines, ELM energy is a constant fraction of pedestal electron energy [31].
Figure 1 shows examples of the increase in ELM energy proportional to ρ* in DIII-D and JET [30]. Snyder [32–34] has proposed the EPED model, which predicts that the pedestal width and height are set by the intersection of the onset of the peeling-ballooning mode at an intermediate to low toroidal mode number, and the onset of the kinetic ballooning modes at a high mode number. A key characteristic dependence of the pedestal width and height is the poloidal beta, β_{p}. The EPED model takes into account a number of variables, including the mass [34]. As β_{p} is dependent, in part, upon temperature, the net result is that the EPED model depends upon both mass and temperature, which are also the key determinants of ρ (together with electric charge, which is constant for isotopes of hydrogen). As both pedestal size and ρ are dependent upon mass and temperature, and ρ has units of length, we treat ρ as a proxy for a variable upon which pedestal size is dependent, and which is in turn affected by pedestal size. We summarise the observed properties and identify their experimental reference, in Table I. In summary, the isotope mass, ρ, the edge pedestal size, ELM waiting times, the edge pedestal pressure, the critical edge pressure, and the electron temperature perturbation at the occurrence of ELMs are all positively correlated, and ELM energy is positively correlated with edge pedestal size.
We assume that shear flow occurs within an edge pedestal whose size is proportional to ρ and model the feedback loop [16] resulting from an increase in ρ within the edge pedestal. In turn, this results in an increase in the temperature and pressure gradient, an increase in shear flow within the edge pedestal, and an increase in the size of the edge pedestal. Negative feedback occurs when ELMs decrease system energy, so that the temperature and pressure gradient decrease, resulting in the reverse of the positive feedback process. We also introduce models in which an edge pedestal appears without feedback.
The sandpile models employed here are modifications of the model introduced by Chapman [12] (Classic Model), whose key feature is a fluidization length, L_{f}, which defines the distance over which the sandpile is conservatively flattened when the critical gradient is exceeded. L_{f} is, therefore, the “self-interaction” distance within the sandpile. As L_{f} decreases, the ability of particles within the sandpile to interact over long distances decreases, and the sandpile is able to build up for longer periods before a system wide avalanche, leading to a mass loss event (MLE). In this way, L_{f} may be considered a proxy for shear flow behaviour, so that a smaller L_{f} leads to greater energy in the sandpile for reasons which are related to the reason that an increase in shear flow leads to an increase in the energy of a fusion plasma.
Typically [6,9,12],L_{f} is set constant over the sandpile. When L_{f} is constant, the gradient of the sandpile in a quasi-steady state is approximately constant, without a significant edge pedestal, although the edge structure [6] has been identified in the Classic Model for large L_{f}. Here, we provide for a L_{f} which differs over the sandpile, in a manner which produces a final sandpile with an edge pedestal of similar appearance to a H-mode plasma.
In the Classic Model, a system of cells is created (here, we use N = 500 cells), and sand is progressively added at the core. The rate of addition of sand, dx, is here set to 1.2 units per time step. As sand builds up in cell n = k, the amount of sand in cell n = k (s_{n=k}) exceeds s_{n=k+1} by an amount called the critical gradient Z_{c}, set equal to 120, meaning that dx/Z_{c}=0.01. When Z_{c} is exceeded, the sand in cell n = k avalanches. The critical feature of the Classic Model is that the avalanche does not occur simply by an amount of sand moving from n = k to n=k+1. Rather, the sand in cells n=k−L_{f} to n=k+1 is flattened conservatively. As a result, the amount of sand at cell n=k+1 increases, effectively moving sand from left to right. We then check whether Z_{c} is exceeded at the boundary between cells n=k+1 and n=k+2, and if so, the avalanche continues. If the avalanche reaches the edge, then the sand which would have been moved to cell n=N+1 is instead lost from the system. If sand is lost from the system, we then sweep through the system again from cell n = 1, and repeat until sand ceases to be lost from the system, before adding further sand at the core. The total amount of sand lost is recorded and referred to as a mass loss event, or MLE. We also record the waiting times, δt_{n}, between successive MLEs, as well as changes in the potential energy, E_{p}, of the sandpile, given by the sum of squares of the values of each cell n. In Bowie et_al [13], a variant was introduced in which further sand was added after each sweep through the system (potentially, while an avalanche was continuing). This is referred to as the Running Model. Here, we employ only the Classic Model.
In this paper, we modify the Classic Model, so that L_{f} is varied in different ways, both in size and in location relative to the critical cell, n_{c}. However, N, dx, and Z_{c} are kept constant in all cases, for ease of comparison. Five different model variations are introduced in Table II, and illustrated schematically in Fig. 2. We introduce each model separately below, and comment on the outputs and interesting features of each model. The Linear Model (Sec. II), Forwards-and-Back Model (Sec. III), and Forwards Model (Sec. IV) are produced by changing the model such that L_{f} is calculated separately for each cell in the sandpile, with reference to its position in the sandpile. We have introduced these models to show that a pedestal can be produced by making only minimal modifications to the Classic Model. In the case of the Forwards-and-Back Model and the Forwards Model, the only modification required is to change the location in the sandpile at which fluidization occurs, relative to n_{c}. Of these models, the Linear Model and the Forwards Model produce sandpiles which resemble in appearance with the density profile of a H-mode fusion plasma, but retain the key features of the Classic Model, including discrete waiting times [13]. In the Feedback Model (Sec. V), by contrast, L_{f} is determined by reference to the actual gradient of the sandpile, so that an element of feedback is introduced, motivated by our consideration of feedback mechanisms in fusion plasmas discussed above. In the Feedback Model, a variable is introduced, whose value ultimately determines the average edge pedestal size. Finally, in the Fixed-Pedestal Model (Sec. VI), we explicitly define the edge pedestal size such that the edge pedestal is of equal value to the average edge pedestal size in the Feedback Model, but without feedback effects. The Fixed-Pedestal Model allows us to compare models with and without feedback, which otherwise share the same features.
The Fixed-Pedestal and Feedback Models will be used to look at the dynamics of ELMs and L-H transitions. While we recognise that both the Feedback Model and the Fixed-Pedestal Model move beyond the standard sandpile paradigm by this explicit introduction of a pedestal, we are motivated by the desire to consider the effects of feedback in the pedestal region, by comparing models with and without feedback, which otherwise share the same features. We also observe that while the EPED model [32–34] is capable of modelling the pedestal size directly using a fully detailed model, our purposes here include considering the dynamic behaviour of the pedestal region, including the impact of feedback effects, as well as considering whether particular aspects of pedestal behaviour can be captured without the need to consider the detailed physics. Simplified dynamical system models have been successfully employed previously in other areas of physics, and may show elements of dynamical behaviour common to multiple areas of physics [1,35,36]. In all of the models introduced here, discrete waiting times and period doubling are observed, and we have produced probability distribution functions and delay plots of waiting times (not shown here), which are consistent with the output of the Classic Model discussed in Bowie et_al [13] The fluidization length L_{f} is a linear, single-expression function at every cell, and so a change in behaviour of E_{p} with R_{L} is not possible. The addition of further complexity to the sandpile model would be required to demonstrate this facet of the EPED model.
II. LINEAR MODEL
We first discuss the Linear Model, in which no elements of feedback are introduced. In this model, L_{f} is set to be proportional to the distance from the edge of the sandpile, such that at the edge of the sandpile (n = N), L_{f} falls to a minimum of 1. For any given cell n
In Eq. (2), values below 1 are rounded to 1, and all other values rounded to the nearest integer, as positive integer values of L_{f} are necessary for operation of the algorithm. L_{fs} is an input scale, here, set equal to a constant of 50.
Figure 3 shows a time trace of E_{p}. In the quasi-steady state, E_{p} varies in the range from 2.0×10^{10} to 3.5×10^{10}. The resultant sandpile, shown in Fig. 4, has the appearance of a modified hyperbolic tan function, mtanh, which has been used to empirically fit pedestal density, temperature and pressure profiles [37], and hence bears some resemblance to the corresponding profiles of a H-mode plasma with an edge pedestal. We have also computed a pedestal fit y(x) to the data s(x) using mtanh of Groebner et_al [37], where
where x is the cell number normalised to the total number of cells, x_{s} is the centre of the pedestal cell, h is the half-width, the pedestal height is A + B and the offset is B − A. We have fitted to the parameters x_{s},h,A and α, with B=−Amtanh(α,(x_{s}−1)/h)) chosen to force the edge of the fit to zero. A Nelder-Mead simplex direct search method was used to find the optimal fit to the sandpile, so as to minimise |y−s|^{2}.
Reduction in the value of L_{f}, whether overall or within the edge pedestal, may be considered to be a proxy for increasing shear flow in a fusion plasma, within a corresponding region. The appearance of the pedestal in this sandpile model suggests that a shear flow which is inversely proportional to the distance from the edge is sufficient, of itself, to produce the pedestal and L-H transition. This may prove useful in development of more complex models, in which shear flow can be modelled as being inversely proportional to the distance from the edge, without the need to incorporate the underlying physics resulting in shear flow.
III. FORWARD-AND-BACK MODEL
In the Classic Model, L_{f} is set constant over the entire sandpile, and sand is fluidized behind the point at which Z_{c} is exceeded (n_{c}). We now consider a model in which, rather than fluidizing the sand behind n_{c}, fluidization occurs both behind and in front of n_{c}. The total size of the fluidized region remains the same, but is shifted, so that half the fluidization occurs in front of n_{c}. Although L_{f} is a constant over the sandpile, at cells near the edge, the available number of cells over which fluidization may occur in front of n_{c} decreases, causing an effective reduction in L_{f} close to the edge. This effect is also observed in the Classic Model near the core; however, its significance is lower as a pedestal at the core does not result in an increase in E_{p} over the remaining cells of the sandpile. We refer to this further model as the Forward-and-Back Model.
There may be an element of physical reality in a model in which fluidization occurs both forwards and backwards. Particles can interact only with other nearby particles. At the edge of the sandpile, nearby particles exist only in the direction of the core, and not in the direction of the edge, meaning that the range of potential interaction is similarly halved. Separately, the number of particles with which interaction may occur is also reduced (as density is lower at the edge), although we do not seek to model that.
We do not expect to see a significant increase in mean E_{p} (E¯{p}) as a result of employing this Forward-and-Back Model as, even at the edge, L_{f} will reduce only to approximately half its input scale value. E¯{p} in the quasi-steady state for the Forward-and-Back Model is 1.9×10^{8}, while σ_{Ep} is 4×10^{7}, meaning that variability (defined here as σ_{Ep}/E¯{p}) is 0.21. For comparison, E¯{p} in the Classic Model for L_{f} = 100 is 2.3×10^{8}, while σ_{Ep} is 1.1×10^{8}, giving a variability of 0.47. For the Linear Model with L_{f} = 100, the variability is σ_{Ep}/E¯{p}=0.098.
An example sandpile in the quasi-steady state is shown in Fig. 5(a). While the sandpile is formed of steps, the step at the edge is not obviously larger than the other steps, suggesting that no significant pedestal is formed in this model. This is consistent with the fact that L_{f} falls to only approximately half of its input scale value, rather than falling to 1. As noted above, steps have previously been observed in the Classic Model [6] for large L_{f}. The steps here are related to high L_{f}, as the function of L_{f} is to flatten the sandpile over its length. The higher the value of L_{f}, the larger the flat spot in the sandpile. These flat spots will move when the height of the step exceeds Z_{c}, triggering an internal (and potentially system wide) avalanche. For smaller values of L_{f}, the steps are less noticeable, as their horizontal extent cannot exceed L_{f}, meaning that at low values of L_{f}, the gradient of the sandpile is approximately constant. Ultimately, the differences between the Forward-and-Back Model and the Classic Model are not particularly pronounced.
IV. FORWARD MODEL
A further variation is to fluidize entirely in front of n_{c} (Forward Model). As with the Forward-and-Back Model, the effective L_{f} is reduced at the edge, while L_{f} is constant over the sandpile, at cells near the edge, the available number of cells over which fluidization may occur in front of n_{c} decreases, causing an effective reduction in L_{f} close to the edge. In the Forward Model, the fluidization occurs entirely forwards, so that the effective L_{f} reduces to 1 at the edge, rather than reducing to 0.5L_{f}+1 as occurs in the Forward-and-Back Model. This produces a steep gradient at the edge, approaching vertical within <1% of the edge.
Figure 5(b) shows a Forward Model sandpile in the quasi-steady state for the same parameters as the Forward-and-Back Model. For the Forward Model, E¯{p} in the quasi-steady state is 2.8×10^{8}, which is approximately 50% higher than that for the Forward-and-Back Model, and also slightly higher than for the Classic Model. The standard deviation is σ_{Ep}=1.6×10^{7}, meaning that variability is 0.06. An edge pedestal is clearly observed in the sandpile. It is notable that this pedestal arises simply by fluidizing in front of, rather than behind, n_{c}. Unlike the Fixed-Pedestal and Feedback Models discussed below, additional free parameters are not required to produce the pedestal. The Linear Model and the Forward Model demonstrate that a clear pedestal can be produced with minor modifications to the Classic Model, and that the essential features of the Classic Model, including clear discrete waiting times between MLEs, can be maintained while doing so.
V. FEEDBACK MODEL
The first step in modifying the Classic Model to produce the Feedback Model is to create a range within which L_{f} changes. As this range is treated as being proportional to ρ, the Larmor radius, we refer to it as R_{L}. Consistent with real plasmas, R_{L} is located at the edge of the sandpile, and, as will be observed, will be proportional to (but not necessarily identical to) the width of the edge pedestal observed in the final sandpile. We do not seek to incorporate ρ directly into our model—while we are creating a range within which shear flow occurs, it is not significant for the purposes of our model to identify ρ itself, only the size of the region in which changes in ρ have an effect.
Consistent with the objective of creating a positive feedback mechanism, R_{L} is itself proportional to the energy of the system at all times. We then employ different values for L_{f}. Within interval 1 (0<n<N−R_{L}), L_{f}=L_{fs}, and hence retains its input scale value. In interval 2 (N−R_{L}<n<N), L_{f}=L_{fR} is chosen to be inversely proportional to the edge gradient of the sandpile, computed at n=N−R_{L}. That is,
where s_{n=N−RL} denotes the sand in cell n=N−R_{L}. Equation (6) tells us that L_{fR} is inversely proportional to the local gradient of sand. Note that in implementing Eq. (6), L_{fR} is set to a minimum of 1 and that (N_{N−RL}/R_{L}) cannot exceed 1. Both assumptions are premised on the basis that ρ is not constant across the plasma, and that it is appropriate to set L_{f} proportional to the local ρ, which in turn depends upon the particle velocity (and accordingly the square root of the energy) in accordance with Eq. (1).
Two feedback loops operate concurrently, as both R_{L} and L_{fR} are varied. We allow R_{L} and L_{fR} to vary after fluidizing each cell, which may occur many times during a system-wide avalanche. If these ranges varied only between time steps, we would expect quite different results as the entire avalanche takes place during a single time step, and the value of R_{L} and L_{fR} would vary significantly before an avalanche started and after it was completed. As a consequence, a second avalanche might start in the following time step, which is inconsistent with the fundamental operating principle of the model, in which changes in the sandpile are considered to occur instantaneously. This approach of allowing both variables to change at each cell is rather more computationally expensive than an approach which requires the calculation to be performed only once for each time step. For example, if an avalanche takes place over 500 iterations in a 500-cell sandpile, then we need to calculate R_{L} and L_{f} 250 000 times for the single time step in which an avalanche occurs in the Classic Model, rather than once.
The variable R_{L} is set proportional to the gradient across the entire sandpile, in accordance with Eq. (7), excluding n = 1 to which sand has just been added. That is,
where s_{n=2} denotes the sand in cell n = 2 and R_{Ls} is an input scale. Calculation of the sandpile requires five inputs: dx, the extra sand added at each iteration; Z_{c}, the critical angle; N, the number of cells; R_{Ls}, the input scale for R_{L}; and L_{fs}, the input scale for L_{f}. The parameters dx, Z_{c}, and N are kept constant, and set to the values used in the other models considered here, and only R_{Ls} and L_{fs} are varied. This gives us one additional free parameter compared to the Classic Model (R_{Ls}), and substitutes L_{fs} for L_{f}.
Time traces for E_{p} and R_{L} for a feedback model with R_{Ls} = 400 are shown in Fig. 6. We observe that E_{p}, and R_{L}, evolve in unison, i.e., as the pedestal collapses, E_{p} decreases, which in turn contributes to the collapse of the pedestal. The traces include start-up, which is followed by progression to the quasi-steady state. The R_{L} trace is less smooth as R_{L} must always take on an integer value. Figure 7 shows this feedback sandpile in the quasi-steady state, where the average value of R_{L} has reduced to 35. L_{fR} is set inversely proportional to the system energy, so that it decreases as the system energy increases. Inside interval 1, L_{f} is equal to L_{fs}. The result is a sandpile whose profile bears a strong resemblance to the energy profile of a fusion plasma in H-mode, with a distinct pedestal.
Figure 8 shows Feedback Model characteristics for quasi-steady state sandpiles as a function of R_{Ls}. The mean energy, E¯{p}, increases exponentially with R_{Ls}, as shown in Fig. 8(a). This behaviour is quite similar for both L_{f} = 50 and L_{f} = 100 with increasing R_{Ls}. The increase in E¯{p} with R_{Ls} may be compared to an L-H transition: an increase in R_{L} results in an exponential increase in energy similar to the way in which a change in initial conditions in a fusion plasma leads to H-mode. Within each E_{p} trace, substantial changes in system size can be observed (see Fig. 6), of an order of magnitude similar to that of an L-H-L transition, in which total confinement varies by a factor of two. While not shown in Fig. 6, smaller MLEs are also observed, analogous to ELMs. This demonstrates that a feedback mechanism is enough to trigger L-H-L transitions in a single time trace, and no special additional mechanism need to be posited to produce both ELMs and the L-H-L transitions. For R_{Ls} = 100, the variability is σ_{E}/E¯{p}=0.35, which is much larger than the variability for the Linear, Forward and Forward-and-Back models.
Comparing Figs. 8(a) and 8(b), we see that log E¯{p} increases linearly with R_{Ls}, while the maximum MLE size increases linearly. Note that E_{p} equals the sum of the squares of all s_{n}, while the MLE size is simply the number of grains lost. We also see that E¯{p} is higher for a lower L_{fs}: reduced L_{fs} lowers L_{f} in both intervals 1 and 2. The relationship between waiting times and R_{Ls} is shown in Fig. 8(c). While maximum waiting times increase with increasing R_{Ls}, median or mean waiting times are independent of R_{Ls}.
VI. FIXED-PEDESTAL MODEL
In order to test whether the observed behaviour is dependent upon the feedback mechanism, we introduce a further model, the Fixed-Pedestal Model, in which we fix R_{L}. To obtain a comparison between the behaviours of the Feedback Model and the Fixed-Pedestal Model, we ran examples of the Feedback Model, and measured the resulting average R_{L}. We then used that average value as the fixed value of R_{L} in the Fixed-Pedestal Model, in order to compare the pedestal size, E_{p}, and the variability. The sizes of intervals 1 and 2 remain fixed in the Fixed-Pedestal Model, as R_{L} is fixed. The Fixed-Pedestal Model is therefore different from the Classic Model, in that two different fixed values of L_{f} are employed within intervals 1 and 2, although the feedback element of the Feedback Model is not present. L_{f} within intervals 1 and 2 is the same in both the Feedback and Fixed-Pedestal Models.
Figure 9 shows sandpiles in the quasi-steady state for the Feedback Model and the Fixed-Pedestal Model. The sandpiles are qualitatively similar. In (a), average R_{L} in the quasi-steady state is approximately 28, which corresponds to the width of the edge pedestal which appears at the edge. In (b), R_{L} is fixed at 28, L_{f} = 50 in interval 1, and L_{f} = 1 in interval 2. Both models include a pedestal, which is not observed in the Classic Model.
Figure 10 shows Feedback cf. Fixed-Pedestal quasi-steady state sandpile model characteristics with changing R_{Ls}. In Fig. 10(a), we see the growth in E¯{p} with increasing R_{L}, for a fixed L_{fs}, in both the Fixed-Pedestal Model and the Feedback Model. The R_{L} value chosen for the Fixed-Pedestal Model matches the average value of R_{L} in the Feedback Model. The range of E_{p} is noticeably larger for the Feedback Model compared to the Fixed-Pedestal Model, but E¯{p} is comparable. This suggests greater variability in the Feedback Model. For R_{Ls} = 100, the variability σ_{Ep}/E¯{p}=0.22 of the Fixed-Pedestal Model is much less than the variability σ_{Ep}/E¯{p}=0.22 of the Feedback Model.
In Fig. 10(b), we see that the maximum lost sand, Δs_{n}, increases substantially with R_{L} for the Feedback Model, while remaining approximately unchanged for the Fixed-Pedestal Model. The ELM size scales with the pedestal pressure [31,38], suggesting that the Feedback Model is the better model.
Figure 10(c) shows that the maximum waiting time between MLEs increases with pedestal size in the Feedback Model, but not in the Fixed-Pedestal Model. This is consistent with the behaviour of decreasing ELM frequency with increasing Larmor radius. While not shown here, there is, however, no pedestal size dependence of the median or mean waiting times in either model. Given that the maximum MLE size, and the corresponding maximum waiting times, are of most relevance to a fusion plasma (to the extent that they correspond with the largest ELMs), it is appropriate to focus on maximum, rather than mean or median, waiting times. The growth in maximum waiting times with pedestal size in the Feedback Model, but not in the Fixed-Pedestal Model, suggests that the Feedback Model is more consistent with the behaviour of a fusion plasma, in which ELM waiting times increase with pedestal size.
In summary, both the Feedback and Fixed-Pedestal Models produce a pedestal. Increasing R_{Ls} and decreasing L_{f} increases the total system energy. The Feedback Model produces greater variability, larger MLEs and longer maximum waiting times. For the Fixed-Pedestal Model, MLE size and waiting times are unaffected by R_{Ls}. Finally, we consider some potential analogies between the outcomes of the Feedback Model and a fusion plasma. In the model, increasing R_{Ls} triggers increases in E¯{p}, in the same way that an increase in the edge pedestal size triggers an increase in stored kinetic energy. In both cases, we expect that feedback will lead to greater variability, larger ELMs, and longer waiting times.
VII. DISCUSSION
We make the following observations in relation to each model introduced here. The results for the variability σ_{Ep}/E¯{p} are quoted for sandpiles with N=500,dx=1.2 and Z_{c} = 120.
A. Linear Model
A simple linear relationship can produce a sandpile which reasonably closely resembles a H-mode profile. This implies that a shear flow which increases towards the edge is sufficient to trigger H-mode. For the purposes of building fully featured models, a linear relationship, which is likely to be computationally simpler, may suffice to model differences in shear flow across the plasma profile. For L_{f} = 100, the variability is σ_{Ep}/E¯{p}=0.098.
B. Forward-and-back model
No substantial pedestal appears in this model, because R_{L} does not drop to unity at the edge. The Forward-and-Back Model produces outcomes which are quite similar to those of the Classic Model. As a result, it seems to be no better or worse than the Classic Model for the purpose of modelling a H-mode plasma. For L_{f} = 100, the variability is σ_{Ep}/E¯{p}=0.21.
C. Forward model
The Forward Model has the same number of input variables as the Classic Model. A significant pedestal is produced, which is not observed in the Classic Model. The pedestal results from a reduction in L_{f} approaching the edge, similar to the Linear Model. Otherwise, the Forward Model produces outcomes which are similar to those of the Classic Model. Overall, the Forward Model may be a better model for a H-mode plasma than the Classic Model. For L_{f} = 100, the variability is σ_{Ep}/E¯{p}=0.06.
D. Feedback model
A clear pedestal can be produced in the Feedback Model, with changes in E¯{p} of an equivalent size to that of a fusion plasma. Choosing the fluidization length scale to be inversely proportional to the local gradient of sand across R_{L} produces a pedestal of similar size to that of a fusion plasma. Similarly, the production of the pedestal is enough to trigger the observed change in potential energy. This suggests that shear flow alone can be sufficient to explain the transition from L-H mode. L-H-L transitions occur as the pedestal builds and collapses. Maximum MLE size, and maximum waiting time, both increase with pedestal size, as occurs in a fusion plasma. For L_{fs}=R_{Ls}=100, the variability is σ_{Ep}/E¯{p}=0.35. This model has the largest variability.
E. Fixed-pedestal model
A clear pedestal is also produced in this model. Unlike the Feedback Model, however, neither the maximum MLE size, nor the maximum waiting time, increases with pedestal size. As both of these increase with pedestal size in a fusion plasma, this suggests that the Fixed-Pedestal is not as good a model for a fusion plasma as the Feedback Model. For L_{fs} = 100 and an effective R_{Ls} = 100, the variability is σ_{Ep}/E¯{p}=0.22. The variability is lower than for the Feedback Model, which is to be expected, given there are fewer constraints in the Fixed-Pedestal Model.
VIII. CONCLUSION
Several models are shown which produce pedestals. Other than the Forwards-and-Back Model, each model produces a sandpile which resembles the density profile of a H-mode fusion plasma, including the pedestal. The mtanh fit, which we have used as a proxy for experimental profiles, shows that the best resemblance appears in the Linear Model and the Feedback Model. The Forwards Model does not require any additional parameters in order to produce a pedestal. If, as we conjecture, there is a relationship between L_{f} and shear flow, then the results of both the Forwards Model and the Linear Model would imply that shear flow which increases towards the edge is sufficient to produce a pedestal in a fusion plasma. If so, this may prove useful in construction of a more fully featured model which seeks to capture the key features of the H-mode.
The Feedback and Fixed-Pedestal Models produce pedestals as a result of choosing a regime within which L_{f} can vary. While this approach introduces additional parameters, the differences in outcomes between these two models show that feedback effects are necessary to result in MLE sizes and maximum waiting times which increase with pedestal size. The variability σ_{Ep}/E¯{p} for the Feedback Model is also the largest of the models explored.
In the absence of feedback, we do not observe an increase in MLE size or maximum waiting time with increasing pedestal size. ELM size and waiting time in a fusion plasma increase with pedestal size. MLE size and waiting time are captured by an MLE model with feedback. If, as we purport, the ELM process is captured by an MLE model with feedback, then a conclusion is that ELMs can be reduced if feedback effects are reduced. If very high spatial and temporal resolution density and temperature data are available pre- and post-ELM, it may be possible to experimentally validate the simulated variation of the pedestal width (which is synchronized with the ELM cycle), and hence the feedback property. One way in which ELM-synchronized feedback might be reduced is to introduce a time-modulated external radial electric field (through one or multiple electric probes), which reduces to nil as system energy increases, and increases after ELMing. This would introduce an element of negative feedback to counter the changes in the internally generated radial electric field. While probes are not a viable solution for a power-plant, they are appropriate for the investigation of physics phenomena. Present-day mitigation and suppression techniques such as resonant magnetic field perturbation or pacing by pellet injection are not synchronized with the ELM cycle, and so the sandpile feedback model offers no explanation for the efficacy of these techniques. Technology and control improvements may, however, ultimately enable real time control of RMP fields, pacing, or rotation control on an inter-ELM timescale, in which case they could be candidates for feedback control in a reactor environment.
Finally, a more extensive parameter scan over the full range of reasonable pedestal widths, and with a larger number of sandpile cells, are both suggestions for further computational work. Such studies would indeed more completely characterise the goodness of fit to experimental profiles, and improve on the mtanh fits used here. We also make some remarks on comparison of our feedback sandpile model to the fully featured popular EPED model. Both models predict a pedestal, in which the pedestal, potential energy and MLE (ELM) size increase with increasing pedestal size. In the sandpile model, the fluidization length L_{f} is a linear, single-expression function at every cell, and so a change in behaviour of E_{p} with R_{L} is not possible. In contrast, the EPED model includes both ideal MHD constraints of the peeling ballooning mode and resistive MHD and/or drift hydrodynamic constraints of the kinetic ballooning mode. The intersection of these constraints in the EPED model gives the pedestal size. Further modification of the feedback sandpile to make the fluidization length-scale a conditional expression beyond an R_{L} threshold might produce a characteristic pedestal size.
TABLE I. 
Behaviour of observables with increasing mass.
TABLE II. 
Comparison of sandpile models.
TABLE I. -body
Observable	Behaviour with increasing mass
Pedestal width	Increases [24–27]
ELM frequency	Decreases [24,25]
ELM size	Increases [25]
Edge pedestal pressure	Increases [24]
H-mode threshold	Decreases [29]
Critical edge pressure	Increases [25]
Electron temperature perturbation at occurrence of ELMs	Increases [25]
Core confinement	Decreases [28]
Edge confinement	Increases [28]
TABLE II. -body
Model	Primary characteristic	Purpose
Linear Model	L_{f} varies inversely with distance from edge	Produces pedestal with minimal change to Classic Model
Forwards-and-Back Model	Fluidization occurs both in front of and behind n_{c}	To see whether pedestal arises with change only to location of fluidization
Forwards Model	Fluidization occurs in front of n_{c}	Produces pedestal with change only to location of fluidization
Feedback Model	L_{f} varies with E_{p} within R_{L}, which also varies with E_{p}	Explores feedback effects to compare to feedback in fusion plasma
Fixed-Pedestal Model	L_{f} varies within R_{L}, which is fixed	Produces similar output to Feedback Model, without feedback, for comparison purposes
FIG. 1. 
Figure 1(c) of Ref [30] showing ELM energy losses normalized to the pedestal energy as a function of normalized ρ determined from profile changes (closed symbols) and equilibrium reconstruction (DIII-D) or diamagnetic loop measurement (JET) open symbols. Reproduced with permission from Beurskens et_al, Plasma Phys.: Controlled Fusion 51, 124051 (2009). Copyright 2009 IOP Publishing.
FIG. 2. 
Schematic models for a sandpile: Linear, Forward, Forward-and-Back, and Feedback and Fixed-Pedestal models.
FIG. 3. 
Linear Model - E_{p} trace for 5×10^{6} iterations. N = 500, L_{fs} = 50, dx = 1.2, and Z_{c} = 120.
FIG. 4. 
Linear Model - Sandpile. Here, N=500, L_{fs} = 50, dx = 1.2, and Z_{c} = 120. The mtanh fit to the Linear Model sandpile was |1−s/y|^{2}=2.3×10^{−4}.
FIG. 5. 
(a) Forward-and-Back Model and (b) Forward Model - sandpile in the quasi-steady state for L_{f} = 100. The mtanh fit to the Forward-and-Back Model sandpile was |1−s/y|^{2}=9.6×10^{−3}, while the mtanh fit to the Forward Model sandpile was |1−s/y|^{2}=8.1×10^{−3}.
FIG. 6. 
Feedback Model - E_{p} and R_{L} traces for R_{Ls} = 400 and L_{fs} = 100. Again, N = 500, dx = 1.2, and Z_{c} = 120.
FIG. 7. 
Feedback Model - sandpile in the quasi-steady state for R_{Ls} = 400, L_{f} = 100, N = 500, dx=1.2, and Z_{c} = 120.
FIG. 8. 
Feedback Model characteristics with R_{Ls} for N = 500, dx = 1.2, and Z_{c} = 120. Figure (a) shows changes in E¯{p} with increasing R_{Ls}, on a linear-log scale, for L_{f} = 50 and L_{f} = 100. Figure (b) shows the max. MLE size for L_{f} = 50, L_{f} = 100, and L_{f} = 150. Figure (c) shows waiting times.
FIG. 9. 
Sandpile in the quasi-steady state for the (a) Feedback Model and (b) Fixed-Pedestal Model, for R_{Ls} = 300, L_{fs}=50. In (a), the mtanh fit was |1−s/y|^{2}=3.4×10^{−4}; for (b), the mtanh fit was |1−s/y|^{2}=7.6×10^{−4}.
FIG. 10. 
Feedback cf. Fixed-Pedestal characteristics versus R_{Ls} for L_{f}=100,N=500,dx=1.2, and Z_{c} = 120. Figure (a) shows E¯{p}, as well as maximum and minimum envelopes. Figure (b) shows max. MLE size and Fig. (c) shows waiting times.

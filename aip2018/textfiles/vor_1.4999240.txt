Long term rolling prediction model for solar radiation combining empirical mode decomposition (EMD) and artificial neural network (ANN) techniques
Long-term prediction of solar radiation intensity plays an important role in the planning and design of photovoltaic power stations. Unlike previous research on solar radiation prediction requiring various meteorological and topographic data, this study proposed a rolling prediction model combining Empirical Mode Decomposition (EMD) and Artificial Neural Network (ANN) techniques with the need for historical solar radiation data only. To overcome the inconsistency problem of the number of intrinsic mode functions derived from the EMD, they are classified into high-frequency term, low-frequency term, and trend item, which are taken as the input parameters of the ANN model. With the historical data one-year after as the output parameter, the ANN model implies the complex, non-linear relationship between the adjacent periods, and it can be used to predict long-term solar radiation. The proposed methodology is applied to Gonghe county in the Qinghai province of China, where a large-scale photovoltaic power plant is under planning. The results indicate that the correlation coefficients between the daily and monthly predicted value and the historical data are 0.698 and 0.930, respectively, which are comparable to previous studies with a greater data requirement and a simpler model.
I. INTRODUCTION
With the increasing strain of conventional energy and the growing pressure from environmental conservation, exploring renewable resources has become a consensus all over the world. As one of the most promising renewable energy sources, solar energy utilization is constantly increasing. Optimal design of solar power systems, such as sizing projects related to solar collector and photovoltaic (PV) systems, requires the expected long-term solar radiation on the horizontal plane ( [Kaplanis et_al, 2016]). Besides, when solar energy is produced on a large-scale and is grid connected, it also needs long-term prediction of solar energy to balance the energy demand and supply ( [Qazi et_al, 2015]). However, it is hard to obtain a long-term daily prediction of the solar radiation with high accuracy due to its various complex and uncertain influence factors, such as sunshine duration, maximum ambient temperature, relative humidity, latitude, longitude, total cloud cover, and clearness index. The inaccuracy and lack of daily solar radiation data lead to high cost of a solar photovoltaic system ( [Yadav and Chandel, 2014]).
Various methods for solar radiation prediction have been proposed in the literature, which can be classified into two categories: physical models and statistical methods. The physical state and dynamic motions of the atmosphere are used in physical models, also known as numerical weather prediction (NWP) models.  [Remund et_al (2008)] compared several months of irradiance forecasts from three NWP sources: the National Digital Forecast Database (NDFD), the European Centre for Medium-range Weather Forecasts (ECMWF), and the Weather and Research Forecasting (WRF) model as initialized by the Global Forecasting System (GFS).  [Perez et_al (2013)] combined and discussed three independent validations of global horizontal irradiance (GHI) multi-day forecast models based on NWP, which were conducted in the US, Canada, and Europe. Although NWP is believed to be generally the most accurate tool for forecasting solar irradiation several hours in advance ( [Mathiesen and Kleissl, 2011]), such models depend greatly on the climate and dynamic motion of the atmosphere. Basically, they perform well in clear sky conditions, while the results get worse with the effect of clouds ( [Zamora et_al, 2005]). Together with computational complexity, the application of such physical models ( [Wang et_al, 2012]) on long-term daily solar radiation prediction is limited. The systematic variations of solar radiation make it possible to analyze and predict it by mathematical models ( [Safi et_al, 2002]). Statistical time series methods for solar radiation prediction are on the basis of measured irradiance data, mainly including regression analysis ( [Trapero et_al, 2015]), ARIMA (Autoregressive Moving Average) ( [Reikard, 2009]), ETS (exponential smoothing) ( [Yang et_al, 2015]), fuzzy theory ( [Chen et_al, 2013]), and wavelet analysis ( [Mellit et_al, 2006]). In fact, the accuracy of these statistical prediction methods is not as high as that of NWP since the parameters vary with time due to many factors ( [Cao and Cao, 2005]). In recent decades, with the development of data mining, artificial intelligence has been widely applied on the radiation prediction, such as Artificial Neural Network (ANN) ( [Amrouche and Le Pivert 2014]), Support Vector Machine (SVM), and heuristic algorithms.
However, when it comes to long-term solar radiation, a limited number of publications on prediction can be found. Most of the studies on long-term solar radiation focus on its characteristic analysis instead of prediction ( [Belov et_al 2006];  [Hu et_al, 2010]; and  [Aste et_al, 2016]); few studies on long-term prediction concern certain features of solar radiation with obvious regularity, such as disturbance storm time (DST), proton flux indexes ( [Mirmomeni et_al, 2006]), solar and geomagnetic activity indices ( [Mirmomeni et_al, 2010]), and sunspot number ( [Gholipour et_al, 2005]). The difficulty of long-term prediction of solar radiation mainly lies in its instability resulting from the complex relationship with unpredictable long-term weather, such as clouds, wind speed, and so on.  [Coelho and Boaventura-Cunha (2014)] tested linear autoregressive, nonlinear autoregressive, and support vector models on long-term solar prediction; even their proposed method combining support vector regression and Markov chains performs poorly when the prediction is sixty-step ahead.
Among various attempts on solar radiation prediction, ANN is one of the most common methods and has successfully been employed for the solar radiation prediction and solar system design ( [Qazi et_al, 2015]) as it is competent to solve non-linear function estimation, data sorting, and pattern detection.  [Yadav and Chandel (2014)] reviewed solar radiation prediction using ANN techniques and presented the relevant input parameters for the ANN models for global, daily, and short term solar prediction. In the systematic literature review by  [Qazi et_al (2015)], the input combinations for hourly and monthly solar radiation prediction were compared. Basically, the input parameters are a combination of the meteorological and topographic data, mainly including the latitude, longitude, altitude, air temperature, relative humidity, rainfall, wind speed, day of the year, etc. ( [Celik et_al, 2016];  [Chiteka and Enweremadu 2016];  [Renno et_al, 2016]; and  [Vakili et_al, 2017]).
The availability of various data in need becomes a huge limiting factor for the application of the ANN method on solar radiation prediction, especially for those large-scale solar energy bases planned in the deserted area.
In this study, a new rolling prediction method combining Empirical Mode Decomposition (EMD) and Artificial Neural Network (ANN) models is proposed, which is based only on the long daily sequence of solar radiation data. The daily data are first decomposed by EMD into several Intrinsic Mode Functions (IMFs), which are then classified into low-frequency item, high-frequency item, and residual term to overcome the number inconsistency problem for the ANN model. The actual data rolling one year forward is taken as the output to train the ANN model. The complex non-linear relationship between the historical data and the data one year ahead is implicit in such a rolling ANN model. The method is applied on a deserted area in the Qinghai province of China, where a large-scale photovoltaic (PV) project is planned. The results show that the proposed methodology can be used to capture the main characteristic of the daily solar radiation in the following year. When taking the monthly average, the prediction accuracy is almost as high as the published report using various meteorological and topographic data. The proposed method can be applied to the design and plan of the solar energy projects, especially in those backward regions where other data are hard to obtain.
II. METHODOLOGY
A. Empirical mode decomposition (EMD)
Empirical Mode Decomposition (EMD) is a signal decomposition algorithm proposed by  [Huang (1998)]. As a method of dealing with nonlinear and non-stationary data, it has been widely applied. The basic idea of EMD is to determine the intrinsic oscillatory modes and decompose the original time series into a finite number of oscillatory modes based on local characteristic timescales with the following assumptions: (1) the first signal has at least two extremes: a maximum and a minimum; (2) the characteristic timescale is determined by the time length between the extremes; (3) if there are only bending points but no extremes, then make difference to get the extremes. The final result can be obtained by interpolation algorithm. The Intrinsic Mode Function (IMF) is a key conception in the EMD algorithm, which has the following two properties: (1) the number of extremes and the number of zeros that pass through the entire sample dataset must be equal or differ by one in the entire data sequence; (2) the mean of envelope formed by the local maximum and the local minimum is zero at any point of the sequence. The process of EMD is illustrated below in detail.
If the difference between the number of extremes and the number of zero-crossing is larger than two, the sequence needs to be stabilized. First, the local maximum and local minimum points of the sequence x(t) are fitted into the upper and lower envelopes of x(t), respectively, and then, the mean of the two envelopes m_{1} is calculated. A new sequence h_{1} is obtained by subtracting m_{1} from the original sequence x(t), as shown in the following equation:
The above screening process is repeated until the mean envelope tends to zero, when the sequence obtained is shown in the following equation:
where h_{l}_{k} is the sequence obtained from the k-th screening; m_{1}_{k} is the mean of the envelope from the k-th screening.
Standard deviation SD is used to estimate whether the screening result can be regarded as an IMF component, as defined in the following equation:
where T is the length of the sequence.
The SD value of EMD is generally set between 0.02 and 0.3, i.e., the decomposition process stops when
Thus, h_{k} (t) is close enough to IMF; meanwhile, the number of decomposition is limited. The resulting IMF components retain amplitude modulation information of the original sequence.
When the criterion shown in Eq. (4) is satisfied, the first IMF component c_{1} = h_{1}_{k} of original sequence x(t) can be obtained, which represents the highest frequency component of x(t). Subtract c_{1} from the original data sequence x(t) to get difference data r_{1} = x(t) − c_{1} without the high frequency component. Take r_{1} as the original sequence that needs to be decomposed, and the screening shown from Eqs. (1) to (3) is repeated until the remaining signal r_{n} becomes a monotonic function. r_{n} represents the trend or mean of the original data sequence. A series of IMF components c_{i} are obtained, which can represent the original sequence with a mean or trend term, as shown in the following equation:
Since each IMF component represents a set of data with a specific characteristic scale, the EMD decomposition actually decomposes the original data sequence into a series of fluctuations with different characteristic scales. Each IMF can be either linear or non-linear with the corresponding physical background.
B. Back propagation-artificial neural network (BP-ANN)
Artificial neural network (ANN) is a mathematical model simulating the biological nervous system, with the function of information processing similar to biological nervous systems. Taking X as the input and y as the output, the mapping relationship y = W(X) between X and y is often complex. Existing data are used to train the ANN and adjust the network structure to estimate the mapping relationship through the continuous learning process. Such a fitting process is adaptive, i.e., the process is realized according to the statistical estimation of the observed data instead of assumptions about the mapping relationship in advance.
Back Propagation (BP) ANN is widely used due to its strong ability of fitting the complex non-linear mapping relationship, which is composed of forward transmission of information and back propagation of the error. In the forward transmission process, the input information is transmitted from the input layer to the output layer through the hidden layer. The state of neurons in each layer only affects the state of the neurons in the next layer. If no desired output is obtained in the output layer, the error value of the output layer is calculated and then propagated backwards through the original path to modify the weights of the neurons in each layer until the output is satisfying.
Taking r-dimensional vector P = [p_{1}, p_{2},…, p_{r}] as the input of the BP-ANN,Fig. 1 shows the i-th neuron structure. Each input element has a certain weight w, and the offset value of this neuron is b_{i}. With an activation function f, the output of this neuron a_{i} is calculated by
The module with the grey background in Fig. 2 shows a BP-ANN structure with two hidden layers. The output of each neuron is determined using Eq. (6), and the error is defined as in the following equation:
where W = (w_{j,i}) and B = {bi→} are the weight and offset matrix of the neurons in the network; S_{2} is the number of neurons in the output layer; t is the element in the target vector; and o is the element in the output vector from the output layer.
If the error between the ANN output and the target is unacceptable, the error is used to adjust the weight and offset by gradient descent algorithm, as shown in the following equations, respectively:
where ΔWij(n+1) is the variation of the weight of the connection between neurons i and j in the (n +1)-th iteration;Δbj(n+1) is the variation of the offset of the j-th neuron in the (n +1)-th iteration; η is the learning rate 0 < η< 1; α is the momentum factor; the activation functions in BP-ANN are Sigmoid functions, and thus, when j is the neuron in the hidden layer, δ_{j}=y_{j}+1−y_{j}t_{j}−y_{j}.
The iteration consisting of forward activation propagation and backward error propagation continues until the output of the BP-ANN approaches close enough to the target, when the BP-ANN model finishes its training and its structure is settled. The model reflects the complex non-linear relationship between the input and output variables.
C. Rolling prediction model for long-term solar radiation
The basic idea of the proposed rolling prediction EMD-ANN method in this study follows the “decomposition-integration” learning paradigm. The main purpose of the decomposition is to simplify the original target, which is classified into predictable sub-targets with more regularity. Those predicted sub-targets are then integrated to obtain the prediction of the original sequence. EMD is first adopted to decompose the long ruleless sequence into several intrinsic mode functions (IMFs). Theoretically, EMD can be used for any time series without the requirement of stationarity. Besides, no pre-set basis function is in need either. Such a property of EMD expands and simplifies its applications. However, since the EMD is a self-adaptive algorithm, the number of IMFs decomposed from different time series is not determinate, even if the length of the series is the same. To keep the number of input parameters of the ANN model consistent in training and testing stages, the IMFs are classified into low-frequency item, high-frequency item, and residual term by the T-test of the distance between the superposition sequence and the origin, and the detailed classification procedure is illustrated below.
The long-term sequence of daily solar radiation from the 1st year to the T-th year X_{1∼T} is decomposed by EMD into n IMFs, which is represented by c_{1},c_{2},…,c_{n}. The cumulative sum s_{i} from c_{1} to c_{i} is calculated, as in Eq. (10), the average distance between which to the origin is also figured out, as in Eq. (11).
If j = k, d_{k} is the maximum of all d_{j}, and k is identified as the break point of the sequences of c_{i}. The sum of the sequences from c_{1} to c_{k} is taken as the high-frequency item of the original solar radiation sequence H, while the sum from c_{k+}_{1} to c_{n-}_{1} is regarded as the high-frequency item L. Since all the IMFs from c_{1} to c_{n}_{–1} fluctuate around 0 except c_{n}, the residual c_{n} is taken as the trend item R. The mathematical expressions of the high-frequency item, low-frequency item, and trend item are shown from Eqs. (12)–(14), respectively, which are taken as the input parameters for the ANN model
The daily solar radiation sequence one year ahead, i.e., from the 2nd year to the (T +1)-th year, is taken as the output parameter. Hence, the complex, non-linear relationship of the solar radiation between before and after is concealed in the ANN model, and the model can be used for rolling prediction for the future.
The detailed process is illustrated in Fig. 2.
III. CASE STUDY
A. Study area
According to the prediction of Chinese Academy of Sciences, the annual energy consumption in China will grow to 7.0 tce (tons of standard coal equivalent) in 2050 ( [Yan, 2011]) from 4.3 tce in 2015, in which the proportion of fossil energy needs to be reduced.
Qinghai Province has abundant solar energy resources with the total annual radiation up to 5800–7400 MJ/m^{2}, ranking second in China, as shown in Fig. 3(a) ( [Li and Zhu, 2011]). In addition, Qinghai Province is located in the northeastern of the Qinghai-Tibet Plateau, and most of the region is sparsely populated. There is about 200 000 km^{2} unused desert, which is preferable for the large-scale solar energy exploration ( [Yan et_al, 2011]).
In recent years, solar power industry has been booming in Qinghai province with the developing speed of “1 GW/year.” Up to the end of 2015, the installation capacity of the photovoltaic (PV) power in Qinghai province reached 6070 MW ( [West Sea Metropolis Daily, 2016]), and more projects are under planning and construction.
Accurate long-term radiation prediction is of great importance for the design of a PV power station. This study takes Gonghe county in Qinghai province as the study area, where a large-scale PV power station is considered. The solar radiation data come from National Aeronautics and Space Administration (NASA), lasting from January 1st of 1984 to December 31st of 1995, as shown in Fig. 3(b). Since the sunspot cycle is about 11 years, the data of first 11 years are used to train the BP-ANN. The radiation intensity sequence of each year is decomposed by EMD into several IMFs first. Then, those IMFs with the similar frequency are integrated as an element of the input vector for the BP-ANN. The elements with different frequencies compose the input vector, and the output vector is the historical data of the 2nd–11th year. Once the BP-ANN model is trained and determined, it can be used to predict the daily radiation sequence of the 13th year with the data of the 2nd–11th year as the input. Such rolling learning-prediction is proved to be effective for long-term prediction of the solar radiation intensity.
B. Results
Taking the L, H, and R components derived from the daily data from the year 1984 to 1993 as the input parameter and the daily data of the year 1985–1994 as the output, the structure of the ANN model 3-20-1 was determined, which is then used to predict the solar radiation of the year 1995 with the data from 1985 to 1994 as the input. Figures 4(a) and 4(b) show the decomposed results by EMD using the daily data from the year 1985 to 1994 and their classification results, respectively (Table I).
To investigate whether the ANN model is superior to other traditional methods in revealing the complex and non-linear relationship between the solar radiation before and after, a regression equation is also conducted using the same input parameters and output parameters. Figure 5(a) shows the daily prediction results. Since the ten-day and monthly solar radiation are often used in the power output plan, the corresponding statistical results with daily data are presented in Figs. 5(b) and 5(c), respectively.
The root mean square error (RMSE), mean absolute percentage error (MAPE), and correlation coefficient (R) are used as metrics to assess the predictive performance of the proposed methods, as defined from Eqs. (15) to (17), respectively
where the subscript hist stands for historical data and the subscript pred represents the predictive results.
The predictive accuracy is shown in Table II.
On the other hand, to investigate the importance of the information excavated from the long-term daily data by EMD, the monthly solar radiation sequence is taken as the input of the ANN for comparison. The processing procedure is similar to that of the daily data: the monthly data of the year 1984–1993 and the year 1985–1994 are decomposed by EMD; the resultant IMFs are classified into three categories by the frequency and taken as the input of the ANN model for training and prediction. The decomposed and classified results with monthly data are shown in Figs. 6 and 7. Figure 8 shows the predictive monthly mean daily solar radiation results using the proposed EMD-ANN rolling method with daily and monthly data, respectively, and the predictive accuracy is compared in Table III.
C. Discussion
Reliable knowledge of solar radiation is a requirement for informed design and deployment planning of solar energy delivery systems. Unlike most of the solar prediction studies using ANN, the proposed method in this study does not need various meteorological and topographic data, such as latitude, longitude, altitude, time, months of the year, air temperature, relative humidity, rainfall, and wind speed, to conduct the prediction. Instead, the information contained in the original solar radiation time sequence with a small time interval is fully exploited by EMD.
The historical daily solar radiation presents violent fluctuations due to the uncertain weather conditions, as shown in Fig. 5(a). Although the proposed rolling EMD-ANN method seems to be unable to predict such an uncertainty, it performs well in the large time interval, such as ten-day and one-month, as shown in Figs. 5(b) and 5(c). Without any other kinds of data, the statistical results with a large time interval show a comparable accuracy to other studies with multiple data sources, as shown in Table II. Instead of focusing on the detailed deviation, which is important for short-term operation plans, such understanding and prediction of the overall variation of the solar radiation such as trends and patterns play a more crucial role in long-term prediction and helps to make power generation plans.
The strong ability of ANN in revealing the complex and non-linear relationship has been substantiated by comparison with the traditional regression equation. The primary obstacle preventing the use of these IMFs for prediction by the ANN model is that the number of IMFs is not fixed for different time series even though the length of the sequence is the same. In our case, 11 IMFs were obtained by EMD using the daily data from the year 1984 to 1993, while 10 IMFs were generated using the daily data from the year 1985–1994, as shown in Figs. 9 and 4(a), respectively. Such a self-adaptive feature makes classification of the IMFs necessary. A significant distinction of different IMFs is their frequency. The IMFs are thus classified into high-frequency term, low-frequency term, and trend item (Fig. 10). The effectiveness of such a classification was verified by the predictive results.
Another comparison of applying the proposed EMD-ANN rolling predictive method on monthly prediction with daily and monthly data demonstrates that there is a large amount of data information existing in the daily time sequence, which is conducive to the monthly prediction and can be mined by EMD.
The prominent advantage of the proposed rolling prediction method combining EMD and ANN is that unlike other prediction models using the ANN model, only the daily solar radiation records are in need. Both the statistical RMSE and MAPE are comparable to other published research of monthly prediction with various types of input parameters as reviewed by  [Qazi et_al (2015)]. It has been demonstrated that if MAPE is between 20% and 10%, a good prediction has been achieved ( [Khoshnevisan et_al, 2013]). The MAPE of the prediction results using daily data is only 10.88%. Hence, the proposed solar radiation rolling model is effective for long-term prediction.
IV. CONCLUSIONS
Long-term solar radiation prediction is important for planning and design of photovoltaic power stations, which usually requires various meteorological and topographic data. In this study, a rolling prediction model is proposed only using the daily historical records of solar radiation. The time sequence of the period X_{1∼T} is first decomposed by EMD techniques, and the derived IMFs are classified into three categories: high-frequency term, low-frequency term, and trend item, which are taken as the input parameters of an ANN model. The historical data of the next period X_{(}_{T}_{+1)} are taken as the output parameters to train the ANN model. After the ANN model is established, it is used to predict the solar radiation of the time period (T +2) with X_{2∼(}_{T}_{+1)} as the input parameters. The proposed rolling prediction model conceals the complex, non-linear relationship between the solar radiation before and after in the ANN model and is applied to the Gonghe county in the Qinghai province of China, where a large-scale photovoltaic power station is under planning. The statistical results of the prediction indicate that the accuracy of the proposed prediction method is comparable to previous research, while both the required data and the computational process are greatly simplified.
TABLE I. 
T-test result of s_{j} derived from the daily solar radiation data from the year of 1984 to 1993 calculated using Eq. (10).
TABLE II. 
Predictive accuracy by different methods for different time intervals with daily data.
TABLE III. 
Predictive accuracy by the EMD-ANN model with daily and monthly data.
TABLE I. -body
s	s_{1}	s_{2}	s_{3}	s_{4}	s_{5}	s_{6}	s_{7}	s_{8}	s_{9}	s_{10}
sig.	0.000	0.000	0.000	0.001	0.039	0.273	0.000.	0.000	0.006	0.000
TABLE II. -body
Time interval	Methods	RMSE (kWh/m^{2}/day)	MAPE (%)	R
Daily mean value	EMD-ANN model	1.2445	25.35	0.698
Regression equation	1.2517	26.23	0.680
Ten-day average daily value	EMD-ANN model	0.7447	14.04	0.867
Regression equation	0.7435	14.08	0.862
Monthly mean daily value	EMD-ANN model	0.5849	10.88	0.930
Regression equation	0.5490	9.854	0.931
TABLE III. -body
	RMSE (kWh/m^{2}/day)	MAPE (%)	R
Prediction with daily data	0.5849	10.88	0.930
Prediction with monthly data	0.9843	18.84	0.737
Note: boldface denotes the results with the highest predictive accuracy.
FIG. 1. 
A neuron structure in ANN.
FIG. 2. 
Rolling prediction model for long-term solar radiation combining EMD and ANN.
FIG. 3. 
(a) Annual solar radiation distribution in China, as well as the location of the study area; (b) daily solar radiation sequence from the January 1st of the year 1984 to the December 31st of the year 1995 at Gonghe County.
FIG. 4. 
(a) IMFs derived from long-term daily solar radiation data of the year 1985–1994 and (b) high-frequency (H), low-frequency (L), and trend item (R) of the monthly solar radiation of the year 1985–1994.
FIG. 5. 
Predictive results with the daily data: (a) daily mean solar radiation prediction; (b) ten-day average daily solar radiation prediction; and (c) monthly mean daily solar radiation prediction.
FIG. 6. 
(a) IMFs derived from monthly solar radiation data from the year 1984 to 1993 and (b) high-frequency (H), low-frequency (L), and trend item (R) of the monthly solar radiation of the year 1984–1993.
FIG. 7. 
(a) IMFs derived from monthly solar radiation of the year 1985–1994 and (b) high-frequency (H), low-frequency (L), and trend item (R) of the monthly solar radiation of the year 1985–1994.
FIG. 8. 
Predictive monthly mean daily solar radiation results of the year 1995 using the proposed EMD-ANN rolling method with daily and monthly data.
FIG. 9. 
IMFs derived from long-term daily solar radiation data from the year of 1984 to 1993.
FIG. 10. 
High-frequency (H), low-frequency (L), and trend item (R) of the daily solar radiation from the year of 1984 to 1993.

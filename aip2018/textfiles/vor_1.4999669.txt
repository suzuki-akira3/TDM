A Hamilton–Jacobi theory for implicit differential systems
In this paper, we propose a geometric Hamilton-Jacobi theory for systems of implicit differential equations. In particular, we are interested in implicit Hamiltonian systems, described in terms of Lagrangian submanifolds of TT*Q generated by Morse families. The implicit character implies the nonexistence of a Hamiltonian function describing the dynamics. This fact is here amended by a generating family of Morse functions which plays the role of a Hamiltonian. A Hamilton–Jacobi equation is obtained with the aid of this generating family of functions. To conclude, we apply our results to singular Lagrangians by employing the construction of special symplectic structures.
I. INTRODUCTION
Implicit differential equations (IDEs) do not only arise in purely mathematical frameworks, as in relation with minimizers of integrals in the calculus of variations or as intermediate steps for the integration of differential algebraic equations [28], they do appear in various areas in science as well. Their applications are important in relativity, control theory, chemistry, etc. For example, they describe exchanges of matter, energy, or information that vary in space and time.
Unfortunately, differential equations and, particularly, IDEs cannot always be solved analytically. For this matter, different mathematical methods have been precisely designed. It is desirable that these differential equations are reducible to quadratures, and many attempts have been tried through Fuchsian, Lie’s theory, etc. Nowadays, the methods of numerically integration have been increasingly developed.
The Hamilton–Jacobi theory (HJ theory) has been long known as a powerful problem solving tool [1,3,21,31]. It is particularly useful for identifying conserved quantities for a mechanical system, which may be possible even when the mechanical problem itself cannot be solved completely. Therefore, it constitutes an alternative way of finding solutions of Hamilton’s equations. It is equivalent to other classical formulations of mechanics and it roots in variational calculus. The action functions are solutions of the Hamilton–Jacobi equation (HJE). It is important to remark that the classical HJ theory only deals with explicit Hamiltonian systems, but in the literature there exist tons of physical models governed by IDEs, hence the necessity of constructing a Hamilton–Jacobi theory for implicit systems.
For example, recall the number of theories described by singular Lagrangians in the sense of Dirac-Bergmann [2,8,18], including systems appearing in gauge theories [33]. The Euler–Lagrange (EL) equations give rise to differential equations that are implicit, and because of the degeneracy of the Lagrangian, they cannot be put in a normal form. Some authors have introduced a geometric formalism for dealing with dynamical systems in their implicit form Refs [45] and  [49] and a unified approach for the Lagrangian description of (time-independent) constrained mechanical systems is provided through a technique that generates IDEs on T*Q from one-forms defined on the total space of any fiber bundle over TQ [5]. Other authors have designed algorithms following the Dirac-Bergmann prescription, to be able to deal with singular Hamiltonian and Lagrangian theories; see, for example, the geometric Gotay–Nester–Hinds algorithm [22–26] (see brief description in the Appendix). In the local coordinate formalism, the classical EL displaying conservative or nonconservative force fields or subject to linear or nonlinear nonholonomic constraints, also arise in implicit form from d’Alembert’s principle of virtual work. In the geometric formalism, the corresponding equations should then be expected to arise in implicit form equivalently from a suitable expression of the above principle.
Our main aim is to generalize the geometric Hamilton-Jacobi explained for explicit systems to the realm of implicit systems on T*Q. We interpret IDEs in terms of arbitrary submanifolds of a higher-order tangent bundle, particularly Lagrangian submanifolds of TT*Q in the case of implicit Hamiltonian systems (IHSs), not necessarily in the horizontal form. As an application, we shall concentrate the problem of Hamilton–Jacobi theory for singular Lagrangian theories.
Let us summarize the problem in more technical terms. We consider a first-order IDE as a submanifold E of TT*Q. We project E to TQ by the tangent mapping Tπ_{Q} to a submanifold Tπ_{Q}(E) of TQ, which is another IDE on Q. The philosophy of the geometric Hamilton–Jacobi theory is to retrieve solutions of E, provided the solutions of Tπ_{Q}(E). In similar fashion as the classical Hamilton-Jacobi theorem, in order to lift the solutions in Q to T*Q, we are still in need of a closed one-form γ on Q, but two ingredients of the theory are missing. One is that the base manifold C=τ_{T^{*}Q}(E) is not necessarily the whole T*Q, but possibly a proper submanifold of it. The second is the nonexistence of a Hamiltonian vector field due to the implicit character of the equations. In the classical theory, the major role of the Hamiltonian vector field is to connect the image space of γ and the submanifold E. To overcome these two difficulties, we need to introduce an auxiliary section σ of the fibration τ_{T^{*}Q} defined on C ∩ Imγ and taking values in E. If, particularly, the dynamics E is a Lagrangian submanifold, then, according to the generalized Poincaré theorem [6,29,40,54,57], there exists a Morse family (a family of generating functions) defined on the total space of a smooth bundle linked to TT*Q by means of a special symplectic structure. A Morse family also establishes a link from the base space T*Q to E so that for this particular case, there is no need for an auxiliary section.
The plan of the manuscript is the following: in Sec. II, we review the fundamentals of Hamiltonian mechanics, and Sec. III develops a geometric interpretation of dynamics as Lagrangian submanifolds and their generating with the aid of Morse families of functions. Section IV illustrates the geometric HJ theory both for IDE and IHS. In Sec. V, we contemplate the construction of complete solutions. Section VI concerns applications of our constructed theory to the case of degenerate Lagrangians.
We assume that functional analytic issues related with the present discussion are satisfied in order to highlight the main aspects of our theory. Accordingly, we assume that all manifolds are connected, and all mathematical objects are real, smooth, and globally defined.
A. Notation chart
Let Q be the configuration space, TQ is the tangent bundle, and T*Q is the cotangent bundle. Considering the tangent and cotangent bundles of TQ and T*Q, these are the possibilities TTQ, T*TQ, TT*Q, and T*T*Q. We refer Table I for the local coordinates. Here we can establish the canonical projections for the first order tangent and cotangent bundles denoted as π_{Q}: T*Q → Q and τ_{Q}: TQ → Q. Furthermore, consider the projections π_{T^{*}Q}:T^{*}T^{*}Q→T^{*}Q, τ_{T^{*}Q}:TT^{*}Q→T^{*}Q, Tπ_{Q}: TT*Q → TQ and the two last projections π_{TQ}: T*TQ → TQ and τ_{TQ}: TTQ → TQ. For the last case there is another possibility Tτ_{Q}: TTQ → TQ, and both possibilities are related through a diffeomorphism we shall devise in the following lines.
Let us recall the definition of the pullback bundle, as we refer to it in Secs. IV and V. Let (P, π, M) be a fiber bundle and assume the existence of a differential mapping φ from a manifold P to the base manifold M. Define the following product manifold
and the surjective submersion φ*π which simply projects an element in φ*P to its first factor in N. The triple (φ*P, φ*π, N) is called the pullback bundle of (P, π, M) via the mapping φ. This definition can be summarized within the following commutative diagram:
Here, ε is the projection which maps an element in φ*P to its second factor P. Let us point out two particular cases which are important for the present work. If φ is a diffeomorphism, φ*P and P become diffeomorphic. If M is an embedded submanifold of P, and N is an embedded submanifold of M in (1), then it is evident that φ*P is an embedded submanifold of P. In this case, the map ε plays the role of an embedding.
Henceforth, we refer to general, arbitrary manifolds by M or N, we will denote fiber bundles by π: P → N, where P is the complete space and N is its projection by π (also M instead of N indistinctly). IDE will be denoted by E generally, and any general Lagrangian submanifold is denoted by S. We will also refer by E to IHSs that are Lagrangian submanifolds generated by a Morse families. By F we denote Morse families. In general, P is the total space of a fiber bundle related with a Morse family F and R is the total space of a special symplectic structure.
II. FUNDAMENTALS
This section is dedicated for reviewing fundamentals of Hamiltonian mechanics from a geometric viewpoint and basics of Tulczyjew’s triple. Here, we are setting the notation we shall be using along the paper.
A. Geometry of the cotangent bundle
Consider a manifold Q and a cotangent bundle T*Q with canonical projection π_{Q}: T*Q → Q. We denote by (q^{i}, p_{i}) the fibered coordinates in T*Q such that π_{Q}(q^{i}, p_{i}) = (q^{i}). A cotangent bundle is equipped with a canonical one-form θ_{Q} defined as follows:
where X_{αq}∈T_{αq}(T^{*}Q) and α_{q}∈Tq*Q. In fibered coordinates, the canonical one-form reads θ_{Q} = p_{i}dq^{i}, which is known as the Liouville one-form on T*Q. Consider now the two-form ω_{Q} = −dθ_{Q}, namely, ω_{Q} = dq^{i} ∧ dp_{i}. This two-form has the following two properties:
1. It has maximal rank 2n, where n is the dimension of Q.
2. dω_{Q} = 0.This two-form is called a symplectic two-form. More generally, a symplectic manifold is a pair (M, ω) such that ω has maximal rank and dω = 0. Therefore, (T*Q, ω_{Q}) is a symplectic manifold and ω_{Q} is the canonical symplectic form on T*Q.
Let (M_{1}, ω_{1}) and (M_{2}, ω_{2}) be two symplectic manifolds and assume that F: M_{1} → M_{2} be a diffeomorphism. F is called a symplectomorphism if F*ω_{2} = ω_{1}.
B. Hamiltonian dynamics on the cotangent bundle
A Hamiltonian system on T*Q is determined by the triple T^{*}Q,ω_{Q},H, where H is the Hamiltonian function. Geometrically, Hamilton’s equations are defined by
where X_{H} is the Hamiltonian vector field associated with the Hamiltonian function H and ι_{XH} is the inner contraction operator.
In Darboux’s coordinates (q^{i}, p_{i}) on T*Q, with i = 1, …, n for an n-dimensional configuration manifold Q. The canonical one-form reads θ_{Q} = p_{i}dq^{i} and the symplectic two-form turns out to be ω_{Q} = dq^{i} ∧ dp_{i}. In this local picture, the Hamiltonian vector field X_{H} is written as
whereas Hamilton’s equation (3) turn out to be
Note that Hamilton’s equations are explicit by definition. Hence, an IDE cannot be recast in the classical Hamiltonian formalism presented in (5). To deal with IHSs, we shall redefine Hamiltonian systems in a more abstract framework, as we shall present in Sec. III D.
C. Geometry of the tangent bundle
Consider the manifold Q and its tangent bundle TQ together with its tangent bundle canonical projection τ_{Q}: TQ → Q. We consider fibered coordinates (q^{i},q̇{i}) such that τ_{Q}(q^{i},q̇{i})=(q^{i}). Given a function f:Q→R, we define its complete lift f^{T} to TQ as the function
In local fibered coordinates,
Given a tangent vector v_{q} ∈ T_{q}Q with components (q^{i}, v^{i}), we define its vertical lift vqV for a point w_{q} ∈ T_{q}Q by
If X is a vector field on Q, then its vertical lift to TQ is the vector field
for all w_{q} in TQ. Now, consider the flow ϕ_{t}: Q → Q of a vector field X. We define the complete lift X^{T} of X to TQ as the generator of the tangent flow Tϕ_{t}: TQ → TQ. We are assuming, for simplicity, that the flow generated by X is complete, but the construction is still valid in general. If X=X^{i}∂∂q^{i}, a direct computation shows that
Consider now a k-form ω on Q. We define its complete lift ω^{T} to TQ a k-form characterized by
The following identity follows from a direct computation d(ω^{T}) = (dω)^{T}. We are particularly interested in the case of lifts of symplectic forms on Q. Therefore, if ω_{Q} is symplectic on Q, then ωQT is a symplectic form on TQ. Indeed,
and d(ω^{T}) = (dω)^{T} = 0.
D. Submanifolds of symplectic manifolds
Let (M, ω) be a symplectic manifold and N be a submanifold of M. We define the symplectic orthogonal complement of TN as the set of tangent vectors
Note that the dimension of the tangent bundle TM is the sum of the dimensions of the tangent bundle TN and its symplectic orthogonal complement TN^{⊥}. We list some of the important cases.
• N is called an isotropic submanifold of M if TN ⊂ TN^{⊥}. In this case, the dimension of N is less or equal to the half of the dimension of M.
• N is called a coisotropic submanifold of M if TN^{⊥} ⊂ TN. In this case, the dimension of N is greater or equal to the half of the dimension of M.
• N is called a Lagrangian submanifold of M if N is a maximal isotropic subspace of (TM, ω), that is, if TN = TN^{⊥}. In this case, the dimension of N is equal to the half of the dimension of M.
• TN is symplectic if TN ∩ TN^{⊥} = 0. In this case, (N, ω_{N}) is a symplectic manifold.
Under a symplectomorphism, the image of a Lagrangian (isotropic, coisotropic, and symplectic) submanifold is a Lagrangian (respectively, isotropic, coisotropic, and symplectic) submanifold.
E. The complete lift of ω_{Q}
Consider the canonical symplectic manifold (T*Q, ω_{Q}). The tangent bundle TT*Q of T*Q carries a symplectic two-form ωQT that derives from two potential one-forms, denoted by θ_{1} = i_{T}ω_{Q} and θ_{2}=d_{T}θ_{Q}. These one-forms are defined by the canonical forms ω_{Q} and θ_{Q}, respectively. The definition of the derivation i_{T} is the manifestation of the double vector bundle structure of TTQ on TQ and is explicitly given by
The derivation d_{T} is the commutator [d, i_{T}] [56].
Accordingly, in the local coordinate chart (q^{i},p_{i};q̇{i},ṗ{i}), the potential one-forms are computed to be
The exterior derivatives of these one-forms are the same and define the symplectic two-form
which is known as the complete lift to the tangent space of the symplectic two-form [51,55]. Note that the difference θ_{2} − θ_{1} is an exact one-form. Actually, it is the exterior derivative of coupling function of the Legendre transformation between the Lagrangian and Hamiltonian formalisms. Further, existence of two potential one-forms for ωQT leads to the existence of Tulczyjew’s triple, which is exhibited in Subsection II F.
F. Tulczyjew’s triple
We now consider a particular kind of symplectic manifolds introduced by Tulczyjew in Refs [50–55]. A special symplectic manifold is a quintuple (R, N, τ, θ, A), where τ: R → N is a fiber bundle, θ is a one-form on R, and A: R → T*N is a diffemorphism such that π = π_{N} ○ A and θ = A*θ_{N}. Since (T*N, ω_{N} = −dθ_{N}) is a symplectic manifold, (R, ω = −dθ) is symplectic too and A*ω_{N} = ω; therefore, (R, ω) and (T*N, ω_{N}) are symplectomorphic. Consider the following diagram:
Tulczyjew’s symplectic space (TT^{*}Q,ωQT) admits two special symplectic structures. Let us study them.
The non-degeneracy of the canonical symplectic structure ω_{Q} on T*Q leads to the existence of the following diffeomorphism:
The mapping β_{Q} is actually a symplectomorphism if the iterated cotangent bundle T*T*Q is equipped with the canonical symplectic two-from ω_{T^{*}Q}. In coordinates, we have that
It is a matter of a direct calculation to prove that the quintuple
is a special symplectic manifold. Here, θ_{1} is the differential one-form defined in (14).
We define a canonical diffeomorphism α_{Q}: TT*Q → T*TQ as follows. First of all, let us recall that there exists a canonical involution S_{Q}: TTQ → TTQ locally given by
(see Ref [20]). Now, given v ∈ TT*Q we define α_{Q}(v) ∈ T*TQ as
where γ:R→TQ and ξ:R→T^{*}Q are curves such that j^{1} ○ γ = S_{Q}(w), j^{1} ○ ξ = v, and τ_{Q} ○ γ = π_{Q} ○ ξ. In local coordinates, we obtain
The mapping α_{Q} is a symplectomorphism if the iterated cotangent bundle T*TQ is equipped with the canonical symplectic two-from ω_{TQ}. Then it becomes immediate to prove that
is a special symplectic manifold. Here, θ_{2} is the differential one-form defined in (14).
As a result, we have derived two special symplectic structures for the symplectic manifold (TT^{*}Q,ωQT). Tulczyjew’s triple is the combination of these two special symplectic structures in one commutative diagram as follows:
III. LAGRANGIAN SUBMANIFOLDS
In this section and Subsections III A–III D, we will summarize the theory of Morse families and Lagrangian submanifolds generated by them. We refer an incomplete list [7,40,52–54,57] for more detailed discussions.
Let (M, ω) be a symplectic manifold. A sufficient condition for a submanifold N ⊂ M to be Lagrangian is TN = TN^{⊥}. If N is an isotropic subspace of a symplectic manifold (M, ω), then N is Lagrangian if an only if dimN = dimM/2. For different types of manifolds (Poisson, Nambu–Poisson, etc), the definition of a Lagrangian submanifold has been accommodated to its background. See, for example, Refs [37],  [38], and  [40].
Two principal examples of Lagrangian submanifolds of the symplectic phase space T*Q are the fibers of the canonical cotangent bundle projection and the image space of closed one-forms γ: Q → T*Q. The latter case includes the zero section of the projection T*Q ↦ Q as well. This statement is the well-known Weinstein tubular neighborhood theorem [57].
A. Morse families
Consider a differentiable fibration (P, π, N). A real-valued function F on the total space P can intuitively be understood as a family of functions parameterized by the coordinates of the fibers of π. The critical set of F is defined by
and is a submanifold of P. The dimension of CrF,π is equal to the dimension of N. Here, VP is the vertical bundle on P consisting of vertical vectors projecting to the zero section of TN under the mapping Tπ. We define a bilinear mapping
where χ:R{2}→P is the mapping such that the vector v is obtained by taking the derivative of χ with respect to its first entry at (0, 0) and the vector w is obtained by taking the derivative of χ with respect to its second entry at (0, 0).
A family of functions F defined on the total space of the fibration (P, π, N) is said to be regular if the rank of the matrix WF,z defined in (24) is the same at each z∈CrF,π. A family of functions F is said to be a Morse family (or an energy function) if the rank of WF,z is maximal at each z∈CrF,π.
Let us write the requirement of being a Morse family in terms of local coordinates. Assume that the dimension of the manifold N is n with coordinates (q^{i}), and the dimension of a fiber is k with coordinates (λ^{a}). The function F is called a Morse family if the rank of the n × (n + k)-matrix
is maximal.
B. Lagrangian submanifolds generated by Morse families
A Morse family F on the smooth bundle P,π,N generates a Lagrangian submanifold
of T^{*}N,ω_{N}. In this case, we say that S_{T^{*}N} is generated by the Morse family F. Note that, in the definition of S_{T^{*}N}, there is an intrinsic requirement that πz=π_{T^{*}N}w. Here, we are presenting the following diagram in order to summarize the discussion:
In order to exhibit the structure of the submanifold S_{T^{*}N}, define a fiber preserving mapping κ from the critical set CrF,π of the Morse family F to the cotangent bundle T*N according to the requirement
which is valid for all π-related vector fields Z_{N}∈X(N) and Z_{P}∈X(P). Note that this mapping is an immersion and that dimS_{T^{*}N} equals to dimCrF,π=n. A direct calculation shows that the image space of κ is the Lagrangian submanifold S_{T^{*}N} defined in (26).
Let N be an immersed submanifold of Q and TN*Q denote the inverse image πQ−1N in the cotangent bundle T*Q. We define the mapping
by requiring that the equality
holds for each Z_{N}∈X(N), where n = π_{Q}(p) and p∈TN*Q. So, ξ is the identity if p ∈ N, that is, if p ∈ T*N. Consider the canonical injection i:TN*Q→T^{*}Q. If S_{T^{*}N} is a Lagrangian submanifold of T*N, then the preimage i◦ξ^{−1}(S_{T^{*}N}) is a Lagrangian submanifold S_{T^{*}Q} of T*Q. If, particularly, the Lagrangian submanifold S_{T^{*}N} is a generated by a Morse family F on the fiber bundle (P, π, N), then, using the same terminology, we say that S_{T^{*}Q} is generated by the Morse family F. We are presenting the following diagram:
Let us try to see this more explicitly in the following way. For every point p ∈ T*Q such that π_{N}p∈N, we can find a point z ∈ P satisfying πz=π_{N}p. Then, for every vector Z_{P}(z), we have that Tπ ○ Z_{P} is a vector field on N and hence a vector field on Q. Then, the elements of the Lagrangian submanifold S_{T^{*}Q} are defined by the requirement
where F is a Morse family on P.
If the local coordinates (q^{i}, λ^{a}) are considered, then the Lagrangian submanifold generated by the Morse family F is defined by
Note that we are not distinguishing here the base manifold N from Q.
C. Lagrangian submanifolds of special symplectic structures
Let R,N=Q,τ,ω=−dθ,A be a special symplectic structure for a symplectic manifold R,ω with symplectomorphism A. If S_{T^{*}Q} is a Lagrangian submanifold of T*Q, then its pre-image S=A^{−1}(S_{T^{*}Q}) under the symplectomorphism A is a Lagrangian submanifold of the symplectic manifold (R, ω). If the Lagrangian submanifold S_{T^{*}Q} is generated by the Morse family F as presented in the diagram (30), then we say that S is generated by the Morse family F as well. To illustrate this, we draw the following diagram:
Let us record here some special cases of the diagram for future reference.
• The simplest case occurs if A is the identity mapping (no special symplectic manifold) on T*Q, P = N (no Morse family), and the submanifold N = Q (no constraints on Q). Then, we have a function F (not a family) on Q and its exterior derivative is a Lagrangian submanifold of T*Q. Then, S turns out to be the image space of a closed one-form dF: Q → T*Q. This case includes the zero section of the projection T*Q ↦ Q as well [57].
• If A is the identity mapping on T*Q (no special symplectic manifold), P = N (no Morse family). Then we have a function F (not a family) on a submanifold of N of Q, and the Lagrangian submanifold
for any Z ∈ T_{p}T*N such that Tπ(Z) ∈ TN ⊂ TQ [33].
• Let P = N (no Morse family) and the submanifold N = Q (no constraints on Q). Instead, consider the existence of a non-trivial special symplectic structure P,N,π,ω,A. Then, a Lagrangian submanifold S of (P, ω) is defined by the pre-image of dF under the isomorphism A, that is,
where E is defined on Q.
• Let P = N (no Morse family), N be a proper submanifold of Q, and (R, N, τ, θ, A) be a special symplectic manifold. Then the set
is a Lagrangian submanifold of R,−dθ and said to be generated by the function F:N→R. We cite chap. 7 of Ref [33] for a proof of this statement in a more general framework.
D. Lagrangian submanifolds of Tulczyjew’s symplectic space
Assume that a submanifold E of TT*Q is defined in terms of the constraint functions Φ^{A}:TT^{*}Q→R,
If E is an IHS, then it must be a Lagrangian submanifold of the symplectic space (TT^{*}Q,ωQT) and the number of constraints must be 2n assuming that the dimension of Q is n. Note that, in this case, the Poisson brackets of the constraint functions must vanish [40],
Here, the Poisson bracket in (36) is the one induced by Tulczyjew’s symplectic two-form ωQT in Subsection II E. This Poisson bracket can be computed as
The image of a Hamiltonian vector field is a Lagrangian submanifold of TT*Q. Conversely, if a Lagrangian submanifold of TT*Q is the image of a vector field on T*Q, then this vector field is a (at least locally) Hamiltonian vector field. To see this, we present the following calculations. Assume that E is a Lagrangian submanifold of TT*Q and there exists a vector field X satisfying E = Im(X). In Darboux’s coordinates, we write X as
where ϕ^{i} and ϕ_{i} are arbitrary functions on T*Q. This local picture enables us to write the fiber variables (q̇,ṗ) in terms of the functions of the base variables (q, p), and the following definition of the Lagrangian submanifold of E is given by
Since E is a Lagrangian submanifold, the Poisson brackets of the defining equations in (39) must be identically zero. Here, the Poisson bracket is the one in (37). This requirement dictates n^{2} number of conditions,
These conditions are the same with the conditions for closure of the one-form ϕ = ϕ_{j}dq^{j} + ϕ^{i}dp_{i}. Locally, every closed one-form is exact. This implies that there exists a Hamiltonian function H depending on (q, p) satisfying dH = ϕ. As a result, the system (39) can be written as in form of the Hamilton’s equations (4).
A stronger result follows from the generalized Poincaré lemma [6,29,40,54,57]. The generalized Poincaré guarantees that for a Lagrangian submanifold E of TT*Q, whether it is explicit or implicit, there exists a Morse family of functions generating E. This theorem is also known as Maslov-Hörmander theorem [7,9–11]. We record here a Morse family generating the Lagrangian submanifold E as follows:
where N is a submanifold of the cotangent bundle T*Q and and F is a Morse family defined on the total space P of the smooth bundle (P, π, N). On the local chart, the Lagrangian submanifold E generated by F is computed to be
Note that if the Morse family F does not depend on the fiber variables (λ), then E becomes explicit.
Let us comment on a particular case. Consider the following constrained Hamiltonian (Dirac) system:
where Φ^{α}, for α = 1, …, k, are real valued functions defining a constraint submanifold M ⊂ T*Q [13,14,17,41]. Note that we prefer to denote the generator by H to highlight that it is a Hamiltonian function in the classical sense. Diagrammatically, we have the following picture generating the dynamics:
where P is the product manifold T^{*}Q×R{k} and the Morse family is given by F(q, p, λ) = H(q, p) + λ_{α}Φ^{α}(q, p).
IV. HAMILTON–JACOBI THEORY FOR IMPLICIT SYSTEMS
A. Geometry of the Hamilton–Jacobi equation
A HJE is a partial differential equation for a generating function S(q^{i}, t) on Q and the time t given by
Note that the generalized momenta do not appear in (44), except as derivatives of S. This equation is a necessary condition describing the external geometry in problems of calculus of variations. Hamilton’s principal function S = S(q^{i}, t), which is the solution of the HJE, and the classical function H are both closely related to the classical action
The function S is a generating function for a family of symplectic flows that describes the dynamics of the Hamilton equations. If the generating function is separable in time, then we can make an ansatz S(q^{i}, t) = W(q^{i}) − Et, where E is the total energy of the system. Then, HJE in (44) reduces to
Physically, this constant is identified with the energy of the mechanical system.
Let us summarize the geometric Hamilton-Jacobi theory. For this, first consider a Hamiltonian vector field X_{H} on T*Q and a one-form section γ on Q. We define a vector field XHγ on Q by
This definition implies the commutativity of the following diagram:
We enunciate the following theorem.
Theorem 1. The closed one-form γ = dW on Q is a solution of the Hamilton–Jacobi equation (45) if the following conditions are satisfied:
1. The vector fields X_{H}andXHγare γ -related, that is,
2. or equivalently, if the following equation is fulfilled:
Proof 1. We refer Refs [12],  [34], and  [35] for the proof of this theorem.The first item in the theorem says that if q^{i}t is an integral curve of XHγ, then q^{i}t,γ_{j}qt is an integral curve of the Hamiltonian vector field X_{H}, hence a solution of Hamilton’s equations (4). Such a solution of the Hamiltonian equations is called horizontal since it is on the image of a one-form on Q. In the local picture, the second condition implies that exterior derivative of the Hamiltonian function on the image of γ is closed, that is, H ○ γ is constant,
Under the assumption that γ is closed, we can find (at least locally) a function W on Q satisfying dW = γ. After the substitution of this, Eq. (49) retrieves the HJE (45).
B. Implicit differential equations
A first-order differential equation on a manifold M is a submanifold of its tangent bundle [15,16]. The submanifold is said to be an explicit differential equation (EDE) if it is an image of a vector field defined on M, otherwise, it is called implicit (IDE) [29,41,42,44,48]. We also refer Refs [27],  [46], and  [47] for studies on linear singular implicit systems.
Consider a local coordinate system (q^{i}) on M and the induced coordinates (q^{i},q̇{i}) on its tangent bundle TM. An IDE can be written in form
for i with certain values running from 1, …, n and a = 1, …, k. Here, g^{i} and f^{a} are real valued differentiable functions on (q,λ)∈M×R{k} [30]. Note that f^{a}’s form a matrix of maximal rank
This implies that only certain q̇{i}’s are expressible as in (50) depending on certain (q^{j}, λ^{a}) for some a’s equal to k ≤ n.
A solution of an IDE is a curve ϕ on M satisfying that the tangent vectors ϕ̇t belong to E for all t. The submanifold E is called integrable if for all vectors v ∈ E there exists a solution ϕ satisfying v=ϕ̇t for some t. Equivalently, we may define “integrability” of an IDE without referring to the solution curves as follows. We say that the IDE is integrable if the restriction of the tangent bundle projection τ_{M} to E is surjective summersion and if E⊂Tτ_{M}E.
In principle, an IDE is not necessarily integrable. For example, consider the following case [44].
Example 1. Let E ⊂ TT*Q be a system of IDE, where Q is coordinated by q and T*Q by (q, p), defined by
which is not integrable in points q^{2} + p^{2} = k, q̇=−1, andṗ = 0 with q ≠ 0.Nonetheless, we can develop an algorithm to extract its integrable part [44]. This algorithm works as follows. We denote the projection of the submanifold E onto M by C. In each step of the algorithm, there is a fiber bundle E^{k},τ^{k},C^{k} consisting of two submanifolds E^{k} ⊂ E and C^{k} ⊂ C and a (surjective submersion) projection τ^{k}: E^{k} → C^{k}. The first step is initiated by choosing E^{0}=E,C^{0}=C and, iteratively, the further steps are defined by
In finite dimensions, there is an end for the algorithm, that is, there exists a three tuple E^{f},τ^{f},C^{f} satisfying that E^{f+1} = E^{f} and C^{f+1} = C^{f}. Note that the final manifold E^{f} is integrable. We call E^{f} the integrable part of E. Constrained
Example 2. Consider the following set (x, p, r, s, ẋ, ṗ, ṙ, ṡ) onTR{4}, with the following equations [44]:
Here, E = E^{0}and C^{0} = {(x, p, r = p, s = 0)} such that TC^{0} = {ẋ, ṗ, ṙ = ṗ, ṡ = 0}. So,
From here, any other iteration E^{k} = E^{1}and TC^{k} = TC^{1}. Hence, (54) is the integrable part of (53).
C. The Hamilton–Jacobi theory for implicit differential equations
In this section, we develop a geometric Hamilton-Jacobi theory for IDE. Our problem is that given a set of IDEs, we are not necessarily provided with a Hamiltonian vector field as explained in Sec. IV A. Here, we propose two methods to construct our theory. The first method consists of a theory which does refer to vector fields. The second is based on the construction of a local vector field defined on the image of a section, but not globally on the phase space.
Let us start with the first method. Consider a submanifold E of TT*Q. By projecting E by the tangent mapping Tπ_{Q} onto the tangent bundle TQ, we arrive a submanifold Tπ_{Q}(E) of TQ. Note that E refers to an IDE on T*Q, whereas Tπ_{Q}(E) refers to an IDE on Q. If E is integrable, then Tπ_{Q}(E) is integrable too. We see this by considering the projection Tπ_{Q}(V) = v ∈ Tπ_{Q}(E) of an element V ∈ E. Note that if φ is a curve on T*Q and it is tangent to V ∈ E, then π_{Q} ○ φ is a curve on Q which is tangent to v ∈ Tπ_{Q}(E). This shows that the projections of the solutions of E are solutions of Tπ_{Q}(E). Our aim is to discuss the inverse question, starting from the solutions of Tπ_{Q}(E) construct solutions of E, that is, to lift the solutions on Q to the cotangent bundle T*Q. This is the philosophy of a geometric Hamilton–Jacobi theory. (Recall the geometric Hamilton–Jacobi theory exposed in Subsection IV A.) Furthermore, if E were not integrable, we would have to perform the integrability algorithm explained in Subsection IV B.
To answer the question we have to introduce a section γ: Q → T*Q. If any solution ψ:R→Q of Tπ_{Q}(E) is a solution γ◦ψ:R→T^{*}Q of E, then we denote the submanifold Tπ_{Q}(E) by E^{γ} and say that E and E^{γ} are γ-related. We illustrate this in a diagram,
In coordinates, a submanifold E of TT*Q can be given by the set of functions Φ^{A}:TT^{*}Q→R,
The projection of E onto T*Q by means of τ_{T^{*}Q} results with a submanifold C of T*Q given by the set of functions
Consider the intersection of the projected submanifold C and the image space of the one-form γ. We denote this globally by C ∩ Im(γ) and locally by Ψ^{α}(q^{i}, γ_{j}(q)) = 0. If a solution curve is represented by ψ^{i}(t) ⊂ Q, the composition γ ○ ψ(t) = (ψ^{i}(t), γ_{i}(ψ(t))) is a curve on T*Q and the time derivative of the curve is
Then, the equations of the submanifold E along γ take the form
provided that Ψ^{α}(q^{i}, γ_{i}(q)) = 0 along γ(Q) ⊂ C. Here, we assumed that ψ^{i}(0) = q^{i}.
In the second case, we consider an additional section σ: T*Q → TT*Q such that σ(C) ⊂ E,
Since E is implicit, there may exist several vectors in E projecting to the same point, say c, in C. The role of the section σ is to reduce this unknown number to one. We are additionally require that the domain of the section σ be the intersection of Im(γ) and C since, for implicit systems, C may not be the whole of T*Q. As a result, we arrive at a vector field X_{σ}. Note that X_{σ} satisfies
for an arbitrary one-form Θ defined on γ(q).
We define a vector field Xσγ on the tangent bundle TQ by the commutation of the following diagram:
Explicitly,
In local coordinates, the vector field X_{σ} and its projection Xσγ can be written as
respectively. Using a one-form section γ on Q, the tangent lift of the projected vector field Xσγ is
Using (57), we find an expression relating the section σ and the vector fields as follows:
We are ready now to state the following lemma.
Lemma 2. Given the conditions above, we say that the two vector fields X_{σ}andXσγare γ-related if and only if (60) is fulfilled.Again, this construction can be mimicked for nonintegrable IDEs that are submanifolds E of a higher-order bundle, after performing the integrability algorithm given in Subsection IV B.
D. A HJ theory for IHS
As we have summarized in Subsection III D, for every Lagrangian submanifold E of TT*Q, there exists a Morse family F:TT^{*}Q→R generating E. This enables us to write E locally as
where F = F(q, p, λ). We cite two important studies [7,43] related with the problem addressed in this subsection.
We introduce a differential one-form γ on the base manifold Q. See that Im(γ) is a Lagrangian submanifold of T*Q so that there is an inclusion ı: Im(γ) ↦ T*Q. Use the inclusion ı in order to pull the bundle (P, π, T*Q) back over Im(γ). By this, one arrives at a fiber bundle (ı*P, ı*π, Im(γ)). For the present case, the commutative diagram for a generic pullback bundle exhibited in (1) takes the following particular form:
Here, the total space
of the pull-back bundle is a submanifold of P with ε being the corresponding inclusion. A local coordinate system on ı*P can be taken as (q, γ(q), λ). Although restriction of the Morse family on ı*P should formally be written as F ○ ϵ, we will abuse notation by still denoting it by F, but to highlight the difference we shall write the arguments of the function as F = F(q, γ(q), λ). The submanifold generated by F = F(q, γ(q), λ) is given by
Note that if the Lagrangian submanifold E is the image of a Hamiltonian vector field X_{H}, then E|_{Im(γ)} reduces to the image space of the composition X_{H} ○ γ.
The submanifold E|_{Im(γ)} exhibited in (63) does not depend on the momentum variables. This enables us to project it to a submanifold E^{γ} of TQ by the tangent mapping Tπ_{Q} as follows:
Note that the submanifold E^{γ} defines an implicit differential equation on Q. We state the generalization of the Hamilton-Jacobi theorem 1 as follows.
Lemma 3. The following conditions are equivalent for a closed one-form γ:
1. The Lagrangian submanifold E in (61) and the submanifold E^{γ}in (64) are γ-related, that is,
2. And it is fulfilled that dF(q, γ(q), λ) = 0, where F is the Morse family generating E.
Proof 2. The one-form γ = γ_{i}dq^{i}is closed, that is, ∂γ_{i}∂q^{j}=∂γ_{j}∂q^{i}. The first assertion in Lemma 3 can be written locally as
with the conditions that ∂F/∂λ^{a} = 0. We make a simple calculation to compute the exterior derivative of the Morse family as follows:
Note that, after the substitution of (65) into (66) and by employing the symmetry∂γ_{i}∂q^{j}=∂γ_{j}∂q^{i}, we arrive at that the exterior derivative of F vanishes when p = γ(q). To prove the reverse direction, it is enough to repeat these steps in reverse order.Assume now that the one-form γ is exact so that γ = dW(q) for some real valued function W called the characteristic function on the base manifold Q. Then the second condition in Lemma 3 gives the implicit Hamilton-Jacobi equation (IHJ equation)
In Lemma 3, if the Lagrangian submanifold E is the image of a Hamiltonian vector field X_{H}, then E^{γ} becomes the image space of the vector field XHγ in (46) and we retrieve the classical HJ theory given in (47).It is possible to generalize Lemma 3 by replacing the image space Im γ by an arbitrary Lagrangian submanifold S of T*Q. Note that, according to the generalized Poincaré lemma, there exists a Morse family W on the total space of a smooth bundle (R, τ, Q) generating the Lagrangian submanifold S. We equip the total space R with the coordinates (q^{i}, μ^{α}). Then we have that the Lagrangian submanifold S can be written as
Now, the inclusion in the diagram (62) becomes ı: S ↦ T*Q. In this case, the restriction of the Morse family F generating the submanifold E of TT*Q to the inclusion ϵ defines the following submanifold:
where W = W(q, μ) and F=F(q,∂W∂q^{i}(q,μ),λ). The submanifold E|_{S} does not depend on the momentum variable p explicitly, so that its projection E^{S} to the tangent bundle TQ by means of Tπ_{Q} is well defined and given by
We are now ready to state a generalization of Lemma 3 as follows.
Lemma 4. Let S be a Lagrangian submanifold of T*Q generated by the Morse family W = W(q, μ) defined on the total space of a bundle (R, τ, Q). The following conditions are equivalent:
1. The Lagrangian submanifold E in (61) and the submanifold E^{S}in (70) are S -related, that is,
for every μ, where E|_{S}is in (69).
2. dFq,∂W∂q(q,μ),λ=0for all μ. Here, F is the Morse family generating E.We only give some clues instead of writing the whole proof of this lemma since it is very similar to the proof of Lemma 3. The closedness of the one-form γ is replaced by the commutativity of the second partial derivatives of the Morse family W with respect to q.Let us comment on the notation T(dW|_{μ}) as well. If the fiber variable μ is frozen, then the exterior derivative dW|_{μ} of the Morse family W becomes a differentiable mapping from Q to T*Q and its tangent mapping T(dW|_{μ}) goes from TQ to TT*Q. We remark that this last comment is a generalization of the Hamilton-Jacobi theory for the Lagrangian submanifolds studied in Ref [4] as well.
Example 3. Let V be a nonholonomic k-dimensional distribution on Q spanned by the vector fields X_{a}. We define the following Morse family on the total space of the fiber bundleT^{*}Q×R{k}:
Here F is a Morse family and determines a Lagrangian submanifold of TT*Q given by
This system is integrable according to Ref [29]. The corresponding Hamilton-Jacobi equation is computed to be
V. COMPLETE SOLUTIONS OF THE HJ EQUATION FOR IHS
Before writing the complete solution of a HJ equation of IHS, we first investigate the complete solutions of HJ equations for explicit systems in terms of Morse families and Lagrangian submanifolds.
A. Lagrangian submanifolds generated by complete solutions
In the classical sense, a solution W of the HJ equation (45) is called complete if it depends on additional variables that are equal in number to the dimension of the base manifold Q^{1}. To illustrate this, we start by considering two copies of the configuration manifold and denote them by Q and Q¯. Endow these manifolds with local coordinates (q^{i}) and (q¯{j}), respectively. The number of arbitrary parameters for the general solution is given by j, which does not necessarily equal i. A complete solution is a real valued function W=W(q¯,q) on the product space Q¯×Q that resolves the HJ equation (45). This function generates three different Lagrangian submanifolds; let us show them.
Construct the fiber bundle structure (Q¯×Q,ρ,Q). Here, the bundle projection ρ is assumed to be a projection to the second factor. As discussed previously, a real valued function W=(q¯,q) on the total space Q¯×Q is called a Morse family if the matrix [∂^{2}W/∂q¯{i}∂q^{j}] is non-degenerate. We draw the following diagram:
In this case, the Morse family W defines a Lagrangian submanifold of T*Q given by
Note that, by changing the roles of Q and Q¯, we may define a bundle structure (Q¯×Q,ρ¯,Q¯) over the manifold Q¯ and obtain a diagram similar to (74). In this case, W defines a Lagrangian submanifold S¯ of T^{*}Q¯ as follows:
Another Lagrangian submanifold generated by W is the result of the following observation. The cotangent bundle T^{*}(Q¯×Q)=T^{*}Q¯×TQ of the product space is a symplectic manifold equipped with the symplectic two-form ω_{Q¯}⊖ω_{Q} [57]. It is evident that the image of the exterior derivative dW of a complete solution W is a Lagrangian submanifold
It is known that a Lagrangian submanifold of T^{*}(Q¯×Q) defines a symplectomorphism between T^{*}Q¯ and T*Q. The Morse family W=W(q¯,q) generates a symplectomorphism according to the following identity:
where we assume Darboux’s coordinates on the cotangent bundles. In the local picture, the induced symplectomorphism is given by
B. Complete solutions for the case of implicit Hamiltonian systems
Let us first try to geometrize the complete solutions of the HJ equation for explicit systems. A function W=W(q¯,q) is a complete solution of the HJ equation (45) if the Hamiltonian function H is constant when it is restricted to S exhibited in (75), that is, a complete solution W is the one satisfying
Using the symplectic diffeomorphism φ in (79) generated by the function W, we pull the function H back to T^{*}Q¯ and see that φ*H is a constant so that the dynamics generated by φ*H is trivial.
Now, assume that we have a Lagrangian submanifold E of TT*Q. Then there exists a Morse family F generating E. A complete solution of the implicit Hamilton-Jacobi equation (67) is a smooth function W satisfying
We aim to pull the dynamics E or the Morse family F back to T^{*}Q¯. To achieve this goal, we recall the definition of the pullback bundle in (1) and apply it to the diffeomorphism (79). This way we obtain a fiber bundle structure (φ^{*}P,φ^{*}π,T^{*}Q¯) where the total space is defined to be
equipped with the induced coordinates (q¯{i},p¯{i},λ), and φ*π is the projection to the second factor. We draw the following commutative diagram in order to summarize the discussion:
Here, φ^ is a diffeomorphism and in the local coordinates reads
The pullback F¯=F◦φ^ of the Morse function F by φ^ is a Morse family on the total space of the pullback bundle (φ^{*}P,φ^{*}π,T^{*}Q¯). Note that F¯ is a constant function and the implicit differential equation generated by F¯ renders trivial dynamics.
Generalizing, the most general form of a Lagrangian submanifold of T^{*}Q¯×T^{*}Q is generated by a Morse family W defined on the total space of the fiber bundle (R, τ, M) where the base manifold M is a submanifold of Q¯×Q. Let us depict it in a diagram,
A complete solution to the implicit Hamilton-Jacobi equation (67) is a Morse family W defined on the total space R. Note that the Morse family F generating the dynamics on E reduces to a constant function on the Lagrangian submanifold generated by W.
Let us now depict the situation in coordinates. Assume that a submanifold M of Q¯×Q is defined by a number “l” of equations
Consider a real function W^{′} on the submanifold M and define an arbitrary continuation
of W′ to the product space P=Q¯×Q×Λ, where (ν_{a})’s are the Lagrange multipliers defining a local coordinate system for Λ. This W is a complete solution of the implicit Hamiltonian dynamics (3) generated by F if
An implicit description of a Lagrangian submanifold of T^{*}Q¯×T^{*}Q generated by W or equivalently of the corresponding diffeomorphism φ can be computed by
where the θ_{Q¯} and θ_{Q} are the canonical one-forms on Q¯ and Q, respectively. In this case, the momenta p∈Tq*Q and p¯∈Tq¯*Q¯ can be explicitly stated as
VI. APPLICATION TO DEGENERATE LAGRANGIAN SYSTEMS
A. Lagrangian dynamics
A Lagrangian function L is a real valued function on TQ. Consider the coordinates (q^{i},q̇{i}) on TQ induced those from Q. We define a vertical endomorphism S given by S=∂/∂q̇{i}⊗dq^{i}. Note that S is a (1, 1)-tensor field on Q. In terms of S, the Cartan one-form θ_{L} is defined to be
where dL is the exterior derivative of a Lagrangian function. The Cartan two-form derivates from the Cartan one-form ω_{L} = −dθ_{L}. See that ω_{L} is symplectic if the Hessian matrix
is not singular. In this case, the fiber derivative (or the Legendre transformation)
becomes a symplectomorphism relating the Cartan two-form ω_{L} on TQ and the canonical symplectic two-form ω_{Q} on T*Q. The Lagrangian is said to be hyperregular if the fiber derivative FL is a global diffeomorphism.
The energy is defined as E_{L} = Δ(L) − L, a real valued function on TQ where the Liouville vector field is Δ=q̇{i}∂/∂q̇{i}. The Hamiltonian is retrieved through
If the Lagrangian is regular or, equivalently, if ω_{L} is symplectic, then the Lagrange equations can be expressed geometrically as
whose solution ξ_{L} is called a Euler–Lagrange vector field explicitly given by
The integral curves (q^{i}(t),q̇{i}(t)) are lifts of their projections (q^{i}(t)) on Q and are solutions of the system of differential equations
which is equivalent to a second-order differential equation
The curves (q^{i}(t)) in Q are called the solutions of ξ_{L} that correspond with the solutions of the Euler–Lagrange equation
If the Lagrangian is regular, then the fiber derivative (89) has the following geometry:
In this case, the Hamiltonian vector field X_{H} associated with the Hamiltonian function H in (90) and ξ_{L} presented in (91) are related as
The diffeomorphisms α_{Q} and β_{Q} map Lagrangian submanifolds into Lagrangian submanifolds,
whereas the Hamiltonian and the Lagrangian vector fields are related to their corresponding Lagrangian submanifolds as
respectively.
B. Lagrangian dynamics as a Lagrangian submanifold
In this section, we depict the geometric interpretation of a HJ theory for Lagrangian dynamics. For it, we present the EL equations in terms of Morse families and special symplectic structures.
Recall the special symplectic structure on the left side of Tulczyjew’s triple,
In the induced local picture on TT*Q, by following the procedure presented in Subsection III B, we compute the Lagrangian submanifold E generated by the Lagrangian L as
which is equivalent to the EL equations (95). We can generate this Lagrangian submanifold from the right wing (the Hamiltonian side) of the triple (22) by defining a proper Morse family F^{L→H} on the Pontryagin bundle PQ = TQ × _{Q}T*Q over T*Q. On a local chart, the energy function
satisfies the requirements of being a Morse family. Hence, F generates a Lagrangian submanifold of T*T*Q as defined in Eq. (26). In coordinates (q^{i}, p_{i}, α_{i}, β^{i}) of T*T*Q, this Lagrangian submanifold is given by
The inverse of the isomorphism β_{Q} maps this Lagrangian submanifold to the Lagrangian submanifold E presented in (97). Here, we record the following diagram for this:
For regular cases, the Morse family F on PQ can be reduced to a Hamiltonian function H on T*Q. For degenerate cases, a reduction of the total space PQ to a subbundle larger than T*Q is possible depending on degeneracy level of Lagrangian function [7]. There exists an intrinsically geometric procedure for dealing with constraints in Hamiltonian and Lagrangian mechanics. It has been available since 1979, and with advantages over the Dirac-Bergman algorithm, it is the Gotay-Nester-Hinds algorithm [23–26] (read the Appendix for a brief description of the method).
C. Hamilton-Jacobi theory for degenerate Lagrangians
To write the associated HJ equation of the EL equations generated by (possibly) degenerate Lagrangian densities, we apply Lemma 3 to the Lagrangian submanifold presented in (97). Accordingly, we arrive at that the implicit HJ equation
for a closed one-form γ = γ_{i}(q)dq^{i}. Taking the exterior derivative of this equation, we arrive at the following local picture of the Hamilton-Jacobi equation for a Lagrangian L:
To illustrate this, we propose two particular problems [36].
Example 4. Consider the degenerate Lagrangian L on TR{3} given by
and the Whitney bundle TR{3}⊕T^{*}R^{3} fibered on T^{*}R^{3} and parameterized by (q^{1},q^{2},q^{3},q̇{1},q̇{2},q̇{3},p_{1},p_{2},p_{3}). The Lagrange multipliers correspond with (λ^{i})=(q̇{1},q̇{2},q̇{3}). Following (98), we define the Morse family
that generates a Lagrangian submanifold E of TT^{*}R^{3}. Explicitly,
It is evident that the projection of E to T^{*}R^{3} results with the following 4-dimensional submanifold:
Consider now the closed one-form γ:R{3}↦T^{*}R^{3}. According to the Lagrangian HJ theorem 3, the system (101) in this particular case takes the form
It is immediate to see from equations [4] and [5] that γ_{1} = γ_{2}. If γ is closed and γ_{3} = 0, one obtains that γ_{1} and γ_{2} are independent of q^{3}. Then [3] in (103) is automatically satisfied. The substitution of [4] into [1] and [2] results in
A nontrivial solution is possible if γ_{1} and γ_{2} are constants. Hence, we record the one-form
In terms of submanifolds, that is, according to the first condition in Theorem 3, the picture is the following. The constant character of the one-form defines a constraint q̇{1}+q̇{2}=c, on the velocity variables. We first restrict the submanifold E to the image space of the γ, and we arrive at
whose generic version is given in (63). The projection of E|_{Im(γ)} to the tangent bundle TR^{3} by Tπ_{R^{3}} results in a five-dimensional submanifold
of the tangent bundle TR{3}. The system of equations (103) is equivalent to saying that the tangent lift of E^{γ} by the tangent mapping Tγ equals E|_{Im(γ)}. It is indeed immediate to see that Tγ(E^{γ}) = E|_{Im(γ)}.In terms of vector fields, the situation is as follows. Consider a section σ of the tangent bundle τ_{T^{*}Q} given by
on the intersection C ∩ Im(γ). Note that Im(σ) ⊂ E. Accordingly, we write the following vector field:
We project this vector field by Tπ_{Q} and arrive at the vector field Xσγ, which is locally the same as X_{σ}. Composing with the section γ,
This shows that
is obviously fulfilled.
Example 5. Consider the Lagrangian L on TR{2} given by
To recast the EL system generated by this Lagrangian function, we simply define the following Morse family on the Whitney sum TR{2}⊕T^{*}R^{2}:
This family generates the following Lagrangian submanifold:
The projection of E onto the cotangent bundle T^{*}R^{2} by the tangent bundle projection τ_{T^{*}Q} results with the following submanifold:
According to Theorem 3, we now introduce a closed one-form γ on R^{2} and require that the Morse family F in (105) is constant on the image space, that is,
For this case, the Hamilton-Jacobi equations (101) turn out to be the following set:
The closedness of γ, together with equation [4], implies that γ_{1} depends only on q^{1}. If we substitute this and equations [3] and [4] into [1] and [2], then we arrive at a partial differential equation and a constraint
Note that the constraint q^{1} = 0 implies that the system is automatically satisfied for any function γ_{1} = γ_{1}(q^{1}). Then, the one-form is described by
Let us assume that γ_{1}(q^{1}) = q^{1} as it is done in Ref [36] and rewrite system (108) in terms of submanifolds. If the Lagrangian submanifold E in (106) is restricted to the image space of γ in (109), then the result becomes
This is projected to the tangent bundle TR{2} by Tπ_{R^{2}} in order to get the reduced dynamics
The γ-relatedness of E and E^{γ} can be checked with the following lift:
As a result, we have three constraints q^{1} = 0, p_{1} = 0, and p_{2} = 0. So, the projected submanifold C in (107) must be rectified as
Here, p_{2} = 0 is called the primary constraint, since it roots in the functional structure of the Lagrangian function, and the other two constraints q^{1} = 0 and p_{1} = 0 are called the secondary constraints.Consider a section σ of the tangent bundle fibration τ_{T^{*}R^{2}} given by
By restricting this section to the intersection Im(γ) ∩ C, we arrive at the following vector field:
The projection of this vector field to TR{2} is the vector field Xσγ, and it looks exactly as X_{σ}, at least locally.Xσγ and X_{σ} are γ related since the tangent lift by γ is given by
and maps the vector field Xσγ into X_{σ}.
VII. CONCLUSIONS AND FUTURE WORK
In this work, we have presented a geometric Hamilton-Jacobi theory for systems of implicit differential equations. In the general context, due to the implicit character of the equations, the lack of a vector field has been solved by the introduction of a local section σ. In the particular case of the implicit Hamiltonian dynamics, Morse families and special symplectic structures have been employed to derive a Hamilton–Jacobi theory in which the Morse function plays the role of the Hamiltonian. This result has been particularly applied to singular Lagrangians. We expect further applications of the theory in constraint Hamiltonian systems, Dirac systems, etc.
The obtainance of a Hamilton–Jacobi theorem through reduction is here sketched in terms of coisotropic reduction [39]. As future work, we aim at stating the problem of reduction of the implicit Hamilton-Jacobi theory under the Lie group symmetry of the implicit system of differential equations.
APPENDIX: THE GOTAY–NESTER–HINDS ALGORITHM
The Gotay–Nester–Hinds algorithm is a suitable tool for reducing the dynamics of singular Hamiltonian or Lagrangian systems to a reduced manifold where the motion is well defined. This algorithm was created as a generalization of the well-known Dirac-Bergman algorithm which has local nature and does not cope with all the singularities appearing in dynamics. Let us briefly describe the Gotay–Nester–Hinds algorithm [23–26].
Let us recall that given a singular Lagrangian L:TQ→R, the Legendre transform FL: TQ → T*Q, and the energy E_{L}:TQ→R, one can define a presymplectic system (M_{1} = FL(TQ), ω_{1}), where ω_{1} is the restriction of the canonical symplectic form on T*Q to M_{1}. We will assume that L is almost regular (the Legendre transformation is a submersion and surjective), then M_{1} = FL(TQ) is a submanifold of T*Q.
The restriction of the Legendre mapping FL_{1}: TQ → M_{1} to this submanifold is a submersion with connected fibers. In this case, M_{1} is called the submanifold of primary constraints. If L is almost regular, ker(TFL) = ker(ω_{L}) ∩ V(TQ), where V(TQ) denotes the vertical bundle, and the fibers are connected, a direct computation shows that E_{L} projects onto a function h_{1}:M_{1}→R. The inclusion of this submanifold is denoted by j_{1}: M_{1} → T*Q and define ω_{1}=j1*(ω_{Q}). The dynamics in the primary constraint manifold is
where h_{1} ∈ C^{∞}(M_{1}) is the projection of the energy E_{L} ∈ C^{∞}(TQ). Now, there are two possibilities: the solution X defined at all the points of M_{1} is such that X defines global dynamics and it is a solution (modulo ker ω_{1}), in other words, there are only primary constraints, or we are in need of a second submanifold M_{2} where ι_{X}ω_{1} = dh_{1} and X ∈ TM_{1}. But such a solution X is not necessarily tangent to M_{2}, so we have to impose an additional tangency condition to M_{2} and obtain a new submanifold M_{3} along which there exists a solution. Continuing this process, we obtain a sequence of submanifolds
where the general description of M_{l+1} is
If the algorithm stabilizes at some k, say M_{k+1} = M_{k}, then we say that M_{k} is the final constraint submanifold which is denoted by M_{f}, and then there exists a well-defined solution X along M_{f}. This constraint algorithm produces a solution X of the equation
where X is a vector field on M_{f}. We can depict the situation in the following diagram:
TABLE I. 
Canonical coordinates and symplectic forms on second-order tangent and cotangent spaces. Consider Q a mechanical configuration manifold and note that we are assuming summation over repeated indices.
TABLE I. -body
Space	Coordinates	Symplectic forms
Q	q^{i}	
TQ	(q^{i},q̇{i})	
T*Q	(q^{i}, p_{i})	ω_{Q} = dq^{i} ∧ dp_{i}
TT*Q	(q^{i},p_{i},q̇{i},ṗ{i})	ωQT=dq̇{i}∧dp_{i}+dq^{i}∧dṗ{i}
TTQ	(q^{i},q̇{i},δq^{i},δq̇{i})	
T*T*Q	(q^{i}, p_{i}, α_{i}, β^{i})	ω_{T^{*}Q}=dq^{i}∧dα_{i}+dp_{i}∧dβ^{i}
T*TQ	(q^{i},q̇{i},a_{i},b_{i})	ω_{TQ}=dq^{i}∧da_{i}+dq̇{i}∧db_{i}

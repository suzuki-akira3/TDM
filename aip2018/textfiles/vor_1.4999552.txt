Characterization of a commercial software defined radio as high frequency lock-in amplifier for FM spectroscopy
A commercial software defined radio based on a Rafael Micro R820T2 tuner is characterized for the use as a high-frequency lock-in amplifier for frequency modulation spectroscopy. The sensitivity limit of the receiver is 1.6 nV/Hz. Frequency modulation spectroscopy is demonstrated on the 6406.69 cm^{−1} absorption line of carbon monoxide.
I. INTRODUCTION
Frequency modulation (FM) spectroscopy as introduced by Bjorklund et_al [1–3] requires for the detection a phase adjuster and an rf-mixer in the configuration of a fast high-frequency lock-in amplifier. These can be either implemented by combining high frequency components like those from Minicircuits or using modern commercial solution as the Stanford Research Systems SR844 200 MHz lock-in amplifier or the HF2LI lock-in amplifier of Zürich Instruments. The approach presented by Bjorklund et_al [1,2] has the drawback that the phase needs to be adjusted because the signal shape depends on dispersion properties of the measured absorption line—two-tone frequency-modulation spectroscopy introduced by Janik et_al [4,29] does not have this drawback; however, it needs a better preparation of the modulation signal. Furthermore, the non-linearity of the rf-mixer setup is not discussed in detail in the literature. To overcome the drawback of the need for an active phase adjustment, the use of a full quadrature receiver is advantageous. In this paper, we evaluate a modern quadrature receiver for this purpose which is useful for high frequency detection from 100 MHz up to 1.7 GHz. The quadrature setup makes an additional phase adjustment unnecessary. The included filters and amplifiers enable nearly thermal noise limited measurements [5,6]. For commercial and scientific applications of FM spectroscopy, powerful and cost effective high-frequency lock-in amplifiers are a crucial component. The presented characterization and application of a software defined radio for this purpose demonstrates the usability of such a cost effective device.
II. DESCRIPTION OF THE SETUP
The setup used for the FM-spectroscopy is depicted in Fig. 1. The lock-in amplifier and signal processing part of the setup consist of a commercially available software defined radio (Airspy SDR [7–9]) based on the R820T2 Rafael Micro silicon tuner [10] and a 204 MHz dual core LPC4370 ARM micro-controller from NXP Semiconductors [11]. The tuner has a low noise amplifier (LNA) and a digitally adjustable tracking filter in front of the mixer. A fractional phase locked loop (PLL) generates the local oscillator signal. The PLL is coupled to an SI5153C [12] clock generator which can be connected to an external 10 MHz reference input. This input enables the use of the receiver as a high-frequency lock-in amplifier since other PLL oscillators can be synchronized to the SDR. The only disadvantage is that this method generates an arbitrary start phase in the system. The intermediate frequency of the mixer is filtered by a digital adjustable intermediate frequency bandpass filter and further amplified by a variable gain amplifier (VGA). The intermediate frequency of the tuner is directly sampled with 20 MHz sampling rate by a 12-bit digitizer, integrated in the LPC4370 ARM micro-controller, which transfers the sampled signal via a universal serial bus (USB) to the host computer.
The software library [13] supplied to the Airspy SDR converts the sampled signal to a quadrature signal with a virtual intermediate frequency (IF) of 5 MHz using the f_{sample}/4-method [14,15] to calculate a 10 Msample/s in-phase and quadrature signal (IQ). To achieve this virtual IF, the internal PLL of the R820T2 is tuned to f + f_{sample}/4—so the desired reception frequency is mixed to an IF of − f_{sample}/4. The software scales the 12-bit digitizer signal to a signed 16-bit integer. Then the DC-part of the signal is computed by a moving average and subtracted from the signal. The in-phase signal (I) is computed by multiplying the signal with a f_{sample}/4 cosine wave (−1, 0, 1, 0), down sampling the signal by a factor of two by taking the non zero values, and averaging the signal with a finite impulse response filter (FIR filter). The quadrature signal (Q) is computed by multiplying the signal with a f_{sample}/4 sine wave (0, −1, 0, 1), down sampling the signal by a factor of two by taking the non zero values, and delaying the signal appropriately. The down sampling of the mixed signals by a factor of two acts as a low pass filter for the IQ signal. This results in an IQ signal with a frequency of f_{sample}/2 [16].
The spectroscopy part of the setup consists of a fiber coupled 1570.62 nm DFB-diode laser system (Thorlabs LS5-L-50A-20NM), which is tunable to the 1570.647 nm absorption line of carbon-monoxide. Wavelength and intensity modulation of the laser are achieved by modulating the laser current with a 1 kHz sinusoidal control voltage, which is synchronized to the external 10 MHz reference. Phase-modulation of the laser with a 400 MHz signal is performed by a fiber coupled electro-optic phase modulator (Thorlabs LN65S-FC), which is driven by an ADF4351 [17] synthesizer (Analog Devices) coupled to the 10 MHz reference. The synthesizer is amplified to achieve the optimal modulation depth for the FM-spectroscopy and low-pass filtered (Minicircuits SLP450+) to suppress higher harmonics. The modulated light is then collimated using a Schäffter + Kirchhoff 60FC-4-A11-03 fiber collimator and passed through a 1 m long absorption cell filled with 0.5 bar CO for characterization of the spectroscopy setup. As a photo-receiver, a fiber-coupled modified Thorlabs DET01CFC InGaAs photo-diode with a bandwidth of 1.2 GHz is used. A bias tee is realized inside the photo-diode package to split the continuous wave and high frequency part of the signal. The high frequency signal is amplified by a Mini Circuits ZKL-2 low noise amplifier and passed to the software defined radio lock-in amplifier. The detector is fiber-coupled using a multi-mode fiber and a 60FC fiber collimator.
III. CHARACTERIZATION OF THE AIRSPY SDR AS LOCK-IN AMPLIFIER
A. Characterization of the 3rd order non-linearity
The datasheet of the R820T tuner [10] states an IIP3 (third order intercept point) of +35 dBm for minimal LNA gain and −7.5 dBm for maximal LNA gain. In order to use the tuner as a software defined lock-in amplifier, the non-linearity of the tuner must be calibrated for each combination of LNA gain and VGA gain. This section shows the measurement principle of the non-linearity, demonstrated for some defined combinations of the gain settings.
The measurement of the third order non-linearity is performed by using a RIGOL DSG815 rf-signal generator tuned to the virtual tuner frequency with an arbitrary offset of 10 kHz. The third order non-linearity affects the imaginary and real parts of the measured signal amplitude independently in a similar way, due to the f_{sample}/4-method which is used to calculate the quadrature signal. Therefore, the third order distortion can be described in the following way: y(t)=x(t)+biIm[x(t)]{3}+Re[x(t)]{3}. Assuming a complex signal with an amplitude a at a frequency ω: x(t) = ae^{−iωt}, the third order distorted signal is given by y(t)=ae^{−itω}1+a^{2}b43+e^{4itω}. The non-linearity factor b can be extracted by measuring the fundamental and the minus third harmonic amplitude of the signal
and calculating the non-linearity factor
Thus, by measuring a signal with a certain frequency offset to the virtual IF-frequency, it is possible to measure the third order non-linearity. In Fig. 2, such a measurement is shown. The effect of the third order non-linearity can be clearly seen in the amplitude plot (absolute value) of the signal as a fourth harmonic amplitude modulation (‖y(t)‖=‖a+a^{3}b4(3+e^{4itω})‖). Furthermore, it is observable as a distortion visible in the phase diagram. In Fig. 3, the Fourier-transform of the signal is displayed. By extracting the amplitudes, a non-linearity factor of b = 1.0510^{−10} can be calculated. Moreover, the figure shows the spectrum of the same signal when the non-linearity is compensated by an approximation to the order 5 of the inverse non-linear function x(t)=y^{−1}(y(t))=y(t)−biIm[y(t)]{3}+Re[y(t)]{3}+O(y(t)){5}. The error signal of the uncompensated and compensated signals is depicted in the left graph of Fig. 4. In the right side of Fig. 4, the phase diagram of the compensated signal is shown. A visible reduction of the non-linearity is achieved. In Table I, a variety of measurements for a combination of R820T2 gain parameters is presented. The gain parameters are chosen to achieve a gain step of approximately 1.57, which is close to 2 dB (V) per gain step.
The third order intercept point can be estimated using the measured data in the following way: a_{IIP3}=baIIP33, therefore a_{IIP3}=b^{−1}. For the measured amplifier settings, b is approximately 10^{−10}, therefore a_{IIP3} can be estimated to be 10^{5} digits. Using the calibration of 1 μV/digit * 1.57^{10−GainValue}, the IIP3 amplitude is 0.1 V * 1.57^{10−GainValue}. Converted to dBm, this results in 29.18 dBm − 3.96 * GainValue dBm. As the data sheet of the R820T is not specific on the dependence of the IIP3 on the gain parameters, this result cannot be compared with the values presented in the data sheet.
B. Characterization of the dynamic range and saturation
In order to test the dynamic range of the receiver, a test signal saturating the receiver approximately by the factor of 2 was chosen. In Fig. 5, the experimental data are displayed. Only approximately 70% of the 16-bit signed integer full range is used. This results in a dynamic range of approximately 11.5 bits for the accessible dynamic range of the 12-bit digitizer.
C. Characterization of the sensitivity
When characterizing the SDR as a lock-in amplifier, two different sensitivity limitations can be observed. With low amplification of the LNA, the noise limit is dominated by the least significant bit digitizer noise of the 12-bit analog digital converter. This noise depends on the sampling rate and the bit rate of the USB interface because the digitizer is physically on the same die as the processor—thus digital noise will be induced by the USB transmission. In Fig. 9, this noise is shown. It is dominant for low amplifications of the LNA and VGA of the tuner. The signal to noise ratio of the receiver is mainly composed out of thermal noise and least significant bit digitizer noise and can be described by the equation
where σ_{Thermal} is the variance of the thermally induced noise and σ_{LSB} is the least significant bit digitizer noise of the digitizer which depends on the resolution of the digitizer and the gain settings of the amplifiers. For high amplification, the LNA amplifies thermally induced noise, which is dominant over the LSB noise. The natural lowest limit in thermal HF noise is given by k_{B}T. For 290 K, this limit is 1.38 × 10^{−23} J/K * 290 K =^ −174 dBm/Hz ≈^4.5×10^{−10} V/Hz.
The measurement is performed by using the RIGOL DSG815 rf-signal generator as calibration and noise source. For the measurement, the signal source was set to a power level of −75 dBm (39.76 μV_{eff}) and a frequency of 400.01 MHz. The tuner was set to a frequency of 400 MHz, which results in an internal local oscillator frequency of 405 MHz and a virtual intermediate frequency of 5 MHz. The processed IQ quadrature signals and its phase diagram are depicted in Fig. 6. In Fig. 7, the spectral noise density of the signal is shown. The spectral noise density was calculated from 20k data points by using a discrete Fourier transform, taking the spectral width of 500 Hz per point into account. By creating a histogram of the amplitude and a histogram of the noise spectral density, the probability density functions of the amplitude noise and the spectral noise density can be displayed. The amplitude noise has a Gaussian distribution with a standard deviation σ of 4.0 μV for a measurement bandwidth of 10 MHz. This is depicted in the left diagram of Fig. 8. The spectral noise density probability distribution is shown in the right plot of Fig. 8. The spectral noise density has a Rayleigh distributed probability density function PDF=xe^{−x22σ2}σ^{2}. The mode σ of the distribution has a value of σ=1.3 nV/Hz which is in good agreement with the standard deviation of the amplitude noise σ_{Rayleigh}=σ_{Gauss}/10MHz. Therefore, the equivalent noise resistance for the input is given by R_{n}=(1.3 nV/Hz){2}/(4kT_{0})=106Ω.
D. Characterization of amplitude and phase noise
Besides the Johnson-Nyquist noise [5,6] of the input, which is observable at high gain and limiting the sensitivity of the lock-in setup, the receiver circuit shows amplitude and phase noise due to the analog-to-digital converter (ADC) noise and PLL-phase and amplitude noise. This can be measured by setting the low noise amplifier and the variable gain amplifier to low gain values and the frequency generator to a higher level. The observed phase noise is then a combination of the PLL-phase noise of the receiver and transmitter circuits, which are assumed to be independent. The amplitude noise which is observed is partly due to in-circuit-noise of the digitizer and voltage noise of the signal source. In Fig. 9, two measurements of a −10 dBm, 400 MHz signal are depicted. In the left diagram, the raw signal amplitude for a sampling rate of 10 Msamples/s is shown and the right diagram shows the raw signal amplitude for a sampling rate of 2.5 Msamples/s. The data of the 12-bit digitizer are distorted by the USB packet transfer of the system. In the case of 10 Msamples/s, it is nearly continuous and in the case of 2.5 Msamples/s, the distortion has an interval of approximately one fifth of the time. In Fig. 10, the resulting statistical probability density plots for the amplitude and phase noise of the signals are shown. The amplitude noise is significantly influenced by the USB transmission of the micro-controller and therefore nearly twice as high for 10 Msamples/s than for 2.5 Msamples/s. The measured variance of the amplitude noise is σ_{2.5Msps} = 8.9 digits and σ_{10Msps} = 14.5 digits which corresponds to one least significant bit of the 12-bit AD converter for 2.5 Msamples/s and two least significant bits for 10 Msamples/s. The smooth distribution in the histogram is due to the DC-offset correction and FIR-filter during computation of the IQ signals. The phase noise is not being influenced by the USB transmission and it is mainly PLL-noise which is not influenced by the noise of the ADC reference. This affects the I and Q signal, which is processed, in a similar way.
E. Measurement of the dependency of the noise on the amplifier settings using a 50 Ω termination resistor
In Secs. III A–III D, the linearity of the receiver system was characterized. Additionally, the dynamic range of 11.5 bits was determined and two sources of noise were identified and measured. A Johnson-Nyquist noise of 4 μV and a digitizer noise of approximately 1 bit were observed. To verify these measurements without the noise induced from an external signal generator, the noise measurement for different amplifier settings was repeated by terminating the input of the receiver with a 50 Ω termination resistor. The measured signal was stored and the standard deviation of the signal was evaluated. The results of this measurement are depicted in Fig. 11. The measured noise level scaled by the gain value is displayed against the gain value. The gain value is approximately 2 dB. The measurement limits are displayed as colored lines in the figure. The 4 μV Johnson-Nyquist limit is displayed as blue line, the least significant bit limit of the digitizer is displayed as yellow line (1 LSB), the 2 LSB limit as green line. The dynamic range limits are displayed as red and purple lines. The best dynamic range without additional signal processing can be achieved at an amplifier value of 16 (approximately 32 dB). The effective number of bits (ENOB) of the digitizer in this setup is between 9.5 and 10 bits. The NXP Semiconductors datasheet states an ENOB of 10.4 bits for the pure digitizer of the microcontroller.
F. Frequency response and bandwidth of the system
There are several ways of bandwidth limiting the measured signal. Noise reduction in lock-in amplifiers is usually achieved by low-pass filtering the mixed signal. This can be realized in this type of setup by using a FIR low pass filter. For the measurement of repetitive signals, another software defined method can be chosen. The demonstrated setup produces synchronous 1 kHz measurement signals by tuning the laser using a PLL locked to the central 10 MHz reference signal. This signal can be averaged several times resulting in a comb filter for the harmonics of 1 kHz with a bandwidth dependent on the number of times of averaging, thus reducing the effective measured noise. An averaging filter with an order of N has a frequency response of 1N∑n=0N−1e^{2πiNfΔT}=(e^{2iNπfΔT}−1)/(N(e^{2iπfΔT}−1)), with the repetition time ΔT. The amplitude response for the averaging filter is therefore ∥sin(NπfΔT)/(N sin(πfΔT))∥. In the presented system, this was realized using a dedicated software based on the supplied development library. It can also be realized using the supplied command line tool “airspy_rx” or powerful software defined packages like GNU-radio. The effect of averaging on measured spectra is discussed in more detail by Werle et_al [19] referencing on Barnes et_al [20]
The system bandwidth limit of the input filter is displayed in Fig. 12. It was measured by tuning the receiver to a fixed frequency of 400 MHz and varying the rf-signal generator in the displayed range. The frequency response shows a filter bandwidth of approximately 10 MHz which is a good aliasing filter for the 20 Msamples/s sampling frequency. Some aliasing effects can be expected for the low frequency limit at 394 MHz.
IV. SPECTROSCOPIC MEASUREMENTS
To demonstrate the capabilities of the software defined lock-in amplifier, a CO FM-spectroscopy setup was build. In Fig. 13, the observable lines are depicted. The shown simulation was done using Hitran spectroscopic data [21,22]. For demonstration of the spectroscopy the R20 at 6406.7 cm^{−1} line of CO was chosen. A 1 m long absorption cell filled with 0.5 bar CO was used in the experiments. For the FM-spectroscopy, a modulation frequency within the bandwidth of the photo-diode is necessary; therefore, a frequency of 400 MHz was chosen for the phase modulation. This enables the measurement of the 2-f FM-spectroscopy signal at 800 MHz within the bandwidth of the 1 GHz photo-diode.
The FM-spectroscopic signal can be described in the following way. The phase modulated electromagnetic wave emitted by the laser system can be described as the real part of
where E_{0}(t) is the temporal electrical field amplitude of the light, J_{n} is the n-th order Bessel function, β is the modulation index, and ω_{m} is the modulation frequency. The transmitted electromagnetic wave can be described with the complex transmission coefficient (e.g., calculated by a Hitran model—Fadeeva function) T(ω) as follows:
The measured power density flow can be expressed by the Poynting vector incident on the photo-diode [23]
By using the lock-in technique at a frequency of ω_{m}, only the case of n − m = ±1 is observed. Therefore the relative intensity on the photo-diode is
This relative signal strength is depicted in the right graph of Fig. 13 for a 400 MHz FM-modulated laser with a modulation depth of β = 1.1. A measurement of the corresponding line using the setup is shown in Fig. 14. The presented measurement was performed using 10 mW of laser power. The damping of the modulator is approximately 3 dB; therefore, 5 mW is transmitted trough the absorption cell. The fiber coupling of the receiver diode is adjusted to achieve an optical power on the fast InGaAs photo-diode below its saturation limit. Taking the a responsivity of 1 A/W and the input impedance R_{input} = 50 Ω into account, an intensity of 0.6 mW (0.64 mW 1 A/W 50 Ω 0.015 = 480 μV) at the detector can be estimated from the measured 490 μV peak signal intensity at 400 MHz. This value is used for the signal to noise estimation. The amplitude and frequency modulation of the laser were fitted and compensated assuming a linear behavior of the laser system. In consequence of the sinusoidal current modulation of the laser, a sinusoidal intensity modulation is expected and can be measured. For the same reason, the laser temperature is modulated in a similar way with a certain phase shift. This results in a sinusoidal wavelength modulation of the laser which is phase shifted to the laser current and intensity modulation. As this wavelength modulation is not necessarily linear, there might be a distortion in the displayed spectrum. To prevent this, a synchronous measurement of the laser wavelength using an etalon as wavelength reference would be favorable. The tuning behavior used in this evaluation is depicted in Fig. 15. At a tuning rate of 1 kHz, a delay between amplitude and frequency tuning of 25 μs was determined, by minimizing the hysteresis effect which is present in the measured data due to the amplitude–frequency delay as presented in the figure.
In order to describe the signal to noise ratio of the system, we follow the ideas presented by Silver [24,25], using the observed shot noise [26,27] and the thermal noise of the system. The shot noise is dependent on the photo-diode I_{Photo} current which is proportional to ∥E_{0}(t)∥^{2}; therefore the signal to noise ratio can be expressed in the following way:
The residual amplitude modulation and excess laser noise are neglected in the above formula. For a laser power of 0.6 mW at the detector, a peak signal current of 9 μA at 400 MHz is generated in the spectroscopic signal. At the bandwidth of 10 MHz, the total noise generated by the Johnson noise and laser shot noise account to an effective noise of 94 nA. This results in a peak SNR of 95:1 for the full bandwidth signal. A shot- and Johnson-Nyquist-noise sensitivity limit of 5×10^{−8}/Hz can be deduced. A type of a floating Allan-variance [28] of the signal can be calculated in the following way:
where N denotes the number of averages of the measured signal, T is the time of one measurement interval, and ⟨⟩ is the temporal floating average of t_{0}.
In Fig. 16, this is shown for the measured spectrum and the pure dark noise of the system. It can be noted that the photo-diode does not seem to increase the Johnson noise significantly compared to a 50 Ohm termination resistor. The dark noise spectrum Allan deviation is calculated for the same 1 kHz repetition rate as the Allan deviation of the spectroscopy signal and decreases with the square root of the number of averages. One thousand averages result in an averaging time of 1 s and increase the signal to noise ratio of the lock-in amplifier by a factor of approximately 31. The measured spectroscopic signal Allan deviation saturates at approximately 100 averages due to a slow spectral drift of the laser or the low finesse etalon effects in the fibers, which is not present in the dark noise Allan deviation. A further improvement of the signal to noise ratio by a factor of approximately 20 can be achieved by bandwidth limiting of the measured signal, which could be achieved using a finite impulse response (FIR) low pass filter limiting the signal to a bandwidth of 20-30 kHz instead of the native system bandwidth of 10 MHz. This would result in a limit of 20-30 harmonics of the comb filter. Low pass filtering would affect the signal form and eventually remove measurable effects like, for example, the low finesse etalon effects in the optical setup, which have a higher spatial frequency than the spectroscopic line. Therefore, the use of such a low pass filter has a slightly different effect on the measured signal than the comb filter. The peak SNR without averaging derived from the measured signal and the initial Allan deviation is 490 μV: 6 μV = 81, which complies well with the theoretical value.
V. CONCLUSIONS
A successful demonstration of a commercially available software defined radio as a lock-in amplifier was performed. For this purpose, the tuner front end and back end were characterized. The sensitivity and non-linearity of the receiver circuit was measured and analyzed. Acquisition of a CO spectral line was demonstrated using FM-spectroscopy with a repetition rate of 1 kHz. This proves the usability of an off-the-shelf SDR as a cheap but powerful lock-in amplifier by adding PLL driven frequency generators. The drawback of the arbitrary initial phase of the used phase locked loops can be either solved by software or hardware measures.
TABLE I. 
Different measured third harmonic and voltage calibrations.
TABLE I. -body
Airspy LinGainValue [18]	LNA gain	Mixer gain	VGA gain	Signal (dBm)	A_{fundamental}	A_{-3rd harmonic}	b	a	V/digit
13	8	5	10	−37	18 033.9	156.485	1.16 × 10^{−10}	17 565	2.543 × 10^{−7}
12	9	0	10	−32	18 951.6	164.933	1.05 × 10^{−10}	18 457	4.304 × 10^{−7}
11	8	0	10	−29	19 156.0	172.466	1.07 × 10^{−10}	18 639	6.020 × 10^{−7}
10	6	1	10	−25	18 082.5	153.58	1.12 × 10^{−10}	17 622	1.009 × 10^{−6}
9	5	0	10	−21	18 753.5	161.963	1.06 × 10^{−10}	18 268	1.543 × 10^{−6}
8	3	0	10	−17	18 727.5	162.011	1.07 × 10^{−10}	18 242	2.449 × 10^{−6}
7	1	2	10	−14	16 536.6	127.907	1.21 × 10^{−10}	16 153	3.906 × 10^{−6}
FIG. 1. 
Schematic of the experimental setup.
FIG. 2. 
Left figure: Temporal plot of the raw quadrature signal of a 400.01 MHz −37 dBm signal with the receiver tuned to 400 MHz. The blue curve is the real part of the signal (I), the yellow curve is the imaginary part of the signal (Q), and the green curve depicts the absolute value of the signal. The measured data are displayed as a raw 16-bit signed integer value. Right figure: First quadrant of the phase diagram of the signal in the imaginary plane. The blue curve shows the measured data; the yellow curve shows a calculated circle.
FIG. 3. 
Frequency density plot in digits/Hz of the compensated (yellow) and uncompensated signals (blue). A reduction of the minus third harmonic by a factor of 3-4 can be observed.
FIG. 4. 
Left figure: Temporal plot of the amplitude error of the 400.01 MHz −37 dBm signal depicted in Fig. 2. The blue curve displays the amplitude error with the third order non-linearity; the yellow curve shows the amplitude error after compensation of the third order non-linearity. Right figure: First quadrant of the phase diagram of the compensated signal in the imaginary plane. The blue curve shows the measured data; the yellow curve shows a calculated circle.
FIG. 5. 
Saturation and dynamic range test of the SDR. The figure shows the IQ signals of a 400.01 MHz frequency signal measured with the receiver tuned to 400 MHz with an amplitude approximately twice the saturation amplitude. The electronics saturates at approximately 70% of the digitizer full scale range. This reduces the digitizer dynamic range to approximately 11.5 bits.
FIG. 6. 
Left figure: Temporal plot of the processed quadrature signal of a 400.01 MHz −75 dBm signal with the receiver tuned to 400 MHz. The blue curve is the real part of the signal (I), the yellow curve is the imaginary part of the signal (Q), and the green curve depicts the absolute value of the signal. Right figure: Phase diagram of the signal in the imaginary plane.
FIG. 7. 
Plot of the spectral noise density of the measured signal displayed in Fig. 6. 20k data points were processed using a discrete Fourier transform. Each data point in the plot has a spectral width of 500 Hz, which was taken into account to scale the plot to nV/Hz.
FIG. 8. 
Plots of the probability density for the noise limit characterization. Left figure: Plot of the probability density of the amplitude noise of the measurement depicted in Fig. 6. The blue curve is a Gaussian distribution with a standard deviation of σ = 4.0 μV and a mean value of μ = 56.2 μV. Right figure: Plot of the probability density of the spectral noise density. The blue curve shows a Rayleigh distribution with σ=1.3 nV/Hz resulting in a mean value of 1.6 nV/Hz.
FIG. 9. 
Measurement of a −10 dBm 400 MHz signal amplitude at different sampling rates of the system. The left diagram shows the raw signal amplitude for a sampling rate of 10 Msamples/s. The right diagram shows the raw signal amplitude for a sampling rate of 2.5 Msamples/s.
FIG. 10. 
Probability density plots of the amplitude (left diagram) and phase (right diagram) of the measurements presented in Fig. 9. The blue data represent the measurements performed with 2.5 Msamples/s and the yellow curves show the data of the measurements performed with 10 Msamples/s. The Gaussian fits for the amplitude have following variances: σ_{2.5Msps} = 8.9 digits, σ_{10Msps} = 14.5 digits. The Gaussian fits for the phase have following variances: σ_{2.5Msps} = 1.9°, σ_{10Msps} = 1.6°.
FIG. 11. 
Measurement of the input noise as a function of the amplification level. The input was terminated using a 50 Ω resistor. The colored lines represent the system limits given by the Johnson-Nyquist noise and the LSB noise of the digitizer.
FIG. 12. 
Frequency response of the receiver system tuned to 400 MHz.
FIG. 13. 
Left figure: Simulated CO absorption spectrum using Hitran data for a 1 m long absorption cell filled with 0.5 bar CO. The blue graph depicts the absorption and the red graph depicts the dispersion. Right figure: Simulated FM-spectroscopy signal for a 400 MHz (0.0133 cm^{−1} = 400 MHz FM-modulated signal with a modulation depth of β = 1.1. The blue graph shows the imaginary part, the red graph shows the real part, and the black curve shows the absolute value of the FM signal strength.
FIG. 14. 
Measurement of the CO line spectrum using the described system. The blue curve is an overlay of 1000 measured spectra, the yellow curve is an average of 100 spectra, and the black curve is a calculated spectrum from Hitran data.
FIG. 15. 
Plot of the tuning behavior of the diode laser at 1 kHz. The amplitude variation showed to be 1.4°=^25μs in advance to the frequency tuning of the laser due to the phase delay of the temperature tuning.
FIG. 16. 
Plots of the Allan deviation of the measured spectra in yellow and the dark noise of the system in blue.

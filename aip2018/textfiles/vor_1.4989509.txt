A comparative study of different methods for calculating electronic transition rates
We present a comprehensive comparison of the following mixed quantum-classical methods for calculating electronic transition rates: (1) nonequilibrium Fermi’s golden rule, (2) mixed quantum-classical Liouville method, (3) mean-field (Ehrenfest) mixed quantum-classical method, and (4) fewest switches surface-hopping method (in diabatic and adiabatic representations). The comparison is performed on the Garg-Onuchic-Ambegaokar benchmark charge-transfer model, over a broad range of temperatures and electronic coupling strengths, with different nonequilibrium initial states, in the normal and inverted regimes. Under weak to moderate electronic coupling, the nonequilibrium Fermi’s golden rule rates are found to be in good agreement with the rates obtained via the mixed quantum-classical Liouville method that coincides with the fully quantum-mechanically exact results for the model system under study. Our results suggest that the nonequilibrium Fermi’s golden rule can serve as an inexpensive yet accurate alternative to Ehrenfest and the fewest switches surface-hopping methods.
I. INTRODUCTION
Nonadiabatic dynamics plays a central role in a variety of important chemical processes that range from redox reactions to photovoltaics [1–12]. The inherently quantum nature of the underlying molecular dynamics makes simulating such processes in complex molecular systems challenging [2,13–21]. One approach for addressing this challenge is based on employing a mixed quantum-classical strategy, where the electronic degrees of freedom (DOF) are treated quantum-mechanically, while the nuclear DOF are treated in a classical-like manner. A variety of such mixed quantum-classical methods has been employed for this purpose over the years. The Ehrenfest method [22], which treats the feedback between electronic and nuclear DOF in a mean-field manner, is arguably the simplest among them. The fewest switches surface-hopping (FSSH) approach [23,24], in its many different implementations [25–34], represents another family of widely used mixed quantum-classical methods that attempt to go beyond the mean-field approximation. A more rigorous approach is based on the mixed quantum-classical Liouville (MQCL) equation [35–39], which can be solved, e.g., via the trajectory-based Sequential Short-Time Propagation (SSTP) [40] or Trotter-Based Surface-Hopping (TBSH) [41] algorithms.
An alternative approach for estimating the rate of nonadiabatic transitions is provided by Fermi’s golden rule (FGR), which is based on treating the electronic coupling within the framework of second-order time-dependent perturbation theory. The equilibrium FGR (E-FGR) allows one to calculate electronic transition rate constants when the system starts out at equilibrium on the donor state and electronic transitions occur on a time scale that is slower than the lifetime of the electronic coupling autocorrelation function [10,42–45]. The nonequilibrium FGR (NE-FGR) extends the applicability of FGR to nonequilibrium initial states and to situations where the above-mentioned separation of time scales is not necessarily valid [46]. Recently proposed implementations of E-FGR and NE-FGR within the framework of the linearized semiclassical (LSC) approximation have given rise to trajectory-based algorithms for calculating E-FGR and NE-FGR electronic transition rates in complex molecular systems [47–51].
In this paper, we present a comprehensive comparison of the four methods, NE-FGR, MQCL, Ehrenfest, and FSSH, for estimating electronic transition rates. To this end, we compare the donor state population relaxation dynamics for the Garg-Onuchic-Ambegaokar (GOA) benchmark charge-transfer model [52], as obtained via these four methods, over a broad range of temperatures and electronic coupling strengths, with different nonequilibrium initial states, in the normal and inverted regimes. In Sec. II, we briefly review the NE-FGR, MQCL, Ehrenfest, and FSSH methods. In Sec. III, we describe the model. Simulation techniques are outlined in Sec. IV. Results are presented and discussed in Sec. V. Conclusions are provided in Sec. VI.
II. THEORY
We consider a two-state system with the overall Hamiltonian Ĥ=H^{0}+H^{I}, where the zero Hamiltonian, H^{0}, and the perturbation, H^{I}, are given by
Here, |D and |A denote the donor and acceptor electronic states (assumed independent of the nuclear DOF), respectively, H^{D∕A} are the corresponding nuclear Hamiltonians,
and Γ^{DA} is the electronic coupling between donor and acceptor states (assumed constant from now on, within the Condon approximation, Γ^{DA}≡Γ_{DA}=ΓAD*). Here, R^=R^{1},…,R^{N} and P^=P^{1},…,P^{N} are the mass-weighted nuclear coordinates and momenta, and V_{D∕A}R^ are the potential energy surfaces (PESs) of the donor (D) and acceptor (A) states.
The system is assumed to start out at the donor electronic state with the nuclear DOF described by the density operator ρ^{D}(0),
The donor state population at time t>0 is then given by
where Tr[⋯]=Tr{N}Tr{e}[⋯] denotes the trace over both nuclear (N) and electronic (e) Hilbert spaces. The different methods described below aim at employing a mixed quantum-classical approach to evaluate P_{D}(t) in complex molecular systems.
A. Nonequilibrium Fermi’s golden rule
The NE-FGR approach is based on the assumption that the electronic coupling term, H^{I}, constitutes a small perturbation in comparison to the zero Hamiltonian, H^{0}. Within the framework of second-order perturbation theory, the time evolution operator in the interaction picture is given by [53]
where exp_{+} stands for positively time-ordered exponential, and the perturbation operator in the interaction picture is given by
Substituting Eq. (6) and exp(−iĤt∕ℏ)=exp(−iH^{0}t∕ℏ)U^{I}(t) into Eq. (5), we obtain
Next, inserting Eq. (7) into Eq. (6) and truncating the expansion after the second-order term lead to the following approximate expression for P_{D}(t) [46]:
where the time-dependent rate coefficient k(t^{′}) is given by
Here,
The NE-FGR, Eq. (10), is based on treating the nuclear DOF fully quantum-mechanically. As such, its use is limited to the very few model systems where exact fully quantum-mechanical real-time dynamics is accessible. Thus, from the point of view of computational feasibility and tractability, it is highly desirable to formulate an approximate NE-FGR which would be based on treating the nuclear DOF in a classical-like manner. However, doing so in a self-consistent manner is nontrivial since the τ-dependence of C(t^{′},τ), Eq. (11), lacks a well-defined classical limit [48]. The LSC approximation [47,48] provides a rigorous approach for obtaining a uniquely defined classical-like expression for C(t^{′},τ) [49,51],
Here,
The evaluation of C^{LSC}(t^{′},τ) calls for sampling initial nuclear coordinates and momenta, (R_{0}, P_{0}), based on the Wigner phase-space density of ρ^{D}(0), ρ^D(0){W}(R_{0},P_{0}), followed by propagating classically forward in time on the donor PES, V_{D}(R), from time 0 to time t^{′}, and then backward in time on the average PES, V_{av}(R) = [V_{D}(R) + V_{A}(R)]/2, from time t^{′} to time t^{′}−τ. ∫t^{′}t^{′}−τdtU(Rtav) is evaluated during the t^{′}→t^{′}−τ segment of the trajectory, where U(R_{t}) = V_{D}(R_{t}) − V_{A}(R_{t}) is the instantaneous potential energy gap between the donor and acceptor states. C^{LSC}(t^{′},τ) is then obtained by averaging exp−iℏ∫t^{′}t^{′}−τdtU(Rtav) over a large number of trajectories until a converged average is obtained.
B. Mixed quantum-classical Liouville dynamics method
The derivation of the MQCL equation [37,54] starts out by performing a partial Wigner transform of the overall (electronic+nuclear) density operator, ρ^(t), with respect to the nuclear DOF,
It should be noted that ρ^{W}(R,P,t) is an operator in the electronic DOF and a classical-like phase-space distribution in the nuclear DOF. The MQCL equation is then obtained by expanding the exact equation of motion for ρ^{W}(R,P,t) to first order in m_{e}/M_{N}, where m_{e} and M_{N} are the electronic and nuclear masses, respectively,
Here, the square brackets ⋅,⋅ represent the commutator, the curly braces {⋅,⋅} denote the classical Poisson bracket, H^{W} is the partial Wigner transform of the overall Hamiltonian [Eq. (1) + Eq. (2)], and iL is the quantum-classical Liouville operator
The MQCL equation is given in an operator form in Eq. (15) and is therefore representation-independent. In practice, it is convenient to rewrite it in a matrix form that depends on the choice of a basis for the Hilbert space of the electronic DOF. To this end, the adiabatic basis is a convenient choice. The adiabatic basis vectors, {|α;R}, are defined as the eigenstates of the electronic Hamiltonian,
Within the adiabatic representation, −iL is given by an Ne2×Ne2 matrix (N_{e} is the dimension of the electronic DOF Hilbert space). The corresponding matrix element is given by
Here, δ(α,β) is the Kronecker delta, ω_{αβ}(R)=(E_{α}(R)−E_{β}(R))∕ℏ≡ΔE_{αβ}∕ℏ, iL_{αα^{′}} is a classical-like Liouville operator
where
and
where S_{αβ}=ΔE_{αβ}d_{αβ}Ṙ⋅dαβ{−1} and d_{αβ}=α;R|∂∕∂R|β;R. Importantly, J_{αα^{′},ββ^{′}} accounts for nonadiabatic transitions.
Several trajectory-based numerical algorithms for solving the MQCL equation in the adiabatic representation have been proposed. The TBSH algorithm is arguably the most accurate and numerically stable to date [41]. Within TBSH, the expectation value of an overall system operator, Â, at time t_{N}=NΔt, where Δt is the time step, is given by
Here, the prefactor Ne2 arises from the uniform sampling over all initial quantum states, (α_{0}β_{0}), κ denotes the trajectory index and results are averaged over N_{traj} trajectories. To simplify the notation, the quantum state of trajectory κ at the jth time step (αβ)jκ is replaced by a single index sjκ=αjκN_{e}+βjκ and at j = 0 by s̃0κ=β0κN_{e}+α0κ, respectively. The quantity W_{sj}(t_{j},t_{j}+Δt∕2)=expi∫tt+Δt∕2dτω_{sj}(R_{sj}(τ)) stands for the phase factor and R_{sj}(τ) are the coordinates of the classical DOF at time τ. Finally, Q_{1} is the matrix of transition probabilities and M is the matrix containing the momentum shifts for every pair of quantum states. Expressions for Q_{1} and M can be found in Ref [41].
Evaluation of Eq. (22) involves Monte Carlo sampling of the initial quantum state of the system, s̃{0}=β_{0}N_{e}+α_{0}, and classical DOF, (R_{0}, P_{0}), adiabatic propagation for a half-time step e^{iLs̃0Δt∕2}(R,P)→(R^{′},P^{′}), and a hopping attempt to another quantum state s_{1}=α_{1}N_{e}+β_{1} with probability |Q1{s̃0s1}Δt|∕|∑_{s}Q1{s̃0s}Δt|. If the kinetic energy along the direction of coupling vector d_{αβ} is sufficient, a momentum jump is performed, (R^{′},P^{′})→(R^{′},P^{′}+ΔP_{αβ}), with
where d¯{αβ}=d_{αβ}∕|d_{αβ}|. Following this, the classical DOF are propagated for the second half-time step, e^{iLs1Δt∕2}(R^{′},P^{′}+ΔP_{αβ})→(R^{″},P^{″}). The procedure is then repeated for N−1 time steps.
C. Ehrenfest and fewest switches surface-hopping methods
The Ehrenfest and FSSH methods are two other commonly used mixed quantum-classical methods [55]. For both methods, one starts out by assuming that the nuclear DOF can be treated classically, while the electronic DOF are treated quantum-mechanically. The nuclear DOFs follow a yet to be specified classical trajectory, {R(t), P(t)} (see below). The dynamics of the electronic DOF is governed by an explicitly time-dependent quantum-mechanical Hamiltonian, which coincides with h^{W}[R(t)] [see Eq. (17)]. The time-dependence of the electronic Hamiltonian originates from the coupling between the nuclear and electronic DOF, through the time-dependence of the classical nuclear coordinates, R(t).
Assuming that the initial electronic state is pure (e.g., |D for the case considered in this paper) and therefore can be described as a ket, |ψ(0), the electronic state at time t is also given by a ket, |ψ(t), which is obtained by solving the following electronic time-dependent Schrödinger equation:
Within the Ehrenfest and FSSH methods, initial conditions of the nuclear DOF, {R(0), P(0)}, are sampled from an initial phase-space probability density. Different choices of initial conditions result in different realizations of the nuclear trajectory, R(t), and therefore give rise to an ensemble of different independent nuclear trajectories, {R^{κ}(t)}. This in turn will give rise to an ensemble of time-dependent electronic Hamiltonians, {h^{W}[R^{κ}(t)]}, and thereby an ensemble of different electronic states at time t, {|ψ^{κ}(t)}. The expectation value of any observable quantity, Â, is then obtained by ensemble averaging over independent trajectories
Here, A^{W}[R,P] is the partial Wigner transform of Â with respect to the nuclear DOF (an electronic operator which depends parametrically on the nuclear phase-space variables). The independent trajectory approximation is made for both the Ehrenfest and the FSSH methods, throughout the manuscript. Alternative approaches that include cross talk between trajectories have been proposed but are beyond the scope of this paper (e.g., Ref [56]). Thus, all quantities depending on R^{κ}(t) and P^{κ}(t), respectively, are evaluated along single trajectories. For readability, we drop the trajectory index κ in the following.
In practice, the electronic ket, |ψ(t), is represented in terms of a basis of one’s choice, {|ϕ_{a}[R(t)]},
The basis states may or may not be R-dependent. Furthermore, the R-dependence does not need to be the same as that of the adiabatic basis states (i.e., eigenstates of h^{W}[R]) [57]. Within the {|ϕ_{a}[R(t)]} basis representation, the electronic time-dependent Schrödinger equation, Eq. (24), is given by
It should be noted that when the basis is adiabatic, the first term on the R.H.S. of Eq. (26) becomes diagonal (ϕ_{b}|h^{W}|ϕ_{a}=δ(a,b)ϕ_{a}|h^{W}|ϕ_{a}), while the second term becomes purely off-diagonal (ϕ_{b}|ϕ̇{a}=[1−δ(a,b)]ϕ_{b}|ϕ̇{a}) and accounts for nonadiabatic transitions. In contrast, when the basis is R-independent, the second term on the R.H.S. of Eq. (26) vanishes and the first term gives rise to nonvanishing diagonal and off-diagonal contributions [23].
The fundamental difference between the Ehrenfest and the FSSH methods is the way the classical nuclear trajectories, {R(t), P(t)}, are generated. Within the Ehrenfest method, {R(t), P(t)} are obtained via the mean-field approximation, i.e., by assuming that the classical-like force is given by F^{MF}(t)=−ψ(t)∂h^{W}∂Rψ(t). Note that for each trajectory, |ψ(t) is the full electronic state vector so that each trajectory’s F^{MF}(t) becomes independent of the chosen electronic basis. Thus, the dynamics of the nuclear DOF are governed by the following classical-like equations of motion:
Within FSSH, the nuclear DOF are subject to a classical-like force which is dictated by one of the basis functions, the so-called active state a, FaSH(t)=−ϕ_{a}[R(t)]∂h^{W}∂Rϕ_{a}[R(t)] so that the dynamics of the nuclear DOF are governed by the following classical-like equations of motion:
Which basis function is used at a given time is determined by a stochastic algorithm that allows for hopping between electronic states as a function of time. The stochastic algorithm is set up so that the fraction of trajectories that employ the state |ϕ_{a} at time t, n_{a}(t)/N_{traj}, are equal to the electronic population of this state, |c_{a}(t)|^{2}, as obtained from solving the electronic time-dependent Schrödinger equation [23,58]. This is achieved by assuming that the transition probability at time t from electronic state |ϕ_{a} to electronic state |ϕ_{b} is given by
Here, Δt is the time step used for propagating the nuclear DOF,
and Θ(x) is the Heaviside function Θ(x<0)=0 and Θ(x≥0)=1, which guarantees positivity of the transition probability. It should be noted that the first term in Eq. (30) vanishes when the adiabatic basis is used, whereas the second term vanishes when using an R-independent basis.
In practice, a random number ζ∈[0,1] is generated from a uniform distribution at each point in time. A hop changing the current active electronic state, |ϕ_{a}, to a different state, |ϕ_{b}, only takes place if the following condition is satisfied:
Within FSSH, a hopping event between electronic states is typically accompanied by a change in the nuclear momenta (so-called momentum adjustment). This appears to be based on the somewhat ad-hoc expectation that energy needs to be conserved along individual nuclear trajectories. However, it should be noted that a surface hopping scheme that avoids this constraint was recently proposed in Ref [56]. However, if energy conservation is imposed, the corresponding shift in the kinetic energy needs to compensate for the change in the potential energy. When the adiabatic representation is used, it was argued that the momentum adjustment to each of the nuclear DOF needs to be proportional to the projection of the nonadiabatic coupling vector, d_{ab}≡ϕ_{a}(R)|∂∂R|ϕ_{b}(R), onto this DOF [58]
where γ is dictated by the above-mentioned energy conservation.
When a representation in terms of an R-independent basis is used, it was proposed that the momentum adjustment is introduced via a uniform velocity rescaling [59,60]
Finally, we note that if energy is to be conserved along individual trajectories, a hop to an energetically higher state can only occur if sufficient classical kinetic energy is available. Otherwise, the transition needs to be aborted. In the case of such frustrated hops, some recent studies proposed a partial momentum reversal [61,62]. However, we found that such modifications have a negligible effect on the results presented below. Hence, in the results reported below, the momentum remains unchanged during frustrated hops, in accordance with earlier studies [63].
In this paper, both basis schemes are examined, i.e., active surfaces are either given by R-independent states {D, A} (FSSH-D) or by adiabatic states {g, e} (FSSH-A), respectively. The quantities of interest in this paper are populations of R-independent states. Since the calculation of R-independent state populations from adiabatic active states is ambiguous [64–66], we report in the following only population measures based on wavefunction coefficients as detailed in Sec. IV. A brief discussion about alternative population measures can be found in the Appendix.
III. MODEL SYSTEM
The main goal of this paper is to provide a comprehensive comparison between NE-FGR, MQCL, Ehrenfest, and FSSH by evaluating the corresponding predictions of the donor state population relaxation dynamics within the GOA benchmark charge-transfer model [52]. The GOA model has been used extensively in recent years for benchmarking numerous approximate methods for describing quantum dynamics [1,10,46,48–50,54,61,65,67–85]. However, a similar benchmarking has not been previously reported to the best of our knowledge.
The overall Hamiltonian of the GOA model is given by [52]
Here, σ^{x}=|DA|+|AD| and σ^{z}=|DD|−|AA|, where |D and |A are the (R-independent) donor and acceptor electronic states; Γ_{DA}=Γ_{AD} is the electronic coupling coefficient (constant within the Condon approximation); −ℏω_{DA} is the donor-to-acceptor reaction energy; y, P_{y}, and Ω are the primary mode mass-weighted coordinate, momentum, and frequency, respectively; {x_{i},p_{i},ω_{i}} are the mass-weighted coordinates, momenta, and frequencies of the N − 1 secondary bath modes, respectively; {c_{i}} are the coupling coefficients between the secondary modes and the primary mode; 2y_{0} is the shift in equilibrium geometry of the primary mode between the donor and acceptor states such that the reorganization energy is given by
The spectral density of the secondary modes is given by
Here, η is the friction coefficient, which determines the coupling strength between the primary mode and secondary modes, and ω_{c} is the cutoff frequency.
The initial state is obtained by shifting the donor thermal equilibrium state by s along the primary mode coordinate
where Z_{D} is the donor-state partition function and k_{B}T is the temperature with the Boltzmann constant k_{B}.
The fact that the primary and secondary modes are harmonic and bilinearly coupled implies an equivalent form of the GOA Hamiltonian in terms of the corresponding normal modes. The latter are obtained by diagonalizing the Hessian matrix,
such that T^{T}DT=diag(ω̃12,…,ω̃N2), with the normal mode frequencies ω̃{j} and T being the unitary diagonalizing transformation matrix. It should be noted that the normal modes are obtained via numerical diagonalization of the Hessian matrix rather than by using the asymptotic effective spectral density, which is only known in closed form in the limit Ω<<ω_{c} [86].
The donor and acceptor nuclear Hamiltonians in terms of normal modes are given by
Here, {R_{j},P_{j},ω̃{j}} are the normal mode coordinates, momenta, and frequencies, respectively, and {Rjeq} are the donor-to-acceptor shifts in equilibrium geometry along the normal mode coordinates,
The same set of normal mode coordinates and momenta is used for all methods in this study.
The initial state in terms of normal modes is given by
where out-of-equilibrium shifts S_{j} are given by
The fully quantum-mechanical correlation function required in the NE-FGR approach, Eq. (11), can be derived for the GOA model in closed form [49]
It should be noted that the LSC approximation for the NE-FGR, Eq. (12), has been recently shown to coincide with the fully quantum-mechanical result, Eq. (43), for the GOA model [49].
MQCL, Ehrenfest, and FSSH calculations on the GOA model were performed in the normal mode representation so that both the primary and the secondary nuclear modes are treated as classical-like. It should be noted that the MQCL equation is known to reproduce the exact fully quantum-mechanical dynamics when the quantum system is bilinearly coupled to a harmonic bath, such as the GOA model considered here [87]. Although MQCL is formally exact for this system, the TBSH algorithm invokes the momentum jump approximation [37,54]. However, provided, a sufficiently large number of trajectories are used, this approximation has been observed to have almost negligible effect on the density matrix evolution [38,54,87].
IV. SIMULATION DETAILS
Dimensionless variables were used throughout such that energy and time are given in units of ℏω_{c} and ωc−1, respectively. The primary mode was chosen to have a frequency of Ω∕ω_{c}=0.5 and an equilibrium displacement of 2y_{0}=2, resulting in a reorganization energy of E_{r}∕ω_{c}=0.5. Two values of the donor-to-acceptor reaction energy were considered: ω_{DA}∕ω_{c}∈{0,2}, corresponding to the normal (ℏω_{DA}<E_{r}) and inverted (ℏω_{DA}>E_{r}) regimes, respectively (see Fig. 1). Three different values of electronic coupling were examined, Γ_{DA}∕ℏω_{c}∈{0.05,0.1,0.2}, ranging from weak to strong coupling, where we classified the strength retrospectively by its ability to cause significant deviations between the FGR approach and the MQCL reference method (see below). Three different temperatures, k_{B}T∕ℏω_{c}∈{0.2,0.5,1} (low to high), and four different nonequilibrium initial states, sω_{c}∕ℏ∈{−1,1,3,5} [see Eq. (37)], were considered. For an analysis of NE-FGR under initially equilibrated conditions, we refer the reader to Ref [49]. The calculations reported below were performed with 200 secondary bath modes sampled from an Ohmic spectral density with η∕ℏ=1.0 and a maximum frequency of 15ω_{c}. For the sake of clarity, we set ℏ=1 and ω_{c}=1 in the following.
The initial partially Wignerized density operator ρ^{W}(R,P,t=0) is given by
ρb,Weq(R,P) is given as a product of N Wigner-transformed harmonic oscillator density operators, Eq. (41), where each DOF is shifted by S_{j} given by Eq. (42).
In MQCL simulations, the time-dependent population of the donor state was calculated using the TBSH algorithm, Eq. (22), with AWαα^{′}(R)=α;R|DD|α^{′};R. All TBSH results presented in this work were obtained by averaging over 5 ×10^{8} trajectories. Error bars were generated by performing five independent stochastic TBSH simulations and calculating the standard deviations of these groups from the combined average. Additionally, we verified that converged results can be obtained with a time step of Δt=0.01. It should be noted that techniques for improving convergence, such as transition filtering or observable cutting [88–92], were not employed. In the following, the term MQCL refers synonymously to this implementation of the TBSH algorithm.
In Ehrenfest and FSSH simulations, initial conditions are the same as for MQCL simulations [see Eq. (44)], where only the donor state is initially populated, c_{D}(0) = 1 and c_{A}(0) = 0. Nuclear DOF are obtained by sampling from the distribution provided in Eq. (41). The step size is Δt=0.01 and results reported were obtained by averaging over 10^{5} trajectories. For the Ehrenfest method, donor state populations are unambiguously defined by P_{D}(t) = |c_{D}(t)|^{2}. For the FSSH-D method in the R-independent basis, donor state populations can be determined either via P_{D}(t) = |c_{D}(t)|^{2} or from the fraction of trajectories with the donor state currently being the active state, P_{D}(t) = n_{D}/N_{traj}. It was verified that both ways give the same populations. However, in Sec. V only coefficient-based populations are shown for clarity. For the FSSH-A method in the adiabatic basis, donor state coefficients are obtained via the unitary transformation matrix: c_{D}(t) = U_{Dg}(t)c_{g}(t) + U_{De}(t)c_{e}(t), where U_{Dα}(t)=D∣α(t) with the adiabatic electronic state α(t)∈{g[R(t)],e[R(t)]}. Populations obtained from active state trajectory counts are discussed in the Appendix.
V. RESULTS AND DISCUSSION
In this section, we compare donor state population relaxation profiles under different conditions, for the GOA model, as obtained from NE-FGR, MQCL, Ehrenfest, FSSH-D, and FSSH-A. Figures 3(a)–3(d) show the comparison in the normal regime, ω_{DA}=0, for the different nonequilibrium initial conditions illustrated in Fig. 1(a). Figures 4(a)–4(d) show the comparison in the inverted regime, ω_{DA}=2.0, for the different nonequilibrium initial conditions illustrated in Fig. 1(b). In each figure, we present results obtained at three different temperatures, k_{B}T∈{0.2,0.5,1.0}, and for different electronic coupling strengths that range from weak, Γ_{DA}=0.05, through moderate, Γ_{DA}=0.1, to strong, Γ_{DA}=0.2.
We start by considering the results in the normal regime [see Figs. 3(a)–3(d)]. We first note that the convergence of the TBSH algorithm (MQCL) improves with increasing electronic coupling. This trend can be traced back to the fact that the MQCL simulations are performed in the adiabatic representation. Strong electronic coupling between donor and acceptor states implies weak coupling between the corresponding adiabatic states, which in turn leads to fewer hops within the TBSH algorithm used to solve the MQCL equation (see Fig. 2). The reduced number of hops results in a better convergence and thus smaller error bars. Importantly, MQCL and NE-FGR appear to be complementary in terms of their ability to deal with different electronic coupling strengths. More specifically, while converging, the MQCL becomes more challenging as the electronic coupling between donor and acceptor becomes weaker, NE-FGR becomes increasingly more accurate. This suggests adopting a cost-effective strategy where MQCL is replaced with the significantly less costly NE-FGR at weak electronic coupling.
We next consider the agreement between the four methods: MQCL, NE-FGR, Ehrenfest, and FSSH. In the normal regime, all methods agree with each other at short times (t≲4) but start deviating from one another at longer times. The deviations between the different methods diminish with increasing temperature, which is consistent with the fact that a classical description of the nuclear DOF becomes more valid with increasing temperature.
With the exception of the nonequilibrium shift being s = −1 [Fig. 3(a), corresponding to starting in the crossing point between donor and acceptor PESs, see Fig. 1], NE-FGR is seen to be in excellent agreement with MQCL for the weak and intermediate electronic couplings, Γ_{DA}=0.05 (upper rows) and 0.1 (middle rows). As expected, significant deviations between NE-FGR and MQCL emerge for strong electronic coupling, Γ_{DA}=0.2 (lower rows). Notably, NE-FGR underestimates the donor state population at strong electronic coupling. This may seem surprising at first glance in light of the fact that NE-FGR is based on assuming that the electronic coupling is weak, thereby underestimating the number of electronic transitions. However, a closer inspection reveals that the fact that NE-FGR yields higher population relaxation rates can be traced back to its inability to account for population backflow from the acceptor state to the donor state [42,72]. The inability of NE-FGR to account for backflow is also manifested by the asymptotic equilibrium populations. More specifically, while detailed balance dictates that P_{D}(t)→0.5 at long times when ω_{DA}=0, the lack of backflow within NE-FGR leads to P_{D}(t)→0 at long times. As a result, NE-FGR becomes unreliable as P_{D}(t) gets close to 0.5.
In the case of s = −1, NE-FGR overestimates the donor population in comparison to MQCL, with the deviations between the two becoming larger with decreasing electronic coupling. Those trends can be traced back to the fact that the initial state in this case is centered around the crossing point between the donor and acceptor PESs [see Fig. 1(a)]. The resonance between the donor and acceptor implies that the coupling between them cannot be considered weak even when Γ_{DA}=0.05. Since NE-FGR is based on treating the donor-acceptor coupling as a small perturbation, it therefore underestimates the population relaxation rate in this case. The effect is seen to diminish with increasing electronic coupling presumably because it is being compensated by backflow.
The importance of the backflow can be estimated from the relative numbers of acceptor-to-donor transitions in FSSH-D. For ω_{DA}=0,s=1,k_{B}T=1, in the intermediate coupling case [Fig. 3(b), middle-right panel], 21.7% out of 3035 hops correspond to backflow, while in the strong coupling case (bottom-right), 25.9% out of 8333 hops correspond to backflow.
The FSSH methods and the Ehrenfest approach are seen to yield very similar predictions, and both slightly underestimate the population relaxation rates in all cases. In general, this deviation is found to be marginally more pronounced in the adiabatic surface-hopping formulation, FSSH-A, than in the diabatic FSSH-D method, with the exception of the s = −1 case, where trajectories start in the nonadiabatic coupling region. In the weak coupling case with Γ_{DA}=0.05, which corresponds to strong nonadiabatic coupling, see Fig. 2, further irregularities arise with FSSH-A at early times when trajectories far from equilibrium configurations are used, i.e., s = 3, 5 [Figs. 3(c)–3(d), upper panels].
Next, we consider the results in the inverted regime with ω_{DA}=2 [see Figs. 4(a)–4(d)]. Population relaxation in the inverted regime is considerably slower compared to the normal regime and exhibits a step-like substructure. It should also be noted that larger nonequilibrium shifts increase the probability of reaching the vicinity of the crossing point between the donor and acceptor PESs. As a result, population relaxation is faster for s = 3, 5 than for s = 1, −1.
NE-FGR and MQCL are in good agreement when the electronic coupling is weak. The agreement remains reasonable for stronger electronic coupling. However, on longer time scales, NE-FGR overestimates the population relaxation rate. Thus, NE-FGR yields a slightly faster population relaxation rate, and more so with increasing electronic coupling. As in the normal regime, this trend can be traced back to the inability of NE-FGR to account for backflow. This interpretation is consistent with the hopping statistics in FSSH-D, which agrees rather well with the MQCL approach. For example, for ω_{DA}=2, s = 1, k_{B}T = 1, and Γ=0.1 [Fig. 4(b), middle-right panel], 33.4% out of the 1967 hops correspond to backflow. This shows that, despite a lower total number of transitions, in the inverted regime, backflow actually plays a bigger role. FSSH-D and Ehrenfest are seen to yield very similar predictions, and both slightly underestimate the population relaxation rates in all cases. FSSH-A, however, yields even lower transition rates in all cases and shows some irregularities in the case of strong nonadiabatic coupling (Γ_{DA}=0.05) and large out-of-equilibrium shifts (s = 3, 5), see Figs. 4(c)–4(d), upper panels.
VI. CONCLUDING REMARKS
In this work, we compared four different methods (NE-FGR, MQCL, Ehrenfest, and FSSH) for calculating electronic transition rates. The comparison was performed on the GOA model for donor-to-acceptor photo-induced charge transfer, over a wide electronic coupling and temperature range, in both the normal and the inverted regimes.
The results demonstrate that all four methods yield rather similar results over a wide parameter range. This suggests that NE-FGR, which is arguably the most cost-effective of the four methods, may be the method of choice in many cases of practical interest. In fact, at low temperatures, NE-FGR often yields somewhat better results than the more computationally demanding FSSH and Ehrenfest methods. However, the perturbative nature of NE-FGR also implies that it is less reliable when population backflow from the acceptor state to donor state becomes significant. This is generally the case, (1) if electronic coupling is large, (2) if the system remains within the coupling region over a long period, or (3) if the overlap between donor and acceptor state nuclear wavefunctions is large, which is more common in the inverted regime. It should be noted that NE-FGR still performs reasonably well at short times in the presence of strong electronic coupling. It should also be noted that NE-FGR and MQCL are complementary in the sense that NE-FGR works best in the weak electronic coupling limit, where the more accurate TBSH algorithm (MQCL) is hard to converge.
To conclude, NE-FGR is capable of capturing the effect of nonequilibrium initial conditions and provides reasonably accurate results at a significantly lower computational cost than MQCL, FSSH, and Ehrenfest. We want to stress that all the methods under consideration in this paper are not limited to bilinearly coupled harmonic nuclear degrees of freedom. A comparison of the impact of anharmonicity on the accuracy of various methods in the context of more realistic molecular model systems would be highly desirable. Studies along those lines are underway in our groups and will be reported in future publications.
APPENDIX: DIABATIC STATE POPULATIONS IN FSSH
In the Ehrenfest method, classical equations of motion are governed by basis-independent forces given by a quantum average, see Eq. (27). In contrast, in FSSH methods, Eq. (28), only a single quantum state at each point in time along a trajectory is used, thus introducing a basis-dependence. Commonly, the adiabatic basis is chosen for two reasons: (1) This representation often yields more localized coupling regions which conform to the FSSH concept of performing a minimal number of hops between states, (2) because of a straightforward energy redistribution scheme based on the nonadiabatic coupling vector, see Eq. (32) [23].
However, obtaining diabatic state populations becomes a non-trivial task when FSSH is implemented in the adiabatic representation. One method is to weigh each trajectory by its active state contribution to the diabatic state. More specifically, for each trajectory, a donor state population of P_{D}=|U_{Dα^{′}}|^{2} is obtained, where α^{′}∈{g,e} is the current active state and U[R(t)] is the unitary adiabatic-to-diabatic transformation matrix [65]. Neglecting the contribution of the non-active state, however, yields erroneous results whenever the electronic coupling is non-zero, which is in the present case the entire configuration space. This deficiency becomes apparent for fully (un)occupied diabatic state populations, which cannot be reproduced, since 0<U_{Dα^{′}}<1 for Γ_{DA}≠0. Furthermore, the vectorial momentum adjustment scheme in the adiabatic framework, Eq. (32), is more restrictive than the one used in the diabatic scheme, Eq. (33), resulting in a higher number of frustrated hops. This violates the internal consistency condition, i.e., the fraction of trajectories with active states α^{′}, n_{α^{′}}(t)∕N_{traj}, should correspond to |c_{α^{′}}(t)|^{2} (which is maintained in the diabatic case) and yield an underestimated donor state population.
On the other hand, the coefficient-based population measure, used in Sec. V, slightly overestimates these populations. These observations are in agreement with Ref [65], where a hybrid measure based on the mixed quantum-classical density matrix was proposed by interpolating between the two methods. In this approach, the donor state population for each trajectory with active state α^{′} is given by
Figure 5 shows a comparison between the donor state population measures within the diabatic framework (FSSH-D), i.e., coefficient-based and active-state-based, and within the adiabatic framework (FSSH-A), i.e., coefficient-based, active-state-based, and the hybrid approach. As previously stated, internal consistency is maintained in the diabatic approach, whereas the three adiabatic methods show significant differences from each other. For large non-equilibrium shifts, s = 5 (right panel), high velocities are obtained yielding large hopping probabilities to change the active surface, which cannot return due to the energy-conservation restriction. The hybrid approach is found to correctly reproduce the initial population but quickly approaches the active-surface counts. The same trends are confirmed for different temperatures k_{B}T and coupling values Γ_{DA} in the normal and the inverted regimes. We want to emphasize that the analysis presented in this work is based on the standard FSSH approach [23,58] without decoherence corrections. We conclude that at least for the parameter space under consideration here, working within the diabatic representation is advantageous compared to working within the adiabatic representation since it provides an unambiguous diabatic state population measure, maintains internal consistency, and shows in general a better agreement with the reference method, MQCL.
FIG. 1. 
Four nonequilibrium initial states of s∈{−1,1,3,5} (orange) are considered in the (a) normal (ω_{DA}=0.0) and (b) inverted (ω_{DA}=2.0) regions. The donor (red) and acceptor (blue) PESs are plotted along the GOA model’s primary mode coordinate with a frequency of Ω=0.5 and an equilibrium displacement of 2y_{0}=2.
FIG. 2. 
Schematic illustrations of the weak (small Γ_{DA}, upper panel) and strong (large Γ_{DA}, lower panel) diabatic coupling regimes corresponding to the cases where transitions between adiabatic states and between diabatic states dominate, respectively. Here, the potential energy surfaces of the diabatic donor (“D,” red) and acceptor (“A,” blue) states are the same, but different diabatic coupling strengths determine the shapes of the adiabatic potential energy surfaces, i.e., the ground state (“g,” black) and the excited state (“e,” cyan).
FIG. 3. 
Comparison of donor state population in the normal region, ω_{DA}=0, calculated using NE-FGR (red, solid line), MQCL (grey, shaded area), Ehrenfest (green dashed line), and surface-hopping dynamics in diabatic (FSSH-D, blue line with triangles) and adiabatic basis (FSSH-A, orange line with circles), as a function of time t, temperature k_{B}T, and electronic coupling Γ_{DA} with initial nonequilibrium shifts of the primary mode of s = −1 (a), s = 1 (b), s = 3 (c), and s = 5 (d). The error bars of the TBSH algorithm for MQCL represent the standard deviation from the mean value of five independent TBSH calculations. All units are given in terms of the cutoff energy ω_{c}.
FIG. 4. 
Comparison of donor state population in the inverted region, ω_{DA}=2, calculated using NE-FGR (red, solid line), MQCL (grey, shaded area), Ehrenfest (green dashed line), and surface-hopping dynamics in diabatic (FSSH-D, blue line with triangles) and adiabatic basis (FSSH-A, orange line with circles), as a function of time t, temperature k_{B}T, and electronic coupling Γ_{DA} with initial nonequilibrium shifts of the primary mode of s = −1 (a), s = 1 (b), s = 3 (c), and s = 5 (d). The error bars of the TBSH algorithm for MQCL represent the standard deviation from the mean value of five independent TBSH calculations. All units are given in terms of the cutoff energy ω_{c}.
FIG. 5. 
Donor state populations P_{D}(t) can be obtained in FSSH-D (blue) and FSSH-A (orange) either from quantum coefficients (solid lines) or from active surfaces (dashed lines). For FSSH-A, a hybrid approach (dotted) was proposed [65]. Results are compared with the MQCL approach (gray). The parameters are set to ω_{DA}=2, k_{B}T = 0.5, Γ_{DA}=0.2, and s = 1 (left) and s = 5 (right), respectively.

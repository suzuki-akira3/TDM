Synchronization and equitable partitions in weighted networks
The work presented in this paper has two purposes. One is to expose that the coupled cell network formalism of Golubitsky, Stewart, and collaborators accommodates in a natural way the weighted networks, that is, graphs where the connections have associated weights that can be any real number. Recall that, in the former setup, the network connections have associated nonnegative integer values. Here, some of the central concepts and results in the former formalism are present and applied to the weighted setup. These results are strongly associated with the existence of synchrony subspaces and balanced relations. This work also makes the correspondence between the concepts of synchrony subspace and balanced relation with those of cluster of synchrony and equitable partition, respectively, which are used in the other strand of literature. This correspondence implies that the results of these two strands of literature are linked. In particular, we remark that the results stated here for weighted coupled cell networks apply in that other strand of literature, and examples are given to illustrate that.
I. Introduction
In the coupled cell network formalism of Golubitsky, Stewart, and collaborators [11,12,20], the networks are directed graphs that abstract interacting dynamical systems: the nodes (cells) represent individual dynamical systems and the directed edges the interactions (See also Ref [9].) The formalism is motivated by the profusion of real world applications that can be modelled through networks of dynamical systems—the coupled cell systems. See, for example, Ref [18]. In this formalism, the network connections have assigned nonnegative integer values. Still, frequently, in a wide range of scenarios, as for example, social and biological systems, it is natural to associate to the connections strength, capacity, or intensity [5,21] and so, in that case, the values associated to the connections can be any real number. Here, we consider the setting of weighted networks, see Ref [8] and references therein. Moreover, we assume coupled cell systems with additive input structure, that is, the input to any cell is a sum of outputs from the cells it is connected to scaled by the weight of the connection. This structure accommodates in a natural way the weighted setup and it is largely used in a wide range of applications, see Refs [7, 10], and  [14]. One of the ultimate goals in the abstraction of coupled cell systems through networks is the inference of dynamical properties that are inherent to the network connection topology and independent of the particular equations that are chosen to model the specific application. In the aforementioned coupled cell network formalism, the existence of subspaces that are flow-invariant, under any network of dynamical systems that have structures consistent with the underlying network of connections, is one example of how the network structure strikes the dynamics of the associated coupled cell systems. These subspaces, which are defined in terms of equalities of certain cell coordinates, are called synchrony subspaces and are designated in some literature as clusters of synchrony [16,17]. See also Ref [15] in the presence of symmetries of the network. In the formalism of Golubitsky, Stewart, and collaborators, it is shown that the synchrony subspaces associated with a network form a subset of the subspaces which are left invariant under the network adjacency matrix (or matrices).
In this paper, we go through some of the central concepts and results in the formalism of Golubitsky, Stewart, and collaborators, and we show that they generalize in a natural way to the weighted setup, in the class of coupled cell systems with additive input structure. In particular, we show that, for weighted networks, an analogous description can be stated for the set of synchrony subspaces (clusters of synchrony). We also present a class of coupled cell systems associated with weighted networks that may contain nonlinear interactions between different cells and where the aforementioned generalization also applies. At the same time, we link these definitions and results to another strand of literature that uses the concepts of clusters of synchrony and equitable partitions and that has mostly been developed independently.
Our results show that there are differences between weighted and unweighted networks. When it comes to the number of lifts of a given network to a network on a larger set of nodes, these are infinitely many; by contrast, the number is finite for unweighted networks. Moreover, fixing a bifurcation condition associated with a network, we also remark that there are always lifting networks (with more nodes) admitting steady-state bifurcating branches that are not lifted from the smaller network. In fact, the number of the liftings with that property is infinite.
II. Weighted coupled cell networks and systems
Let G be a graph with n nodes and such that the edges have associated weights which are real values. The dynamical systems that are associated with G are called coupled cell systems and are such that the cells—the individual dynamical systems—are represented by the nodes of G, and the couplings between the cells—the way they influence the dynamical evolution of each other—are determined by the edges of G and corresponding weights. We also say that G is a weighted coupled cell network of n identical cells.
Define the input valency of a node to be the sum of the weights of the edges directed to the node. A network is said to be regular when all the network nodes have the same input valency.
We now make precise the class of dynamical systems that are being addressed at this paper. We take a cell to be a system of ordinary differential equations, and we consider coupled cell systems with additive input structure that naturally accommodates the weighted setup, see Refs [10] and  [7]. Let C={1,…,n} be the set of cells of G where each cell c has phase space P_{c}=R^{k}. Since the cells have the same internal dynamics, they are defined by the same differential equation. A system associated with cell j of such an n-cell weighted network G has the form
where f:R^{k}→R^{k} and g:R^{k}×R^{k}→R^{k} are smooth functions and each a_{ji}∈R is the value of the weight of the coupling strength from cell i to cell j. The function f characterizes the internal dynamics and the function g is the coupling function. We say that coupled cell systems with cells governed by equations of the form (1) are G-admissible with additive input structure.
A. Synchrony subspaces and balanced relations
Let Δ be a subspace of the network total phase space defined by certain equalities x_{i}=x_{j} of cell coordinates—a polydiagonal subspace. We define Δ to be a network synchrony subspace when it is left invariant under the flow of every G-admissible coupled cell system, with additive input structure. Thus if x_{i}=x_{j} is one of the conditions defining a network synchrony subspace Δ, then a solution with synchronization pattern corresponding to Δ has cells i,j synchronized, that is, x_{i}(t)=x_{j}(t) for all time t.
Consider the equivalence relation ⋈ on the network set of cells defined in the following way: i⋈j if and only if all the vectors in Δ satisfy the equality x_{i}=x_{j}. Write then Δ=Δ_{⋈}. The definition in Refs [20] and  [12] of a relation ⋈ to be balanced generalizes to this setup in the following way: the relation ⋈ is balanced when it satisfies the condition that i⋈j if and only if, for every ⋈-class, the sums of the weights of the couplings directed to cells i and j, from the cells in that ⋈-class, are equal (Definition 2.2 in Ref [3]). Visualizing graphically an equivalence relation ⋈ on the network set of cells by colouring equivalent cells with the same colour, we have that ⋈ is balanced if and only if, whenever two cells i and j have the same colour, for every colour, the sums of the weights of the couplings directed to i and to j from cells of the same colour are equal.
As proved in Ref [3], Theorem 6.5 in Ref [20] generalizes to the weighted setup.
Given a weighted network G and a balanced equivalence relation ⋈, consider the network Q_{⋈}, the quotient network of G by ⋈, obtained in the following way: the cells correspond to the ⋈-equivalence classes and the directed edges are the projections of the directed edges of G. More precisely, if I_{i} and I_{j} are two ⋈-equivalence classes, as ⋈ is balanced, then the sum of the weights of all directed edges from the cells in I_{i} to any given cell in I_{j} does not depend on the cell of I_{j} considered. Thus, if I_{i}={i_{1},…,i_{l}} and we choose j_{1}∈I_{j}, then there will be a directed edge from I_{i} to I_{j} with weight w_{j1,i1}+⋯+w_{j1,il}. The network G is said to be a lift of Q_{⋈}.
Theorem 5.2 of Ref [12] generalizes in a trivial way to the weighted setup.
B. The lattice of synchrony subspaces
The synchrony subspaces of a coupled cell network are ordered by inclusion; with this partial order and the meet operation given by intersection they form a lattice [19]. Note that if two polydiagonal subspaces of a network total phase space are left invariant under the flow of every G-admissible coupled cell system, then its intersection has also that flow-invariance property. Moreover, the intersection of two polydiagonals is also a polydiagonal. That is, the intersection of two linear subspaces defined by certain equalities of coordinates is also a subspace of the same kind. As it remains true for weighted networks that the intersection of synchrony subspaces is a synchrony subspace, it also holds for the weighted setup that the set of synchrony subspaces of a weighted network is a lattice.
Using the same arguments as in Ref [1] (Corollary 2.11), it follows that:
It follows from this corollary that both the characterization and the algorithm obtained in Ref [1], for the lattice of synchrony subspaces of a network, apply to the weighted setup. That is, as the synchrony subspaces of a weighted network are subspaces that are left invariant by the network adjacency matrix, it follows that the lattice of synchrony subspaces of the network can be obtained using the eigenvalue and eigenvector structure of its adjacency matrix. The set of the subspaces which are left invariant under a network adjacency matrix is a lattice with the partial order of inclusion and where the join operation is given by the usual sum. However, the sum of two synchrony subspaces may not be a polydiagonal space and so the join operation in the lattice of the synchrony subspaces is not the sum. Moreover, there is no explicit form of describing the join of two synchrony subspaces. The method used in Ref [1] applies to the weighted setup. Specifically, there is a subset of synchrony subspaces called minimal with the property of every remaining synchrony subspace in the lattice being a sum of synchrony subspaces in that subset. Shortly, each minimal synchrony subspace is associated to an eigenvector or a set of generalized eigenvectors. Moreover, it corresponds to the intersection of all synchrony subspaces containing that eigenvector or that set of generalized eigenvectors.
C. Lifts of a weighted network
In Ref [2], based on the notion of balanced relation of a network, a method is proposed that systematically enumerates all lifts of a given (quotient) network using the network adjacency matrices. This method applies to the weighted setup due to the generalization of the definition of a network balanced relation. Briefly, given an n-cell weighted network G with set of cells {1,…,n} with adjacency matrix A_{G} and a balanced relation ⋈ with classes I_{1},…,I_{p}, we can construct the p×p adjacency matrix of the quotient network Q_{⋈} in the following way: form an n×p matrix A¯_{G} where each column j is the sum of the columns of A_{G} corresponding to the cells in the class I_{j}. As ⋈ is balanced, for each I_{j}, the rows of matrix A¯_{G} corresponding to the cells in that class are equal. So, the adjacency matrix of Q_{⋈} is the submatrix of A¯_{G} where the j row is any of the rows of A¯_{G} corresponding to a cell in the class I_{j}.
Theorem 2.5 of Ref [2] applies so to the weighted setup:
We illustrate the method described of finding all the n-cell weighted lifts of a p-cell network with the particular case of the 4-cell weighted lifts of the 3-cell bidirectional ring Q in Fig. 1. The adjacency matrix of the network Q is
Now, as the network Q is symmetric under any permutation of the cells, we have that it is indifferent which cell of Q corresponds to an equivalence class with two cells of a balanced relation of the network lift. Suppose we take cell 1 of Q. From Theorem II.13, after renumbering the cells if necessary, the adjacency matrix of any 4-cell weighted lift of Q is of the following form:
where a,b,c,d∈R. Thus, we have an infinite set of 4-cell networks admitting Q as a quotient.
More generally, it follows directly from Theorem II.13 that:
III. Synchrony-breaking codimension-one bifurcations
Consider a regular n-cell weighted network G with valency v and adjacency matrix A_{G}, and take a coupled cell system with additive input structure depending on a real parameter λ. If the set of cells of G is C={1,…,n}, where each cell c has phase space P_{c}=R^{k}, the equation of cell j has the form
where f:R^{k}×R→R^{k} and g:R^{k}×R^{k}×R→R^{k} are smooth functions. We assume that the system (4) has a full synchronous equilibrium, say at the origin when the bifurcation parameter λ is zero. Taking a degeneracy condition at the partial derivatives of the vector field at (x,λ)=(0,0) such that the Jacobian matrix of the system at (x,λ)=(0,0) has nontrivial kernel containing at least one vector outside the full synchronous space {x: x_{1}=⋯=x_{n}}, then we say that the system (4) undergoes a synchrony-breaking codimension-one steady-state bifurcation from the origin. One question we can pose is about the existence of bifurcating branches of steady-state solutions emerging from the origin which are not fully synchronized. Moreover, taking the restriction of the system (4) to a synchrony subspace Δ_{⋈}, we may ask how the synchrony-breaking codimension-one bifurcations from the origin compare for (4) and the restricted system taking the same degeneracy condition. This last issue is addressed at Section III A. We start by relating the Jacobian matrix of the system (4) at (x,λ)=(0,0) with the network adjacency matrix.
We assume that system (4) has an equilibrium in the full synchronous subspace (after a change of coordinates, the origin). That is,
A proof analogous to that of Proposition 3.1 in Ref [13] shows that the linearization of the system (4) at the origin is determined by the adjacency matrix A_{G} in the following way:
Denote by E^{c} the center subspace and by J^{c} the restriction of J to it. If we assume a codimension-one bifurcation occurs for the system (4) from the origin, say at λ=0, we have that a steady-state or Hopf bifurcation occurs when J has a zero eigenvalue or a pair of purely imaginary eigenvalues, respectively. Also, the bifurcation is synchrony-breaking when the center subspace E^{c} is not contained in the full synchronous subspace {x:x_{1}=⋯=x_{n}}.
As the eigenvalues of each k×k matrices α+vη+μ_{j}β, for j=1,…,n, are generically simple, the possible steady-state bifurcation types do not depend on k, and we may assume k=1. In that case, α=(∂f∂xj){0,0},η=(∂g∂xj){0},β=(∂g∂xi){0} and the set of the eigenvalues of J is
We have a steady-state synchrony-breaking bifurcation problem associated with a real eigenvalueμ_{i}≠v of A_{G} when
A. The lifting bifurcation problem
If a codimension-one local bifurcation (steady-state or Hopf) occurs for a coupled cell system associated to a (quotient) network, we may ask how that bifurcation lifts to the overall space for the possible different lifts of that quotient network; this is known as the lifting bifurcation problem [2]. More precisely, assume that Q is a p-cell quotient network of G by a synchrony subspace Δ. By Theorem II.7, we have that, any branch of solutions of the Q-admissible equations (that we may think, are the equations of the system (4) restricted to Δ) corresponds to a branch of solutions of the system (4). However, it can happen that the center subspace for (4) is bigger than that of (4) restricted to Δ. If that occurs, it may happen that the codimension-one local bifurcation gives rise to branches of solutions that are not contained in Δ. By Remark III.2, for steady-state bifurcation, taking the bifurcation condition (5), if the algebraic multiplicity of the eigenvalue μ_{i} for A_{G} is bigger than that for A_{Q}, then branches of steady-state solutions can occur outside Δ.
Proof Suppose Q has adjacency matrix A_{Q}=[qij]{1≤i,j≤p}. Consider a weighted (p+1)-cell weighted network G with set of cells enumerated in the form C=(1,p+1,2,…,p) and where the adjacency matrix A_{G} has the following block structure:
for t_{1},…,t_{p}∈R. By Theorem II.13, the network Q is the quotient network of G by the synchrony subspace {x:x_{1}=x_{p+1}}. □
Proof By Theorem III.5, the set of (p+1)-cell weighed networks which are lifts of Q and whose trace is the trace of A_{Q} plus t is infinite. For such networks, the eigenvalue t increases its algebraic multiplicity by one from A_{Q} to A_{G}. □
IV. Cluster synchronization in networks with positive and negative weights
In this section, we follow Ref [17] and we show how cluster synchronization, considered there, for networks with positive and negative weights relates with synchrony subspaces and balanced relations on weighted coupled cell networks. Given an n-cell network G with positive and negative interactions, consider its adjacency matrix A_{G} symmetric and with zero diagonal entries. Take the signed Laplacian matrix of the network to be
where D_{abs} is the diagonal matrix called the signed degree matrix or absolute degree matrix: the diagonal entry jj is the sum ∑i|a_{ji}|. A signed graph is defined to be structurally balanced if the product of the signs along any closed path in the network is positive, equivalently, if the graph can be split into two factions where each faction contains only positive interactions internally, while the connections between the two factions are negative. In that case, there exists a diagonal matrix Σ=diag(σ), with ±1 on the diagonal, such that the matrix
contains only negative elements on the off-diagonal. Thus, the signed Laplacian L_{σ} can be transformed into the standard Laplacian L^{′} of an associated graph with only positive weights through the similarity transformation defined by Σ. It is known that the signed Laplacian is positive semidefinite and its spectrum contains one zero eigenvalue when the graph is connected and structurally balanced. Networks with only positive weights are always structurally balanced taking Σ the n×n identity matrix.
Consider the linear signed consensus dynamics governed by
In order to analyze the cluster synchronization in structurally balanced signed networks, it is of interest to describe the spaces left invariant under L_{σ}. As L_{σ} and L^{′} are similar, by the above remark, we may restrict to find the spaces left invariant under L^{′}. One way of doing that is by finding the external equitable partitions of the network with Laplacian L^{′}, that is, the equitable partitions of the weighted graph with adjacency matrix L^{′}. A signed external equitable partition (sEEP) of G is so an external equitable partition of the network with Laplacian L^{′}.
Consider the linear system
As the two systems (10) and (9) are linearly conjugate (using Σ) we have that:
Note that dynamics of (9) restricted to Σ(Δ_{⋈}) is linear conjugate to the dynamics of (10) restricted to Δ_{⋈}. Moreover, the dynamics of (10) restricted to Δ_{⋈} is consistent with the quotient network of the network with adjacency matrix L^{′} by ⋈. In Ref [17], the network associated with the Laplacian L^{′} restricted to Δ_{⋈} is referred as the quotient graph of G by the signed external equitable partition. We finish this section with an example of an 8-cell network G with positive and negative interactions presented in Ref [17] where we illustrate the concepts and remarks presented here.
Networks of dynamical systems are abundantly used in the modeling of real-world problems in many areas of science. Frequently, these systems are abstracted by weighted networks (graphs) where the connections have associated values (weights) that can be any real number. Different weights represent different strengths, capacities, or intensities of the connections. In this note, we show that the coupled cell network formalism of Golubitsky, Stewart, and collaborators, where the connections have associated nonnegative integer values, generalizes in a natural way to weighted networks. Specifically, we show how some of the central concepts and results in that formalism are also valid and applicable in the weighted setup. A central concept in the theory of coupled cell networks concerns the existence of synchrony patterns, where groups of cells are synchronized in a robust way. These patterns are in one-to-one correspondence with balanced equivalence relations of the network graph set of nodes. These concepts are given a different terminology by the more applied community. More specifically, they are also commonly referred to as clusters of synchrony and equitable partitions. In this work, while we extend the synchronization definitions and results in the coupled cell network formalism of Golubitsky, Stewart, and collaborators to the weighted setup, we also relate and translate them to cluster synchronization, equitable partitions, external equitable partitions, and signed external equitable partitions.
In the coupled cell network formalism of Golubitsky, Stewart, and collaborators [11,12,20], the networks are directed graphs that abstract interacting dynamical systems: the nodes (cells) represent individual dynamical systems and the directed edges the interactions (See also Ref [9].) The formalism is motivated by the profusion of real world applications that can be modelled through networks of dynamical systems—the coupled cell systems. See, for example, Ref [18]. In this formalism, the network connections have assigned nonnegative integer values. Still, frequently, in a wide range of scenarios, as for example, social and biological systems, it is natural to associate to the connections strength, capacity, or intensity [5,21] and so, in that case, the values associated to the connections can be any real number. Here, we consider the setting of weighted networks, see Ref [8] and references therein. Moreover, we assume coupled cell systems with additive input structure, that is, the input to any cell is a sum of outputs from the cells it is connected to scaled by the weight of the connection. This structure accommodates in a natural way the weighted setup and it is largely used in a wide range of applications, see Refs [7, 10], and  [14]. One of the ultimate goals in the abstraction of coupled cell systems through networks is the inference of dynamical properties that are inherent to the network connection topology and independent of the particular equations that are chosen to model the specific application. In the aforementioned coupled cell network formalism, the existence of subspaces that are flow-invariant, under any network of dynamical systems that have structures consistent with the underlying network of connections, is one example of how the network structure strikes the dynamics of the associated coupled cell systems. These subspaces, which are defined in terms of equalities of certain cell coordinates, are called synchrony subspaces and are designated in some literature as clusters of synchrony [16,17]. See also Ref [15] in the presence of symmetries of the network. In the formalism of Golubitsky, Stewart, and collaborators, it is shown that the synchrony subspaces associated with a network form a subset of the subspaces which are left invariant under the network adjacency matrix (or matrices).
In this paper, we go through some of the central concepts and results in the formalism of Golubitsky, Stewart, and collaborators, and we show that they generalize in a natural way to the weighted setup, in the class of coupled cell systems with additive input structure. In particular, we show that, for weighted networks, an analogous description can be stated for the set of synchrony subspaces (clusters of synchrony). We also present a class of coupled cell systems associated with weighted networks that may contain nonlinear interactions between different cells and where the aforementioned generalization also applies. At the same time, we link these definitions and results to another strand of literature that uses the concepts of clusters of synchrony and equitable partitions and that has mostly been developed independently.
Our results show that there are differences between weighted and unweighted networks. When it comes to the number of lifts of a given network to a network on a larger set of nodes, these are infinitely many; by contrast, the number is finite for unweighted networks. Moreover, fixing a bifurcation condition associated with a network, we also remark that there are always lifting networks (with more nodes) admitting steady-state bifurcating branches that are not lifted from the smaller network. In fact, the number of the liftings with that property is infinite.
Let G be a graph with n nodes and such that the edges have associated weights which are real values. The dynamical systems that are associated with G are called coupled cell systems and are such that the cells—the individual dynamical systems—are represented by the nodes of G, and the couplings between the cells—the way they influence the dynamical evolution of each other—are determined by the edges of G and corresponding weights. We also say that G is a weighted coupled cell network of n identical cells.
Define the input valency of a node to be the sum of the weights of the edges directed to the node. A network is said to be regular when all the network nodes have the same input valency.
We now make precise the class of dynamical systems that are being addressed at this paper. We take a cell to be a system of ordinary differential equations, and we consider coupled cell systems with additive input structure that naturally accommodates the weighted setup, see Refs [10] and  [7]. Let C={1,…,n} be the set of cells of G where each cell c has phase space P_{c}=R^{k}. Since the cells have the same internal dynamics, they are defined by the same differential equation. A system associated with cell j of such an n-cell weighted network G has the form
where f:R^{k}→R^{k} and g:R^{k}×R^{k}→R^{k} are smooth functions and each a_{ji}∈R is the value of the weight of the coupling strength from cell i to cell j. The function f characterizes the internal dynamics and the function g is the coupling function. We say that coupled cell systems with cells governed by equations of the form (1) are G-admissible with additive input structure.
The additive input structure of equations (1) does not incorporate nonlinear interactions between different cells, corresponding to nonpairwise couplings, and that can be a restriction. See, for example, Refs [4] and  [6]. One class of coupled cell systems for weighted networks that can incorporate nonpairwise interactions is, for example,
for j=1,…,n. Here, f:R^{k}→R^{k}, g:R^{k}×R^{k}→R^{k}, and g_{r}:(Rk){r+1}→R^{k} are smooth functions. Also, the overbar denotes invariance under permutation of the corresponding variables. Note that, for the coupled cell systems (2), every nonlinear interaction that occurs in a cell j equation has strength given by the sum of all the weights of the edges directed to the cell j from the cells involved in that interaction. We note that this type of coupled cell systems makes more sense in the case where there are all-to-all interactions between the cells of the network.  ◊
Let Δ be a subspace of the network total phase space defined by certain equalities x_{i}=x_{j} of cell coordinates—a polydiagonal subspace. We define Δ to be a network synchrony subspace when it is left invariant under the flow of every G-admissible coupled cell system, with additive input structure. Thus if x_{i}=x_{j} is one of the conditions defining a network synchrony subspace Δ, then a solution with synchronization pattern corresponding to Δ has cells i,j synchronized, that is, x_{i}(t)=x_{j}(t) for all time t.
Consider the equivalence relation ⋈ on the network set of cells defined in the following way: i⋈j if and only if all the vectors in Δ satisfy the equality x_{i}=x_{j}. Write then Δ=Δ_{⋈}. The definition in Refs [20] and  [12] of a relation ⋈ to be balanced generalizes to this setup in the following way: the relation ⋈ is balanced when it satisfies the condition that i⋈j if and only if, for every ⋈-class, the sums of the weights of the couplings directed to cells i and j, from the cells in that ⋈-class, are equal (Definition 2.2 in Ref [3]). Visualizing graphically an equivalence relation ⋈ on the network set of cells by colouring equivalent cells with the same colour, we have that ⋈ is balanced if and only if, whenever two cells i and j have the same colour, for every colour, the sums of the weights of the couplings directed to i and to j from cells of the same colour are equal.
Results have been obtained using the graph-theoretic notions of equitable partitions and external equitable partitions of weighted graphs concerning cluster synchronization of networks of oscillators, see, for example, Refs [16] and  [17]. Consider an n-cell network G with weighted adjacency matrix A_{G} and form the graph Laplacian matrix L=D−A_{G}, where D is the n×n diagonal matrix with diagonal entries d_{ii} given by the total coupling strengths of each node i. Take a partition P of the set of cells of G. We have then the following:
(i) P is equitable for G if and only if it corresponds to a balanced equivalence relation of G.
(ii) P is external equitable for G if and only if it corresponds to a balanced equivalence relation of the weighted network with adjacency matrix the Laplacian L.
(iii) If P is equitable for G, then it corresponds to a balanced equivalence relation of G and G_{L}.It follows then that the results that will be stated concerning balanced equivalence relations do apply to equitable partitions and external equitable partitions of weighted graphs. Moreover, we can visualize graphically the equitable partitions and external equitable partitions as above: different parts correspond to different colours and then the partition is equitable if and only if whenever two cells i and j have the same colour, for every colour, the sums of the weights of the couplings directed to i and to j from cells of the same colour are equal. The colouring should be considered at the graph G_{L} if we look for external equitable partitions.  ◊
P is equitable for G if and only if it corresponds to a balanced equivalence relation of G.
P is external equitable for G if and only if it corresponds to a balanced equivalence relation of the weighted network with adjacency matrix the Laplacian L.
If P is equitable for G, then it corresponds to a balanced equivalence relation of G and G_{L}.
As proved in Ref [3], Theorem 6.5 in Ref [20] generalizes to the weighted setup.
Let G be an n-cell weighted network. Consider the admissible coupled cell systems for G with additive input structure, for a given choice of total phase space (Rk){n}. Then, a polydiagonal subspace Δ_{⋈} is a synchrony subspace for G if and only if the ⋈-relation is balanced on the set of cells of G.
If we take an external equitable partition of an n-cell network G, it follows then that its parts define a balanced equivalence relation of the weighted network G_{L} with adjacency matrix the Laplacian L=D−A_{G}. Examples of coupled cell systems with additive input structure associated with G_{L} are
(i) The linear system
where x=(x_{1},…,x_{n}) and x_{i} is the coordinate corresponding to cell i.
(ii) The nonlinear system
where γ is a parameter that regulates the coupling strength, and F and G are (smooth) nonlinear (G is the coupling function). See Ref [17].Taking an external equitable partition of G, then it corresponds to a balanced equivalence relation ⋈ of the set of cells of the network G_{L} and so the polydiagonal Δ_{⋈} is flow-invariant for both of these two classes of coupled cell systems. That is, dynamics starting in Δ_{⋈} remain there for all time and correspond to synchronized clusters of cells, where cells in the same part of the partition are synchronized.  ◊
The linear system
where x=(x_{1},…,x_{n}) and x_{i} is the coordinate corresponding to cell i.
The nonlinear system
where γ is a parameter that regulates the coupling strength, and F and G are (smooth) nonlinear (G is the coupling function). See Ref [17].
The results in Theorem II.3 are equally valid if, instead of coupled cell systems with additive input structure, we consider coupled cell systems for G with structure given by (2).  ◊
Given a weighted network G and a balanced equivalence relation ⋈, consider the network Q_{⋈}, the quotient network of G by ⋈, obtained in the following way: the cells correspond to the ⋈-equivalence classes and the directed edges are the projections of the directed edges of G. More precisely, if I_{i} and I_{j} are two ⋈-equivalence classes, as ⋈ is balanced, then the sum of the weights of all directed edges from the cells in I_{i} to any given cell in I_{j} does not depend on the cell of I_{j} considered. Thus, if I_{i}={i_{1},…,i_{l}} and we choose j_{1}∈I_{j}, then there will be a directed edge from I_{i} to I_{j} with weight w_{j1,i1}+⋯+w_{j1,il}. The network G is said to be a lift of Q_{⋈}.
Consider the networks G and Q in Fig. 1. The relation ⋈ with classes {1,2},{3},{4} is balanced for G. Equivalently, {{1,2},{3},{4}} is an equitable partition of G. The corresponding quotient is Q.  ◊
Theorem 5.2 of Ref [12] generalizes in a trivial way to the weighted setup.
Let G be a weighted network and ⋈ a balanced equivalence relation on G. Then:
(a) The restriction to Δ_{⋈} of a G-admissible coupled cell system with additive input structure is a Q_{⋈}-admissible coupled cell system with additive input structure.
(b) Every Q_{⋈}-admissible coupled cell system with additive input structure is the restriction to Δ_{⋈} of a G-admissible coupled cell system with additive input structure.
The restriction to Δ_{⋈} of a G-admissible coupled cell system with additive input structure is a Q_{⋈}-admissible coupled cell system with additive input structure.
Every Q_{⋈}-admissible coupled cell system with additive input structure is the restriction to Δ_{⋈} of a G-admissible coupled cell system with additive input structure.
Consider the 4-cell network G of Fig. 1. The general form of a coupled cell system with additive input structure consistent with G takes the form
Its restriction to the synchrony subspace Δ_{⋈}={x:x_{1}=x_{2}} taking coordinates x_{1},x_{3},x_{4} is
Observe that these equations commute with all permutations of the symmetric group S_{3}, reflecting the fact that the quotient network Q (on the right of Fig. 1) has that symmetry group.  ◊
(i) The results in Theorem II.7 are equally valid if, instead of coupled cell systems with additive input structure, we consider coupled cell systems with structure given by (2) for both G and Q_{⋈}. (ii) Moreover, if we take the class of equations of Remark II.4 and an equitable or an external equitable partition ⋈ of G, denoting by the Δ_{⋈} the associated polydiagonal, we have that the restriction of those equations to Δ_{⋈} corresponds to equations of the same class but now we take the Laplacian matrix associated with the quotient Q_{⋈}.  ◊
The synchrony subspaces of a coupled cell network are ordered by inclusion; with this partial order and the meet operation given by intersection they form a lattice [19]. Note that if two polydiagonal subspaces of a network total phase space are left invariant under the flow of every G-admissible coupled cell system, then its intersection has also that flow-invariance property. Moreover, the intersection of two polydiagonals is also a polydiagonal. That is, the intersection of two linear subspaces defined by certain equalities of coordinates is also a subspace of the same kind. As it remains true for weighted networks that the intersection of synchrony subspaces is a synchrony subspace, it also holds for the weighted setup that the set of synchrony subspaces of a weighted network is a lattice.
Using the same arguments as in Ref [1] (Corollary 2.11), it follows that:
Let G be an n-cell weighted network and ⋈ an equivalence relation on its set of cells. Then Δ_{⋈} is a synchrony subspace if and only if {x∈R^{n}: x_{i}=x_{j} if i⋈j} is left invariant under the network adjacency matrix.
It follows from this corollary that both the characterization and the algorithm obtained in Ref [1], for the lattice of synchrony subspaces of a network, apply to the weighted setup. That is, as the synchrony subspaces of a weighted network are subspaces that are left invariant by the network adjacency matrix, it follows that the lattice of synchrony subspaces of the network can be obtained using the eigenvalue and eigenvector structure of its adjacency matrix. The set of the subspaces which are left invariant under a network adjacency matrix is a lattice with the partial order of inclusion and where the join operation is given by the usual sum. However, the sum of two synchrony subspaces may not be a polydiagonal space and so the join operation in the lattice of the synchrony subspaces is not the sum. Moreover, there is no explicit form of describing the join of two synchrony subspaces. The method used in Ref [1] applies to the weighted setup. Specifically, there is a subset of synchrony subspaces called minimal with the property of every remaining synchrony subspace in the lattice being a sum of synchrony subspaces in that subset. Shortly, each minimal synchrony subspace is associated to an eigenvector or a set of generalized eigenvectors. Moreover, it corresponds to the intersection of all synchrony subspaces containing that eigenvector or that set of generalized eigenvectors.
From Remark II.2, it follows that both the characterization and the algorithm obtained in Ref [1] can be applied to find the equitable partitions (using the eigenvalue and eigenvector structure of A_{G}, or L in case the interest is in the external equitable partitions).  ◊
Consider the network G in Fig. 2 that corresponds to the network in Fig. 4 of Ref [17]. Applying the algorithm in Ref [1] to the adjacency matrix of G, it follows that the equitable partitions of G are the ones listed in the first three rows of Table I. The same algorithm applied to the Laplacian matrix gives the external equitable partitions of G, which are listed in Table I. As observed in Remark II.2, the set of the equitable partitions is a subset of the set of the external equitable partitions.  ◊
In Ref [2], based on the notion of balanced relation of a network, a method is proposed that systematically enumerates all lifts of a given (quotient) network using the network adjacency matrices. This method applies to the weighted setup due to the generalization of the definition of a network balanced relation. Briefly, given an n-cell weighted network G with set of cells {1,…,n} with adjacency matrix A_{G} and a balanced relation ⋈ with classes I_{1},…,I_{p}, we can construct the p×p adjacency matrix of the quotient network Q_{⋈} in the following way: form an n×p matrix A¯_{G} where each column j is the sum of the columns of A_{G} corresponding to the cells in the class I_{j}. As ⋈ is balanced, for each I_{j}, the rows of matrix A¯_{G} corresponding to the cells in that class are equal. So, the adjacency matrix of Q_{⋈} is the submatrix of A¯_{G} where the j row is any of the rows of A¯_{G} corresponding to a cell in the class I_{j}.
Theorem 2.5 of Ref [2] applies so to the weighted setup:
Let Q be a weighted network with p cells and adjacency matrix A_{Q}=[qij]{1≤i,j≤p}. A weighted n-cell network G with set of cells C={1,…,n}, is a lift of the network Q if and only if there is a partition of C into p parts, say I_{1},…,I_{p}, such that, after renumbering the cells if necessary, the adjacency matrix A_{G} of G has the following block structure:
where Q_{ij} is an #I_{i}×#I_{j}-matrix where each row sum is q_{ij}.
In Ref [17], given an equitable partition or external equitable partition for an undirected network G, with adjacency matrix A_{G} and Laplacian matrix L_{G}, the corresponding quotient network is defined in a similar way as we do here but considering the sum of the output connections instead of that of the input connections. In the setting of undirected networks (graphs), it is actually indifferent to take the sum of the output connections or that of the input connections. In fact, the quotient adjacency matrices obtained in each case are the transposed ones of the other and thus have the same set of (generalized) eigenvectors and thus the same lattice of synchrony subspaces (balanced relations).  ◊
We illustrate the method described of finding all the n-cell weighted lifts of a p-cell network with the particular case of the 4-cell weighted lifts of the 3-cell bidirectional ring Q in Fig. 1. The adjacency matrix of the network Q is
Now, as the network Q is symmetric under any permutation of the cells, we have that it is indifferent which cell of Q corresponds to an equivalence class with two cells of a balanced relation of the network lift. Suppose we take cell 1 of Q. From Theorem II.13, after renumbering the cells if necessary, the adjacency matrix of any 4-cell weighted lift of Q is of the following form:
where a,b,c,d∈R. Thus, we have an infinite set of 4-cell networks admitting Q as a quotient.
More generally, it follows directly from Theorem II.13 that:
For any p-cell weighted network Q, given n>p, there is an infinite set of n-cell weighted lifts of Q.  ◊
Consider a regular n-cell weighted network G with valency v and adjacency matrix A_{G}, and take a coupled cell system with additive input structure depending on a real parameter λ. If the set of cells of G is C={1,…,n}, where each cell c has phase space P_{c}=R^{k}, the equation of cell j has the form
where f:R^{k}×R→R^{k} and g:R^{k}×R^{k}×R→R^{k} are smooth functions. We assume that the system (4) has a full synchronous equilibrium, say at the origin when the bifurcation parameter λ is zero. Taking a degeneracy condition at the partial derivatives of the vector field at (x,λ)=(0,0) such that the Jacobian matrix of the system at (x,λ)=(0,0) has nontrivial kernel containing at least one vector outside the full synchronous space {x: x_{1}=⋯=x_{n}}, then we say that the system (4) undergoes a synchrony-breaking codimension-one steady-state bifurcation from the origin. One question we can pose is about the existence of bifurcating branches of steady-state solutions emerging from the origin which are not fully synchronized. Moreover, taking the restriction of the system (4) to a synchrony subspace Δ_{⋈}, we may ask how the synchrony-breaking codimension-one bifurcations from the origin compare for (4) and the restricted system taking the same degeneracy condition. This last issue is addressed at Section III A. We start by relating the Jacobian matrix of the system (4) at (x,λ)=(0,0) with the network adjacency matrix.
We assume that system (4) has an equilibrium in the full synchronous subspace (after a change of coordinates, the origin). That is,
A proof analogous to that of Proposition 3.1 in Ref [13] shows that the linearization of the system (4) at the origin is determined by the adjacency matrix A_{G} in the following way:
Let G be a regular n-cell weighted coupled cell network with valency v, adjacency matrix A_{G} and denote by μ_{1},…,μ_{n} the eigenvalues of A_{G}. Consider a G-admissible system where the equation of cell j is given by (4). Take
the k×k matrices representing the linearized internal dynamics and couplings. Then
where id{n} is the n×n identity matrix and the eigenvalues of J are the union of the eigenvalues of the k×k matrices α+vη+μ_{j}β , for j=1,…,n, including algebraic multiplicity. Moreover, if u∈C^{k} is an eigenvector of α+vη and w∈C^{n} is an eigenvector of A_{G}, then u⊗w is an eigenvector of J.
Denote by E^{c} the center subspace and by J^{c} the restriction of J to it. If we assume a codimension-one bifurcation occurs for the system (4) from the origin, say at λ=0, we have that a steady-state or Hopf bifurcation occurs when J has a zero eigenvalue or a pair of purely imaginary eigenvalues, respectively. Also, the bifurcation is synchrony-breaking when the center subspace E^{c} is not contained in the full synchronous subspace {x:x_{1}=⋯=x_{n}}.
Let Q be a weighted quotient network of G by a synchronous subspace Δ of dimension p. Due to Theorem II.7, we have that the p eigenvalues of A_{Q} are eigenvalues of A_{G}.  ◊
As the eigenvalues of each k×k matrices α+vη+μ_{j}β, for j=1,…,n, are generically simple, the possible steady-state bifurcation types do not depend on k, and we may assume k=1. In that case, α=(∂f∂xj){0,0},η=(∂g∂xj){0},β=(∂g∂xi){0} and the set of the eigenvalues of J is
We have a steady-state synchrony-breaking bifurcation problem associated with a real eigenvalueμ_{i}≠v of A_{G} when
If a codimension-one local bifurcation (steady-state or Hopf) occurs for a coupled cell system associated to a (quotient) network, we may ask how that bifurcation lifts to the overall space for the possible different lifts of that quotient network; this is known as the lifting bifurcation problem [2]. More precisely, assume that Q is a p-cell quotient network of G by a synchrony subspace Δ. By Theorem II.7, we have that, any branch of solutions of the Q-admissible equations (that we may think, are the equations of the system (4) restricted to Δ) corresponds to a branch of solutions of the system (4). However, it can happen that the center subspace for (4) is bigger than that of (4) restricted to Δ. If that occurs, it may happen that the codimension-one local bifurcation gives rise to branches of solutions that are not contained in Δ. By Remark III.2, for steady-state bifurcation, taking the bifurcation condition (5), if the algebraic multiplicity of the eigenvalue μ_{i} for A_{G} is bigger than that for A_{Q}, then branches of steady-state solutions can occur outside Δ.
Consider the S_{3}-symmetric (quotient) network Q in Fig. 1. Besides the valency 2, the other eigenvalue of A_{Q} is −1 (with algebraic and geometric multiplicity 2). We address the lifting steady-state synchrony-breaking bifurcation problem associated with the eigenvalue −1 of A_{Q}. The general form of the adjacency matrix of the 4-cell lifts of Q is given in (3). A necessary condition for the existence of branches of steady-state solutions that are not lifted from the Q-equations is that the algebraic multiplicity of the eigenvalue −1 for the adjacency matrix for the lift is bigger than that for A_{Q}. As A_{Q} has zero trace, that is equivalent to consider the 4-cell lifts whose adjacency matrix has trace equal to −1, which are of the form
for a,c,d∈R. The associated coupled cell systems with additive input structure are of the form
and we assume the existence of a full synchronous equilibrium at the origin. That is, f(0,λ)+2h(0,0,λ)=0, for all λ∈R. The eigenvalues of J are α+2(η+β) and α+2η−β with algebraic multiplicity 3. Taking the degeneracy condition
we have J^{c}⊋J^{c}|_{Δ}. Using the fact that Δ={x:x_{1}=x_{2}} is a synchrony subspace, the equilibria of (7) are obtained by solving the system of the form
where the first equation is the difference x˙{1}−x˙{2}=0. Thus, looking for steady-state solutions where x_{1}≠x_{2} corresponds to solve the previous system where the first equation is replaced by H(x_{1},x_{2},x_{3},x_{4},λ)=0. If the determinant of the Jacobian matrix of that system, with respect to the x_{i} variables and evaluated at the origin, is nonzero, then by the Implicit Function Theorem, there will be a unique bifurcating branch of solutions, parametrized by λ, where x_{1}≠x_{2}.
A particular example, taking a=0, c=1, and d=0 in (6), is the network G of Fig. 1. See Table II for the set of synchrony subspaces of that network. Taking the synchrony subspace Δ_{2}={x: x_{1}=x_{4}}, the corresponding quotient is the network #11 in Ref [13]. For this quotient, the generic existence of two transcritical branches of steady-state solutions where one of the branches have cells 1,2,3 all desynchronized is proved in Ref [13]. Thus, for the G-admissible equations, there is a bifurcating branch of steady-state solutions, where cells 1,2 are not synchronized, at the synchrony subspace Δ_{2}. This branch does not lift from a branch of the Q-admissible quotient equations.  ◊
It was shown in Ref [2] that, in the coupled cell network formalism [20,12], up to an isomorphism, there are only two 4-cell and twelve 5-cell lifts of the network Q in Fig. 1. Moreover, for the lifting steady-state synchrony-breaking bifurcation problem associated with the eigenvalue −1 of A_{Q}, it was proved that among all these lifts, only for two of the 5-cell lifts, there is an increase of the dimension of the center subspace for the lift equations and the existence of branches of steady-state solutions that are not lifted from the Q-equations. This contrasts with what we have seen in the previous example in the weighted network setup.  ◊
Let Q be a regular p-cell weighted network with p≥1 and t a real number. The set of (p+1)-cell weighed networks which are lifts of Q and such that the trace of A_{G} is the trace of A_{Q} plus t is infinite.
Proof Suppose Q has adjacency matrix A_{Q}=[qij]{1≤i,j≤p}. Consider a weighted (p+1)-cell weighted network G with set of cells enumerated in the form C=(1,p+1,2,…,p) and where the adjacency matrix A_{G} has the following block structure:
for t_{1},…,t_{p}∈R. By Theorem II.13, the network Q is the quotient network of G by the synchrony subspace {x:x_{1}=x_{p+1}}. □
Let Q be a regular p-cell weighted network with p≥1 and t a real eigenvalue of A_{Q}. The set of (p+1)-cell weighed networks which are lifts of Q such that the bifurcation problem associated with t has a bigger center space than the corresponding bifurcation problem for Q is infinite.
Proof By Theorem III.5, the set of (p+1)-cell weighed networks which are lifts of Q and whose trace is the trace of A_{Q} plus t is infinite. For such networks, the eigenvalue t increases its algebraic multiplicity by one from A_{Q} to A_{G}. □
In this section, we follow Ref [17] and we show how cluster synchronization, considered there, for networks with positive and negative weights relates with synchrony subspaces and balanced relations on weighted coupled cell networks. Given an n-cell network G with positive and negative interactions, consider its adjacency matrix A_{G} symmetric and with zero diagonal entries. Take the signed Laplacian matrix of the network to be
where D_{abs} is the diagonal matrix called the signed degree matrix or absolute degree matrix: the diagonal entry jj is the sum ∑i|a_{ji}|. A signed graph is defined to be structurally balanced if the product of the signs along any closed path in the network is positive, equivalently, if the graph can be split into two factions where each faction contains only positive interactions internally, while the connections between the two factions are negative. In that case, there exists a diagonal matrix Σ=diag(σ), with ±1 on the diagonal, such that the matrix
contains only negative elements on the off-diagonal. Thus, the signed Laplacian L_{σ} can be transformed into the standard Laplacian L^{′} of an associated graph with only positive weights through the similarity transformation defined by Σ. It is known that the signed Laplacian is positive semidefinite and its spectrum contains one zero eigenvalue when the graph is connected and structurally balanced. Networks with only positive weights are always structurally balanced taking Σ the n×n identity matrix.
Δ⊆R^{n} is invariant under L^{′} if and only if Σ(Δ) is invariant under L_{σ}.  ◊
Consider the linear signed consensus dynamics governed by
In order to analyze the cluster synchronization in structurally balanced signed networks, it is of interest to describe the spaces left invariant under L_{σ}. As L_{σ} and L^{′} are similar, by the above remark, we may restrict to find the spaces left invariant under L^{′}. One way of doing that is by finding the external equitable partitions of the network with Laplacian L^{′}, that is, the equitable partitions of the weighted graph with adjacency matrix L^{′}. A signed external equitable partition (sEEP) of G is so an external equitable partition of the network with Laplacian L^{′}.
It follows from Remark II.2 that the signed external equitable partitions of G are the balanced equivalence relations of the weighted network with adjacency matrix L^{′}.  ◊
Consider the linear system
As the two systems (10) and (9) are linearly conjugate (using Σ) we have that:
Δ_{⋈} is a synchrony subspace of the equations (10) if and only if Σ(Δ_{⋈}) is an invariant subspace of the equations (9).  ◊
Note that dynamics of (9) restricted to Σ(Δ_{⋈}) is linear conjugate to the dynamics of (10) restricted to Δ_{⋈}. Moreover, the dynamics of (10) restricted to Δ_{⋈} is consistent with the quotient network of the network with adjacency matrix L^{′} by ⋈. In Ref [17], the network associated with the Laplacian L^{′} restricted to Δ_{⋈} is referred as the quotient graph of G by the signed external equitable partition. We finish this section with an example of an 8-cell network G with positive and negative interactions presented in Ref [17] where we illustrate the concepts and remarks presented here.
Consider the network G in Fig. 3 that corresponds to the network in Fig. 7 of Ref [17], where the connections between the pairs of nodes (3,5), (4,5), and (5,8) have weight −1 and all the other connections have weight 1. The signed Laplacian matrix of G is given by
Using the similarity transformation defined by the 8×8 diagonal matrix Σ with diagonal given by (1,1,1,1,−1,−1,−1,1), we get the Laplacian L^{′} of an associated network (graph) with only positive weights
Applying the algorithm in Ref [1] to this Laplacian matrix L^{′}, it follows, from Remark IV.2, that the signed external equitable partitions of G are the ones listed in Table III. It follows then, by Remark IV.3, that the subspaces {x: x_{1}=x_{2},x_{3}=x_{4},−x_{6}=−x_{7}=x_{8}} and {x: x_{1}=x_{2}=x_{3}=x_{4}=−x_{5}=−x_{6}=−x_{7}=x_{8}} are invariant under the linear signed consensus dynamics associated with network G.  ◊
Table I. 
The set of the external equitable partitions of the network G in Fig. 2. The set of the equitable partitions of G is given by the first three rows.
Table II. 
The set of synchrony subspaces of the network G in Fig. 1.
Table III. 
The set of the signed external equitable partitions of G in Fig. 3 that corresponds to the network in Fig. 7 of Ref [17].
Table I. -body
{{1,2},{3},{4},{5},{6},{7},{8}}
{{1},{2},{3},{4},{5},{6},{7,8}}
{{1,2},{3},{4},{5},{6},{7,8}}
{{1,2,7,8},{3,6},{4,5}}
{{1,2,4,5,7,8},{3,6}}
{{1,2,3,4,5,6,7,8}}
Table II. -body
R^{4}	{x: x_{1}=x_{2}=x_{3}}
{x:x_{1}=x_{2}}	{x:x_{1}=x_{2}=x_{4}}
{x:x_{1}=x_{4}}	{x:x_{1}=x_{2};x_{3}=x_{4}}
{x:x_{2}=x_{4}}	{x:x_{1}=x_{2}=x_{3}=x_{4}}
Table III. -body
{{1,2},{3,4},{5},{6,7,8}}
{{1,2,3,4,5,6,7,8}}
FIG. 1. 
A weighted 4-cell regular network G of valency two with the synchrony subspace Δ={x:x_{1}=x_{2}}: {{1,2},{3},{4}} is an equitable partition of G; ⋈, where 1⋈2 is a balanced equivalence relation of G. The corresponding quotient is the 3-cell bidirectional ring Q.
FIG. 2. 
The network G of example II.12 that corresponds to the network in Fig. 4 of Ref [17].
FIG. 3. 
The network G of example IV.4 that corresponds to the network in Fig. 7 of Ref [17].

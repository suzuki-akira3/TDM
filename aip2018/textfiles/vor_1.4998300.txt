Grid-converged solution and analysis of the unsteady viscous flow in a two-dimensional shock tube
The flow in a shock tube is extremely complex with dynamic multi-scale structures of sharp fronts, flow separation, and vortices due to the interaction of the shock wave, the contact surface, and the boundary layer over the side wall of the tube. Prediction and understanding of the complex fluid dynamics are of theoretical and practical importance. It is also an extremely challenging problem for numerical simulation, especially at relatively high Reynolds numbers. Daru and Tenaud [“Evaluation of TVD high resolution schemes for unsteady viscous shocked flows,” Comput. Fluids 30, 89–113 (2001)] proposed a two-dimensional model problem as a numerical test case for high-resolution schemes to simulate the flow field in a square closed shock tube. Though many researchers attempted this problem using a variety of computational methods, there is not yet an agreed-upon grid-converged solution of the problem at the Reynolds number of 1000. This paper presents a rigorous grid-convergence study and the resulting grid-converged solutions for this problem by using a newly developed, efficient, and high-order gas-kinetic scheme. Critical data extracted from the converged solutions are documented as benchmark data. The complex fluid dynamics of the flow at Re = 1000 are discussed and analyzed in detail. Major phenomena revealed by the numerical computations include the downward concentration of the fluid through the curved shock, the formation of the vortices, the mechanism of the shock wave bifurcation, the structure of the jet along the bottom wall, and the Kelvin-Helmholtz instability near the contact surface. Presentation and analysis of those flow processes provide important physical insight into the complex flow physics occurring in a shock tube.
I. INTRODUCTION
The shock tube is used as an experimental apparatus for studies of hypersonic flow and chemical reactions. The shock wave reflected from the end wall interacts with the boundary layer on the side wall induced by the incident shock as shown schematically in Fig. 1. Compression by the main high-energy flow from the left causes the fluid at the end wall to “leak” backwards near the bottom wall where the fluid dynamic pressure is low because of the wall boundary layer. In time, the forward flow and backward flow in the boundary layer separate from the bottom wall resulting in a complex system of vortices, shock wave bifurcation, and other various flow structures. The homogeneity of the flow conditions in that region, however, is important for experimental tests using the shock tube ( [Bull and Edwards, 1968]).  [Mark (1958)] was the first to study this type of shock-wave/boundary-layer interaction. He developed a model based on the experimental results for analysis and prediction of the flow configuration.  [Byron and Rott (1961)] used a more realistic model, which is applicable for higher Mach numbers compared to Mark’s model. Subsequent theoretical analyses can be found in  [Davies and Wilson (1969)] and  [Stalker and Crane (1978)].
In the recent decades, experiments and numerical simulations of this problem have been reported by other authors ( [Kleine et_al, 1992];  [Wilson et_al, 1995]; and  [Weber et_al, 1995]). As the viscosity plays an important role in the development of the flow field, the Reynolds number is a key parameter determining the features of the interaction. Differences of the Reynolds numbers used in the above papers make it difficult for comparison and analysis between their reported results.
 [Daru and Tenaud (2001)] proposed a two-dimensional model problem for numerical simulation of the flow field in a viscous shock tube, which is designed for evaluating different numerical methods. This is a time-dependent unsteady problem. At moderate Reynolds numbers, a number of vortices appear in the computational domain due to high shearing effects, with length scales varying in a wide range. The multi-scale nature and the complicated flow field make it a good test case for high-order high-resolution schemes. As very fine grids are needed to resolve small structures, a practical problem is whether the computation could be completed within acceptable computational time. Therefore, this case is a challenge for the robustness, accuracy, resolution, and efficiency of a numerical method. In addition, this test case provides a clean problem to analyze and understand the fundamental flow physics of complex interactions between the shock, contact surface, and boundary layer all happening in a seemingly simple shock tube.
Since presented by  [Daru and Tenaud (2001)], the viscous shock tube problem has been studied in many articles ( [Sjögreen and Yee, 2003];  [Daru and Tenaud, 2004];  [Kim and Kim, 2005a];  [2005b];  [Daru and Tenaud, 2009];  [Li et_al, 2010b];  [Houim and Kuo, 2011];  [Wan et_al, 2012];  [Sun et_al, 2014];  [Kotov et_al, 2014];  [Tenaud et_al, 2015];  [Wang and Ren, 2015];  [Pan and Xu, 2016]; and  [Pan et_al, 2016]). The cases with Reynolds numbers of 200 and 1000 are most frequently used. The results for the Re = 200 case by different schemes are generally similar. But for the Re = 1000 case, a range of solutions that are noticeably different have been reported in different papers. A grid-converged solution has not been shown at this Reynolds number. In this paper, grid-converged solutions are successfully obtained at both Reynolds numbers.
The gas-kinetic scheme (GKS) developed by  [Xu] ( [1998];  [2001]) has drawn much attention in recent years because of its use of physically motivated method for calculating the numerical fluxes in evolution of the conservation laws. This method employs the BGK-type Boltzmann equation (BGK is named after Bhatnagar, Gross and Krook, the three authors of the paper  [Bhatnagar et_al, 1954]) instead of the Navier–Stokes (NS) equations. A gas distribution function is modelled to represent the flow status. Then all macroscopic variables are simply the moments of the distribution function. The GKS method has some unique advantages compared with most traditional numerical schemes. On the one hand, the computations in space and time are coupled since the variables x, y, and t all appear explicitly in the integration of the gas distribution function. On the other hand, the inviscid and viscous fluxes are treated simultaneously, which avoids the potential inconsistency introduced by the decoupling of the computation of the two kinds of fluxes. The gas-kinetic scheme is a method applicable for simulations of both low-speed flows and high-speed supersonic flows ( [Xu, 2001] and  [Xu et_al, 2005]). This property makes it a very suitable scheme for the computation of the viscous shock tube problem since there exist both low-speed flow inside the boundary layer and high-speed flow outside the boundary layer in the flow field.
To achieve higher accuracy, a high-order gas-kinetic scheme is used in this paper to simulate the flow in the shock tube. The high-order GKS has been extended from the original 2nd-order GKS recently by different researchers ( [Li et_al, 2010a];  [Kumar et_al, 2013];  [Luo and Xu, 2013]; and  [Liu and Tang, 2014]). A high-order gas-kinetic scheme not only uses a high-order reconstruction technique but also has a high-order model for the gas evolution process. Since the gas evolution model for the GKS is intrinsically multidimensional, no Gaussian points are needed for integration at the cell interface. Moreover, with the inclusion of time derivatives in the expression of the flux function, the GKS is time accurate hence no complex time-marching schemes are needed. However, a limitation of the gas-kinetic scheme is the computational cost. Since a microscopic gas distribution function is constructed as an intermediate step between the conservative variables and the fluxes, a lot of coefficients are introduced during the computation, and many integrations are needed. So this scheme generally takes more time than NS solvers. To overcome this weakness, based on the high-order gas-kinetic scheme proposed by  [Luo and Xu (2013)] which employs the WENO-JS (Weighted Essentially Non-Oscillatory method with Jiang and Shu’s implementation, see  [Liu et_al, 1994] and  [Jiang and Shu, 1996]) reconstruction technique and a high-order gas evolution model, several simplifications are made by the authors and the resultant scheme enhances the efficiency by about 400% for two-dimensional flows ( [Zhou et_al, 2017]). The accuracy and robustness of the new scheme have been validated by a number of stringent inviscid and viscous, low-speed and high-speed test cases in  [Zhou et_al (2017)]. In this paper, we will use this efficient high-order gas-kinetic scheme to simulate the viscous shock tube problem with very fine grids and obtain grid-converged solutions at both Re = 200 and Re = 1000.
In Sec. II, we will first outline the numerical method. Section III spells out the specification and computational conditions of the shock tube problem. The solutions at Re = 200 and Re = 1000 are presented in Secs. IV and V. Section V focuses on the difficult case at Re = 1000. A rigorous grid-convergence study based on the Grid-Convergence Index (GCI) is presented and used to prove grid convergence of our computations on a sequence of successively refined grids. The grid-converged solution provides fine details of the complex flow structure for the Re = 1000 case. In Sec. VI, we discuss and analyze the detailed evolution of the fluid dynamics revealed by the numerical solution starting from the initiation of the incident shock wave and contact surface through a sequence of phenomena including the downward concentration of the fluid through the curved shock, the formation of the vortices, the bifurcation of the shock wave, the creation of a jet-like flow toward the bottom wall, and vortex structures created by the Kelvin-Helmholtz instability near the contact surface. Finally, we draw the conclusions in Sec. VII.
II. NUMERICAL PROCEDURE
In this section, we give a brief introduction to the numerical method. More details can be found in  [Luo and Xu (2013)] and  [Zhou et_al (2017)].
In a finite-volume framework, the role of the gas-kinetic scheme is to provide the fluxes across the cell interfaces. We start from the BGK equation ( [Bhatnagar et_al, 1954])
where f is the gas distribution function, g is the equilibrium state that f approaches, u = (u, v)^{T} is the particle velocity, and τ is the collision time. For two-dimensional flow, the equilibrium (Maxwellian) distribution is
where ρ is the density, U and V are the macroscopic velocities in the x and y directions. λ = m/2kT, where m is the molecular mass, k is the Boltzmann constant, and T is the temperature. K is the number of internal degrees of freedom which equals to 3 for diatomic molecules. ξ is the internal variable with ξ^{2}=ξ12+ξ22+⋯+ξK2.
Equation (1) has an analytical integral solution
where x′ = x − u(t − t′) is the particle trajectory. Therefore f depends on the equilibrium distribution function g(x, t, u, ξ) and the initial distribution function f_{0}(x, u, ξ).
Let g = g(0, 0, u, ξ) denote the Maxwellian distribution at the point (x, y, t) = (0, 0, 0). Then g̃, the equilibrium distribution in the neighbourhood, can be expressed via the Taylor expansion to the second order,
According to the Chapman-Enskog expansion, to the order of the Navier-Stokes equations, the non-equilibrium distribution f has the following relation with the equilibrium distribution g ( [Ohwada and Xu, 2004]):
Expanding each term of f at the point (x, y, t) = (0, 0, 0) and neglecting high-order derivatives of g, we have
Note that for an arbitrarily given equilibrium state g, there exist g̃ and f̃ corresponding to g. Then we have the form g̃=g̃(g,x,t,u) and f̃=f̃(g,x,t,u). The initial state at the cell interface should be discontinuous,
where g0l and g0r correspond to the reconstructed conservative variables at the left and right sides of the cell interface, respectively, i.e.,
where dΞ = dudvdξ, dξ = dξ_{1}dξ_{2}…dξ_{K}, and ψ is the vector of moments,
On the other hand, the equilibrium distribution function in the integral of the solution is replaced by
where the equilibrium distribution g^{e} is obtained from the statuses of both sides,
Substituting the expressions of f_{0} and g into Eq. (3) and neglecting some unimportant terms ( [Zhou et_al, 2017]), the final form of the distribution function reads
The method for evaluating the derivatives of g in the above expansion is detailed in  [Xu (2001)] and  [Zhou et_al (2017)]. The collision time is determined by
where μ is the dynamic viscosity and p^{e} is the pressure corresponding to g^{e}. τ_{n} is the numerical collision time which contains artificial dissipation ( [Luo and Xu, 2013]). Note that an adaptive function e^{1−η−10} is designed for the numerical collision time. This function ensures that τ_{n} differs from τ only when the normalized pressure difference η is large enough. By performing this, we aim to provide a necessary but minimum artificial dissipation. α is a constant and is taken to be 0.3 for all computations in this paper.
Once the distribution function f is obtained, the flux at a vertically placed cell interface can then be expressed as
For a rectangular cell [x_{i−1/2}, x_{i+1/2}] × [y_{j−1/2}, y_{j+1/2}] with dimensions Δx_{i} = x_{i+1/2} − x_{i−1/2} and Δy_{j} = y_{j+1/2} − y_{j−1/2}, the cell-averaged conservative variable W_{ij} is updated from the time t_{n} to t_{n+1} as follows:
Since F is an explicit function of t and x, y, the integrations in Eq. (15) can be easily obtained.
To provide the initial values for the evolution process, the macroscopic variables and their derivatives need to be constructed before each computational step. In the perpendicular direction of the cell interface, a standard 5th-order WENO-JS method ( [Jiang and Shu, 1996]) is used to determine the value of the variables on both sides of the interface. Following the suggestion in  [Shu (1997)], the characteristic variables are used instead of conservative variables. The results of the one-dimensional WENO scheme are line-averaged values. A third-order interpolation is then used to obtain the value at the midpoint of the interface. After that, the first- and second-order derivatives in both the x and y directions can be calculated from the reconstructed variables.
III. DESCRIPTION OF THE VISCOUS SHOCK TUBE PROBLEM
The viscous shock tube problem was proposed by  [Daru and Tenaud (2001)]. A diaphragm is vertically located in the middle of a square 2-D shock tube with a unit side length, separating the space into the left and right parts. The initial state in non-dimensional form is given by
where γ = 1.4 is the specific heat ratio of air. The Prandtl number is taken to be Pr = 0.73. No-slip adiabatic conditions are applied at all boundaries of the tube.
The diaphragm is broken instantly at t = 0. A shock wave with the Mach number Ma = 2.37 forms and moves toward the right, followed by a contact discontinuity. Simultaneously, a rarefaction wave expands in both directions. Figure 2 shows the evolution of density, velocity, and pressure from t = 0 to t = 1 in the inviscid case (hence the flow is one-dimensional). It is seen from the figures that the incident shock reaches the right wall at about t = 0.21. Then it is reflected back to the left, later interacting with the contact discontinuity.
With presence of viscosity, the incident shock wave induces boundary layers along the horizontal walls of the tube. They will then interact with the incident and reflected shock, as well as other structures appearing later. In Fig. 2, we can observe a number of wave reflections and interactions in the region close to the right wall for the one-dimensional inviscid case. It is the two-dimensional viscous case that presents a much more complicated and thus interesting flow field, which is the focus of this paper.
Since the configuration is symmetric about the line y = 0.5, only half of the tube [0, 1] × [0, 0.5] is computed, and the symmetric condition is applied on the top boundary. We focus on the evolution of the flow field from t = 0 to t = 1 at Reynolds numbers of 200 and 1000. The viscosity is assumed to be constant (so that μ = 1/Re). All grids used are uniform with Δx = Δy. The CFL (Courant-Friedrichs-Lewy) number is 1.0 for all computations.
IV. THE Re = 200 CASE
The Re = 200 case has been simulated by many authors ( [Daru and Tenaud, 2001];  [Sjögreen and Yee, 2003];  [Daru and Tenaud, 2004];  [Kim and Kim, 2005a];  [2005b];  [Daru and Tenaud, 2009];  [Houim and Kuo, 2011];  [Wan et_al, 2012];  [Sun et_al, 2014];  [Kotov et_al, 2014];  [Tenaud et_al, 2015];  [Wang and Ren, 2015];  [Pan and Xu, 2016]; and  [Pan et_al, 2016]). At this relatively low Reynolds number, the results presented in different papers are quite consistent when the grid is fine enough. As reported in  [Daru and Tenaud (2009)], the sufficient grid resolution is 1000 × 500 for the high-order scheme presented therein. Other computations ( [Daru and Tenaud, 2001] and  [Sjögreen and Yee, 2003]) indicate that the behavior of high-order methods is obviously better than that of the second-order ones.
An important problem of the previous studies is the lack of adequate criteria for the judgement of convergence and for the comparison between results.  [Daru and Tenaud] ( [2001];  [2009]) used the plot of density distribution along the bottom wall to demonstrate convergence. This method was also adopted by some other authors ( [Kim and Kim, 2005a];  [2005b]; and  [Pan et_al, 2016]). Another commonly used criterion is to compare the height of the primary vortex ( [Kim and Kim, 2005a];  [2005b];  [Wang and Ren, 2015];  [Pan and Xu, 2016]; and  [Pan et_al, 2016]). On the same uniform 500 × 250 grid, the reported vortex height varies from 0.163 to 0.171 by different schemes. However, it is found that the flow structures are not necessarily the same even when the vortex heights are very close.
The grid convergence for the present scheme is illustrated in Fig. 3, where the density contours at t = 1 are presented. The results by the 500 × 250 grid and the 1000 × 500 grid are almost indistinguishable. Figure 4(a) shows the density distribution along the bottom wall. The curves from the 500 × 250 grid to the 1500 × 750 grid are nearly identical. Even with a coarser 250 × 125 grid, a very good result is obtained.
We think that the density distribution along the bottom wall is a good criterion for the convergence study. Some critical points on the curve of the finest grid are extracted and listed in Table I as a reference for comparison. The positions of the selected points are given in Fig. 4(b). For macroscopic evaluations of the computed results, we recommend the following three criteria which are easily measured in the density contour plot, see Fig. 5:
1. The position of the triple point, which is approximately (x, y) = (0.58, 0.137).
2. The height of the primary vortex, which is approximately 0.166.
3. The orientation of the long axis of the primary vortex. This is an obvious criterion for qualitative evaluation.
V. THE Re = 1000 CASE: NUMERICAL SIMULATION
The above case at Re = 200 serves as verification for the present computational code. When the Reynolds number is increased to 1000, many fine flow structures appear; hence the flow field becomes more complex. This case has been simulated in several papers ( [Daru and Tenaud, 2001];  [Sjögreen and Yee, 2003];  [Daru and Tenaud, 2004];  [2009];  [Li et_al, 2010b];  [Wan et_al, 2012];  [Kotov et_al, 2014]; and  [Pan et_al, 2016]). The results from different papers or even from different methods in the same paper are very different. One reason is the sensitivity of the problem to the computational conditions and another reason is that the grids used in the previous studies are not fine enough to achieve grid convergence due to the practical limit on computational time. Grid-convergence studies were performed in  [Daru and Tenaud (2001)],  [Sjögreen and Yee (2003)], and  [Daru and Tenaud (2009)] with different numerical methods including classical TVD schemes and various high-order schemes. The most successful result is obtained by  [Daru and Tenaud (2009)], where two high-order schemes (RK3-WENO5 and OSMP7) showed the same trend of convergence, and the results on the two finest grids (3000 × 1500 and 4000 × 2000) are very similar. However, some small visible differences still exist on the two sets of grids, as noted in  [Daru and Tenaud (2009)]. Armed with the new accurate and efficient gas-kinetic scheme, we perform in this section a rigorous systematic grid-convergence study of the viscous shock tube problem at Re = 1000.
A. Numerical results
Five successively refined grids are used for investigation, which are 1000 × 500, 2000 × 1000, 3000 × 1500, 4000 × 2000, and 5000 × 2500, respectively. Figure 6 shows the density distribution at t = 1 on different grids. It is clear that a converged solution in terms of the density field is obtained on the 3000 × 1500 grid. And the main features of the vortex structures are able to be predicted on the 2000 × 1000 grid.
The shock tube problem of the present study contains a wide range of spatial and time scales accounting for the difficulty in obtaining grid-converged solutions despite long computational time. For the present work, the averaged central processing unit (CPU) time for one time step and one grid point is 3.3 × 10^{−6} s with the Intel Xeon CPU E5-1620 v3 at 3.50 GHz. In practice, we did parallel computing with OpenMP on 4 cores. The computational speed is then enhanced by around 160%. With CFL = 1.0, the wall time for a simulation on the 3000 × 1500 grid (on which the converged result is obtained) is 50 h. While for the finest 5000 × 2500 grid, the computation was finished within 12 days, which is deemed acceptable since the aim of this paper is to establish grid-converged solutions so that we can gain reliable results and insight into the physics of the complex flow.
To perform a quantitative comparison, the density distribution along the bottom wall is shown in Fig. 7(a). The difference between the curves on the 2000 × 1000 and 3000 × 1500 grids is already very small. As in the Re = 200 case, the critical points of the density distribution obtained on the finest grid are extracted and listed in Table II as a reference. The positions of the selected points are shown in Fig. 7(b).
Although  [Daru and Tenaud (2009)] did not perform a rigorous grid-convergence analysis, the solution based on wall density distribution and limited contour plots in their paper on their finest 4000 × 2000 grid appears to be very close to ours among all the varying numerical results previously published.
As a demonstration of the necessity of using very fine grids to compute this problem, the shear stress on the bottom wall at t = 1 is plotted in Fig. 8. It is shown that the wall shear stress changes sign 16 times on the wall. This behavior mainly results from the generation of a number of vortices with different sizes and directions near the wall during the evolution of the flow field, which are difficult to resolve on a coarse grid. For completeness and benchmark reference, the pressure along the bottom wall is also presented in Fig. 9.
B. Grid refinement study with the grid-convergence index approach
As shown in Fig. 6, we can hardly see any difference in the plot of the density distribution on the grids 3000 × 1500, 4000 × 2000, and 5000 × 2500. Since the flow field is very complex, it is important to develop some quantitative measure on the convergence of the computational solutions to the presumed exact solution as the grid spacing is refined to approach zero. We adopt the Grid-Convergence Index (GCI) approach proposed by  [Roache] ( [1994];  [1997]).
Based on the generalized theory of the Richardson extrapolation ( [Richardson, 1911]), the grid-convergence index is defined to uniformly report the grid refinement tests. Assuming f_{1} and f_{2} are solutions on a fine grid and a coarse grid, respectively, the relative error is expressed as
Then the GCI of the fine-grid solution is defined by the following formula:
where r is the ratio of the grid spacing between the coarse and fine grids (r = h_{2}/h_{1} > 1), and p is the order of accuracy of the scheme. c_{s} = 3 is a safety factor. As pointed out by  [Roache (1994)], the GCI gives a conservative estimate of the error relative to the unknown “exact” solution.
The underlying assumption of the GCI approach is the smoothness of the solution. The solution must have a Taylor series expansion at least up to the order of the numerical scheme. Despite the existence of many sharp “discontinuities” in the present shock tube problem, the solution of the Navier-Stokes equations is not strictly discontinuous. Thus, the GCI still serves as a reliable measure on the convergence of our computations when the grids used are sufficiently fine enough.
In detail, the GCI on the 2000 × 1000 and finer grids is computed. The calculations are performed on the target grid and the first coarser grid next to it, e.g., to get the GCI of the solution on the 3000 × 1500 grid, the solutions on the 3000 × 1500 grid and its neighbouring 2000 × 1000 grid are used in Eqs. (17) and (18).
In particular, we choose the 1000 × 500 grid as a standard stencil. The GCI based on the averaged density in each stencil cell is computed. Since the cell numbers of all grids are integer multiples of the stencil cell number in both the x and y directions, no interpolation or other approximation is needed. Following the suggestion of  [Roache (1994)], since a uniform order p cannot be found across the field which contains shocks and other discontinuities, a conservative value p = 1 is used. After the GCI on each cell of the stencil is obtained, the average and root mean square of all the GCIs are taken and reported.
 [Roache (1994)] also proposed a method for checking whether the asymptotic range of convergence is reached by two GCIs on three different grids, on the premise that the order of scheme is known. This is based on the fact that the GCI is essentially an estimate of the error level. Similarly, in the present case that the practical order of the scheme cannot be well defined, we assume that when three GCIs are located in a straight line in the log-log plot against the grid spacing, a conclusion can be drawn that the solution is converging with a constant order.
The results are shown in Fig. 10. For both averaging methods, the points corresponding to the 3000 × 1500 grid, the 4000 × 2000 grid, and the 5000 × 2500 grid are approximately in a line, indicating that the asymptotic range is achieved on the 3000 × 1500 grid, whereas the result of the 2000 × 1000 grid is out of the range. This conclusion agrees well with Fig. 6, where the visible details of the density distribution stay unchanged for the 3000 × 1500 and finer grids, but not for the 2000 × 1000 one.
If we go back to the original meaning of the GCI, it is seen in Fig. 10, from an overall perspective, that the averaged relative error of the result obtained by the 5000 × 2500 grid is less than 1%, with respect to the exact solution.
The viscous shock tube problem at Re = 1000 is naively simple in geometry and initial and boundary conditions. Yet, it encompasses the evolution of almost all elementary flow phenomena of a viscous compressible flow and their mutual interactions, resulting in a complex dynamic flow field with a multitude of fine scales. As such it offers a difficult but arguably necessary test case to demonstrate the accuracy and efficiency of modern high-resolution and high-order numerical methods for compressible viscous flows. The grid-converged solution for this problem as well as the rigorous GCI approach presented here provides the research community a useful database and approach in comparing and assessing different numerical methods for their numerical discretization, flux models, shock capture strategies, effect of numerical dissipation, time evolution, and implementation of boundary conditions. In addition, the achievement of the grid-converged solution enables us to perform analysis of the complex unsteady flow physics of the shock tube problem with no uncertainty, which is the focus of Sec. VI.
VI. THE Re = 1000 CASE: ANALYSIS OF THE COMPLEX FLOW PHYSICS
The dynamic evolution of the flow field at Re = 1000 is of great significance for understanding the fluid dynamics of the interactions between boundary layers, vortices, and wave systems in supersonic flow. Analysis and discussion of the flow physics of this problem, however, have been rather minimum in previous papers except those by  [Daru and Tenaud] ( [2004];  [2009]).  [Chen (2015)] calculated a slightly different problem and gave some discussions on the flow behavior at early stages. This is due partly to the complexity of this problem and partly lack of adequate proof of numerical convergence.
The objectives of this paper are two-fold: (1) to establish a previously unachieved grid-independent solution of the viscous shock tube problem as benchmark solution for the research community; (2) to provide new details and insight into the physics of the complex flow in a viscous shock tube. On obtaining the grid-converged solution on the 3000 × 1500 grid following the rigorous grid-convergence study in Sec. V B, we are now able to provide much more reliable and detailed data on the evolution of the flow in the shock tube compared to previous researchers. In this section, we present and analyze many carefully selected, new, and finely resolved snapshots of the flow field at different time instants to reveal the detailed dynamic processes of the flow.
Before detailed description, we present the whole history of the physical dynamic process in Fig. 11, where the magnitude of the density gradient at different time points of interest is shown in chronological order.
At t = 0, break of the diaphragm results in three different waves: a right-moving shock wave, a contact discontinuity following the shock, and an expansion wave propagating in both directions. The waves travel freely into the undisturbed region creating a boundary layer on the bottom wall behind, see Fig. 12. This configuration is similar to the inviscid case in Fig. 2, except for the creation of the wall boundary layer and thickening of the two discontinuities (especially the contact discontinuity) due to the viscous effect.
The boundary layer is attached to and dragged by the right-moving shock wave, as can be seen in Fig. 12(b), where the distribution of the velocity in the x-direction is shown. The boundary layer thickens as one moves away from its initiation point at the foot of the shock much like a usual boundary layer over a flat plate until x = 0.75 where the contact discontinuity is located. The effective Reynolds number is increased due to the high density in the freestream flow behind the contact surface, resulting in a decrease of the boundary layer thickness.
At this stage, the boundary layer is behind the shock wave and is theoretically of zero thickness at the foot of the shock. Therefore, the shock front remains effectively straight across the channel and curves only slightly as it touches the wall. On the contrary, the contact discontinuity, being a material wave front that moves with the fluid, is dramatically bent over the boundary layer because of the no-slip condition on the wall. It is seen from Fig. 12(a) that a very oblique contact discontinuity is stretched along the horizontal wall and it connects with the vertical one outside the boundary layer.
The curved near-wall section of the shock wave gets enlarged with time. Since the pressure gradient is perpendicular to the shock surface, the curving of the shock generates a non-zero y-direction component of the pressure gradient. Figure 13(a) shows the distribution of the magnitude of the pressure gradient at t = 0.15. The shock is more curved at locations closer to the wall. The y-component of the pressure gradient is shown in Fig. 13(b). Obviously this quantity is closely related to the curvature of the shock. As a consequence, the fluid will experience a sudden acceleration when it flows across the narrow shock, obtaining a downward velocity. Although this velocity is very small and nearly invisible because of the much larger flow velocity in the x-direction, later we will see that it is of great importance in the following dynamic process.
At about t = 0.21, the right-travelling shock wave encounters the end wall and is then reflected by it. As the shock is curved, it reaches the wall successively from upper parts to lower parts. Figure 14 presents the three snapshots around the time of reflection. In Fig. 14(a), the upper part shown in the plot has just moved to the wall; in Fig. 14(b), the upper part has been reflected back while the lower part just touches the wall; in Fig. 14(c), the lower part has also completed the reflection. Since theoretically the horizontal velocity of the flow in the region behind a reflected normal shock is zero, the downward-concentrating effect of the curved shock can be observed very obviously in Figs. 14(b) and 14(c). It is clear from the streamlines that the fluid flows to the lower-right corner from upper regions behind the reflected shock wave. However, we emphasize that this process started from the very beginning: A region with negative velocity in the y-direction always exists after the shock wave is generated, see Fig. 15(a). The gathering of flow near the root of the shock makes the density there larger, as shown in Fig. 15(b). To get a better view, a Galilean transform is made at t = 0.2: A constant is subtracted from the U velocity in the flow field, so that the V velocity is shown more clearly. The streamlines after the transformation are presented in Fig. 16. It demonstrates how the fluid is moving to the bottom wall. This process has no essential difference with the phenomenon behind the reflected shock shown in Fig. 14.
We now focus on the flow in the lower right corner. It is seen from Fig. 15(c) that the shock wave disperses near the bottom wall due to the viscous effect. Hence it is more like a sequence of compression waves in this region. In addition, the shock is very curved there and the strength in the x-direction is then weakened. As a consequence, the reflected wave in the near-wall region is not as strong as that in the upper region where the incident shock is thin and normal to the right wall. This effect creates a pressure gradient pointing to the lower left direction, see Fig. 17. Driven by such a pressure gradient, the downward flow alters its direction to the left. Figures 17(a)–17(d) display the process that how the streamlines adjust to become nearly perpendicular to the pressure contour lines.
The reversed flow at the lower-right corner shown in Fig. 17(d) soon encounters the incident flow near the left edge of the reflected shock. With continuous supply of fluid, an oblique separation line forms and gets longer between the two parts of the fluid. This process is shown in Fig. 18. In the last three snapshots of Fig. 18, we can see that the fluid on each side of the separation line is forced to split downward and upward, generating two sink points at the ends of the separation line and a saddle point in the middle.
The clashing of the two opposing streams near the wall forces the separation line to stretch and lift up due to mass conservation. At the upper end of the separation line, the higher-energy flow on the left overpowers the flow from the right, wrapping around to form a clockwise vortex, which gets larger in size with entrainment of more fluids, see Fig. 19. Notice that the streamlines and the pressure contour lines finally adjust to be orthogonal to each other.
It is interesting that there is a close connection between the vortex and the oblique reflected shock wave. Notice that the left edge of the vortex is aligned with the oblique shock. The rotation of the vortex makes the difference on the left and right sides of the oblique shock greater so that the strength of the shock is enhanced. And the asymmetric pressure distribution in the direction parallel to the oblique shock caused by the vortex rotation makes the shock more oblique, as shown in Fig. 20. On the other hand, after the flow passes the oblique shock, the normal component of the velocity decreases to near zero, while the tangential component remains unchanged. Therefore, the fluid behind the oblique reflected shock flows upwards along it, which is in the same direction with the rotating flow in the vortex. This means that the oblique shock provides a momentum injection mechanism to the vortex and makes it larger and stronger.
The process in this stage can also be interpreted in another view: The downward moving fluid behind the reflected shock wave carries higher momentum than the fluid in the boundary layer. Then it is easy for the former to insert inside the boundary layer, as shown in Fig. 21, where the momentum vectors and the distribution of the momentum magnitude are plotted.
At about t = 0.27, the reflected shock wave encounters the right-travelling contact discontinuity and is nearly stopped by it. The contact discontinuity then moves on with a lower speed. Simultaneously, a new shock wave is formed and propagates to the right. The interaction process is presented in Fig. 22. Notice that the contact discontinuity has not reached the reflected shock wave in Fig. 22(a).
The flow in the bulk region away from the bottom wall is similar to the one-dimensional inviscid case, whereas the configuration in the near-wall region is much more complex. Since the shock wave becomes oblique in the lower region, the change of the flow passing the normal shock and the oblique shock is different. This difference of the two regions behind the reflected shock becomes extreme after the contact discontinuity brings the large-density and high-momentum fluid behind it. Remember that the vortex is carrying the fluid along the oblique shock from the lower region to the upper region. To accommodate the huge difference of the fluid property, a shock appears at the interface between the two regions, i.e., bifurcation occurs at the junction point of the normal shock and the oblique shock, see Fig. 22(c). This process is more clearly presented in Fig. 23, where we can see a lambda-shaped structure around the triple point.
At about t = 0.32, the new shock wave produced by the shock/contact-discontinuity interaction has been reflected back by the right wall (see Fig. 2). It then crosses the right-moving contact discontinuity and is slowed down by it. After that, the shock interacts with the vortex and then with the stationary shock, making it start to move again to the left, along with the triple point of the lambda-shaped shock. There are also many other secondary waves and a number of interactions between them at this stage, but they are relatively weak. Hence, they do not affect the primary picture much.
Later when the vortex is stronger, it dominates the local flow field. We can see from Fig. 24 that the dense fluids are entrained by the vortical flow around the core of the vortex, creating a jet inserting into the bottom lighter fluids. The momentum magnitude distributions are plotted in Fig. 25, showing how the jet is generated at the lower right corner of the high-momentum region.
In another view, the jet is enclosed by two contact discontinuities, one of which originates from the vertical contact discontinuity, while the other originates from the oblique contact discontinuity. This mechanism is clearly shown in Figs. 11(a)–11(c). In Fig. 11(a), the two contact discontinuities with different orientations are presented in the density-gradient-magnitude contour map. Then the horizontal discontinuity encounters the oblique shock wave, and the vertical contact discontinuity encounters both the normal and oblique shocks. The two contact discontinuities become stronger after getting through the shock wave, and their shape remains the same, except that the horizontal one is a little deflected up by the oblique shock. Then they are both bent and carried down by the vortex, forming the two boundaries of the jet.
As the horizontal contact discontinuity is deflected behind the oblique shock wave, a wedge-shaped area appears between it and the bottom wall. In Fig. 26(a), we can see that the jet becomes longer and extends to the left, alternatively reflecting on the two boundaries of the wedge-shaped area. This area is then divided by the jet into several individual regions distributed on both sides of the jet. Small secondary vortices are induced by the jet in these individual regions. And these vortices may further induce smaller vortices. See the section between x = 0.85 and x = 0.9 in Fig. 26(a). This demonstrates the multi-scale feature of the flow field. To avoid ambiguity, the vortex formed at the beginning will be called the primary vortex hereinafter. It should be noted that a large vortex is generated by the primary vortex in the lower right corner.
From Fig. 26(a) which shows the distribution of the momentum magnitude, it is also found that the upper right edge of the primary vortex is a thin contact surface. Therefore the Kelvin-Helmholtz instability occurs around it, which is shown in Fig. 11(f), where a sequence of vortical structures is observed near the contact surface. These structures are driven by the primary vortex down to the corner and merged with the stationary contact discontinuity located at around x = 0.94. After getting to the bottom wall, the vortical structures are taken over by the counterclockwise-rotating corner vortex shown in Fig. 26(a). The corner vortex carries these structures upward along its streamlines. This process is presented in Figs. 11(g)–11(i). Meanwhile, the wide stationary contact discontinuity at about x = 0.97 is rolled up. In Fig. 11(i), we can see that the big rotating structure at the lower right corner involves at least four contact discontinuities altogether.
The distribution of the momentum magnitude at t = 0.75 is plotted in Fig. 26(b). It is clear that besides the left-moving zigzagging jet beneath the deflected contact discontinuity, there is another jet turning right at about x = 0.92 along the streamlines of the corner vortex. In fact, this flow pattern can be found at each point where the jet impinges on the bottom wall, which is also the lower boundary of the wedge-shaped area: The jet is split by the wall into two branches due to its high momentum: the bigger turning to the left and the smaller to the right (see Fig. 27).
As for the upper boundary of the wedge-shaped area, when the jet impinges on it, a part of the jet will be ejected up leaking into the outer region above the deflected contact discontinuity. This phenomenon is demonstrated by the streamlines in Fig. 26(b). Clearly that the jet is not totally restricted in the wedge-shaped area. The ejected fluids are then taken to the right by the high-momentum flow in the outer region, producing a pulling force which makes the jet broken at the contacting points, as is shown in Fig. 27, where a gap is seen at about x = 0.7.
With presence of the gaps, the fluids under the jet are carried up by the ejected jet into the outer flow region. These hot and light fluids are also taken away by the outer high-momentum flow, forming thin filaments, the biggest among which finally bumps onto the left edge of the primary vortex, see the temperature distribution in Fig. 28.
On the other hand, the secondary vortices above the jet are lifted up as the ejected part of the jet is taken to the right by the outer fluid. Under the flushing of the high-speed outer flow, they are deformed rapidly and get closer to the neighbouring vortices, shown in Figs. 29(a)–29(d). Then the adjacent small vortices are merged into a big one since they share the same rotating direction, see Figs. 29(e) and 29(f). The rotation of the new big vortex tends to make the jet become straight. Also notice that the amount of the fluid under the jet has decreased due to the ejection from the gaps. The final result is that the small vortices in the wedge-shaped area all vanish, and the jet becomes very flattened.
VII. CONCLUSION
The viscous shock tube problem is simulated by an efficient high-order gas-kinetic scheme. Grid-convergence studies by using the GCI approach are presented for the two cases at Re = 200 and Re = 1000. Grid-converged solutions are achieved on the 500 × 250 grid for the Re = 200 case and on the 3000 × 1500 grid for the Re = 1000 case. Nevertheless, critical points on the curve of the density distribution along the bottom wall are extracted from the result obtained on the finest grid (1500 × 750 for Re = 200 and 5000 × 2500 for Re = 1000) as benchmark data. The viscous shock tube problem is a good test case for accuracy, resolution, and efficiency of high-order high-resolution schemes. We hope that the present results can serve as a benchmark solution.
The dynamic process of the Re = 1000 case is analyzed. Important evolution stages, flow structures, and physical phenomena are interpreted in detail, including the downward flow due to the shock curvature, the origin of the primary vortex, the shock bifurcation (the formation of the lambda-shaped shock), the Kelvin-Helmholtz instability, the components of the corner vortex, the secondary vortices, and their breaking up. These processes demonstrate the complexity of the interactions between shock waves, contact discontinuities, boundary layers, and multi-scale vortices.
TABLE I. 
Extracted data of the density along the bottom wall Re = 200.
TABLE II. 
Extracted data of the density along the bottom wall Re = 1000.
TABLE I. -body
x	ρ	x	ρ	x	ρ	x	ρ
0.3030	39.8418	0.6123	47.3367	0.7317	108.3916	0.8617	117.6452
0.4490	37.0662	0.6370	39.3203	0.7543	92.5760	0.9437	96.4287
0.5230	52.6465	0.6577	36.9558	0.7790	64.5319	0.9670	98.2689
0.5730	42.4400	0.6830	49.6513	0.7957	59.4386	0.9883	81.8465
0.5930	40.5506	0.7070	77.9810	0.8183	95.3607	0.9943	82.7077
TABLE II. -body
x	ρ	x	ρ	x	ρ	x	ρ
0.3001	39.5483	0.6063	36.6144	0.7491	72.8602	0.8817	118.8170
0.4391	36.9422	0.6173	37.3454	0.7579	56.5015	0.9081	106.8818
0.4525	38.1477	0.6405	30.9455	0.7621	67.0630	0.9239	102.2508
0.4811	60.1735	0.6581	35.1934	0.7701	74.9344	0.9447	97.2271
0.5085	53.2823	0.6703	45.5234	0.7839	53.1310	0.9631	99.4473
0.5121	53.4914	0.6761	42.6753	0.7909	50.8776	0.9739	77.4691
0.5265	44.3346	0.6891	67.0539	0.7991	65.2257	0.9785	81.3049
0.5355	43.1639	0.7111	94.2231	0.8051	85.1548	0.9829	77.2446
0.5631	38.6210	0.7391	69.4755	0.8121	82.7582	0.9923	97.4887
0.5769	38.9783	0.7451	67.8694	0.8399	106.8413	0.9999	85.6308
FIG. 1. 
Main flow structure of the interaction between the boundary layer and the reflected shock.
FIG. 2. 
x–t diagrams of (a) density, (b) velocity, and (c) pressure for the inviscid case.
FIG. 3. 
Density distribution at t = 1 for the Re = 200 case. 25 contours are equally spaced from 22 to 121 with the grids of (a) 250 × 125, (b) 500 × 250, (c) 1000 × 500, and (d) 1500 × 750.
FIG. 4. 
Density distribution along the bottom wall at t = 1 for the Re = 200 case. (a) Comparison of different grids; (b) positions of the selected points in Table I.
FIG. 5. 
Accuracy evaluation criteria for the Re = 200 case.
FIG. 6. 
Density distribution at t = 1 for the Re = 1000 case. 20 contours are equally spaced from 20 to 115 with the grids of (a) 1000 × 500, (b) 2000 × 1000, (c) 3000 × 1500, (d) 4000 × 2000, and (e) 5000 × 2500.
FIG. 7. 
Density distribution along the bottom wall at t = 1 for the Re = 1000 case. (a) Comparison between different grids; (b) positions of the selected points in Table II.
FIG. 8. 
Wall shear stress at t = 1 for the Re = 1000 case.
FIG. 9. 
Wall pressure at t = 1 for the Re = 1000 case.
FIG. 10. 
Overall grid-convergence index for the viscous shock tube problem at Re = 1000. h is the grid spacing.
FIG. 11. 
Distribution of density gradient magnitude at (a) t = 0.25, (b) t = 0.30 (the key structure is enlarged), (c) t = 0.35, (d) t = 0.40, (e) t = 0.45, (f) t = 0.50 (vortical structures are marked out), (g) t = 0.55, (h) t = 0.65, (i) t = 0.75, (j) t = 0.80, (k) t = 0.90, and (l) t = 1.00.
FIG. 12. 
Flow field at t = 0.15 (the y-axis is stretched for clarity): (a) distribution of density gradient magnitude; (b) distribution of the velocity in the x-direction.
FIG. 13. 
Distribution of the pressure gradient at t = 0.15: (a) pressure gradient magnitude; (b) y-component of the pressure gradient. The dashed lines indicate the vertical direction.
FIG. 14. 
Streamlines and the distribution of the y-component of the pressure gradient at (a) t = 0.2124, (b) t = 0.2140, and (c) t = 0.2146.
FIG. 15. 
Flow field at t = 0.2: (a) V velocity; (b) density; (c) pressure gradient magnitude.
FIG. 16. 
Streamlines under a Galilean transform and distribution of V velocity at t = 0.2.
FIG. 17. 
Streamlines and pressure contour lines at (a) t = 0.2144, (b) t = 0.2146, (c) t = 0.2148, and (d) t = 0.2150.
FIG. 18. 
Streamlines and pressure distribution at (a) t = 0.2150, (b) t = 0.2154, (c) t = 0.2158, (d) t = 0.2162, (e) t = 0.2166, and (f) t = 0.2170.
FIG. 19. 
Streamlines and pressure distribution at (a) t = 0.218, (b) t = 0.219, and (c) t = 0.220.
FIG. 20. 
Streamlines and distribution of the pressure gradient magnitude at (a) t = 0.23 and (b) t = 0.24.
FIG. 21. 
Momentum vectors (every other point is plotted in the x-direction) and distribution of the momentum magnitude at (a) t = 0.214, (b) t = 0.215, (c) t = 0.216, and (d) t = 0.217.
FIG. 22. 
Streamlines and Mach number distribution at (a) t = 0.26, (b) t = 0.28, and (c) t = 0.30.
FIG. 23. 
Streamlines and distribution of pressure gradient magnitude at (a) t = 0.27, (b) t = 0.28, and (c) t = 0.29.
FIG. 24. 
Velocity vectors (every 8 points are plotted in both directions) and density distribution at (a) t = 0.29, (b) t = 0.33, and (c) t = 0.37.
FIG. 25. 
Distribution of momentum magnitude at (a) t = 0.25, (b) t = 0.30, and (c) t = 0.35.
FIG. 26. 
Streamlines and momentum magnitude distribution at (a) t = 0.5 and (b) t = 0.75.
FIG. 27. 
Distribution of momentum magnitude at (a) t = 0.775, (b) t = 0.800, and (c) t = 0.825.
FIG. 28. 
Temperature distribution at (a) t = 0.75, (b) t = 0.80, (c) t = 0.85, (d) t = 0.90, (e) t = 0.95, and (f) t = 1.00.
FIG. 29. 
Streamlines and distribution of momentum magnitude at (a) t = 0.81, (b) t = 0.83, (c) t = 0.85, (d) t = 0.87, (e) t = 0.89, and (f) t = 0.91.

Method for making 2-electron response reduced density matrices approximately N-representable
In methods like geminal-based approaches or coupled cluster that are solved using the projected Schrödinger equation, direct computation of the 2-electron reduced density matrix (2-RDM) is impractical and one falls back to a 2-RDM based on response theory. However, the 2-RDMs from response theory are not N-representable. That is, the response 2-RDM does not correspond to an actual physical N-electron wave function. We present a new algorithm for making these non-N-representable 2-RDMs approximately N-representable, i.e., it has the right symmetry and normalization and it fulfills the P-, Q-, and G-conditions. Next to an algorithm which can be applied to any 2-RDM, we have also developed a 2-RDM optimization procedure specifically for seniority-zero 2-RDMs. We aim to find the 2-RDM with the right properties which is the closest (in the sense of the Frobenius norm) to the non-N-representable 2-RDM by minimizing the square norm of the difference between this initial response 2-RDM and the targeted 2-RDM under the constraint that the trace is normalized and the 2-RDM, Q-matrix, and G-matrix are positive semidefinite, i.e., their eigenvalues are non-negative. Our method is suitable for fixing non-N-representable 2-RDMs which are close to being N-representable. Through the N-representability optimization algorithm we add a small correction to the initial 2-RDM such that it fulfills the most important N-representability conditions.
I. INTRODUCTION
In quantum mechanics, any system can be described by a wave function, given as a solution of the Schrödinger equation. However, in practice, this equation is only exactly solvable for a few specific systems such as the hydrogen atom. For more complicated systems, we have to rely on approximate methods. The standard approach is to first perform a Hartree-Fock [1,2] (HF) calculation. Here, the wave function is the Slater determinant which gives the lowest possible energy. Methods like configuration interaction [3] (CI) and coupled cluster [4] (CC) theory improve upon HF by including an increasing number of Slater determinants which are classified according to their excitation level. The highest level of theory, full CI, is reached when all possible Slater determinants are included in the wave function expansion. However, the factorial scaling of full CI makes it prohibitively expensive for all but the smallest systems.
The HF, CI, and CC methods are often referred to as single reference because it is assumed that the wave function is dominated by a single electron configuration. However, whenever several electron configurations become (nearly) degenerate, e.g., during bond breaking processes, these methods fail. Such systems are said to be strongly correlated and a qualitatively accurate description of the system requires multiple Slater determinants. Different multi-reference approaches were developed to include these strong correlation effects, e.g., complete active space self-consistent field (CASSCF) [5], multireference CI (MRCI) [6], and density matrix renormalization group (DMRG) [7–10]. However, due to their computational cost, their applicability is also limited to small systems.
Instead of classifying determinants according to their excitation level, determinants can also be described in terms of their seniority [11]. The seniority of a determinant is the number of unpaired electrons. In this study, we use Roman letters a, b, … to denote spatial orbitals. We will only consider singlet pairing, so each spatial orbital can at most be occupied by two electrons with opposite spin. We denote the spin-up orbital and spin-down orbital by a and ā, respectively. General spin orbitals are referred to by Greek letters α, β, …
The doubly occupied CI [12,13] (DOCI) wave function is the most general seniority-zero wave function and only includes those Slater determinants where all spatial orbitals are doubly occupied. The DOCI method has gained a lot of interest in recent years because it was found to be an excellent model for describing static correlation [14–18] in strongly correlated systems. Although the number of determinants is strongly reduced compared to full CI, DOCI still scales combinatorially with the system size. Because the orbitals in DOCI space are either empty or doubly occupied, we introduce the pair creation and pair annihilation operators, Sa†=âa†âā† and S_{a} = â_{ā}â_{a}, where âa† and â_{a} are the single particle creation and annihilation operators from the second quantization formalism [1].
Recently, several of us introduced a computationally tractable approximation to DOCI that is called the antisymmetric product of 1-reference orbital geminals [16,19–23] (AP1roG), also known as pair-coupled cluster doubles [24–27] (pCCD),
with N being the even number of electrons and L being the number of spatial orbitals, and θ denotes the vacuum state with respect to geminal creation. The geminal coefficients cia link the geminals to the underlying single particle orbitals. To keep the computational cost low, the AP1roG energy is not determined variationally, but by using the projected Schrödinger equation (cf. CC theory). A popular choice for AP1roG is to project against a fully paired reference determinant, Φ_{0}, and the set of its pair-excited determinants, Φia|=Φ_{0}Si†S_{a}, resulting in the following set of equations:
It has been shown that AP1roG is able to produce results which are nearly indistinguishable from DOCI at reasonable computational cost for molecular systems [16,28,29]. It is important to note that DOCI, and also its approximations, are orbital dependent. Hence, orbital optimization is essential to obtain accurate results [21–26,30,31].
It is well known that since electrons are indistinguishable and they only interact pairwise, the energy is in fact completely determined by the 2-electron reduced density matrix [32–34] (2-RDM). In contrast to the wave function which is dependent on 4N spin coordinates, the 2-RDM provides us with a much less complicated object to investigate a system.
A Hamiltonian with at most two-body interactions can be written as
with h_{αβ} and V_{αβγδ} being the one- and two-electron matrix elements. The 1-RDM and 2-RDM are defined as the expectation values of the 1- and 2-electron reduced density operators,
Now, the ground state energy can be expressed as a function of the 2-RDM,
with K being the second order reduced Hamiltonian
The 2-RDM could be computed directly by evaluation of the expectation values, Eq. (4b). However, for non-variational methods like CC or AP1roG, this can become computationally very expensive and it may be better to compute the 2-RDM elements as the response of the energy to changes in the two-electron matrix elements,
According to the Hellman-Feynman theorem [1], for exact solutions of the Schrödinger equation, the response 2-RDM is equal to the definition (4b). However, when using non-variational methods where it is more practical to calculate the response 2-RDM, we will have to deal with the fact that in general this 2-RDM is not exact in the sense that it does not equal the definition in Eq. (4b). Moreover, in most cases, these approximate 2-RDMs will not be N-representable.
The N-representability problem was first described in detail by Coleman in 1963 [35–37]. How do we know that a given 2-RDM is actually derivable from a physical (ensemble of) N-electron wave function(s)? The necessary and sufficient conditions for a 2-RDM to be N-representable are known [38–40]; however, they are of no practical use since it would require the knowledge of the ground state energy of every possible two-particle Hamiltonian. In Sec. II, we will recapitulate the necessary and sufficient conditions for N-representability on the 1-RDM, first derived by Coleman [35]. Afterwards, we move on to the more complex problem of N-representability of the 2-RDM. The most important necessary conditions were originally proposed by Garrod and Percus [38]. Later, these so-called positivity conditions were generalized to a hierarchy of N-representability conditions [41,42]. In the last part of this section, we look at the 2-RDM derived from a seniority-zero wave function [12,13,43]. In DOCI space, the structure of the 2-RDM is greatly simplified. Furthermore, the N-representability conditions can be reformulated. These DOCI N-representability conditions contain and extend on the diagonal conditions proposed by many authors [44,45].
In Sec. III, we propose an algorithm to make non-N-representable 2-RDMs approximately N-representable. While we focus on 2-RDMs resulting from response theory, the algorithm can in fact be used on any non-N-representable 2-RDM. The goal is to find the 2-RDM which is the closest to the initial 2-RDM but has the right symmetry, the correct trace, and satisfies the so-called P-, Q-, and G-conditions. Next to the general N-representability optimization algorithm which can act on any 2-RDM, we have also implemented a procedure for the special case of 2-RDMs in seniority-zero space. Finally, some calculations illustrating the performance of both algorithms are given in Sec. IV.
II. N-REPRESENTABILITY
A. General N-representability conditions
Some properties of the 1-RDM and 2-RDM can be directly derived from their definitions (4a) and (4b). They are both Hermitian and have the following symmetry properties:
Note that we assume all wave functions to be real and all density matrices to be real-symmetric. Both RDMs are normalized,
Furthermore, the 1-RDM can be computed from the 2-RDM through contraction
These conditions are necessary, but they are far from sufficient to guarantee that a given 1-RDM or 2-RDM is actually N-representable. Additional conditions must be imposed in order to ensure N-representability.
It was found that p-positivity conditions [42,46] for a p-RDM could be derived from the positive semidefinite property of a class of non-negative Hamiltonians of the form
where Â is a p-particle operator. The expectation value of this Hamiltonian must be non-negative,
i.e., its matrix representation must be positive semidefinite, with different forms of this operator leading to different p-positivity conditions. A matrix M is positive semidefinite if and only if all of its eigenvalues are greater than or equal to zero. This is denoted as M⪰ 0.
1. N-representability of the 1-RDM
The 1-RDM becomes diagonal
We have the following conditions:
The necessary and sufficient condition for N-representability of the 1-RDM again forces the elements of ρ_{a} to be in the interval [0, 1].
2. N-representability of the 2-RDM
Since seniority must be conserved, the 2-RDM becomes block diagonal in the seniority number and the P-, Q-, and G-conditions can be reformulated [12,13,43].
• P-condition: The seniority-zero block of the 2-RDM is called the pair density matrix Π with elements
From the non-negativity of the Hamiltonian Â^{†}Â [Eq. (12)] with Â^{†}=∑_{a}x_{a}âa†âā†, it follows that this pair density matrix should be positive semidefinite, i.e., Π ⪰ 0. The seniority-two block is part of the diagonal of the 2-RDM and we call it the exchange 2-RDM,
We choose to put D_{aa} = 0. Because the diagonal elements of a positive semidefinite matrix must be non-negative, this leads to the condition that D_{ab} ≥ 0. Now there are two ways of obtaining the 1-RDM from the 2-RDM,
The consistency between these two must be separately enforced. The trace of the 2-RDM can now be split into two contributions,
• Q-condition: The Q-matrix had the same structure as the 2-RDM. The seniority-zero part has the elements
The constraint Q^{Π}⪰ 0 follows from the non-negativity of Eq. (12) when choosing Â^{†} = ∑_{a}x_{a}â_{a}â_{ā}. The seniority-two block is on the diagonal of the Q-matrix and all elements should be equal to or greater than zero,
Their normalization is given by
• G-condition: This condition is more elaborate because more contributions are non-zero. For a complete derivation of the G-condition in DOCI space, we refer to Ref [43]. First, the matrix G^{Π} with elements
must be positive semidefinite, G^{Π}⪰ 0, and second, the following set of 2 × 2 matrices must be positive semidefinite:
The DOCI energy can be split in two contributions from the pair density matrix Π and the exchange density matrix D,
where the DOCI reduced Hamiltonian gets a similar structure as the 2-RDM does in seniority-zero space,
B. N-representability conditions in seniority-zero space
In seniority-zero space, the spatial orbitals are either empty or doubly occupied. Both the structure of the 1-RDM and 2-RDM are greatly simplified for DOCI wave functions because the operator cannot change the number of broken pairs, i.e., the operators need to couple to seniority-zero.
III. N-representability optimization algorithm
For wave function methods that are solved in a projective manner, like CC and geminals methods, the approximate 2-RDMs obtained from response theory, Eq. (7), are in general not N-representable. Consequently, they do not necessarily satisfy the N-representability constraints presented in Sec. II nor do they always have the right symmetry. The goal of the new algorithm we will present here is to “fix” the response 2-RDM so that it becomes approximately N-representable, i.e., it has the right symmetry, Eqs. (8b) and (8c), and the right trace, Eq. (9b), and it satisfies the P-, Q-, and G-conditions, Eqs. (17), (18), and (20). This optimization problem can actually be formulated as a semidefinite programming (SDP) problem,
Our strategy is to find the 2-RDM that minimizes the square norm of the difference between the initial 2-RDM and the targeted 2-RDM, under the constraints that this 2-RDM is symmetric, its trace is normalized, and the P, Q-, and G-matrices are positive semidefinite matrices, i.e., their eigenvalues are non-negative. This kind of problem strongly resembles the variational optimization of the energy in 2-RDM theory [37,50,51].
Given the problem definition in Eq. (37), we could approach this in the context of semidefinite programming (SDP) [52–55]. However, the methods for solving SDP problems are quite complex, and existing general purpose solvers are inefficient for large-scale problems. Given that the initial 2-RDM comes from a computationally efficient method (e.g., AP1roG), we prefer a “fixing” procedure of comparable scaling. So, in this section, we propose an alternative approach to find an approximate solution to Eq. (37) which is computationally much faster.
In 1988, Higham [56] showed that for a given real matrix B_{0}, the closest (with respect to the Frobenius norm) symmetric positive semidefinite matrix B, i.e., the solution to
is given by the positive symmetric part of B_{0}. However, Higham’s method does not preserve the normalization of the initial matrix B_{0}. From the problem definition in Eq. (37), we see that we need to impose an additional constraint on the trace, i.e., we are dealing with a problem of the following kind:
with T being a known fixed value. We can show that the closest symmetric positive semidefinite matrix B with fixed trace is obtained by shifting the set of eigenvalues {λ_{i}} of B_{0} with a value σ_{0} which is the root of the equation f(σ) = T where f(σ) = ∑_{i}θ(λ_{i} − σ)(λ_{i} − σ) with θ(λ_{i} − σ) the Heaviside step function. A proof for both Higham’s problem [Eq. (38)] and the optimization problem from Eq. (39) with the additional constraint on the trace is given in the Appendix.
Based on this result, we propose the following iterative procedure to determine the closest, positive semidefinite, symmetric 2-RDM with the correct trace:
(a) Symmetrize the 2-RDM,
(b) Compute the eigenvector decomposition to find the eigenvalues {λ},
(c) Shift all the eigenvalues by a constant σ_{0} which is the root of the equation f(σ) = ∑_{i}θ(λ_{i} − σ)(λ_{i} − σ) = Tr (Γ) and set any negative shifted eigenvalues to zero,
The root σ_{0} is determined through a bisection method.
(d) Find an updated 2-RDM from the resulting shifted set of eigenvalues and the original eigenvectors,
In order for the 2-RDM to also satisfy the Q- and G-conditions, a similar procedure can be used for making the Q- and G-matrix positive semidefinite under the normalization constraints (22) and (23). Alternatively, instead of determining the shift for the eigenvalues through a bisection method, we can also determine the shifted eigenvalues in an iterative fashion: in a first step, we set the negative eigenvalues to zero, and in a second step all the eigenvalues are shifted by a constant to fulfill the trace conditions. These two steps are repeated until none of the eigenvalues are negative anymore and we have the correct trace.
An overview of the N-representability optimization algorithm is given in Fig. 1; it is referred to as the regular 2-RDM algorithm. We sequentially optimize the P-, Q-, and G-matrix and iterate until the procedure converges. Convergence is measured by the error on the traces and the magnitude of the largest negative eigenvalue. When convergence is reached, we have determined the 2-RDM which is close to the initial 2-RDM, but which is N-representable in the sense that it fulfills the P-, Q-, and G-conditions. We will refer to this converged 2-RDM as the “fixed” 2-RDM. We emphasize that the obtained 2-RDM from the optimization algorithm is not strictly the closest in the sense of Eq. (37), but corresponds to a 2-RDM that is also close, has the right P-, Q-, and G-properties, and is obtained at a much more favourable computational cost compared to the exact solution, Eq. (37). It is possible to change the order in which the P-, Q-, and G-matrices are fixed; however, we observed that this does not significantly influence the results.
In the case of seniority-zero space, the non-zero elements of the 2-RDM are split over the pair density matrix Π and D and the optimization problem can be formulated as
We try to fix both the pair and exchange density matrix, Π and D, such that they become approximately N-representable in the sense that they are symmetric, they have the right normalization, Eqs. (29a) and (29b), and they satisfy the DOCI-reformulated P-, Q-, and G-conditions presented in Sec. II B 2. This algorithm is denoted as the DOCI 2-RDM algorithm. As in the regular 2-RDM optimization algorithm, the P-, Q-, and G-conditions are enforced sequentially. Convergence is measured by the norm of the difference between density matrices from consecutive iterations.
IV. RESULTS
The algorithms for making the 2-RDM approximately N-representable are tested on a variety of systems. We start with applying the DOCI 2-RDM algorithm on a typical example for strong correlation: the symmetric dissociation of a linear chain of equally spaced hydrogen atoms. We then look at some 12- and 14-electron diatomic species where we perform calculations for three different bond lengths with both the DOCI 2-RDM (doci2RDM) and regular 2-RDM (reg2RDM) algorithms. Finally, we pushed the DOCI 2-RDM optimization algorithm into a regime where AP1roG is known to fail, i.e., the attractive Richardson pairing Hamiltonian [57,58]. The Hartree-Fock and AP1roG calculations are done with the HORTON software package [59]. For the AP1roG calculations, a variational orbital optimization scheme [21–23] is used. The full CI energies are obtained with the Psi4 program package [60]. All DOCI calculations are done with in-house developed programs.
For comparing the fixed 2-RDM, Γ̃, with the initial 2-RDM, Γ^{response}, we define a cost function, weighted by the number of terms in the summation
and in the case of DOCI space
A. Linear hydrogen chain, H_{8}
In Fig. 2, the energy profile for the dissociation of a linear H_{8} chain is shown. The AP1roG and DOCI results are nearly indistinguishable over the whole range of interatomic distances. Both are also very close to the full CI solution; the deviation is due to the lack of dynamical correlation in these seniority-zero methods [14,16]. Subsequently, we use the DOCI 2-RDM algorithm to fix the AP1roG response 2-RDM and the energy is calculated according to Eq. (35). Note that using directly the response 2-RDM in Eq. (35) reproduces the AP1roG energy and is therefore not plotted separately.
For interatomic distances up to 4 a.u., the fixed 2-RDM energy, AP1roG energy, and DOCI energy are within less than milliHartree (mHa) range. For larger bond distances, the fixed 2-RDM energy starts to deviate from the AP1roG and DOCI energy and the difference increases to 0.1 Ha. During the optimization procedure, the 2-RDM is restricted to fulfill some conditions; hence, energy increases are to be expected. The small deviations around equilibrium length indicate that the original 2-RDMs are in fact very close to being N-representable, while at larger bond lengths, the response 2-RDMs are further away from N-representability. As a measure for the violation of the 2-positivity N-representability conditions of the initial 2-RDM, we can use the (absolute) sum of all negative eigenvalues of the P-, Q-, and G-matrix. This sum is below 6 × 10^{−4} for bond distances up to 4 a.u., and for larger bond lengths, it varies from 0.15 to almost 1.00. The larger the interatomic distances, the more the response 2-RDM violates the P-, Q-, and G-conditions. Although the AP1roG energy is an excellent approximation for the DOCI energy, also in the bond breaking region, the structure of the response 2-RDM deviates more and more from N-representability with increasing bond length. This is also confirmed by the cost functions. For bond lengths under 4 a.u., the cost function was found to be below 5 × 10^{−9}, and at larger bond lengths it increases from 10^{−5} up to values around 2.6 × 10^{−3}, thereby confirming that at larger bond lengths the fixed, N-representable 2-RDMs differ more from the initial 2-RDMs than around the equilibrium distance.
B. 12- and 14-electron species
The DOCI 2-RDM algorithm is tested on seven 12- and 14-electron molecules. Table I lists the DOCI energy (with AP1roG optimized orbitals) and the energy difference with respect to the AP1roG energy, ΔE_{AP1roG}, for three interatomic distances. It also shows the difference of the fixed DOCI 2-RDM energy and AP1roG energy, ΔE_{doci2RDM}. As was already shown in earlier papers [16,28,29], the AP1roG energy is a very good approximation to the DOCI energy, and it deviates at most by about 4.9 mHa from the DOCI energy. Finally, the cost functions, Eq. (46), are also listed in Table I. For equilibrium geometries, the response 2-RDM is very close to being N-representable. For larger bond lengths, the cost functions increase, indicating larger corrections are needed in order to enforce N-representability of the initial 2-RDM.
Since the AP1roG energy is such a good approximation to the DOCI energy, it would be preferable to have only slight changes in energy upon fixing the 2-RDM. In line with the results from the dissociation of a linear H_{8} chain, there is an increase in energy, compared to AP1roG, as a result from constraining the 2-RDM during the N-representability optimization procedure. The reported energy difference, ΔE_{doci2RDM}, can be seen as an energetic cost for enforcing N-representability on the initial 2-RDM. This energetic cost is of the order milliHartree for equilibrium bond lengths and increases with increasing interatomic distance. It even attains the unrealistic value of 2.5 hartree for the stretched N_{2} molecule. Moreover, it appears that the method performs worse for stretched diatomic species with multiple bonds, like N_{2} and CO, while its performance is better for singly bonded diatomics, like LiF and BF.
By using the DOCI 2-RDM algorithm, we restrict the 2-RDM to seniority-zero space, but this leads to large increases in energy, mostly for stretched geometries. Therefore, we have also tested the regular 2-RDM fixing procedure on these seven diatomic molecules such that the 2-RDM can move outside seniority-zero space. We should note that for this algorithm the full 2-RDM, which is a four-dimensional array of size 2L, is constructed. As such, the memory requirements are much higher compared to the DOCI specific algorithm where we are just required to store two L × L matrices. The results can be found in Table II. The cost functions, Eq. (45), are much lower in comparison to the DOCI 2-RDM algorithm. We find an N-representable 2-RDM which is closer to the initial 2-RDM compared to the fixed DOCI 2-RDM. However, this fixed reg2-RDM still has a DOCI structure (see Table III) meaning that it still lies in the seniority-zero space. The regular 2-RDM fixing procedure converges to a 2-RDM which is also in DOCI space; however, it is a different solution than the one which results from the DOCI 2-RDM algorithm. The energetic cost due to the regular 2-RDM fixing procedure is lower than the energy increase due to DOCI 2-RDM fixing. However, it is still quite high, particularly for the stretched geometries, i.e., about 0.9 hartree for N_{2}.
We found that the deviation from N-representability of the initial 2-RDM is mostly due to violation of the G-condition. In Fig. 3, a log-log scatter plot is shown of the most negative eigenvalue of the initial G-matrix and the energetic cost due to DOCI 2-RDM fixing and the regular 2-RDM fixing. The violation of the G-condition is strongest for stretched molecules, and this can be correlated with a higher energy increase upon 2-RDM fixing. As could already be concluded, the use of the regular 2-RDM algorithm reduces the energy increase compared to the DOCI 2-RDM algorithm, especially at larger interatomic distances.
C. Pairing Hamiltonian
Until now we have handled systems where the AP1roG model is known to perform well for energies. In general, the resulting 2-RDMs did not deviate too much from N-representability. It has been shown that AP1roG fails for the attractive pairing model as soon as a critical pairing interaction strength is reached [63,64]. The Richardson pairing Hamiltonian can be written as [57,58]
The parameter g is called the interaction strength and can distinguish between attractive (g < 0) and repulsive (g > 0) interactions. The set {ϵ_{i}} are the single particle energies. Specifically, we will investigate the half-filled pairing Hamiltonian with twelve equally spaced levels, the so-called picket-fence model [65,66], i.e., ϵ_{p} = p Δϵ with Δϵ being the interlevel spacing. In this case, the ground state lies in the fully paired (seniority-zero) space; thus, DOCI coincides with full CI. For the following calculations, we again use the DOCI 2-RDM algorithm. In this subsection, the AP1roG and full CI energies are calculated with an in-house program.
In Fig. 4, the total energy as a function of the interaction strength g in the attractive region is shown. It is clear that beyond a certain interaction strength g AP1roG completely fails to correctly describe the system. This is because the particle-hole reference states are not sufficient to correctly describe the collective pairing oscillations of the superconducting ground state of the system. However, the plotted energies are still converged solutions to the AP1roG equations and may correspond to non-collective excited states of the system. Next to the exact solution according to Richardson [57,58], we also show the Bardeen-Cooper-Schrieffer (BCS) solution [67]. AP1roG breaks down near a critical pairing interaction strength of g_{c} ≅ −0.35 which is the transition point to a superconducting system, i.e., the HF to BCS transition point where the superconducting gap is of the same order as the interlevel spacing [65,66].
In Fig. 5, one sees that when AP1roG starts to fail, the energy even goes below the exact solution. This is indeed possible since AP1roG is not a variational method, for which the exact energy is an upper limit, but is solved through the projected Schrödinger equation. Fixing the 2-RDM partly remedies the non-variational character of the AP1roG energy; however, the increase in energy becomes more pronounced reaching the critical g_{c} signalling the inadequacy of AP1roG in this regime. N-representability fixing of the 2-RDM results in energies that are above the exact energy. We also show the energy profiles for the repulsive pairing model in Fig. 6, g > 0. Here AP1roG does not fail as drastically as for the attractive region because the ground state is better characterized by a few particle-hole excitations across the reference state. N-representability fixing of the 2-RDM again increases the energy, which is in line with the results obtained for the previous systems.
For the integrable pairing Hamiltonian, we are able to compute the exact 2-RDMs at fairly low cost, so we can now compare the initial 2-RDM and fixed 2-RDM with the exact 2-RDM; see Fig. 7. The cost functions are defined in a similar fashion as in Eq. (46), but now with respect to the exact 2-RDM. We also plot the cost function of the response 2-RDM and fixed 2-RDM. As expected the cost functions increase with increasing (in absolute value) interaction strength. Moreover, the cost functions of the response 2-RDM and fixed 2-RDM with respect to the exact 2-RDM nearly overlap indicating that although we bring the 2-RDM closer to being N-representable, the distance to the exact 2-RDM does not change much. This could indicate that the N-representability optimization algorithm seems to bring the 2-RDM closer to the set of N-representable 2-RDMs but not necessarily closer to the exact 2-RDM.
V. CONCLUSIONS
Many methods in quantum chemistry rely on a projective method to solve the Schrödinger equation, like CC and geminal-based methods. Since for these methods direct computation of the 2-RDM is impractical, it may be better to compute the 2-RDM from response theory. However, these approximate 2-RDMs often suffer from the so-called N-representability problem. In this manuscript, we have introduced an optimization algorithm to make non-N-representable 2-RDMs approximately N-representable. Our algorithm presents an alternative approach to semidefinite programming problems. Although it only provides an approximate solution, it is computationally less complex and much faster. Due to the current interest in seniority-zero wave function models, we also developed a 2-RDM optimization procedure tailored specifically to DOCI space. With the proposed algorithms, we can find the 2-RDM which is closest (with respect to the Frobenius norm) to the initial non-N-representable 2-RDM under the constraints that the resulting 2-RDM should be symmetric, its trace has the correct normalization, and it satisfies the standard 2-positivity conditions.
From the results, we can conclude that for bond breaking processes, where the AP1roG energy is a very good approximation for the DOCI energy, the structure of the response 2-RDM deviates more and more from N-representability with increasing interatomic distances. Fixing the 2-RDMs results in an energy increase with respect to the original 2-RDM energy because we put certain constraints on the 2-RDM during the N-representability optimization procedure. Using the general 2-RDM algorithm to enforce N-representability has a lower energetic cost compared to the DOCI 2-RDM algorithm; however, for stretched geometries, this energy increase is quite high for both algorithms. For the attractive Richardson pairing Hamiltonian, AP1roG fails beyond a certain critical interaction strength resulting in response 2-RDMs which are far from being N-representable. We are able to compare both the response 2-RDM and fixed 2-RDM with the exact solution and it seems that although we have made the initial 2-RDMs approximately N-representable, the optimization procedure did not bring the fixed 2-RDMs necessarily closer to the exact solution in this case.
Our method is most suited for fixing 2-RDMs which are close to being N-representable, i.e., the underlying theory gives 2-RDMs which do not severely violate the N-representability conditions. By using the N-representability optimization procedure, a small correction is added to the initial 2-RDM such that the final 2-RDM is N-representable in the sense that it has the right symmetry and fulfills the trace conditions and the P-, Q-, and G-conditions.
APPENDIX: PROOFS
Higham [56] showed that for an arbitrary matrix B_{0} there is a unique nearest, with respect to the Frobenius norm, symmetric positive semidefinite matrix B, which can be expressed in terms of the eigenvalues and eigenvectors of the symmetric part of B_{0}. This matrix B was named the positive approximant of B_{0}. The symmetric part of B_{0} is given by
Since a positive approximant of B_{0} is also a positive approximant of its symmetric part B0sym, the problem reduces to finding a solution to
Given the spectral decomposition for B0sym,
we can express the target matrix B in the same eigenbasis,
The Frobenius difference can be rewritten as
For any positive semidefinite matrix Y, this cost function is minimized by setting the off-diagonal matrix elements to zero. Hence, the minimizing B must be diagonal in the eigenbasis of B0sym. If we set yi2=Y_{ii}, then
The last term is minimized when y_{i} = 0 and the first term is minimized when yi2=λ_{i}. This means that the solution to the problem in Eq. (A2) is simply the positive part of B0sym, i.e.,
with θ(λ) being the Heaviside step function.
Since the trace of a matrix is equal to the sum of its eigenvalues, it is easy to see that Higham’s method does not preserve the normalization of the initial matrix B_{0}. Thus, we need to add another constraint in order to keep the trace fixed. Following the same reasoning as before and using the same definitions for B0sym and B, we can again conclude that Y should be a diagonal matrix. This is because the constraint on the trace ∑_{i}Y_{ii} = T does not depend on the off-diagonal matrix elements. Setting yi2=Y_{ii}, we can rewrite the problem as
This is a constrained minimization problem which can be solved by the method of Lagrange multipliers. We introduce the Lagrangian with Lagrange multiplier μ,
Taking the proper partial derivatives returns the following set of equations:
This means either y_{i} = 0 or yi2=λ_{i}+μ2, i.e., a constant shift σ=−μ2 from λ_{i}. Introducing the continuous piecewise linear function f(σ) = ∑_{i}θ(λ_{i} − σ)(λ_{i} − σ), it is clear that the roots of f(σ) = T will yield the needed constant shift. It is easy to see that f(σ) is monotonically decreasing in σ, reaching zero for σ ≥ λ_{max} and f(σ) → +∞ for σ → −∞. Hence, for every T > 0, there will be a unique solution for the shift σ_{0} (Fig. 8). The minimizing matrix B is
TABLE I. 
DOCI energy (with AP1roG optimized orbitals), energy difference with respect to AP1roG, ΔE_{AP1roG} = E_{DOCI} − E_{AP1roG}, energy difference of the AP1roG energy and the 2-RDM fixed through the DOCI 2-RDM algorithm, ΔE_{doci2RDM} = E_{doci2RDM} − E_{AP1roG}, and the cost function as defined in Eq. (46). All calculations are done using the 6-31g* basis set and all energies are given in atomic units. The equilibrium bond lengths, R_{e}, are taken from the NIST CCCBDB [62] database for CCSD(T) optimized geometries.
TABLE II. 
Energy difference of the AP1roG energy and the 2-RDM fixed through the regular 2-RDM algorithm, ΔE_{reg2RDM} = E_{reg2RDM} − E_{AP1roG} and the cost function as defined in Eq. (45).
TABLE III. 
Sum of the elements of the final 2-RDM fixed through the regular 2-RDM algorithm that should be zero in the case of DOCI structure, i.e., elements that are not of the type in Eqs. (26) and (27).
TABLE I. -body
Molecule	C_{2}	BN	BeO	LiF	N_{2}	CO	BF
R_{e} (Å)	1.2562	1.3369	1.3490	1.5658	1.1191	1.1472	1.2829
Interatomic distance R = R_{e}
E_{DOCI}	−75.5416	−79.0162	−89.4948	−107.0007	−109.0597	−112.8392	−124.2000
ΔE_{AP1roG}	3.0 × 10^{−5}	2.8 × 10^{−4}	2.0 × 10^{−5}	−6.3 × 10^{−6}	−8.4 × 10^{−5}	−2.9 × 10^{−5}	−1.7 × 10^{−5}
ΔE_{doci2RDM}	8.5 × 10^{−3}	7.4 × 10^{−3}	4.4 × 10^{−3}	6.4 × 10^{−3}	9.5 × 10^{−3}	8.5 × 10^{−3}	2.6 × 10^{−4}
f_{doci2RDM}	4.7 × 10^{−7}	1.7 × 10^{−7}	4.9 × 10^{−10}	1.0 × 10^{−10}	1.2 × 10^{−9}	5.0 × 10^{−10}	1.7 × 10^{−11}
Interatomic distance R = R_{e} + 1.00 Å
E_{DOCI}	−75.3490	−78.8974	−89.3491	−106.9057	−108.7107	−112.4785	−124.0251
ΔE_{AP1roG}	8.1 × 10^{−5}	6.8 × 10^{−5}	−1.6 × 10^{−4}	2.0 × 10^{−6}	1.5 × 10^{−3}	4.9 × 10^{−3}	1.1 × 10^{−4}
ΔE_{doci2RDM}	2.1 × 10^{−1}	1.6 × 10^{−1}	5.0 × 10^{−2}	7.3 × 10^{−3}	4.2 × 10^{−1}	2.9 × 10^{−1}	5.8 × 10^{−2}
f_{doci2RDM}	5.7 × 10^{−6}	7.8 × 10^{−6}	5.2 × 10^{−8}	2.4 × 10^{−10}	9.8 × 10^{−6}	3.4 × 10^{−6}	5.4 × 10^{−8}
Interatomic distance R = 5.00 Å
E_{DOCI}	−75.3051	−78.8536	−89.3477	−106.8345	−108.5920	−112.4708	−123.9567
ΔE_{AP1roG}	−6.2 × 10^{−4}	1.1 × 10^{−5}	−3.8 × 10^{−5}	2.3 × 10^{−5}	2.6 × 10^{−4}	1.2 × 10^{−3}	2.1 × 10^{−5}
ΔE_{doci2RDM}	8.9 × 10^{−1}	4.1 × 10^{−1}	1.3 × 10^{−1}	1.2 × 10^{−3}	2.5 × 10^{0}	9.1 × 10^{−1}	3.2 × 10^{−2}
f_{doci2RDM}	1.0 × 10^{−4}	2.9 × 10^{−5}	6.0 × 10^{−6}	5.9 × 10^{−9}	5.6 × 10^{−4}	4.1 × 10^{−5}	1.8 × 10^{−7}
TABLE II. -body
Molecule	C_{2}	BN	BeO	LiF	N_{2}	CO	BF
R_{e} (Å)	1.2562	1.3369	1.3490	1.5658	1.1191	1.1472	1.2829
Interatomic distance R = R_{e}
ΔE_{reg2RDM}	1.5 × 10^{−3}	8.3 × 10^{−3}	6.9 × 10^{−5}	1.4 × 10^{−5}	2.4 × 10^{−4}	1.2 × 10^{−4}	4.0 × 10^{−5}
f_{reg2RDM}	8.9 × 10^{−13}	3.9 × 10^{−13}	6.3 × 10^{−16}	3.0 × 10^{−17}	2.9 × 10^{−15}	1.1 × 10^{−15}	2.5 × 10^{−16}
Interatomic distance R = R_{e} + 1.00 Å
ΔE_{reg2RDM}	2.2 × 10^{−2}	7.5 × 10^{−3}	5.9 × 10^{−4}	2.2 × 10^{−5}	4.2 × 10^{−2}	2.1 × 10^{−2}	5.4 × 10^{−4}
f_{reg2RDM}	1.2 × 10^{−10}	1.5 × 10^{−11}	1.9 × 10^{−14}	7.4 × 10^{−17}	4.4 × 10^{−10}	1.2 × 10^{−10}	1.0 × 10^{−13}
Interatomic distance R = 5.00 Å
ΔE_{reg2RDM}	9.2 × 10^{−2}	1.4 × 10^{−1}	5.6 × 10^{−3}	9.5 × 10^{−5}	9.1 × 10^{−1}	1.3 × 10^{−1}	5.0 × 10^{−4}
f_{reg2RDM}	4.5 × 10^{−9}	1.8 × 10^{−8}	9.3 × 10^{−12}	2.6 × 10^{−15}	6.3 × 10^{−7}	1.4 × 10^{−8}	3.2 × 10^{−14}
TABLE III. -body
Molecule	C_{2}	BN	BeO	LiF	N_{2}	CO	BF
R_{e} (Å)	1.2562	1.3369	1.3490	1.5658	1.1191	1.1472	1.2829
R = R_{e}	6.6 × 10^{−9}	6.3 × 10^{−9}	1.1 × 10^{−8}	5.7 × 10^{−9}	1.7 × 10^{−8}	1.5 × 10^{−8}	1.4 × 10^{−8}
R = R_{e} + 1.00 Å	2.1 × 10^{−8}	8.7 × 10^{−9}	1.8 × 10^{−8}	8.5 × 10^{−9}	9.6 × 10^{−9}	8.4 × 10^{−9}	1.8 × 10^{−8}
R = 5.00 Å	1.3 × 10^{−8}	1.5 × 10^{−8}	9.4 × 10^{−9}	1.3 × 10^{−8}	1.4 × 10^{−8}	9.0 × 10^{−9}	6.0 × 10^{−9}
FIG. 1. 
General scheme for the N-representability optimization procedure.
FIG. 2. 
Symmetric dissociation of a linear H_{8} chain with interatomic distance R using an ANO-2s basis set [61]. Total energies predicted by full CI, Hartree-Fock, AP1roG (with optimized orbitals), DOCI (with optimized orbitals), and fixed 2RDM energy [calculated according to Eq. (35)].
FIG. 3. 
Log-log scatter plot of the absolute value of the most negative eigenvalue of the initial G-matrix and the ΔE_{doci2RDM} (unfilled markers) and the ΔE_{reg2RDM} (filled markers) at three interatomic distances.
FIG. 4. 
Energy as a function of the interaction strength g for the attractive pairing model (g < 0) of six electron pairs in twelve orbitals with equally spaced single particle energies. Total energies predicted by the AP1roG and BCS methods and the exact solution according to Richardson.
FIG. 5. 
Same data as in Fig. 4 with the additional curve representing the fixed 2-RDM energy.
FIG. 6. 
Energy as a function of the interaction strength g for the repulsive pairing model (g > 0) for the same system as in Fig. 4. Total energies from the AP1roG method, the fixed 2-RDM, and the exact solution according to Richardson.
FIG. 7. 
Cost functions of the AP1roG response 2-RDM and the fixed 2-RDM with respect to the exact 2-RDM and of the response 2-RDM with respect to the fixed 2-RDM as a function of the interaction strength g for the attractive pairing model.
FIG. 8. 
f(σ) = ∑_{i}θ(λ_{i} − σ)(λ_{i} − σ).

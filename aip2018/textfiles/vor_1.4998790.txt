Evolution of dense spatially modulated electron bunches
An analytical theory describing the dynamics of relativistic moving 1D electron pulses (layers) with the density modulation affected by a space charge has been revised and generalized for its application to the formation of dense picosecond bunches from linear accelerators with laser-driven photo injectors, and its good agreement with General Particle Tracer simulations has been demonstrated. Evolution of quasi-one-dimensional bunches (disks), for which the derived formulas predict longitudinal expansion, is compared with that for thin and long electron cylinders (threads), for which the excitation of non-linear waves with density spikes was found earlier by Musumeci et_al [Phys. Rev. Lett. 106(18), 184801 (2011)] and Musumeci et_al [Phys. Rev. Spec. Top. --Accel. Beams 16(10), 100701 (2013)]. Both types of bunches can be used for efficiency enhancement of THz sources based on the Doppler frequency up-shifted coherent spontaneous radiation of electrons. Despite the strong Coulomb repulsion, the periodicity of a preliminary modulation in dense 1D layers persists during their expansion in the most interesting case of a relatively small change in particle energy. However, the period of modulation increases and its amplitude decreases in time. In the case of a large change in electron energy, the uniformity of periodicity is broken due to different relativistic changes in longitudinal scales along the bunch: the “period” of modulation decreases and its amplitude increases from the rear to the front boundary. Nevertheless, the use of relatively long electron bunches with a proper preliminary spatial modulation of density can provide a significantly higher power and a narrower spectrum of coherent spontaneous radiation of dense bunches than in the case of initially short single bunches with the same charge.
I. INTRODUCTION
Short dense electron bunches with a moderately relativistic electron energy formed in laser-driven photo injectors [3–5] can, in particular, be effectively used for generation of super-radiant, or coherent spontaneous terahertz radiation (see, e.g., Refs [6–15]). To significantly increase the radiation energy and frequency, a number of authors suggested using a preliminary spatial modulation of electron density in such sources [1,2,16,17]. The modulation can be obtained, for example, by means of time modulation in the illuminating laser intensity leading to the corresponding modulation of the electron current from a photo cathode. Numerical simulations and experiments carried out in Refs [1] and  [2] have shown that the density modulation in thin bunches with a small ratio of radius to modulation period can lead to the excitation of nonlinear plasma waves and even to the formation of sharp spikes. These important results look very clear and reliable; they were also confirmed in a number of following experiments. Meanwhile, it is very interesting that the correct results for 3D situation for thin bunches have been obtained in Refs [1] and  [2] from a solution for a 1D (planar) model. However, it is fairly obvious that a “static” displacement of the particles in the 1D planar pulse of finite length cannot lead to the appearance of the returning forces and plasma oscillations. The presence of plasma oscillations in the solution for the 1D model obtained in Refs [1] and  [2] is presumably the result of the implicit assumption used in the theory on maintaining the modulation period, which is physically justified only for the opposite case of small bunch radius. The authors of Refs [1] and  [2] start from a longitudinally infinite 1D electron layer and, correspondingly, suppose that there is no “central” plane, and hence all the periods of the initial density modulation are equivalent, and the value of the period remains constant. In fact, the latter assumption is equivalent to the presence of restoring forces. This assumption can be justified due to effective cut-off of the longitudinal field from the far-away slices in 3D thread-like bunches. As for quasi-plane, nearly 1D bunches with large radii and short lengths, the Coulomb particle repulsion can only weaken the modulation. We think that this case as well as case of bunches with an intermediate shape may have an independent interest for experiment because they allow using of larger charges and in addition they can be more efficient for production of directed THz radiation. Therefore, we have revised the theory for a moving 1D electron layer with a finite longitudinal length corresponding to the real bunch in the form of a disk in the moving reference frame and with an arbitrary density distribution considering changing of the modulation period. In contrast to the theory of Refs [1] and  [2] for such 1D situation, the derived formulas confirm the validity of the above simple physical expectations.
In this paper, we provide a simple description of the evolution of an arbitrary one-dimensional density distribution as well as a discussion for the evolution of three-dimensional bunches; it should be emphasized that the latter completely confirms the results of Refs [1] and  [2] for thin bunches. General formulas for changing the electron density and the corresponding spatial spectra for 1D model were obtained in Sec. II and then used in Secs. III and IV for the cases of small and large change in electron energy, respectively. The latter case includes, in particular, the evolution of bunches in an accelerating section. The limitations of a 1D model and its comparison with 3D threads are discussed on the basis of General Particle Tracer (GPT) simulations in Sec. V. A brief discussion of the results is given in Sec. VI.
II. ARBITRARY 1D DISTRIBUTION OF ELECTRON DENSITY
Let us study the evolution for a “static” initial distribution of electrons with the same relativistic velocity v directed along the x axis and with the initial volume charge density −ρ_{0}(x_{0}) in a moving 1D pulse (layer) of width L (Fig. 1). For the sake of simplicity, consider only symmetric distributions, ρ_{0}(−x_{0})=ρ_{0}(x_{0}), relative to the cross section x_{0}=0 where the layer field equals zero, E(0)=0. This simplification does not reduce the generality of the problem. Results can be easily generalized to the case of an arbitrary density distribution.
Using a Lagrangian approach, we monitor the motion of a particle belonging to the layer from its initial plane x_{0} to the current plane x under the action of the layer electric field (Fig. 1). The particles from the cross section x_{0}=0 move uniformly with the velocity v_{0}=β_{0}c. For particles with positive x_{0}, the absolute value of the field increases with the initial coordinate; the acceleration and velocity of the particles are also increasing functions of x_{0}. Thus, particle bunching and/or overtaking are impossible. Consequently, the whole layer width and spatial scales inside the layer expand in time (free expansion of the electron gas into vacuum).
The calculation of the electric field inside the layer is significantly simplified if one takes into account that the charge per unit surface σ(x)=∫v_{0}txρ(y)dy is the same in the x plane as in the corresponding initial plane x_{0}. Then, according to the Gauss theorem, the same is true for the field E(x)=−4πσ(x)
Under the influence of this invariant and constant field, an electron with initial coordinate x_{0} moves with the constant acceleration a=eE_{0}(x_{0})/m in the instantly co-moving reference frames (relativistic, uniformly accelerated motion). Here, e and m are electron charge and mass, respectively. At an arbitrary initial electron velocity current particle coordinate can be written in the form
where the instant value of the electron Lorentz factor γ=(1−β2){−1/2} in the field of constant force ma is as follows:
A change in electron Lorentz factor should be relatively small
in the most interesting case where the layer is used for modeling an electron bunch in a source of narrow-band radiation. Then, Eq. (2) can be approximately represented in the simpler “quasi-non-relativistic” form
where a_{||}=a/γ^{3} is the slowly changing particle acceleration in the laboratory reference frame. Taking into account conservation of the charge in the elementary electron layer
one obtains the electron density in the arbitrary cross section x
where ξ(x_{0},t)=dx/dx_{0} is the local coefficient of the layer expansion, which can be readily found from Eqs. (2)–(5).
Simple formulas (2)–(7) present the required solution of the problem for evolution of any symmetric 1D electron layer. The initial particle coordinate x_{0} in these expressions is generally speaking an implicit function of the current coordinate x. However, it is possible to present the current spatial spectrum of the density distribution at time t, F(k)=12π∫−∞∞ρ(x)e^{ikx}dx, in the explicit form by using Eqs. (2)–(6). For example, for the case of a small energy change (4), we have
where q=a_{||}(x_{0})t^{2}/2.
III. SMALL CHANGE IN ELECTRON ENERGY
Consider first a non-modulated uniform electron layer with constant initial particle density ρ_{0}(x_{0})=ρ_{0} within the interval 0≤|x_{0}|≤L/2 in the most interesting case of a small change in particle energy where the particle acceleration a_{||} is proportional to the initial coordinate x_{0}. In this case, the entire layer expands uniformly with the same coefficient ξ_{0} that increases in time (Fig. 2). Here, ξ_{0}=1+q_{0},q_{0}=(ωbt){2}/2; ω_{b}=(4πeρ0/mγ3){1/2} is the beam “plasma” frequency corresponding to the initial electron density.
The spatial spectrum for this case is as follows:
The instant value of the characteristic wave number k_{char}∼2π/ξ_{0}L decreases in inverse proportion to ξ_{0}, and the corresponding spatial scale increases as ξ_{0}.
Consider now the evolution of a periodically modulated layer with an arbitrary initial density distribution
where ε is the modulation amplitude, g(φ)=g(φ+2π) is a periodic and even function of φ=hx_{0} with zero integral by the period 2π, h=2π/d is the characteristic wave number in the initial spatial spectrum, and d and N are the spatial period and the number of periods, respectively.
Considering the periodicity of the function g(φ) and using Eqs. (5) and (6), one concludes that in the case of a small change in electron energy where the electron acceleration a_{∥} can be considered as a constant, the current density ρ(x) is a periodic function of the argument ψ=h(x−vt) with the period ξ_{0}d increasing in time.
As the first example of a periodic distribution, consider an ideally modulated (ε=1) layer in the form of a periodic set of N identical sub-layers (a periodic train of short pulses with a constant density) having for simplicity equal values of the initial widths and separations between them, d/2 [Fig. 3(a)]. Note an obvious, but useful property of the case of maximum modulation ε=1 (Fig. 3): the field inside empty intervals is constant. Hence, the particles move with the same velocity at both of their boundaries. Thus, these intervals are not changed in time [Fig. 3(b)]. All the sub-layers filled in with the initial density 2ρ_{0} expand at the same rate (1+2q_{0}), which increases in time; subsequently, the density in sub-layers decreases by a factor of (1+2q_{0}) compared with the initial value. The expanding layer preserves a periodic structure, but with increasing the value of the period. The period and total layer width expand with the average coefficient (1+q_{0}). The layer expands significantly when the parameter q_{0} reaches the value of the order of unity that corresponds to time t∼ωb−1.
Up to phase coefficient, the spectrum of the electron density
is the product of the spectrum of one “rectilinear” sub-layer Gνr=sinψ/ψ [compare with Eq. (9)] and of the lattice factor H_{ν}=sin2Nψ/sin2ψ from summation of all N periods. Here, ν=ξ_{0}κ,κ=k/h, and ψ=kξ_{0}d/4=πν/2. Using the Laurent series for (sin2ψ){−1}, we transform Eq. (10) to the form
The function H_{ν} is periodic, and the maxima of the function Gνr decrease with ν. Hence, the largest maximum in the spectrum corresponds to the zero wave number, ν=0. For many periods, the functions sinNπ(ν−n)/π(ν−n) are close to delta functions; correspondingly, the positions of other main maxima are close to the fixed integer values ν=2m+1,m=1,2,… and the normalized wave numbers decrease in time inversely proportionally to ξ_{0}.
Similar formulas and results can be obtained for a smooth cosine initial distribution (Fig. 4)
This distribution was considered in Refs [1] and  [2] by assuming that the modulation period is maintained. If the latter assumption is not used, then the evolution of the density is described by an expression that follows from Eq. (7):
In accordance with the statement in the Introduction about the absence of particle bunching and overtaking in a 1D system with a static initial density distribution, the denominator in Eq. (13) is not equal to zero and the density never approaches infinity if |ε|≤1 (Fig. 4). The spectrum for Eq. (13) has a similar form described by Eqs. (10) and (11) as in the previous case, but with another spectral function for one period
Here, z=εκq_{0}, ν=κ(1+q_{0}). For any value of the parameter ν, this function can, in principle, be expressed through Anger and Weber functions [18], which can be reduced to ordinary Bessel functions of the first kind for integer ν. Only the zero and first harmonics of the initial wave number h are not zero in the initial spectrum when t=0,q_{0}=0, and ν=κ. Higher harmonics also arise during expansion and distortion of the density distribution, but their values quickly reach the maxima and then decrease. The positions and values of the main maxima for a large number of periods, N ≫1, are close to the values
where F_{0}=ρ_{0}N/h is the value of the maximum for a zero wave number.
IV. LARGE CHANGE IN ELECTRON ENERGY
If the change in particle energy is large, |Δγ|∼γ, then one should use general formulas (2) and (3) for relativistic uniformly accelerated particles. In this case, relativistic contraction or extension of longitudinal scales for 1D sub-layers moving with essentially different velocities and the corresponding change in electron density are significant. The current density ρ(x,t) and the spatial spectrum for this case can be found after calculation of initial particles' coordinates x_{0} for current coordinates x from Eqs. (2) and (3) and their substitution into the spectrum. In this case, particles in the rear/front part of the layer move significantly slower/faster than in the middle part. Thus, due to the Lorentz extension/contraction of the longitudinal scales, the Coulomb expansion of the layer becomes non-uniform with increasing density and decreasing longitudinal size (“period”) of the sub-layers from the rear to the front part (Fig. 5). An “excessive” deceleration of the rear particles and an “insufficient” acceleration of the front particles, which are described by general relativistic formulas (2) and (3), lead to the lower and higher electron densities, respectively.
An alternative and more general method of calculation is division of the moving layer into interacting planes with charge surface densities σ_{i} (a gas of 1D particles) consisting of electrons moving along the x coordinate. The fields of the planes in the cross section x are described by the expressions
Such an approach enables a rigorous consideration of expansion for a 1D layer [Figs. 6(a)–6(c)] and, if necessary, the inclusion of all the effects of additional particle bunching and/or overtaking due to the initial energy spread or energy chirping of the beam. If a proper Coulomb force reduction is introduced, this approach also allows a simple estimation of the longitudinal expansion for transversely limited (initially cylindrical) 3D electron bunches when the transverse bunch expansion can be neglected. The simplest reduction coefficient describing the weakening of the Coulomb longitudinal field (16) for the particles located at the distance |x_{j}(t)−x_{i}(t)| can be found by using the expression for the field on the axis of a moving, uniformly charged disk
The coefficient κ_{red} provides a smooth transition from quasi-plane layers, ρ≫1, to point charges, ρ≪1 [Figs. (6d)–6(f)]. Figure 6 demonstrates the expansion of a periodic set of sub-bunches with zero initial particles velocities in the accelerating field E_{ac}=600kV/cm. The initial widths and separations of the sub-bunches are 1 mm, i.e., they are much greater than these parameters used earlier. This permits a not too rapid expansion of the bunch.
The expansion of bunches is quicker in the beginning of acceleration section where the particles have very small axial velocity. The 1D approximation is obviously satisfactory only for very short lengths and sufficiently short electron bunches. A more consistent consideration of 3D effects will be conducted in Sec. V.
Relativistic effects of changing density and period of modulation along the bunch can be compensated by use of an energy chirping with increasing accelerating voltage during the bunch duration, which is also necessary for compression of the electron beam down to the sizes corresponding to the THz wavelengths. Certainly, such a method leads to an inhomogeneous radiation line widening in an undulator.
V. APPLICABILITY LIMITS FOR 1D APPROACH. CHARGED DISKS AND THREADS: GPT SIMULATIONS
Dependence of the field on the axis of a moving, infinitely thin disk from the distance (17) gives the parameter of the problem, which determines the possibility to use the 1D approximation. For the field of a disk of finite length L_{disk}, the radius should be much larger than its length in a co-moving reference frame, or
in the laboratory frame. A similar parameter D=2π(L/γd) is used in Refs [1] and  [2] with a characteristic axial scale equal to the modulation period, L_{disk}=d. For a more rigorous application of 1D formulas for description of the evolution of the near-axis area of the initially cylindrical bunches, an at least N times larger value of L_{disc} = L, which is equal to the total initial length of the bunch, should be used in inequality (18). On the other hand, in the opposite case where the 1D approach is obviously not applicable, the parameter D is adequate, and its smallness means that close interactions of particles are most important. Simulations based on General Particle Tracer (GPT) [19] and the experiments described in Refs [1] and  [2] were carried out not for large but small values of D∼1. The corresponding bunches look as straight threads rather than disks. Such threads can be considered as different, but still 1D objects with 1D particle motion, which satisfy the same equations, although with a different (alternating) field distribution. Rapid reduction, changing the direction, and an increase in the “negative” electric force within a modulation period immediately explain the appearance of the restoring force, the approximate maintaining of the modulation period, and the excitation of nonlinear plasma waves found in Refs [1] and  [2].
We have checked the above considerations using the GPT code [17] for a wide range of the parameter D, including its small, intermediate, and large values. In good agreement with the simulations in Refs [1] and  [2] for D of the order of unity and smaller (threads), we have observed the excitation of nonlinear plasma waves, spikes, etc. For large values of parameter D, waves are not excited and the modulation period increases in good agreement with our analytical results (Fig. 7). Correspondingly, there is a regular energy chirp with increasing electron energy from the rare to the front of the disk.
For the smaller radii, including the case R∼γd (Fig. 8), one observes a complete disappearance and then re-emergence of the density modulation in the electron thread, the modulation period is nearly constant, and the energy chirp along the thread is smaller than in the case of disks.
VI. CONCLUSIONS
We have demonstrated, both analytically and numerically, that unlike the case of charged threads actually studied in Refs [1] and  [2], any initial finite static distribution of electrons in 1D and quasi-1D layers can only expand and does not lead to the excitation of plasma oscillations. The characteristic time of such expansion is inversely proportional to the initial relativistic electron plasma frequency. In the most interesting case of a relatively small change in particle energy in the radiation section, the periodicity of modulation is maintained, but its period increases and amplitude decreases in time. In the case of a large change in electron energy, the periodicity is broken; the “period” of modulation decreases and its amplitude increases from the rear to the front boundary due to the relativistic change in longitudinal scales. It has been shown that a relatively long electron bunch with a proper preliminary spatial modulation can emit in a long undulator a significantly higher energy and a narrower spectrum of coherent spontaneous radiation than a short single bunch with the same charge.
Comparison of two limited initial shapes of ultrarelativistic modulated electron bunches with large charge, namely, short “disks” and long “threads,” which can be formed on the basis of laser-driven photo injectors, shows that both configurations can provide a significantly higher energy from the sources of coherent spontaneous THz radiation. The excitation of plasma waves in the treads maintains the modulation period and allows excitation of high-frequency radiation harmonics, but at the same plasma frequency the modulation amplitude changes faster in this regime. Choosing one or another bunch shape is mainly determined by the possibilities of their implementation in specific accelerators.
FIG. 1. 
Coulomb expansion of a moving 1D electron pulse (layer) with an arbitrary symmetric initial density distribution (velocities of boundaries are shown for the most important case of a relatively low change in electron energy).
FIG. 2. 
Expansion of a uniform electron layer: (a) t=0 and (b) ω_{b}t=2.
FIG. 3. 
Expansion of a periodic set of uniform sub-layers separated by equal empty intervals: (a) t=0 and (b) ω_{b}t=2.
FIG. 4. 
Expansion of a cosine periodic density distribution with the modulation parameter ε=1: (a) t=0 and (b) ω_{b}t=2.
FIG. 5. 
Expansion of a periodic set of five uniform sub-layers separated by equal empty intervals for a large change in particles energy: (a) t=0 and (b) ω_{b}t=2.
FIG. 6. 
Acceleration and expansion of a set of five bunches with the initial widths and separations between them 1 mm and total surface density σ=30 (Gaussian units are used) in the accelerating field E_{ac}=600kV/cm: (a)–(c) 1D approach and (d)–(f) modeling of finite transverse dimensions using the reduction coefficient κ_{red} from Eq. (17) for the charged cylinder with the radius R = 3 mm and charge of 3 nC.
FIG. 7. 
Results of GPT simulations for a cosinusoidal modulation inside of an electron disc with initial parameters ε=1,R =2 mm, d=20μm, N =5, γ=13, and q =0.5 nC for distances x =0 (a), 30 cm (b), and 70 cm (c).
FIG. 8. 
Results of GPT simulations for a cosine modulation inside an electron thread with the initial parameters ε=1,R =0.2 mm, d=20μm, N =5, γ=13, and q =0.05 nC for distances x =0 (a), 27 cm (b), and 50 cm (c).

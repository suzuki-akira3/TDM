A unified method of detecting core-periphery structure and community structure in networks
The core-periphery structure and the community structure are two typical meso-scale structures in complex networks. Although community detection has been extensively investigated from different perspectives, the definition and the detection of the core-periphery structure have not received much attention. Furthermore, the detection problems of the core-periphery and community structure were separately investigated. In this paper, we develop a unified framework to simultaneously detect the core-periphery structure and community structure in complex networks. Moreover, there are several extra advantages of our algorithm: our method can detect not only single but also multiple pairs of core-periphery structures; the overlapping nodes belonging to different communities can be identified; different scales of core-periphery structures can be detected by adjusting the size of the core. The good performance of the method has been validated on synthetic and real complex networks. So, we provide a basic framework to detect the two typical meso-scale structures: the core-periphery structure and the community structure.
I. INTRODUCTION
Many real-world systems in the field of communication, social, transportation, information, biology, etc., can be described as networks [1]. Meso-scale structures are very important for understanding of network properties and dynamics. Considerable investigations have focused on the study of a particular type of meso-scale structure known as the community structure which has some cohesive groups called “communities,” nodes in the same community are connected densely to each other, whereas nodes in different communities are connected sparsely [2,3]. The adjacency matrix representing the community structure is given in Fig. 1(a). Various techniques have been developed to detect the community structure [4,5], e.g., the algorithms were based on modularity [6], random walks [7], spectral clustering [8], hierarchical clustering [9,10], nonnegative matrix factorization approach [11], and so on. There are also many algorithms for overlapping community detection based on label propagation [12,13], link partition [14,15], clique percolation theory [16,17], multi-objective evolutionary algorithm [18], etc.
Another meso-scale structure known as the core-periphery structure has not received enough attention, but it has been examined in the networks of society [19], scientific citation [20], international trade [21,22], and other fields [23–25]. For instance, maintaining a party or an organization often needs an elite group to organize and manage it. The elite group is composed of highly influential and powerful individuals who have more connections with each other, and other people involved, namely, the periphery part with few connections inside are less organized and less dominant [22]. Biological networks, such as that of the human brain, where a group of densely connected network nodes provides long-term functionality and robustness (core), while another group of sparsely connected nodes is responsible for adaptation on short time scales to changing conditions in the environment (periphery) [26]. All of these phenomena are the expressions of the CP structure, indicating the significance of studying the CP structure [27–29].
Although the two meso-scale structures were studied more or less, the relationship between them is not well clarified. In fact, there are some intuitive relationships between the two typical meso-scale structures: on the one hand, a network with a single CP structure [the adjacency matrix is shown in Fig. 1(b)] implies the absence of the community structure; on the other hand, a network with multiple pairs of CP structures [the adjacency matrix is illustrated in Fig. 1(c)] often implies the existence of the community structure. However, the community structure does not imply the existence of the multiple CP structure, if there are no closely connected core nodes and more loosely connected peripheral nodes in each community, the multiple pairs of CP structure do not appear. Therefore, correct understanding the relationship between two meso-scale structures can help us distinguish and design effective methods to detect both of them.
The formal and rather popular definition of the CP structure was proposed by Borgatti and Everett [27], in which a node belongs to a core if and only if it is well connected both to other core nodes and to peripheral nodes, and peripheral nodes do not connect with other peripheral nodes. The adjacency matrix of an ideal CP structure is illustrated in Fig. 1(b) [28]. Since the definition of an ideal CP structure is too strict to meet, a looser definition of the CP structure is that core nodes are highly interconnected and peripheral nodes fray into a tree [30]. However, it is a descriptive definition, the strict definition from mathematics has not been well proposed. The existing CP detection methods were mainly implemented by checking how well a network approximates the ideal case [27,28,31] or by ranking the nodes according to certain centrality indices denoting the nodes' coreness [31–33]. Recently, Zhang et_al first proposed a method for identifying the CP structure using a maximum likelihood method to fit a stochastic block model with the CP structure. By fitting the model to the observed network data, the parameters of the fit tell us the best partition with respect to the CP structure [34]. The method is nonparametric, and can deal with large-scale networks and a weak CP structure. However, these methods often face one or several of following shortcomings: first, the methods need to give the size of the core in advance; second, the methods rudely divide a network into a single CP structure, however, many real networks present multiple pairs of CP structures [35]. More importantly, multiple pairs of CP structures and a community structure may coexist in many real networks, and the methods do not provide a unified framework to detect the both meso-scale structures.
Inspired by these reasons, the goal of this paper aims to propose a unified method to detect the CP structure and community structure. In doing so, we first rank all nodes according to a connection density (CD) indictor, then we can judge whether the network exhibits a single CP structure, multiple pairs of CP structures or community structure based on the defined region density (RD) curve. Moreover, the multi-scale of the CP structure and the overlapping nodes can be detected too.
II. THE PROPOSED ALGORITHM
In this section, we describe the method used for detecting both the CP structure and community structure. Consider an undirected and unweighted network, the general framework of our method is presented in Algorithm 1 (shown in the Appendix). The algorithm consists of three main steps: (1) re-rank all nodes in a new sequence; (2) the region density of each node is calculated and the region density curve is plotted; and (3) detect main meso-scale structures of the network based on the region density curve.
A. Re-rank nodes in a new sequence
Consider a network G(V, E), where V is the set of nodes and E is the set of links. Given that the links between core nodes are denser, we want to re-rank all nodes such that nodes with more common connections approach each other in the new sequence. In doing so, we define a set U and a set V′=V∖U to store re-ranked nodes and the remaining nodes, respectively. Initially, U=∅ and V′=V. To start the sorting process, we need to choose one node as the starting node. We can choose a node with the highest centrality value since the node is more likely to be a core node. We here choose the node with the highest closeness centrality as the first node in set U, and renumber it as u_{1}, i.e., U={u_{1}} (we found that the results are not sensitively dependent on different centrality indices, such as the degree, betweenness, eigenvector, and so on [1]). Now, we need to choose a node from V′ and put it into U to make sure the new added node has the most connections with the nodes in U. If more than one node is found, we choose the node with the maximum degree and put it into U. Namely, we choose the node with the largest value of P and put it into set U, which is defined as
where A_{ij} is the element of the adjacency matrix and k(i) and k_{max} are the degree of node i and the maximal degree, respectively.
The framework of the re-ranking process is given in Algorithm 2 (shown in the Appendix). Take an illustration in Fig. 2 as an example, there are four red nodes in U, now one node in V′ (outside of the circle) is going to be added into U [see Fig. 2(a)]. However, nodes a and b have the same connections with U, we choose node a and put it into U since node a has a larger degree value [see Fig. 2(b)]. If their degree values are also the same, one of them is randomly chosen. In this way, the nodes which have more common connections are able to close each other in the new sequence. According to the above method, all nodes are sorted in U as: U={u_{1},u_{2},…,u_{N}}.
B. Plot region density curve
We here first define a local indicator—connection density (CD)—to characterize the density of connections in a subgraph S, which is given as
where n′ is the number of nodes in S and m′ is the number of existing connections in S.
A parameter α is defined to measure the minimal size of the core. For a given value of α, the region density of a node u_{i} is defined as the connection density of subgraph consisting of nodes from u_{i−α+1} to itself, i.e.,
We mainly set α=⌊〈k〉⌋ in this work, with 〈k〉 be the average degree of the network and ⌊·⌋ be the integral function (in the next context, we also address that different scales of meso-scale structures can be observed by adjusting the value of α). We can draw a region density curve after calculating the value of RD regarding each node, where the horizontal axis denotes the node sequence defined in Sec. II A, and the ordinate axis is the value of RD.
We take the karate club network as an example to illustrate the main steps in Secs. II A and II B. The karate club network consists of 34 nodes that represent club members and 78 links that represent friendships among members. The club was split into two groups because of a conflict of the club president (node 34) and the instructor (node 1), as shown in Fig. 3(a). Note that node 9 is a special node, who supported the president (node 34), but joined the instructor's (node 1) club for some reasons. To fairly compare with the existing methods, we also assume that node 9 belongs to the node 34's club [2,36,37]. According to our defined re-ranking way in Sec. II A, node 1 is first put into the set U owing to its the highest closeness value (i.e., u_{1}=1). Though there are a lot of nodes in V′ connecting to node 1, node 3 is second added into U since it has the maximal degree value (i.e., u_{2}=3). At this time, nodes 1 and 3 are included in set U. Next, nodes 2, 4, 14, 8, and 9 in V′ connecting to all of nodes in U, however, node 2 is added into U since its degree value is the largest. Repeat the above steps until V′=∅. According to the descriptions in Sec. II B, we draw a region density curve in which the ordinate labels the value of RD regarding each node [as shown in Fig. 3(b)].
C. Detect meso-structures
A subgraph S can be viewed as a core if the CD(S) is larger than a threshold value β. Larger value of β gives rise to the stricter definition of the core. Once the region density curve is presented, the meso-scale structures can be detected by comparing how many peaks are larger than or equal to β. Note that some peaks in the beginning of the curve are not valid even though whose RD(u_{i})≥β. For example, if we set α = 4, the first three nodes in the region density curve cannot form the core even though RD(u_{2})=1 or RD(u_{3})=1, since the number of nodes is smaller than the minimal size of core α. Moreover, if the values of RD for two sequential nodes are greater than or equal to β, the two cores or communities are merged as a single one. A region density curve of networks with a CP structure has the following characteristic: the difference between the maximum and minimum values is very huge, and the values of RD for most nodes are very low. This is consistent with the fact that the number of peripheral nodes is far larger than the number of core nodes, and the connections among core nodes are very dense but among peripheral nodes are very few. The framework of detecting core nodes is summarized in Algorithm 3 (shown in the Appendix).
Figure 4 schematically shows the region density curves of three types of ideal meso-scale structures. The region density curves in Figs. 4(a) and 4(b) correspond to a network with a single CP structure and with a multiple pair of CP structures, respectively. The region density curve of a community structure without a CP structure is similar to a cosine curve, where the difference between the peak and least values is not so huge, as shown in Fig. 4(c). Of course, the number of community structures in the network is determined by the number of the peaks which reach the value of β. In sum, we can judge the meso-scale structures of a network according to its region density curve.
Though we can determine the core node and the number of cores based on the region density curve, some important problems should be further considered. First, when multiple pairs of CP structures are detected, we should know that the peripheral nodes belong to which core and how close they are with their core nodes; second, when the community structure exists in a network, can we find the overlapping nodes who belong to different communities? To this end, we begin to expand peripheral nodes from each core to form its sub-CP structure. At the beginning, each sub-CP structure only contains core nodes and they are defined as class 0. The peripheral nodes which have direct connections with the core nodes are valued as class 1, and they are allocated to the core which has the most connections with them. In this way, one or several initial sub-CP structures are formed (each sub-CP structure only contains core nodes and their periphery neighbors). Next, the neighbors of the initial sub-CP structures are defined as class 2, and they are allocated to the sub-CP structure which has the most connections with them. The expanding process finishes until all peripheral nodes are allocated and their class values are determined. Many experimental results have demonstrated that most of the real networks are “small-world,” i.e., their average length of paths are very short [38]. Thus, the above expanding process can be finished in several steps.
In the above allocation steps, some nodes may be allocated to more than one sub-CP structure or community, namely, they have the same neighbors connecting two or several sub-CP/community structures. These nodes are viewed as active nodes. One may intuitively think that these active nodes are the overlapping nodes because they connect different sub-CP structures or communities. However, we address that many active nodes may not be real overlapping nodes. For example, even though an important person need to frequently connect the leaders in different organizations owing to his special role, but which does not mean that the important person belongs to different organizations. Therefore, we re-allocate each active node to a sub-CP/community which has the most neighbors of the active node. If there are still some active nodes which are assigned to more than one sub-CP structure/community, these kind of active nodes are viewed as the real overlapping nodes. The framework of detecting meso-structure is demonstrated in Algorithm 4 (shown in the Appendix).
We still use the karate club network as an example to help us understand our method. In Sec. II A, all nodes have been re-ranked and the region density curve is plotted in Fig. 3(b). Now, we should use the number of peaks in the curve to determine the meso-scale structures. According to the assumption α=⌊〈k〉⌋, one has α = 4 owing to 〈k〉≈4.59. Here, we set the core density β = 1, that is to say,, all core nodes are fully connected. As shown in the region density curve, the values of RD(4), RD(14), and RD(31) are equal to 1. Thus, the region formed by these three nodes are {1,3,2,4},{3,2,4,14}, and {9,34,33,31} (though RD(2)=1 and RD(3)=1, neither of them is valid peak since their region is too small to form core). Because node 4 and node 14 are sequentially placed in the curve, the two cores are merged into one larger core, i.e., {1,3,2,4,14}. Now, there are two cores: C_{1}={1,3,2,4,14} and C_{2}={9,34,33,31} [Fig. 3(c)]. According to the above expanding method, we can know that each peripheral node belongs to which core and how far from its own core.
In the first allocation, nodes 10, 28, and 29 are allocated to the two sub-CP structures, so the three active nodes need to be re-allocated. In the secondary distribution, nodes 28 and 29 are allocated to the right sub-CP structure [see Fig. 3(c)]. However, node 10 still has the same number of connections to the two sub-CP structures, which is viewed as the real overlapping node.
Figure 3(d) shows the adjacency matrix of the karate club network, which is very similar to the ideal sub-CP structures shown in Fig. 1(c). Although the karate club network has been used as a benchmark network for community detection, our result indicates that the karate club network has two pairs of CP structures, leading to the network with two communities. We should address that even though some community detection algorithms can divide the karate club network into two groups, which do not clearly clarify each node being the core node or peripheral node, namely, the inner structure in each group is not well answered. Our method not only divides the network into two groups, but also accurately differentiates the core nodes and peripheral nodes in each group. In addition, our method can further distinguish the roles of peripheral nodes, and identify the active nodes and overlapping nodes simultaneously. In short, our method provides a more systematic and accurate description of the meso-scale structure and the roles of nodes in networks.
III. EXPERIMENTAL RESULTS
In this section, we examine the meso-scale structures in some real-world networks and a synthetic benchmark network used in community network detection.
A. USA airport network
The USA airport network has 332 nodes representing airports and 2126 unweighted links describing the airlines between airports [39]. The average degree of this network is 〈k〉=12.81, so the value of α is 12. By setting β = 1, as shown in Fig. 5(b), only one peak in the region density curve reaches the value of 1, the values of RD for the other nodes are very low. So this network exhibits a strong single CP structure. There are 22 core nodes (the core nodes are the red nodes in Fig. 5(a), and the core nodes are also labeled in the enlarged region density curve [see Fig. 5(c)].
If we reduce the value of α, we can find different sizes of meso-scale structures. When the value of α ranges from 6 to 11, the USA airport network still has a single CP structure, with just a slight change of the number of core nodes. When α = 5, besides the largest CP structure, another three smaller meso-scale structures can be observed. Each of them has 5 core nodes and their number of peripheral nodes is 3, 14, and 1, respectively. Generally speaking, the number of peripheral nodes is larger than the number of core nodes, so only the second small meso-scale structure can be viewed as a CP structure, the other two are the small scale of community structures. Namely, there are a large CP structure, a small CP structure, and two small community structures in this network. The region density curve for α = 5 is shown in Fig. 5(d) and there are four peaks reaching 1. The first peak contains more nodes, while the other three peaks contain fewer nodes and the values of RD for most remaining nodes are very low. Figures 5(e) and 5(f) show the adjacency matrix of the USA airport network for α = 12 and α = 5, respectively. The adjacency matrix shown in Fig. 5(e) is very similar to the ideal case shown in Fig. 1(a), indicating this network exhibits a single CP structure. But when α = 5, there are three smaller meso-scale structures shown in the lower right area of Fig. 5(f).
B. Dolphin social network
The dolphin social network is an undirected social network of frequent associations between 62 dolphins in a community living off Doubtful Sound, New Zealand. The network has 62 nodes representing the dolphins and 159 links denoting the frequent associations between dolphins [3]. The community is composed of two families, as shown in Fig. 6(a), the nodes with different colors belong to different families.
The value of α = 5 in this network. As shown in Fig. 6(b), the difference between the peak and lowest value in region density curve is very huge. The values of RD for most nodes are very low. So we can judge that the dolphin social network has CP structures. If we set β = 1, there are two peaks, but the first peak is invalid since there are only three nodes (nodes 34, 38, and 41). Only the subgraph including nodes 46, 30, 22, 52, and 19 forms a core. So we set β=0.9 to relax the definition of the core. In this case, only one connection is missed in the core group (for a subgraph with five nodes, the possible number of connections is (52)=10). Now, RD(25)=0.9 and RD(10)=0.9, as a result, two cores emerge: C_{1}={46,30,22,52,19,25} and C_{2}={14,42,58,18,10}, and the network has two pairs of CP structures. Similar to the method in the karate club network, all peripheral nodes can be classified to one corresponding core group and assigned a class value denoting how far they are from their core group. Figure 6(d) demonstrates the adjacency matrix of the dolphin social network. If we further relax the definition of the core by setting β=0.75, the network presents a richer phenomenon: there are three pairs of CP structures in the dolphin social network. The accurate partition is given in Fig. 6(e) and its adjacency matrix is presented in Fig. 6(f), respectively. Therefore, more types of partitions can be obtained by adjusting the value of β.
C. Political blogs network
Adamic and Glance constructed a network of political blogs during the 2004 U.S. Presidential election. The nodes of this network are blogs about US politics and the edges are hyperlinks between these blogs [40]. There are 1222 blogs and 16 714 connections in the network. Since this network displays a marked division into groups of conservative and liberal blogs, which has been viewed as a typical example of a community structure [41].
After plotting the region density curve [see Fig. 7(b)], one can see that there are two obvious peaks in the curve. So the network has two pairs of CP structures. By using the expanding method, the peripheral nodes can be divided into their core group and form a corresponding sub-CP structure [see Fig. 7(a)], where blue nodes are the periphery of yellow cores and the red nodes are the periphery of green cores, respectively. Moreover, there are 11 nodes marked by light blue color which are the overlapping nodes. The adjacency matrix in Fig. 7(c) also validates that the network has two pairs of CP structures.
Some methods based on centrality indices assume that the nodes with higher centrality values are core nodes [32]. In this network, we pick two nodes with larger degree values [orange node in the left side and the light purple node in the right side of Fig. 7(a)] as examples to argue that nodes with larger centrality values are not necessarily the core nodes. The main reason is that these nodes have many connections with peripheral nodes but few connections with core nodes.
D. Synthetic benchmark network
Our experimental results indicate that our method can not only detect the CP structure but also the community structure. But one should note that not all community networks indicate the existence of the CP structure. Here, we generate an Lancichinetti–Fortunato–Radicchi (LFR) benchmark network proposed in Ref [42] to answer the question whether networks with a community structure also have a CP structure. The LFR benchmark networks are widely used to test the performances of different algorithms in detecting overlapping communities. In this section we also generate several sets of LFR networks to compare the performances of different algorithms in detecting overlapping communities. Here, the parameters in this synthetic network are set as follows: the average degree 〈k〉=8, the maximum degree k_{max} = 12, the mixing parameter μ=0.1, and the exponents of the power law distribution of node degrees γ_{1} and community size γ_{2} are −2 and −1, respectively. The network has 100 nodes and 404 links, and it is composed of 10 communities whose sizes range from 7 to 12. The formation mechanism can only guarantee emergence of a community structure but cannot ensure there is a core in each community. The region density curve of the synthetic network is shown in Fig. 8(a), which is very similar to the curve shown in Fig. 4(c). So we can judge that the network does not exhibit a CP structure. The adjacency matrix of the network shown in Fig. 8(b) is very similar to Fig. 1(a), which further validates that the network has no CP structure.
E. College football network
The college football network describes games between Division I-A American college football teams in the year 2000 [43]. It has 115 nodes and 613 connections, leading to α = 10. From the region density curve in Fig. 9(a), we can conclude that the college football network only has a community structure but has no CP structure. By setting α = 8, the characteristics of the region density curve are more clear and the peaks are easier to be observed [see Fig. 9(b)]. For the football network, the inner connections in each community are not very dense, so is hard to achieve a full connection in each community. For this purpose, we set β=0.6 to detect the community structure. According to our method, the network can be divided into 11 communities. The adjacency matrix of the network is shown in Fig. 9(c), which is very similar to the adjacency matrix shown in Fig. 1(a).
IV. COMPARISON OF DIFFERENT ALGORITHMS
In this section, we compare the performance of our algorithm with other existing methods regarding the detection of the CP structure and community structure, respectively. The normalized mutual information (NMI) index is used to measure the performance of different algorithms, which is defined as [44]
Here, A and B are the partition determined by algorithms and the real partition, respectively, I(A, B) is the mutual information of A and B. H(A) and H(B) are the entropy of A and B, respectively. NMI is in the range of [0,1] and equals to 1 only when two partitions are totally coincident.
A. Performance on detection of the CP structure
Since the study on the detection of the CP structure has not been paid much attention, moreover, some existing algorithms were proposed to detect the single CP structure and the number of core nodes should be given in advance. Thus, few algorithms can be used to fairly compare. Very recently, one algorithm aimed at detecting multiple pairs of CP structure was proposed by Sadamori Kojaku and Naoki Masuda (termed as the KM algorithm) [35]. The KM algorithm is to maximize one defined quality function. Moreover, in the KM algorithm, nodes were removed as residual nodes by considering the statistical significance of each CP pair. Here, we do not check the statistical significance of the CP structure when we implement this algorithm, since the statistical significance is not considered in other algorithms. In the work, Kajuka et_al compare their algorithm with two other algorithms. One is the BE-KL algorithm, which aims to detect a single CP structure by maximizing Q_{BE} (a quality function based on the Pearson correlation coefficient to measure the similarity between the given partition and its ideal CP structure) using the Kernighan-Lin algorithm [45]. The BE-KL algorithm mainly focuses on how to detect networks with a single CP structure. The other algorithm is termed as the Two-step algorithm, the network is first divided into non-overlapping communities by maximizing modularity using the Louvain algorithm [46], then the core and periphery in each community are detected by the BE-KL algorithm again. Here, we compare our algorithm with these three algorithms: BE-KL, Two-step and KM algorithms on sets of synthetic networks, including networks with a single CP structure and multiple pairs of CP structures, respectively.
Since the ground truths about CP structures in real networks are not known, we generate some synthetic networks based on the stochastic block models [34,47] to measure the performances of different algorithms. For sets of synthetic networks with a single CP structure, the size of the whole network, the size of the core and the size of the periphery are set as N = 600, N_{c} = 100, and N_{P} = 500, respectively. For a network with a typical CP structure, the connection probability among core nodes (P_{CC}) should be larger than or equal to the connection probability between core nodes and peripheral nodes (P_{CP}), and further larger than the connection probability among peripheral nodes (P_{PP}). Therefore, we let P_{PP} = 0.05, and P_{CP}=P_{CC}4, then sets of synthetic networks are generated by varying the value of P_{CC}. Two parameters in our method are set as α=⌊k⌋ and β=5ρ, where ρ=2MN(N−1) with M being the number of links. As shown in Fig. 10(a), our method has better performance than the other algorithms when P_{CC} is not very large, namely, the CP structure is not very strong. Otherwise, the performance of the BE-KL algorithm is better than others when P_{CC} is very large.
Several sets of synthetic networks with two pairs of CP structures are also generated to compare the performances of different algorithms. For each pair of CP structure, the parameters are set as: N_{c} = 50, N_{P} = 250, P_{PP} = 0.05, and P_{CP}=P_{CC}4, respectively. Moreover, the connection probability linking two pairs of CP structures is fixed as 0.01. Moreover, we set α=⌊k⌋ and β=10ρ. Figure 10(b) indicates that the Two-step algorithm gives rise to the best performance, and our method is better than the other two algorithms in most cases. For the Two-step algorithm, each step needs to maximize the corresponding quality function based on the global structure of the network, which significantly increases the time complexity. Moreover, the performance of the Two-step algorithm in detection of network with a single CP structure is very bad. The results of the synthetic networks with a single CP structure and with multiple CP structures indicate that the performance of our method is generally better than other algorithms.
B. Performance on detection of overlapping communities
The performances of different algorithms in detecting overlapping communities are compared on three real networks and three LFR benchmark networks [42] (introduced in Sec. III D). The three real networks are the karate club network, the dolphin social network, and the college football network, respectively. The ground truths about the community structure in these networks are known. The basic topological features of these networks are given in Table I.
We compare our method with four overlapping community detection algorithms: a clique percolation method (CPM) proposed by Palla et_al [16], a local expansion and optimization algorithm (LFM) proposed by Lancichinetti et_al [42], a fast overlapping community search (FOCS) method developed by Bandyopadhyay et_al [48], and a fuzzy c-means clustering (FCM) algorithm proposed by Zhang et_al [49] Their comparisons are summarized in Table II. One can observe that the performance of our method in detecting overlapping communities generally outperforms other methods, especially on real networks.
V. CONCLUSIONS
In this work, we have proposed a unified method to detect the CP structure and community structure in networks. This method is effective not only on a single CP structure but also on the community structure and multiple pairs of CP structures, and further in finding active nodes and overlapping nodes in networks. Also, the role of each node is assigned. In addition, our method does not need to fix the size of the core in advance, where some sequential cores can form a larger core. Therefore, our method provides a tool for the identification of meso-scale structures in the network, and may also provide some inspirations in identifying the influential nodes.
Of course, many places are worthy of future study. On the one hand, we set α=⌊〈k〉⌋ and β = 1 in most cases. For each network, how to choose the values of α and β is a non-negligible problem. Of course, as we have discussed, many rich structures can be observed if the values of α and β are properly chosen. On the other hand, previous results have demonstrated that the network structure has a fundamental effect on its collective dynamics, for instance, networks with a scale-free structure can promote the outbreaks of infectious diseases [50,51] and reduce the transportation efficiency [52]. The community structure also significantly affects its collective dynamics, such as synchronization [53], spreading of epidemic [54], evolutionary games [55], and so forth. As a result, how the CP structure affects the collective dynamics is an important issue that deserves in-depth studies. For example, Simóm et_al have found that the CP structure can induce double percolation phase transition under certain conditions [56].
The community structure in complex networks as a typical meso-scale structure has received considerable attention; however, the other type of meso-scale structure—the core-periphery (abbreviated as CP) structure—has received much less attention than it deserves, even though the CP structure has been extensively observed in many social and biological systems. Recently, some researchers have begun to pay attention to this problem and designed some algorithms to detect the CP structure. Nevertheless, most of them aimed at detecting a single CP structure but cannot detect multiple pairs of CP structures. In addition, the two meso-scale structures are separately studied previously. In this work, we propose a simple and effective algorithm which can not only detect single as well as multiple pairs of CP structures, but also can simultaneously detect the CP structure and community structure in complex networks. Moreover, the multi-scale of the CP structure and the overlapping nodes can be detected too. Therefore, our proposed algorithm builds a bridge connecting the two typical meso-scale structures: the CP structure and the community structure.
Many real-world systems in the field of communication, social, transportation, information, biology, etc., can be described as networks [1]. Meso-scale structures are very important for understanding of network properties and dynamics. Considerable investigations have focused on the study of a particular type of meso-scale structure known as the community structure which has some cohesive groups called “communities,” nodes in the same community are connected densely to each other, whereas nodes in different communities are connected sparsely [2,3]. The adjacency matrix representing the community structure is given in Fig. 1(a). Various techniques have been developed to detect the community structure [4,5], e.g., the algorithms were based on modularity [6], random walks [7], spectral clustering [8], hierarchical clustering [9,10], nonnegative matrix factorization approach [11], and so on. There are also many algorithms for overlapping community detection based on label propagation [12,13], link partition [14,15], clique percolation theory [16,17], multi-objective evolutionary algorithm [18], etc.
Another meso-scale structure known as the core-periphery structure has not received enough attention, but it has been examined in the networks of society [19], scientific citation [20], international trade [21,22], and other fields [23–25]. For instance, maintaining a party or an organization often needs an elite group to organize and manage it. The elite group is composed of highly influential and powerful individuals who have more connections with each other, and other people involved, namely, the periphery part with few connections inside are less organized and less dominant [22]. Biological networks, such as that of the human brain, where a group of densely connected network nodes provides long-term functionality and robustness (core), while another group of sparsely connected nodes is responsible for adaptation on short time scales to changing conditions in the environment (periphery) [26]. All of these phenomena are the expressions of the CP structure, indicating the significance of studying the CP structure [27–29].
Although the two meso-scale structures were studied more or less, the relationship between them is not well clarified. In fact, there are some intuitive relationships between the two typical meso-scale structures: on the one hand, a network with a single CP structure [the adjacency matrix is shown in Fig. 1(b)] implies the absence of the community structure; on the other hand, a network with multiple pairs of CP structures [the adjacency matrix is illustrated in Fig. 1(c)] often implies the existence of the community structure. However, the community structure does not imply the existence of the multiple CP structure, if there are no closely connected core nodes and more loosely connected peripheral nodes in each community, the multiple pairs of CP structure do not appear. Therefore, correct understanding the relationship between two meso-scale structures can help us distinguish and design effective methods to detect both of them.
The formal and rather popular definition of the CP structure was proposed by Borgatti and Everett [27], in which a node belongs to a core if and only if it is well connected both to other core nodes and to peripheral nodes, and peripheral nodes do not connect with other peripheral nodes. The adjacency matrix of an ideal CP structure is illustrated in Fig. 1(b) [28]. Since the definition of an ideal CP structure is too strict to meet, a looser definition of the CP structure is that core nodes are highly interconnected and peripheral nodes fray into a tree [30]. However, it is a descriptive definition, the strict definition from mathematics has not been well proposed. The existing CP detection methods were mainly implemented by checking how well a network approximates the ideal case [27,28,31] or by ranking the nodes according to certain centrality indices denoting the nodes' coreness [31–33]. Recently, Zhang et_al first proposed a method for identifying the CP structure using a maximum likelihood method to fit a stochastic block model with the CP structure. By fitting the model to the observed network data, the parameters of the fit tell us the best partition with respect to the CP structure [34]. The method is nonparametric, and can deal with large-scale networks and a weak CP structure. However, these methods often face one or several of following shortcomings: first, the methods need to give the size of the core in advance; second, the methods rudely divide a network into a single CP structure, however, many real networks present multiple pairs of CP structures [35]. More importantly, multiple pairs of CP structures and a community structure may coexist in many real networks, and the methods do not provide a unified framework to detect the both meso-scale structures.
Inspired by these reasons, the goal of this paper aims to propose a unified method to detect the CP structure and community structure. In doing so, we first rank all nodes according to a connection density (CD) indictor, then we can judge whether the network exhibits a single CP structure, multiple pairs of CP structures or community structure based on the defined region density (RD) curve. Moreover, the multi-scale of the CP structure and the overlapping nodes can be detected too.
In this section, we describe the method used for detecting both the CP structure and community structure. Consider an undirected and unweighted network, the general framework of our method is presented in Algorithm 1 (shown in the Appendix). The algorithm consists of three main steps: (1) re-rank all nodes in a new sequence; (2) the region density of each node is calculated and the region density curve is plotted; and (3) detect main meso-scale structures of the network based on the region density curve.
Consider a network G(V, E), where V is the set of nodes and E is the set of links. Given that the links between core nodes are denser, we want to re-rank all nodes such that nodes with more common connections approach each other in the new sequence. In doing so, we define a set U and a set V′=V∖U to store re-ranked nodes and the remaining nodes, respectively. Initially, U=∅ and V′=V. To start the sorting process, we need to choose one node as the starting node. We can choose a node with the highest centrality value since the node is more likely to be a core node. We here choose the node with the highest closeness centrality as the first node in set U, and renumber it as u_{1}, i.e., U={u_{1}} (we found that the results are not sensitively dependent on different centrality indices, such as the degree, betweenness, eigenvector, and so on [1]). Now, we need to choose a node from V′ and put it into U to make sure the new added node has the most connections with the nodes in U. If more than one node is found, we choose the node with the maximum degree and put it into U. Namely, we choose the node with the largest value of P and put it into set U, which is defined as
where A_{ij} is the element of the adjacency matrix and k(i) and k_{max} are the degree of node i and the maximal degree, respectively.
The framework of the re-ranking process is given in Algorithm 2 (shown in the Appendix). Take an illustration in Fig. 2 as an example, there are four red nodes in U, now one node in V′ (outside of the circle) is going to be added into U [see Fig. 2(a)]. However, nodes a and b have the same connections with U, we choose node a and put it into U since node a has a larger degree value [see Fig. 2(b)]. If their degree values are also the same, one of them is randomly chosen. In this way, the nodes which have more common connections are able to close each other in the new sequence. According to the above method, all nodes are sorted in U as: U={u_{1},u_{2},…,u_{N}}.
We here first define a local indicator—connection density (CD)—to characterize the density of connections in a subgraph S, which is given as
where n′ is the number of nodes in S and m′ is the number of existing connections in S.
A parameter α is defined to measure the minimal size of the core. For a given value of α, the region density of a node u_{i} is defined as the connection density of subgraph consisting of nodes from u_{i−α+1} to itself, i.e.,
We mainly set α=⌊〈k〉⌋ in this work, with 〈k〉 be the average degree of the network and ⌊·⌋ be the integral function (in the next context, we also address that different scales of meso-scale structures can be observed by adjusting the value of α). We can draw a region density curve after calculating the value of RD regarding each node, where the horizontal axis denotes the node sequence defined in Sec. II A, and the ordinate axis is the value of RD.
We take the karate club network as an example to illustrate the main steps in Secs. II A and II B. The karate club network consists of 34 nodes that represent club members and 78 links that represent friendships among members. The club was split into two groups because of a conflict of the club president (node 34) and the instructor (node 1), as shown in Fig. 3(a). Note that node 9 is a special node, who supported the president (node 34), but joined the instructor's (node 1) club for some reasons. To fairly compare with the existing methods, we also assume that node 9 belongs to the node 34's club [2,36,37]. According to our defined re-ranking way in Sec. II A, node 1 is first put into the set U owing to its the highest closeness value (i.e., u_{1}=1). Though there are a lot of nodes in V′ connecting to node 1, node 3 is second added into U since it has the maximal degree value (i.e., u_{2}=3). At this time, nodes 1 and 3 are included in set U. Next, nodes 2, 4, 14, 8, and 9 in V′ connecting to all of nodes in U, however, node 2 is added into U since its degree value is the largest. Repeat the above steps until V′=∅. According to the descriptions in Sec. II B, we draw a region density curve in which the ordinate labels the value of RD regarding each node [as shown in Fig. 3(b)].
A subgraph S can be viewed as a core if the CD(S) is larger than a threshold value β. Larger value of β gives rise to the stricter definition of the core. Once the region density curve is presented, the meso-scale structures can be detected by comparing how many peaks are larger than or equal to β. Note that some peaks in the beginning of the curve are not valid even though whose RD(u_{i})≥β. For example, if we set α = 4, the first three nodes in the region density curve cannot form the core even though RD(u_{2})=1 or RD(u_{3})=1, since the number of nodes is smaller than the minimal size of core α. Moreover, if the values of RD for two sequential nodes are greater than or equal to β, the two cores or communities are merged as a single one. A region density curve of networks with a CP structure has the following characteristic: the difference between the maximum and minimum values is very huge, and the values of RD for most nodes are very low. This is consistent with the fact that the number of peripheral nodes is far larger than the number of core nodes, and the connections among core nodes are very dense but among peripheral nodes are very few. The framework of detecting core nodes is summarized in Algorithm 3 (shown in the Appendix).
Figure 4 schematically shows the region density curves of three types of ideal meso-scale structures. The region density curves in Figs. 4(a) and 4(b) correspond to a network with a single CP structure and with a multiple pair of CP structures, respectively. The region density curve of a community structure without a CP structure is similar to a cosine curve, where the difference between the peak and least values is not so huge, as shown in Fig. 4(c). Of course, the number of community structures in the network is determined by the number of the peaks which reach the value of β. In sum, we can judge the meso-scale structures of a network according to its region density curve.
Though we can determine the core node and the number of cores based on the region density curve, some important problems should be further considered. First, when multiple pairs of CP structures are detected, we should know that the peripheral nodes belong to which core and how close they are with their core nodes; second, when the community structure exists in a network, can we find the overlapping nodes who belong to different communities? To this end, we begin to expand peripheral nodes from each core to form its sub-CP structure. At the beginning, each sub-CP structure only contains core nodes and they are defined as class 0. The peripheral nodes which have direct connections with the core nodes are valued as class 1, and they are allocated to the core which has the most connections with them. In this way, one or several initial sub-CP structures are formed (each sub-CP structure only contains core nodes and their periphery neighbors). Next, the neighbors of the initial sub-CP structures are defined as class 2, and they are allocated to the sub-CP structure which has the most connections with them. The expanding process finishes until all peripheral nodes are allocated and their class values are determined. Many experimental results have demonstrated that most of the real networks are “small-world,” i.e., their average length of paths are very short [38]. Thus, the above expanding process can be finished in several steps.
In the above allocation steps, some nodes may be allocated to more than one sub-CP structure or community, namely, they have the same neighbors connecting two or several sub-CP/community structures. These nodes are viewed as active nodes. One may intuitively think that these active nodes are the overlapping nodes because they connect different sub-CP structures or communities. However, we address that many active nodes may not be real overlapping nodes. For example, even though an important person need to frequently connect the leaders in different organizations owing to his special role, but which does not mean that the important person belongs to different organizations. Therefore, we re-allocate each active node to a sub-CP/community which has the most neighbors of the active node. If there are still some active nodes which are assigned to more than one sub-CP structure/community, these kind of active nodes are viewed as the real overlapping nodes. The framework of detecting meso-structure is demonstrated in Algorithm 4 (shown in the Appendix).
We still use the karate club network as an example to help us understand our method. In Sec. II A, all nodes have been re-ranked and the region density curve is plotted in Fig. 3(b). Now, we should use the number of peaks in the curve to determine the meso-scale structures. According to the assumption α=⌊〈k〉⌋, one has α = 4 owing to 〈k〉≈4.59. Here, we set the core density β = 1, that is to say,, all core nodes are fully connected. As shown in the region density curve, the values of RD(4), RD(14), and RD(31) are equal to 1. Thus, the region formed by these three nodes are {1,3,2,4},{3,2,4,14}, and {9,34,33,31} (though RD(2)=1 and RD(3)=1, neither of them is valid peak since their region is too small to form core). Because node 4 and node 14 are sequentially placed in the curve, the two cores are merged into one larger core, i.e., {1,3,2,4,14}. Now, there are two cores: C_{1}={1,3,2,4,14} and C_{2}={9,34,33,31} [Fig. 3(c)]. According to the above expanding method, we can know that each peripheral node belongs to which core and how far from its own core.
In the first allocation, nodes 10, 28, and 29 are allocated to the two sub-CP structures, so the three active nodes need to be re-allocated. In the secondary distribution, nodes 28 and 29 are allocated to the right sub-CP structure [see Fig. 3(c)]. However, node 10 still has the same number of connections to the two sub-CP structures, which is viewed as the real overlapping node.
Figure 3(d) shows the adjacency matrix of the karate club network, which is very similar to the ideal sub-CP structures shown in Fig. 1(c). Although the karate club network has been used as a benchmark network for community detection, our result indicates that the karate club network has two pairs of CP structures, leading to the network with two communities. We should address that even though some community detection algorithms can divide the karate club network into two groups, which do not clearly clarify each node being the core node or peripheral node, namely, the inner structure in each group is not well answered. Our method not only divides the network into two groups, but also accurately differentiates the core nodes and peripheral nodes in each group. In addition, our method can further distinguish the roles of peripheral nodes, and identify the active nodes and overlapping nodes simultaneously. In short, our method provides a more systematic and accurate description of the meso-scale structure and the roles of nodes in networks.
In this section, we examine the meso-scale structures in some real-world networks and a synthetic benchmark network used in community network detection.
The USA airport network has 332 nodes representing airports and 2126 unweighted links describing the airlines between airports [39]. The average degree of this network is 〈k〉=12.81, so the value of α is 12. By setting β = 1, as shown in Fig. 5(b), only one peak in the region density curve reaches the value of 1, the values of RD for the other nodes are very low. So this network exhibits a strong single CP structure. There are 22 core nodes (the core nodes are the red nodes in Fig. 5(a), and the core nodes are also labeled in the enlarged region density curve [see Fig. 5(c)].
If we reduce the value of α, we can find different sizes of meso-scale structures. When the value of α ranges from 6 to 11, the USA airport network still has a single CP structure, with just a slight change of the number of core nodes. When α = 5, besides the largest CP structure, another three smaller meso-scale structures can be observed. Each of them has 5 core nodes and their number of peripheral nodes is 3, 14, and 1, respectively. Generally speaking, the number of peripheral nodes is larger than the number of core nodes, so only the second small meso-scale structure can be viewed as a CP structure, the other two are the small scale of community structures. Namely, there are a large CP structure, a small CP structure, and two small community structures in this network. The region density curve for α = 5 is shown in Fig. 5(d) and there are four peaks reaching 1. The first peak contains more nodes, while the other three peaks contain fewer nodes and the values of RD for most remaining nodes are very low. Figures 5(e) and 5(f) show the adjacency matrix of the USA airport network for α = 12 and α = 5, respectively. The adjacency matrix shown in Fig. 5(e) is very similar to the ideal case shown in Fig. 1(a), indicating this network exhibits a single CP structure. But when α = 5, there are three smaller meso-scale structures shown in the lower right area of Fig. 5(f).
The dolphin social network is an undirected social network of frequent associations between 62 dolphins in a community living off Doubtful Sound, New Zealand. The network has 62 nodes representing the dolphins and 159 links denoting the frequent associations between dolphins [3]. The community is composed of two families, as shown in Fig. 6(a), the nodes with different colors belong to different families.
The value of α = 5 in this network. As shown in Fig. 6(b), the difference between the peak and lowest value in region density curve is very huge. The values of RD for most nodes are very low. So we can judge that the dolphin social network has CP structures. If we set β = 1, there are two peaks, but the first peak is invalid since there are only three nodes (nodes 34, 38, and 41). Only the subgraph including nodes 46, 30, 22, 52, and 19 forms a core. So we set β=0.9 to relax the definition of the core. In this case, only one connection is missed in the core group (for a subgraph with five nodes, the possible number of connections is (52)=10). Now, RD(25)=0.9 and RD(10)=0.9, as a result, two cores emerge: C_{1}={46,30,22,52,19,25} and C_{2}={14,42,58,18,10}, and the network has two pairs of CP structures. Similar to the method in the karate club network, all peripheral nodes can be classified to one corresponding core group and assigned a class value denoting how far they are from their core group. Figure 6(d) demonstrates the adjacency matrix of the dolphin social network. If we further relax the definition of the core by setting β=0.75, the network presents a richer phenomenon: there are three pairs of CP structures in the dolphin social network. The accurate partition is given in Fig. 6(e) and its adjacency matrix is presented in Fig. 6(f), respectively. Therefore, more types of partitions can be obtained by adjusting the value of β.
Adamic and Glance constructed a network of political blogs during the 2004 U.S. Presidential election. The nodes of this network are blogs about US politics and the edges are hyperlinks between these blogs [40]. There are 1222 blogs and 16 714 connections in the network. Since this network displays a marked division into groups of conservative and liberal blogs, which has been viewed as a typical example of a community structure [41].
After plotting the region density curve [see Fig. 7(b)], one can see that there are two obvious peaks in the curve. So the network has two pairs of CP structures. By using the expanding method, the peripheral nodes can be divided into their core group and form a corresponding sub-CP structure [see Fig. 7(a)], where blue nodes are the periphery of yellow cores and the red nodes are the periphery of green cores, respectively. Moreover, there are 11 nodes marked by light blue color which are the overlapping nodes. The adjacency matrix in Fig. 7(c) also validates that the network has two pairs of CP structures.
Some methods based on centrality indices assume that the nodes with higher centrality values are core nodes [32]. In this network, we pick two nodes with larger degree values [orange node in the left side and the light purple node in the right side of Fig. 7(a)] as examples to argue that nodes with larger centrality values are not necessarily the core nodes. The main reason is that these nodes have many connections with peripheral nodes but few connections with core nodes.
Our experimental results indicate that our method can not only detect the CP structure but also the community structure. But one should note that not all community networks indicate the existence of the CP structure. Here, we generate an Lancichinetti–Fortunato–Radicchi (LFR) benchmark network proposed in Ref [42] to answer the question whether networks with a community structure also have a CP structure. The LFR benchmark networks are widely used to test the performances of different algorithms in detecting overlapping communities. In this section we also generate several sets of LFR networks to compare the performances of different algorithms in detecting overlapping communities. Here, the parameters in this synthetic network are set as follows: the average degree 〈k〉=8, the maximum degree k_{max} = 12, the mixing parameter μ=0.1, and the exponents of the power law distribution of node degrees γ_{1} and community size γ_{2} are −2 and −1, respectively. The network has 100 nodes and 404 links, and it is composed of 10 communities whose sizes range from 7 to 12. The formation mechanism can only guarantee emergence of a community structure but cannot ensure there is a core in each community. The region density curve of the synthetic network is shown in Fig. 8(a), which is very similar to the curve shown in Fig. 4(c). So we can judge that the network does not exhibit a CP structure. The adjacency matrix of the network shown in Fig. 8(b) is very similar to Fig. 1(a), which further validates that the network has no CP structure.
The college football network describes games between Division I-A American college football teams in the year 2000 [43]. It has 115 nodes and 613 connections, leading to α = 10. From the region density curve in Fig. 9(a), we can conclude that the college football network only has a community structure but has no CP structure. By setting α = 8, the characteristics of the region density curve are more clear and the peaks are easier to be observed [see Fig. 9(b)]. For the football network, the inner connections in each community are not very dense, so is hard to achieve a full connection in each community. For this purpose, we set β=0.6 to detect the community structure. According to our method, the network can be divided into 11 communities. The adjacency matrix of the network is shown in Fig. 9(c), which is very similar to the adjacency matrix shown in Fig. 1(a).
In this section, we compare the performance of our algorithm with other existing methods regarding the detection of the CP structure and community structure, respectively. The normalized mutual information (NMI) index is used to measure the performance of different algorithms, which is defined as [44]
Here, A and B are the partition determined by algorithms and the real partition, respectively, I(A, B) is the mutual information of A and B. H(A) and H(B) are the entropy of A and B, respectively. NMI is in the range of [0,1] and equals to 1 only when two partitions are totally coincident.
Since the study on the detection of the CP structure has not been paid much attention, moreover, some existing algorithms were proposed to detect the single CP structure and the number of core nodes should be given in advance. Thus, few algorithms can be used to fairly compare. Very recently, one algorithm aimed at detecting multiple pairs of CP structure was proposed by Sadamori Kojaku and Naoki Masuda (termed as the KM algorithm) [35]. The KM algorithm is to maximize one defined quality function. Moreover, in the KM algorithm, nodes were removed as residual nodes by considering the statistical significance of each CP pair. Here, we do not check the statistical significance of the CP structure when we implement this algorithm, since the statistical significance is not considered in other algorithms. In the work, Kajuka et_al compare their algorithm with two other algorithms. One is the BE-KL algorithm, which aims to detect a single CP structure by maximizing Q_{BE} (a quality function based on the Pearson correlation coefficient to measure the similarity between the given partition and its ideal CP structure) using the Kernighan-Lin algorithm [45]. The BE-KL algorithm mainly focuses on how to detect networks with a single CP structure. The other algorithm is termed as the Two-step algorithm, the network is first divided into non-overlapping communities by maximizing modularity using the Louvain algorithm [46], then the core and periphery in each community are detected by the BE-KL algorithm again. Here, we compare our algorithm with these three algorithms: BE-KL, Two-step and KM algorithms on sets of synthetic networks, including networks with a single CP structure and multiple pairs of CP structures, respectively.
Since the ground truths about CP structures in real networks are not known, we generate some synthetic networks based on the stochastic block models [34,47] to measure the performances of different algorithms. For sets of synthetic networks with a single CP structure, the size of the whole network, the size of the core and the size of the periphery are set as N = 600, N_{c} = 100, and N_{P} = 500, respectively. For a network with a typical CP structure, the connection probability among core nodes (P_{CC}) should be larger than or equal to the connection probability between core nodes and peripheral nodes (P_{CP}), and further larger than the connection probability among peripheral nodes (P_{PP}). Therefore, we let P_{PP} = 0.05, and P_{CP}=P_{CC}4, then sets of synthetic networks are generated by varying the value of P_{CC}. Two parameters in our method are set as α=⌊k⌋ and β=5ρ, where ρ=2MN(N−1) with M being the number of links. As shown in Fig. 10(a), our method has better performance than the other algorithms when P_{CC} is not very large, namely, the CP structure is not very strong. Otherwise, the performance of the BE-KL algorithm is better than others when P_{CC} is very large.
Several sets of synthetic networks with two pairs of CP structures are also generated to compare the performances of different algorithms. For each pair of CP structure, the parameters are set as: N_{c} = 50, N_{P} = 250, P_{PP} = 0.05, and P_{CP}=P_{CC}4, respectively. Moreover, the connection probability linking two pairs of CP structures is fixed as 0.01. Moreover, we set α=⌊k⌋ and β=10ρ. Figure 10(b) indicates that the Two-step algorithm gives rise to the best performance, and our method is better than the other two algorithms in most cases. For the Two-step algorithm, each step needs to maximize the corresponding quality function based on the global structure of the network, which significantly increases the time complexity. Moreover, the performance of the Two-step algorithm in detection of network with a single CP structure is very bad. The results of the synthetic networks with a single CP structure and with multiple CP structures indicate that the performance of our method is generally better than other algorithms.
The performances of different algorithms in detecting overlapping communities are compared on three real networks and three LFR benchmark networks [42] (introduced in Sec. III D). The three real networks are the karate club network, the dolphin social network, and the college football network, respectively. The ground truths about the community structure in these networks are known. The basic topological features of these networks are given in Table I.
We compare our method with four overlapping community detection algorithms: a clique percolation method (CPM) proposed by Palla et_al [16], a local expansion and optimization algorithm (LFM) proposed by Lancichinetti et_al [42], a fast overlapping community search (FOCS) method developed by Bandyopadhyay et_al [48], and a fuzzy c-means clustering (FCM) algorithm proposed by Zhang et_al [49] Their comparisons are summarized in Table II. One can observe that the performance of our method in detecting overlapping communities generally outperforms other methods, especially on real networks.
In this work, we have proposed a unified method to detect the CP structure and community structure in networks. This method is effective not only on a single CP structure but also on the community structure and multiple pairs of CP structures, and further in finding active nodes and overlapping nodes in networks. Also, the role of each node is assigned. In addition, our method does not need to fix the size of the core in advance, where some sequential cores can form a larger core. Therefore, our method provides a tool for the identification of meso-scale structures in the network, and may also provide some inspirations in identifying the influential nodes.
Of course, many places are worthy of future study. On the one hand, we set α=⌊〈k〉⌋ and β = 1 in most cases. For each network, how to choose the values of α and β is a non-negligible problem. Of course, as we have discussed, many rich structures can be observed if the values of α and β are properly chosen. On the other hand, previous results have demonstrated that the network structure has a fundamental effect on its collective dynamics, for instance, networks with a scale-free structure can promote the outbreaks of infectious diseases [50,51] and reduce the transportation efficiency [52]. The community structure also significantly affects its collective dynamics, such as synchronization [53], spreading of epidemic [54], evolutionary games [55], and so forth. As a result, how the CP structure affects the collective dynamics is an important issue that deserves in-depth studies. For example, Simóm et_al have found that the CP structure can induce double percolation phase transition under certain conditions [56].
APPENDIX: PSEUDOCODE OF OUR ALGORITHMS
Algorithm 1: GeneralFramework(G(V,E),β)
comment:G(V, E) is a network and β is a threshold
U← RerankNodes(G)
α←⌊<k>⌋
for eachu_{i}∈U
 do {RD(u_{i})←Computeregiondensityofnodeu_{i}byEq.(3)
Cset← FindCoreSet(G,U,β)
CPset← FindCPSet(G,Cset,NumC)
return (Cset, CPset)
Algorithm 2: RerankNodes(G(V,E))
comment:G(V, E) is a network
U←∅,V′←V
comment: Select the node with the highest closeness centrality as the first node.
u←max(V.closeness)
Add u into U
Remove u from V′
comment: Select the node with the most connections with the nodes in U, if more than one node were found, we choose the node with the maximum degree.
whileV′≠∅

return:(U)
Algorithm 3: FindCoreSet(G(V,E),U,β)
comment:G(V, E) is a network, U is a set of nodes, and β is a threshold
Cset←∅, NumC←1
comment: if the values of RD for two sequential nodes are greater than or equal to β, the two cores are merged as a single one.
fori←αtonumNode

ifRD(u_{numNode})<β
thenNumC←NumC – 1
return(Cset,NumC)
Algorithm 4: FindCPSet(G(V,E),Cset,NumC)
comment:G(V, E) is a network and Cset is a set of cores
CPset←Cset
class← 0
nodeCset.class←class
NodeP←V-nodeCset
comment: Allocate the periphery nodes
whileNodeP≠∅

NodeActive←node in different CPset(i)
comment: Re-distribute active nodes
Remove NodeActive from CPset(i)
for eachj∈NodeActive

return(CPset)
TABLE I. 
The basic topological features of considered networks and the values of α and β are chosen. N and M are the total numbers of nodes and links, respectively. NC is the number of communities. ρ=2MN(N−1) is the density of the network. 〈k〉 is the average degree.
TABLE II. 
The performances of different algorithms in detecting overlapping communities are compared on three real networks and three synthetic networks (Net1, Net2, and Net3). The values of α and β in our method are listed in the last two columns of Table I.
TABLE I. -body
Network	N	M	NC	Ρ	〈k〉	α	Β
Karate	34	78	2	0.1390	4.588	4	1
Dolphins	62	159	2	0.0841	5.129	5	0.9
Football	115	613	2	0.0935	10.048	10	0.6
Net1	100	471	9	0.0952	9.42	9	0.6
Net2	500	2402	10	0.0193	9.608	9	0.3
Net3	1000	5001	10	0.01	10.002	10	0.3
TABLE II. -body
Network	LFM	FCM	FOCS	CPM	Our method
Karate	0.6904	0.6148	0.2889	0.2161	0.9186
Dolphins	0.7811	0.8889	0.2334	0.1986	0.8889
Football	0.754	0.7357	0.6773	0.7471	0.7404
Net1	0.9225	0.9624	0.8482	0.9846	0.9171
Net2	0.7008	0.9535	0.0248	0	0.5011
Net3	0.5731	0.9576	0	0	0.4536
FIG. 1. 
Adjacency matrices of idealized block models. (a) Community structure, (b) single CP structure, and (c) multiple pairs of CP structure.
FIG. 2. 
An illustration of re-ranking nodes in a new sequence. (a) Red nodes in the circle are in set U, one node connecting set U is going to be added into U, i.e., node a, b, and c and (b) node a is added into U since its degree is larger than node b even though both of them have 2 connections with U.
FIG. 3. 
Detection on the karate club network. (a) Original structure, where nodes with the same color are in the same community, (b) region density curve of the network, the numbers in the curve are their original numbers, and (c) network has two pairs of CP structures, and all nodes are assigned a class value. In addition, node 10 is an overlapping node. (d) Matrix representation of the network, where the orange lines indicate the borders separating different blocks. Here, α = 4 and β = 1.
FIG. 4. 
Region density curves of three types of ideal meso-scale structures. (a) Single CP structure, (b) multiple sub-CP structures, and (c) community structure. The dashed red lines are the threshold value β, which are used to determine the number of CP structure pairs or communities.
FIG. 5. 
Detection on the USA airport network. (a) Original structure, where the red nodes are the core nodes, (b) full region density curve when α = 12, (c) region density curve of the first 25 nodes, and the first 22 nodes are the core nodes, (d) full region density curve when α = 5, (e) matrix representation of the network when α = 12, and (f) matrix representation of the network when α = 5, where the orange lines indicate the borders separating different blocks. Here, β = 1.
FIG. 6. 
Detection on the Dolphin social network. (a) Original structure, where the nodes with the same color are in the same community, (b) region density curve, where the dashed red line and the dashed green line correspond to β=0.9 and β=0.75, respectively, (c) the network has two pairs of CP structures and each node is assigned a class value, (d) matrix representation of the network, where the orange lines indicate the borders separating different blocks, (e) the network has three pair of CP structures and each node is assigned a class value, and (f) matrix representation of the network, where the orange lines indicate the borders separating different blocks. β=0.9 in (c) and (d); β=0.75 in (e) and (f). Here, α = 5.
FIG. 7. 
Detection on the Political blogs network. (a) Visualization of the network, where the yellow nodes and green nodes are two core groups. Blue nodes and red nodes are the peripheries of the yellow core and green core, respectively. Light blue nodes are the overlapping nodes. The orange node and the light purple node are the nodes with high degree values; their degree values are 301 and 351, respectively, but they are the peripheral nodes, (b) region density curve of the network, and (c) matrix representation of the network, where the orange lines indicate the borders separating different blocks. Here, α = 27 and β=0.75.
FIG. 8. 
Detection on the synthetic benchmark network with 10 communities. (a) Region density curve of the network and (b) matrix representation of the network, where the orange lines indicate the borders separating different blocks. Here, α = 8 and β=0.6.
FIG. 9. 
Detection on the college football network. (a) Region density curve of the network when α = 10, (b) region density curve of the network when α = 8, and (c) matrix representation of the network when α = 8. Here, β=0.6.
FIG. 10. 
NMI accuracy as a function of P_{CC} on set synthetic networks with different algorithms. (a) Synthetic networks with a single CP structure and (b) synthetic networks with two pairs of CP structures.

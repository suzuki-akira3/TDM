Performance evaluation and bias correction of DBS measurements for a 1290-MHz boundary layer profiler
Recently, the government installed a boundary layer profiler (BLP), which is operated under the Doppler beam swinging mode, in a coastal area of China, to acquire useful wind field information in the atmospheric boundary layer for several purposes. And under strong wind conditions, the performance of the BLP is evaluated. It is found that, even though the quality controlled BLP data show good agreement with the balloon observations, a systematic bias can always be found for the BLP data. For the low wind velocities, the BLP data tend to overestimate the atmospheric wind. However, with the increment of wind velocity, the BLP data show a tendency of underestimation. In order to remove the effect of poor quality data on bias correction, the probability distribution function of the differences between the two instruments is discussed, and it is found that the t location scale distribution is the most suitable probability model when compared to other probability models. After the outliers with a large discrepancy, which are outside of 95% confidence interval of the t location scale distribution, are discarded, the systematic bias can be successfully corrected using a first-order polynomial correction function. The methodology of bias correction used in the study not only can be referred for the correction of other wind profiling radars, but also can lay a solid basis for further analysis of the wind profiles.
I. INTRODUCTION
Over the past few years, the wind profiler has proven to be a powerful tool for successive observation of the wind field in the atmosphere. Recently, in order to provide useful atmospheric information for the assessment of wind environment [1,2] and wind-resistance design of megatall buildings [3–5], the government installed a boundary layer profiler (BLP) in a coastal area (also a cold region) of China (121.75°E, 39.05°N), which often suffers from extreme wind conditions, such as cold front weather system. And the BLP operates at a frequency of 1290 MHz.
Typically, wind profiling radars can measure the wind velocities by two kinds of techniques. One is the Doppler Beam Swinging (DBS) technique [6,7], which measures the radial velocity along the line of sight of the radar beam by Doppler shift [8–10]. The other is a full correlation analysis (FCA) technique, which is widely incorporated by spaced antenna (SA) wind profiling radars [11,12].
In previous studies, based on the comparison with other independent instruments, it was proved that the wind profiling radars, using the SA FCA technique, can basically detect the atmospheric wind correctly [13,14]. In some studies [15–17], however, an underestimation effect was found for this measuring technique. Holdsworth [15] reported that, when comparing with the balloon observations, the SA FCA technique could produce excellent agreement in the wind direction but underestimated the wind magnitude by a large percentage of 10%. And this underestimation could be observed in all regions of the atmosphere. Reid et_al [16] reported that the University of Adelaide and Australian Government Bureau of Meteorology (AGBoM) collaborated and deployed a prototype operational wind profiling radar capable of operating in SA FCA modes at Mt Gambier, South Australia and then compared the measured data with the balloon observations. It was found that, for the height range of 6.1-14 km, the slope of linear regression fit was 0.98, while for the lower height range of 2-6 km, a large deviation was found and the slope dropped to 0.93. Based on the results, the authors concluded that when the SA FCA technique is adopted, a bias will occur in the profiler estimates of the wind magnitude, and the underestimation is dependent on wind velocity.
In 2014, ATRAD Pty Ltd. in conjunction with the University of Adelaide installed a BLP at Buckland Park, which is located 40 km north of the city of Adelaide, South Australia. And this BLP also adopts the SA FCA measuring technique. Dolman and Reid [17] reported the data detected by the above wind profiler and compared that with the balloon observations. It was concluded that, even though the BLP data had been processed by a quality control procedure, they still underestimated the atmospheric wind by up to 7%, with a regression slope of 0.93. This kind of magnitude underestimation results from any effect that suppresses the correct value of the cross-correlation functions of the fading time series calculated between the antenna pairs [12]. In order to compensate the underestimation, Dolman and Reid [17] further proposed a correction function with the power law. Based on the correction, the slope of the regression fit (BLP data vs. balloon observations) reached to 1.0 and the systematic bias was mitigated to a certain degree. This work is worthy of recognition since it is the first attempt to eliminate the systematic bias.
The wind profiler using the DBS measuring technique has also been widely adopted in the past years. And it has been proved that this technique is especially suitable for areas where the flows cannot be considered to be uniform over the sampled area or steady over the time it takes for a scan to be completed [18]. In spite of the prevailing of the DBS technique, studies on its systematic bias are quite limited. Based on the comparison of the BLP data and the data measured by a sonic anemometer during 3993 h, Lane [19] found that the slope and intercept of the linear regression fit were 0.99 and 0.81, respectively, and then concluded that the DBS lidar tended to overestimate the wind velocity by ≈0.5 m/s for wind velocities below 20 m/s. This study is also worthy of recognition since it is the first time to quantitatively evaluate the systematic bias of the DBS technique. Nevertheless, the range of wind velocity is still relatively limited (the maximum value is 20 m/s), and hence the systematic bias may not be evaluated comprehensively, especially for larger wind velocities. Except for the above work, few research about the bias of the DBS technique can be found by the authors, and no attempt has been made to correct such an overestimation/underestimation.
Considering the problems mentioned earlier, the performance of the BLP (DBS mode) operated at a larger range of wind velocities (0–35 m/s) is evaluated in this study. In Sec. II, a brief introduction about the BLP system and BLP datasets is given. In Sec. III, for the measurements detected under strong wind conditions, the methodology of performance evaluation is proposed, and the systematic bias of the BLP is evaluated. Then, in Sec. IV, the probability distribution function of the differences between the BLP data and balloon observations is discussed, and a bias correction for the BLP data operated in the DBS mode is conducted to diminish the overestimation/underestimation. This study will provide a deep insight into the performance of the BLP using the DBS technique. And the corrected BLP data can lay a solid basis for the research on the atmospheric wind field. Besides, the methodology of bias correction proposed in this paper can also be referred for the improvement of the measurement accuracy for other instruments.
II. SYSTEM DESCRIPTION AND BLP DATASET
The BLP located at the coastal area of China has been used as a research and development instrument since 2009. It can measure the three-dimensional wind velocities by the Doppler beam swinging (DBS) technique. Specifically, this BLP is operated in a configuration with one vertical beam and four oblique beams in the two perpendicular directions (NE-SW and NW-SE). Figure 1 shows the directions of the five beams. The four oblique beams were directed 15° off zenith toward NE, SE, SW, and NW, respectively.
In this study, the radial velocities measured by the four oblique beams are used to calculate the atmospheric wind by the following equations:
where V_{re} is the east radial velocity, V_{rw} is the west radial velocity, V_{rn} is the north radial velocity, V_{rs} is the south radial velocity, and ϕ is the elevation angle of the Doppler beam. This kind of four-beam method is supposed to be more reliable than the three-beam or two-beam method [20]. The BLP typically operates with interleaved low, middle, and high modes, with a time resolution of approximate 150 s (the time used to complete a scan). Typical operating parameters for these three modes are given in Table I. The instrument was configured to make wind estimates beginning at an altitude of 60 m, and the maximum number of range gates is 49, with a maximum height of 3.84 km. In order to comprehensively evaluate the performance of the BLP operated at a large coverage of wind velocities, the data measured during 13 strong windy days (basically, the wind velocities are in a range of 0–35 m/s) selected from 2012 to 2015 are used in the study.
III. PERFORMANCE EVALUATION OF THE BLP
A. Methodology of performance evaluation
All the original BLP data have been examined by a composite quality control (QC) procedure, which was proposed by the authors [21] to control the optimal range of radial velocity dataset, recognize the rain contaminated data, and screen the outliers with unreasonable vertical wind shear. The accuracy of quality controlled BLP data is assessed through the comparison with radiosonde flights from the closest station, which is approximately due to SSW (south-southwest) of the BLP (see Fig. 2). And the two sites are separated by approximately 20.5 km. During the 13 days (strong wind conditions), 18 radiosonde flights are available for comparison.
However, it should be noted that, for the two sites, the wind velocities measured at the lower altitudes cannot be compared directly because when flows encounter change of the terrain roughness, a new inner boundary layer (IBL) will develop and propagate upwards through the upstream layer as the downstream distance increases. Elliott [22] suggested that the depth of the IBL, δ, can be calculated using the following equation:
where x is the distance from the changed roughness boundary and z_{new} is the roughness length of the downstream terrain. According to GB 50009-2012 [23], for the region where the BLP station and radiosonde station are located, the terrain roughness can be classified as category B with a power-law exponent of 0.15. This stipulation denotes that the landscape can be open fields, villages, forests, hills, sparsely populated towns, or city suburbs, and the corresponding roughness length can be determined as ≈0.25 (class 5) based on the revised Davenport classification [24](see Table II). However, with the progress of urbanization in recent years, more and more tall buildings are built up in this region. It can be seen from Fig. 2 that this area has been already covered by relatively condensed buildings and the relative distances of buildings are far less than 8 to 12 obstacle heights (class 5). Obviously, land cover of this kind has exceeded the stipulation of category B given in GB 50009-2012 [23] and is similar to the landscape description of class 7 (z_{0} = 1.0) of the Davenport classification. Moreover, the orography between the two sites basically fluctuates within the range of 0–60 m. And in some local areas, the ground surface is even covered by small hills with heights of about 100 m (Fig. 2). Those above-mentioned factors will contribute to the change of wind velocities in the lower heights. Thus, when calculating the maximum height of the IBL, the effect of land cover and orography is sufficiently considered and z_{new} is determined as 2.0. This value indicates the densely populated city center and dense group of high buildings in the AS/NZS (Australian/New Zealand Standard) [25] (the supreme Class) and the “Chaotic” city center (Class 8, the supreme Class) in the revised Davenport classification [24]. And δ can be then calculated as 905.2 m, above which the wind field can hardly be affected by the terrain roughness. The above-mentioned measure can better guarantee the validity of following comparisons for the wind magnitude and wind direction.
When comparing the measurements at the two sites, the BLP data, which are centered on the delayed balloon launch time [26] (a lag time for wind blows over the distance) within 30 min, are averaged. Besides, for enlarging the dataset used for comparison, a sliding window technique is adopted and hence the 30-min mean wind records can be updated every 150 s. In the case, the adjacent wind velocity profiles measured two before and two after that delayed time are also adopted.
B. Overall performance of the BLP
Based on the methodology introduced earlier, the performance of the BLP is evaluated. Figure 3 shows the comparison between the quality controlled BLP data and balloon observations. The black solid line in the figure represents the y = x line. It can be seen from Fig. 3, basically, that the BLP data show good agreement with the balloon observations.
But, for a better understanding of the BLP performance, the slope a and intercept b are further calculated by the linear regression. Besides, the correlation coefficient r and other three basic criteria [Eqs. (4)–(6)] used by NOAA/ERL (National Oceanic and Atmospheric Administration/Environmental Research Laboratory) [27] are also adopted for the evaluation,
where N is the number of data, x_{i} is the ith balloon observation, y_{i} is the ith datum acquired by the BLP, RMSE is the root-mean-square error, and PRECISION is the standard deviation of the differences. The above indicators are all calculated and listed in Table III. And it can be seen that each of them is in a reasonable range [20,28]. However, it also should be noted that both of the two regression parameters (a and b) deviate from the ideal values (1.0 and 0) with a certain degree, which indicates the occurrence of a systematic bias of the BLP. Figure 4 shows the derived regression line. It can be found that the systematic bias of the BLP (DBS technique) has a reliance on the wind velocity. For the low wind velocities, the BLP data tend to be larger than the balloon observations, which is quite similar with the conclusion drawn by Lane et_al [19] However, with the increment of wind velocity, the BLP data show a tendency of underestimation.
Figure 5 further shows two comparisons of wind velocity profiles measured by the two instruments, which can better illustrate the underestimation of the BLP at the high wind velocity. It can be seen from Fig. 5(a), basically, that the BLP data of the five wind velocity profiles (include the profile considering the time lag and four adjacent wind profiles, see Sec. III A) tend to deviate from the balloon observations more seriously with the increment of wind velocity in the upper profile. In Fig. 5(b), a more obvious underestimation of BLP measurements can be found in the entire range of height, with a maximum deviation of ≈4.2 m/s.
Figure 6 further shows the comparison of the wind directions measured by the two instruments. It is found that the wind directions measured by the BLP show good agreement with that of balloon observations with a slope of 1.01 and intercept of −2.81°. The BIAS is only 1.95°, and the correlation coefficient reaches 0.97. Since all the criteria indicate that the wind direction even has a better precision than the wind magnitude, the authors tentatively suppose that it is not the measurement error in a single direction (either zonal or meridional) that leads to the bias of the wind magnitude, but the simultaneous measurement bias in both the two wind directions leads to the underestimation or overestimation.
In the case, the real atmospheric wind may not be detected exactly. However, it is well known that a high accuracy of measurement instrument is the precondition for any studies on the characteristic of atmosphere. Therefore, such a systematic bias should be compensated as much as possible so as to improve the precision of the BLP measurements.
IV. BIAS CORRECTION OF THE BLP
For the FCA SA technique, a measurement bias was also found by Dolman and Reid [17] (for comparison, the regression line is also shown in Fig. 4). And to modify the bias, a correction function with a form of power law was proposed. However, it should be noted that the regression intercept increased to 0.19 after the correction, indicating that the corrected BLP data might slightly overestimate the atmospheric wind on the whole.
When adding the correction item, the overestimation or underestimation effect should disappear, and the systematic bias should also be decreased. Following the philosophy of Dolman and Reid [17], several correction functions with different forms, including the power law [Eq. (7a)] and polynomials with different orders [Eq. (7b)], are adopted to correct the data measured under the DBS mode,
where C_{1}(y) and C_{2}(y) are the bias correction based on the lower law and polynomials, respectively, y is the BLP datum, α, β, and γ are the constant factors used in the power law, and a_{0}, a_{1}, …, a_{n} are the constant factors used in the polynomials.
The corrected BLP data y_{c} can be calculated by [Eq. (8)]. It should be noted that, in order to avoid overfitting and obtain a succinct formula, the maximum order of polynomial is confined to 3,
For the linear correction with only two parameters, the correction formula can be determined by solving the equations of â = 1 and b^ = 0, where â and b^ represent the regressive slope and intercept derived by the least square method [Eqs. (9a) and (9b)]. For the correction formula with more than two parameters, in addition to the bias correction, a relatively small RMSE is also expected. Thus, it can be classified into a multi-objective optimization problem, and the objective function can be expressed as min{f_{1} = (â − 1)^{2}, f_{2} = abs(b^), RMSE_{c}}, where RMSE_{c} is the root-mean-square error calculated based on the corrected data [Eq. (10)],
It should be noted that the indicator of BIAS is not set as the optimization objective directly, but the intercept and slope are used instead. This is because these two goals indicate a more strict requirement, which not only can keep the indicator of BIAS in a low level but also can diminish the overestimation/underestimation effect.
The optimization problem is solved by the Non-dominated Sorting Genetic Algorithm II (NSGA II) [29], which can create a mating pool by combining the parent and offspring populations and selecting the best (with respect to fitness and spread) N solutions. Based on the algorithm, a group of Pareto solutions is generated. Then, the solution, at which the two major objectives (f_{1}, f_{2}) are well satisfied (e.g., within ±0.01 of the target value) and the RMSE reaches a relatively small value, is selected as the optimal one among all the solutions. However, it should be noted that the BLP data, which have large discrepancies with the balloon observations, should be removed before optimization. This is because the data with poor quality may exert a large effect on the derivation of correction formula. Besides, even if these data are used in the optimization to derive the correction formulae, they can hardly be corrected by those formulae and still show large discrepancies with the balloon observations. Figure 7 shows such an example. A third-order polynomial correction is derived based on all data points, and then the original data are modified by such a correction (the corrected indicators are also given in Fig. 7). It can be seen that the BLP data with a large discrepancy (the black diamonds) still do not show better agreement with the balloon observations. Moreover, compared to the measurements in Fig. 3, the “good” data even deviate more seriously than before, especially for the wind velocities larger than 30 m/s.
In order to remove the effect of poor quality data on correction of the systematic bias, the characteristic of the differences between the wind estimates measured by the two instruments are further investigated. The histogram of the measurement differences is shown in Fig. 8. It is found that the differences follow the t location scale distribution (the following equation):
where Γ(·) is the gamma function. The other three parameters, including the location parameter μ, scale parameter σ, and shape parameter ν, are calculated by the maximum likelihood estimation, and their values are calculated as 0.50, 1.63, and 2.75, respectively.
The applicability of the t location-scale distribution is evaluated by the K-S test, and this distribution can pass through the examination at 1% significance level. And it is also found that this distribution is the most suitable probability model to describe the difference between the datasets measured by the two instruments. For other probability models (e.g., normal distribution and lognormal distribution), the K-S test cannot be passed at the same significance level. Thus, in order to mitigate the effect of wind estimates with poor quality, only the data with the differences that fall in the confidence interval of 95% of the t location scale distribution are retained for deriving the correction function.
Based on the above-mentioned method, the parameters in different correction formulae are derived, and then the BLP data are corrected. After the data are corrected by different formulae, the regression parameters and three indicators are then derived and listed in Table IV. For comparison, the indicators calculated based on the uncorrected data (after the poor quality data in Fig. 3 are deleted) are also given. It can be found that, in spite of the slight increment of RMSE, all of the correction functions can diminish the overestimation or underestimation effect and can reduce the bias successfully. Therefore, considering the effectiveness and simplicity of the correction formula, the first-order polynomial is recommended to modify the BLP data measured under the DBS mode. And the corresponding polynomial parameters of a_{0} and a_{1} can be determined as −1.04 and 0.066, respectively.
V. CONCLUSIONS
Under strong wind conditions, the performance of a BLP, which was installed in a coastal area of China and operated under the DBS mode, is evaluated. It is found that, basically, the quality controlled BLP data can show good agreement with the balloon observations. However, the BLP data tend to overestimate the atmospheric wind for the low wind velocities, and with the increment of wind velocity, the BLP data present a tendency of underestimation. Therefore, similar to the wind profiling radars operated under the SA FCA mode, the BLP under the DBS mode also has the systematic bias. Then, the authors make an effort to compensate such a systematic bias so as to improve the precision of the BLP data. It is found that the measurement differences between the two instruments follow the t location scale distribution. And after the data with large discrepancies (outside of 95% confidence interval of the t location scale distribution) are excluded, a first-order polynomial correction function is proposed based on the NSGA II algorithm. The slope and intercept of the correction function can be determined as −1.04 and 0.066, respectively. After the BLP data are compensated, the indicator of BIAS is then decreased and the phenomenon of overestimation or underestimation is removed. This study provides an insight into the performance of the BLP using the DBS measuring technique. And the bias correction method used can also be referred to the improvement of other instruments. Besides, this work lays a solid basis for the further studies on the characteristic of atmospheric wind.
TABLE I. 
Typical operating parameters of the three modes.
TABLE II. 
Revised Davenport classification of aerodynamic roughness.
TABLE III. 
The regression parameters and indicators for the performance evaluation.
TABLE IV. 
The regression parameters and three indicators calculated based on uncorrected/corrected data.
TABLE I. -body
	BLP low mode	BLP middle mode	BLP high mode
Antenna aperture (m × m)	2.4 × 2.4	2.4 × 2.4	2.4 × 2.4
Beam width (deg)	6	6	6
Operating frequency (MHz)	1 290	1 290	1 290
Emission wavelength (mm)	232	232	232
PRF (Hz)	62 500	18 518	18 518
Range (km)	0.06-0.36	0.42-1.14	1.23-3.84
Range resolution (m)	60	60	90
Pulse width (μs)	0.4	0.4	0.6
Peak transmit power (kW)	33.3	33.3	33.3
No. of FFT points	128	128	128
No. of coherent integration	270	80	80
No. of incoherent integration	16	16	16
TABLE II. -body
Class	z_{0}, ft (m)	Wind flow and landscape description
1	0.0007 (0.0002)	“Sea”: open sea or lake (irrespective of the wave size), tidal flat, snow-covered flat plain, featureless desert,
		tarmac, and concrete, with a free fetch of several kilometers.
2	0.016 (0.005)	“Smooth”: featureless land surface without any noticeable obstacles and with negligible vegetation, e.g., beaches,
		pack ice without large ridges, marsh and snow-covered or fallow open country.
3	0.1 (0.03)	“Open”: level country with low vegetation (e.g., grass) and isolated obstacles with separations of at least 50 obstacle heights,
		e.g., grazing land without windbreaks, heather, moor and tundra, runway area of airports. Ice with ridges across wind.
4	0.33 (0.10)	“Roughly open”: cultivated or natural area with low crops or plant covers, or moderately open country with occasional obstacles
		(e.g., low hedges, isolated low buildings, or trees) at relative horizontal distances of at least 20 obstacle heights.
5	0.82 (0.25)	“Rough”: cultivated or natural area with high crops or crops of varying height and scattered obstacles at relative distances
		of 12 to 15 obstacle heights for porous objects (e.g., shelterbelts) or 8 to 12 obstacle heights for low solid objects (e.g., buildings).
6	1.64 (0.5)	“Very rough”: Intensely cultivated landscape with many rather large obstacle groups (large farms and clumps of forest) separated
		by open spaces of about 8 obstacle heights. Low densely planted major vegetation like bushland, orchards, and young forest.
		Also, area moderately covered by low buildings with interspaces of 3 to 7 building height and no high trees.
7	3.3 (1.0)	“Skimming”: landscape regularly covered with similar-size large obstacles, with open spaces of the same order
		of magnitude as obstacle heights, e.g., mature regular forests, densely built-up area without much building height variation.
8	≥6.6 (≥2.0)	“Chaotic”: city centers with a mixture of low-rise and high-rise buildings or large forests of irregular height with
		many clearings. (Analysis by wind tunnel advised)
TABLE III. -body
a	b	r	BIAS	RMSE	PRECISION
0.93	1.18	0.94	0.28	2.60	2.58
TABLE IV. -body
Form	a	b	r	BIAS	RMSE
Uncorrected	0.94	0.97	0.96	0.37	2.04
1st-order	1.00	0.00	0.96	<0.01	2.07
2nd-order	1.00	<0.01	0.96	<0.01	2.06
3rd-order	1.00	<0.01	0.96	<0.01	2.06
Power law	1.00	<0.01	0.96	<0.01	2.08
FIG. 1. 
The directions of five beams. (ϕ is the elevation angle and equals to 75°).
FIG. 2. 
Location of the two sites.
FIG. 3. 
The comparison between the quality controlled BLP data and balloon observations.
FIG. 4. 
The comparison between the regression lines.
FIG. 5. 
For the BLP operated under the DBS mode, the underestimation of wind velocity at the high range of wind velocity.
FIG. 6. 
The comparison of the wind directions measured by the wind profiler and rawinsondes.
FIG. 7. 
BLP data corrected by the third-order polynomial correction function.
FIG. 8. 
Probability distribution function of the differences between the data measured by the two instruments.

Impulse excitation scanning acoustic microscopy for local quantification of Rayleigh surface wave velocity using B-scan analysis
A new technique for performing quantitative scanning acoustic microscopy imaging of Rayleigh surface wave (RSW) velocity was developed based on b-scan processing. In this technique, the focused acoustic beam is moved through many defocus distances over the sample and excited with an impulse excitation, and advanced algorithms based on frequency filtering and the Hilbert transform are used to post-process the b-scans to estimate the Rayleigh surface wave velocity. The new method was used to estimate the RSW velocity on an optically flat E6 glass sample, and the velocity was measured at ±2 m/s and the scanning time per point was on the order of 1.0 s, which are both improvement from the previous two-point defocus method. The new method was also applied to the analysis of two titanium samples, and the velocity was estimated with very low standard deviation in certain large grains on the sample. A new behavior was observed with the b-scan analysis technique where the amplitude of the surface wave decayed dramatically on certain crystallographic orientations. The new technique was also compared with previous results, and the new technique has been found to be much more reliable and to have higher contrast than previously possible with impulse excitation.
I. INTRODUCTION
Scanning acoustic microscopy (SAM) has been used to nondestructively quantify the local material properties in heterogeneous materials for many decades [1,2]. While typically focused on imaging, there have been a number of studies dedicated to making quantitative measurements of material properties with SAM [3,4]. In a SAM setup, a piezoelectric element with a spherical or line focusing lens is excited with a tone burst, a continuous wave, or an impulse. Pressure waves generated in coupling media such as water interact with the elastic material properties of the sample. The various wave modes excited in the sample send energy back to the transducer by reflecting off either the surface or objects below the surface. The advantage of the line focusing lens is that it is directionally sensitive and can be used to characterize the entire slowness surface of a single crystal [3]. The disadvantage is that line focused transducers require a relatively large single crystal to fit the entire focal spot within the sample. As such, it has been applied extensively in characterization of thin-film properties [5]. A spherically focused lens is not directionally sensitive, but it has a very tight focal spot allowing it to fit within a typical grain in a polycrystalline aggregate.
In a typical experimental setup, the focusing lens has a wide enough opening angle that the Rayleigh critical angle is exceeded, thus exciting Rayleigh surface waves (RSWs) in the material. These RSWs propagate at a distinct velocity when compared to the bulk waves of the material due to the particle displacements being a combination of shear and longitudinal modes. The RSW velocity can be used to characterize the elastic properties of a material with high precision [6]. The RSW velocity has also been used in the past to fully characterize the single crystal elastic moduli of a sample [5,7] as well as the orientation of crystallites that make up a polycrystalline aggregate [8]. Furthermore, SAM measurements have been made to characterize the effective RSW velocity in complex materials [9].
The earliest developed SAM systems as well as most systems currently available are based on tone burst excitation [10]. Enhanced contrast in the acoustic images is observed when the lens is operated at a specific defocus level. This contrast enhancement location is found by analysis of the V(z) curve, where the variation of the gated signal amplitude is plotted as a function of the distance of the lens from the sample. When the focusing lens is wide enough to generate a RSW on the sample, the direct reflected wave (DRW) and the RSW interfere, causing oscillations in the V(z) curve. The periodicity is related to the RSW velocity in the material; thus, it has been used for local quantitative measurement of the elastic properties [1]. Alternatively, when continuous waves are used, the V(z) curve is a mixture of acoustic standing waves in water and the RSW on the surface [11]. Analysis of the complex standing wave pattern is used to determine the RSW velocity in the material and the longitudinal wave velocity in the coupling fluid simultaneously. In both the tone burst and continuous wave excitation methods, the DRW and the RSW are not separated in the time domain. On the other hand, SAM based on impulse excitation allows the separation of the DRW and the RSW in the time domain [9,12,13]. The amplitude of the RSW is used for imaging, while the time separation between the DRW and the RSW at different defocus levels is used for quantitative measurement of the RSW velocity. This method, known as the two-point defocus method, has been used to generate maps of the RSW velocity. The method has also been extended to measure the surface skimming longitudinal wave (SSLW) velocity to quantify the isotropic elastic properties over the sample.
The previous work on impulse excitation SAM has been limited to scans on relatively small samples due to the amount of time required for the scan. Furthermore, the quantitative results were obtained on samples that are isotropic, and anisotropic samples have been analyzed by assuming that the properties average to become isotropic. In this paper, novel instrumentation and analysis algorithms are shown that extend the impulse excitation techniques. Measurements are made at many different levels of defocus, and advanced analysis algorithms are used to determine the RSW velocity real-time during scan. These algorithms are based on the analysis of the b-scans that are formed by plotting the transducer response as a function of the defocus depth, z, and the time, t, essentially forming a V(z, t) curve [14]. This improved the sensitivity in measuring the SAW velocity over previous impulse-excitation techniques. The b-scan analysis for SAM signals at varying levels of defocus has not been shown previously using any excitation method. Further analysis is performed in post-processing that enhances the contrast in the images and improves the quality of velocity estimation. The algorithms were tested on an optically flat E6 glass sample, and the sensitivity standard deviation estimated over hundreds of spatial locations on the sample was found to be ±2 m/s, which is an improvement over the previous methods. They were also tested on large grained Ti-6Al-4V (Ti64) samples to show the feasibility of using this method for spatial quantification of surface wave velocities in more complex material systems.
II. SAMPLES USED IN THIS WORK
Three different samples were analyzed with the modified scanning method that will be discussed below. The first sample was E6 glass polished and leveled optically flat. This sample provided a means of comparison of the quantitative values obtained from the instrument to the previously obtained values as well as to literature values. The RSW velocity in this sample has been determined via impulse excitation in previous work [9] to be 3035 ± 5 m/s, which was found to be in agreement with other reported literature values for this material.
The second sample was originally shown in Ref [15] and recently has been used for the purposes of validating an electromagnetic model [16] as well as a model for impulse excitation acoustic microscopy [17]. When referred to in this paper, this sample will be called Ti64-plate-coarse. The sample is a coarse-grained beta-annealed Ti-6Al-4V (Ti64) sample with grain sizes up to 1 cm in diameter. This sample has primarily (93% volume fraction) hexagonal close-packed (HCP) phase which is transversely isotropic in the elastic stiffness matrix. It was scanned with both eddy current testing (ECT) methods as well as acoustic microscopy methods in previous work and then imaged using RSW mapping techniques in Ref [18]. The RSW mapping images of the sample have been relatively poor to date due to the antiquated scanning methodology. This paper shows a much improved analysis of this sample with modern computational techniques and experimental methodologies relying on b-scan analysis.
In these experiments, there is very little sensitivity to the third Euler angle, which describes a rotation about the c-axis of the hexagonal crystal, as the material is effectively isotropic in the basal plane. Furthermore, the transducer is spherically focused and thus sees the rays from RSW propagating in all directions. Therefore, inside the large grains where there are no grain boundaries close to the sample points, there is very little sensitivity to the first Euler angle as well, thus leaving the transducer sensitive mostly to the tilt of the c-axis, which is given by the second Euler angle.
The third sample used for this study comes from the study in Ref [19]. This sample was extracted from a large ingot that was again coarse-grained Ti64 but has a relatively constant β-grain size compared with the previous sample. While the measurements are not sensitive to β-phase, the resulting α-phase colonies after heat treatment were still relatively uniform across the sample, which gives more areas for verification and validation of the measurement technique. Furthermore, the sample is larger than the previous sample, giving more area to perform the RSW measurements. The inverse pole figure (IPF) map of this sample is given in Fig. 1. This IPF map has a reference direction out of the page, and colors that are closer to red indicate an orientation close to the basal plane. In this work, this sample will be referred to as 2B-B-1-2AR-RF-B.
III. NEW EXPERIMENTAL METHOD
An in-depth introduction to the operating principle of the defocused probe, impulse excitation measurement of RSW velocity can be found in Ref [9]. In this paper, the modifications made to this setup are discussed. A 50 MHz SAM transducer with a spherical focused lens with a 0.2″ focal length was used to collect data. The transducer and sample were immersed in water, and the transducer was excited with an impulse electrical source. The impulse was generated with a 50 MHz center frequency JSR pulser/receiver with 20 dB gain, and data were digitized at 1 GSPS. A challenge for this setup is that the gain was restricted so that the direct reflected wave signal was not saturated. This necessarily made the RSW signal low, which led to challenges in the analysis of the signals in certain crystallographic orientations. This led to low repeatability and physically impossible velocities in these regions, which will be discussed in Sec. V.
A. New experimental method setup
A diagram of the physical setup is shown in Fig. 2. The DRW ray is shown down the middle of the transducer, and the RSW ray is shown on either side of the DRW ray. In the previous experimental setup, two defocus points were used to calculate the velocity of the RSW in the sample using the equation
where Δt_{1} and Δt_{2} are the time delays of the DRW for defocus points z_{1} and z_{2}, respectively, and Δt_{r,1} and Δt_{r,2} are the time delays to the RSW signal. Similar arguments were made to calculate the longitudinal wave velocity by defocusing the probe even further to decouple the SSLW from the DRW [18].
In the new experimental setup, multiple a-scans along the z-axis are collected, as shown on the right of Fig. 2. Each a-scan is then stacked on top of one another, and a false color associated with the amplitude is applied to an image to build a b-scan. An example of this is shown in Fig. 3. The x-axis shows the time delay after the transducer was pulsed, and the y-axis shows the z-location of the probe with 0 simply being the original location where the probe was slightly defocused. The probe is moved down toward the sample in the negative z-direction to defocus it and move the RSW signal from the DRW signal in the time domain. The DRW and the RSW can clearly be seen to separate further as the probe is defocused more. In this experiment, the probe started at a slight defocus, thus the traces to not meet at z = 0. If a line is fit to each of the signals, the slope of each line can be used to determine the RSW velocity by using the equation
In this equation, m_{DRW} and m_{RSW} are the slope of the DRW line and the RSW line, respectively. These lines are formed by considering the position along the z-axis as the independent variable and the time delay as the dependent variable. In that way, the dimensions of the slopes end up in s/m, which agrees with (2). Furthermore, if the RSW always separates more as the probe is defocused, then the quantity in the radical is guaranteed to be positive. This is only violated in extremely low amplitude cases when determining the RSW peak is so difficult that the repeatability of the measurement is not acceptable anyway.
To provide quick feedback during the scanning process, time-optimized algorithms were developed to calculate approximate values of the RSW velocity. This feedback is necessary to visually validate the physical setup as early as possible, as each scan can take a significant amount of time. In the algorithm, the location of peaks of the first two points is calculated for each z-axis scan line using the traditional maximum amplitude value within the gated region for RSW and DRW reflections. Subsequent peaks along the z-axis are calculated using smart gates which use the knowledge of previous a-scans to process the current a-scan. The smart gates are shifted based on the average change of the peak locations between each z-axis increment. Rather than looking for a maximum value within the shifted smart gate, which would be prone to error, peaks are found using a series of quadratic polynomial fits on sequential groups of data in the gated waveform. The next peak location is estimated using previous peak locations and an approximate RSW velocity. If no peak is found within the distance threshold, the estimated peak is used. This is repeated for each a-scan along the z-axis. While this method is highly prone to error in difficult areas such as between grains, the algorithm runs in approximately the time it takes the stages to move to the next location of the X-Y plane. The new experimental setup as a whole takes roughly 0.5 s per scan point as opposed to 5 s that the previous experiments required to calculate the RSW velocity at one spatial location [9].
B. Results with new experimental method
The new experimental setup and algorithms were used to collect data from the Ti64-plate-coarse sample as well as the E6 glass. The E6 glass was raster scanned over an 8 × 9 mm portion of the sample. The sample was leveled using the time of flight of the direct reflected wave, as in the previous experiments. A C-scan depicting the RSW velocity calculated using the methods discussed earlier is shown in Fig. 4. The histogram of this data showed that this was roughly normal in distribution, and the mean and standard deviation of the calculated velocity in this material are 3042 ± 2 m/s, which is very close to the previously obtained value but has a higher precision. Furthermore, this standard deviation was estimated from over 7000 spatial locations on the sample surface rather than simply performing the measurement in the same spatial location multiple times. Thus, the b-scan method gives a significant improvement in the precision over the previous experiment as well as a reduction in the amount of time required per scan point.
Data from the Ti64-plate-coarse sample are shown in Fig. 5. This same sample has been scanned using the previous experimental setup, and those images were shown in Ref [17]. Due to the improved time for scanning, more spatial locations could be measured over the sample, offering considerable improvements in the details in each image.
IV. POST-PROCESSING FOR IMPROVED RSW VELOCITY CALCULATIONS
While this method of velocity calculation improved significantly upon the prior method of experimentation, it is intended to calculate the velocity as quickly as possible, so analysis can be done real time by the experimenter. However, there are difficulties with the technique that lead to incorrect calculation of the RSW velocity in certain samples, as can be seen in Fig. 6. Velocities calculated in the grains at the top and bottom of the image are not reliable, and many of the spatial locations in the vertical center of the image are also corrupt. One of the primary concerns with the on-the-fly calculation is that the algorithm tries to detect peaks based on the peaks found in the previous a-scans. This is extremely efficient and robust for quick computation, but the algorithm can get caught following the wrong trajectory in the b-scan and thus miss tracking the RSW line entirely. Furthermore, when two separate peaks in the wave packet are close in amplitude, the algorithm tends to switch between the peaks, which was the issue in this image. In post-processing, it is possible to perform a more robust peak detection to enhance the image of RSW velocity.
A. Post-processing algorithm theory
The post-processing algorithm is based on the underlying assumption that for any given a-scan the direct reflected wave should exhibit the highest amplitude and the Rayleigh surface wave the second highest. Conceptually, identifying the signals from the direct reflected wave and Rayleigh surface wave should be attainable using a nearest neighbor peak finding approach. However, in cases where the Rayleigh surface wave appreciably decreases in amplitude, the highest peak following the maximum a-scan amplitude often lies on secondary peaks associated with direct reflected wave. As such, it is necessary to demodulate the a-scans into an envelope estimation to reduce the basis signals for the direct reflected wave and Rayleigh surface wave to individual peaks.
Before estimating a given a-scan envelope, it is necessary to perform a smoothing routine to remove quantization noise. Such quantization noise can prove significant when using high sampling rates while collecting signals at a suboptimal amplitude resolution through 8-bit analog to digital conversion. To estimate the required cutoff frequency for smoothing, successively wider low-pass sinc filters were applied to individual a-scans until the maximum residual of the raw and smoothed signals fell below the precision limit of the ultrasonic acquisition system. In practice, however, due to computation time concerns, this cutoff frequency estimation process was only performed for a subset of the data and the highest estimated cutoff was applied to the entire dataset to limit information loss from low frequency biasing.
Following smoothing, the envelope of each a-scan was estimated by calculating the magnitude of the analytic signal via the Hilbert transform. This has been successfully applied to ultrasound signals previously [20]. The effect of the transform can be seen in Fig. 7. The Hilbert transform demodulates the analytic signal magnitude from the high frequency phase information. In a sense, this converts the time-domain signal to the amplitude envelope which is plotted on the same time scale as the raw signal. The envelope has less major peaks than the raw signals, and if the RSW and the DRW are separated enough, it should result in large single peaks corresponding to each wave packet. This effect can be clearly seen in the figure, where the envelope of the DRW is shown with the first peak marked with an x, and the envelope of the RSW is shown as the second peak marked. This combined with the smoothing algorithm makes it possible to use a nearest neighbor peak fitting routine to find the peaks corresponding to the center of the DRW signal and the RSW signal for each a-scan.
B. Results with the post-processing algorithm
The algorithms were first tested on the E6 glass sample to verify that it gives similar results to the experimental methods. The algorithm found the effective velocity of the E6 glass to be 3019 m/s, which is slightly lower than both the values found by the experiment as well as the values found in the literature using the two-point defocus method but still within an acceptable range. The standard deviation using the post-processing algorithm was ±6.2 m/s, which is slightly higher than the experimental method, but once again was estimated using over 7000 different spatial locations, indicating that the precision is significantly better than the two-point defocus method and similar to the smart-gate experimental algorithm. The lack of agreement in velocity calculation between the experimental smart gate algorithm and the post-processing algorithm is likely due to a bias introduced by the Hilbert transform. However, it will be shown that the peak-finding algorithms perform much better on the data that have been mapped through the Hilbert transform when individual peaks in the waveform are nearly the same amplitude. Once each grain is identified, further analysis would be required to remove this bias from the estimate.
While the post-processing algorithm produces a slightly less precise estimation of the velocity, the value in using the algorithm is that it can find RSW peaks with higher fidelity and more consistency than with traditional peak finding algorithms. The algorithm was used to perform peak fitting on the b-scan at each location of sample 2B-B-1-2AR-RF-B. An example of the fit lines to the b-scan images can be seen in Fig. 8. In this image, the peaks that the algorithm found corresponding to the DRW signal and the RSW signal are given by green x’s. For each a-scan (a horizontal line in this image), the peaks corresponding to each reflection are estimated. Then, the algorithm fits the red line to these peaks to estimate the slope and intercept of the lines corresponding to the DRW and the RSW in the image. Two points are then taken from each line to perform the calculations given in (1).
The algorithm was run at every point on sample 2B-B-1-2AR-RF-B, and a new map of the RSW velocity was generated. This is shown in Fig. 9. The color-scale on this image is the same as that of Fig. 6, but what can be seen from this image is that much of the corrupt data from Fig. 6 have been removed. The algorithm is able to find the peaks with much higher fidelity by fitting peaks in the Hilbert transform space. Eliminating the multiple peaks that can be associated with the wave packet by simply analyzing the wave envelope reduced the chances of the algorithm switching between peaks in each RSW signal in the b-scan. The grains with reliable velocity calculation in Fig. 6 show similar velocities as those shown in Fig. 9.
V. ANALYSIS OF RESULTS
The post-processing algorithm reliably corrected many of the flawed velocity calculations due to peak finding difficulties in the experimental method, as can be seen when comparing Fig. 6 with Fig. 9. This map is supposedly close to representing the surface wave velocity on each crystal, though there are still some issues in these results related to the crystallographic orientation of each grain. This section will discuss these issues related to the orientation of the crystal.
One aspect of Fig. 9 that is obvious is that certain grains seem to have more noise in the calculation than other grains. To see this, the section of the sample that was scanned that has associated electron backscatter diffraction (EBSD) data is shown next to the acoustic microscopy velocity estimates in Fig. 10. The EBSD data shown here are only color-coded according to the angle of the c-axis tilt or the second Euler angle. Certain grains are labeled for convenience.
The grains with the most well-defined colors are ones such as grain #2. This grain has a c-axis tilt of 25°. This finding is consistent across the entire sample, where any grain that has a relatively low c-axis tilt has very little scatter in the velocity calculation from the experiments. Furthermore, the velocity calculations in these grains are all between 3000 m/s and 3200 m/s, which is well within the expected range for this material system. This is contrasted with grains such as grain #3, where the tilt of this grain is 60°. It can be seen from the velocity map that the experimental velocity measurements have significantly more noise in this grain. For a quantitative comparison, the estimated standard deviation of experimental velocity in grain #2 is 10.6 m/s, whereas the estimated standard deviation in grain #3 is 107.2 m/s. When a grain, e.g., grain #1, has a c-axis tilt close to 90°, the velocity is once again more predictable, with an estimated velocity of 3261 m/s and a standard deviation of 70.4 m/s. These findings are repeatable for multiple different grains in this sample. The worst case is any grain that has orientation close to that of grain #4. This grain has an orientation of 64°, and the RSW calculations are off the color-scale in the image, which is physically impossible, meaning the velocity calculation in this grain is very unreliable. Any of the grains that show as largely white in this image have poor reproducibility in the velocity calculation, and all of them are oriented between 60° and 70°.
The reason behind this artifact in the data can be seen by looking at the b-scan in the grains. Figure 11 shows the b-scan from grain #2 on top and the b-scan for grain #4 on bottom. As can be seen in this image, the RSW signal in grain #2 is very strong and the algorithm has no problem in finding the peaks. The b-scan for the grain oriented at 64° has a very low RSW amplitude, and thus the algorithm cannot consistently find a RSW signal in these b-scans leading to considerable noise and non-physical values of the RSW velocity. This implies that the RSW amplitude, as well as the velocity, is tied to the tilt of the c-axis, though not in a linear relationship. In fact, the RSW signal disappears almost entirely in this 60°–70° range only to gain amplitude again above 70°. This behavior is unexplained at this point and requires further investigation with multiple hexagonal material systems to verify. For the sake of improving the RSW velocity measurement, it may be enough to run two scans at different gains to amplify the RSW signal enough to get a strong reading. The high fidelity calculation of RSW velocity in regions where the RSW signal was strong enough to find peaks consistently, especially with the improved contrast over that which has been previously accomplished with the impulse excitation method, is promising.
The bottom image in Fig. 10 shows the maximum amplitude from the RSW fits on each a-scan in the b-scans. The amplitude is equivalent to that shown in Fig. 7 in the plot of the Hilbert transform of the a-scan. The image is saturated with any amplitude above 20 being the same color black to improve the contrast ratio of the lower amplitude grains. The lowest amplitudes clearly correspond to the grains in which RSW velocity was the least reliable. In fact, as can be seen in Fig. 7, the noise in the plot of the Hilbert transform is roughly on the order of 0–5, which is the same level as the amplitude of grain #4. Lastly, the amplitude is clearly not unique with respect to the second Euler angle, as can be seen by looking at grains #1 and #3. Given this fact, it is more than likely that some combination of the velocity measurement as well as the amplitude in the grain would be required to uniquely identify the second Euler angle from data collected in this material. More work is required to determine this for other hexagonal materials.
VI. SUMMARY AND CONCLUSION
In this work, the impulse excitation method of scanning acoustic microscopy was extended using enhanced b-scan analysis to improve the resolution and accuracy from the current state of the art. The repeatability of the measurement was shown on an optically flat E6 glass sample and found to be improved over the previous two-point defocus method. The scan is also quicker than the previous method, allowing for enhanced resolution in the x-y plane as shown by the images taken over the first Ti64 sample. The quantitative measurement of velocity in Ti64 was carried out on multiple grains in a third sample and was found to be within a good range for the material. Further analysis of the b-scans in certain grains revealed that the amplitude of the RSW signal from impulse excitation is dependent on the tilt of the c-axis and that in certain crystallographic orientations, the RSW signal disappears entirely. This phenomenon has not been explained but should be further investigated in multiple hexagonal materials for application of the technique to hexagonal crystals. This showed that both the smart-gate algorithm as well as the post-processing algorithm has difficulty in quantitative measurement of RSW velocity when the amplitudes are low and that gains should be adjusted to improve the signals if possible. It should also be noted that the Ti64 material was chosen for its high degree of complexity to test the technique, and the results to date have indicated that there is significant promise for quantitative measurement of velocity and/or orientation in this material using the b-scan analysis technique.
FIG. 1. 
IPF map of sample 2B-B-1-2AR-RF-B.
FIG. 2. 
Diagram of the experimental setup for defocused probe impulse excitation SAM.
FIG. 3. 
Example b-scan at one (x, y) location. The direct reflected wave and the Rayleigh surface waves are clearly visible and get closer as the probe is brought closer to focus.
FIG. 4. 
Map of the calculated RSW velocity over the E6 glass sample.
FIG. 5. 
Map of the calculated RSW velocity over the entire Ti64-plate-coarse sample.
FIG. 6. 
Calculated velocity map over sample 2B-B-1-2AR-RF-B. This map clearly shows corrupted data on many of the large grains as well as streaking on the top and bottom of the sample.
FIG. 7. 
Image of an a-scan on the left and the transformed a-scan on the right. The peak finding algorithm works on the transformed a-scan. This image shows the peaks located on the particular a-scan (green “x”).
FIG. 8. 
Image of a b-scan with red lines fit to each set of peaks (green “x”).
FIG. 9. 
Improved map of the microstructure from RSW velocity measurements over the surface of 2B-B-1-2AR-RF-B.
FIG. 10. 
(Top) Image of the second Euler angle mapped over the surface of a portion of sample 2B-B-1-2AR-RF-B, (Middle) new velocity map of the same portion, and (Bottom) image of the maximum fit amplitude over the b-scan. Specific grains are labeled with numbers for discussion.
FIG. 11. 
(Top) Image of the b-scan in grain #2 and (Bottom) the b-scan in grain #4. The RSW signal is almost non-existent in grain #4, leading to very inaccurate measurements of the velocity in this grain.

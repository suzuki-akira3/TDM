Accounting for Debye sheath expansion for proud Langmuir probes in magnetic confinement fusion plasmas
A Child-Langmuir law-based method for accounting for Debye sheath expansion while fitting the current-voltage I-V characteristic of proud Langmuir probes (electrodes that extend into the volume of the plasma) is described. For Langmuir probes of a typical size used in tokamak plasmas, these new estimates of electron temperature and ion saturation current density values decreased by up to 60% compared to methods that did not account for sheath expansion. Changes to the collection area are modeled using the Child-Langmuir law and effective expansion perimeter l_{p}, and the model is thus referred to as the “perimeter sheath expansion method.” l_{p} is determined solely from electrode geometry, so the method may be employed without prior measurement of the magnitude of the sheath expansion effects for a given Langmuir probe and can be used for electrodes of different geometries. This method correctly predicts the non-saturating ΔI/ΔV slope for cold, low-density plasmas where sheath-expansion effects are strong, as well as for hot plasmas where ΔI/ΔV ∼ 0, though it is shown that the sheath can still significantly affect the collection area in these hot conditions. The perimeter sheath expansion method has several advantages compared to methods where the non-saturating current is fitted: (1) It is more resilient to scatter in the I-V characteristics observed in turbulent plasmas. (2) It is able to separate the contributions to the ΔI/ΔV slope from sheath expansion to that of the high energy electron tail in high Te conditions. (3) It calculates the change in the collection area due to the Debye sheath for conditions where ΔI/ΔV ∼ 0 and for V = V_{f}.
I. INTRODUCTION
A Langmuir probe is an electrically biased electrode that can be inserted into a plasma. The dependence of the current flowing through the electrode from an applied bias potential (the I-V characteristic) provides estimates of plasma parameters [1–6]. We will consider the standard Langmuir probe function for a single electrode,
where the electric potential of the electrode, V, and the current flowing into the electrode, I, are measured experimentally. The fitted parameters are the electron temperature kT_{e}/e (eV), the ion saturation current density J_{sat} (A/m^{2}), and the floating potential V_{f} (V). The effective collection area A_{coll} is a problem-dependent constant. V_{p} is the plasma potential.
When V is sufficiently negative (V_{f} − V ≫ kT_{e}/e), the exponential term from Eq. (1) becomes negligible, and I becomes constant as a function of V. This constant current is called the ion saturation current I_{sat}.
However, the Debye sheath enlarges the effective collection area resulting in a current that continues to increase with increasingly negative V. The effects of sheath expansion can be minimized by using electrodes that are much larger than the Debye sheath or planar-probes with guard rings [7], but in situations where these approaches are impractical, sheath expansion effects make it difficult to accurately estimate n_{e} and T_{e} from the Langmuir probe. Therefore, a method to account for sheath expansion while fitting I-V characteristics is needed.
Refined models of the sheath and sheath expansion have already been developed and studied [8–11], and one approach to account for sheath expansion is to model the full geometry of the sheath for the plasma conditions and for the range of voltages of the electrode. For example, Refs [12] and  [13] model the sheath for circular Langmuir probe mounted flush to the walls in tokamaks, as well as the sheaths of the surrounding walls. References  [14] and  [15] also account for the magnetic pre-sheath for the same geometry, which is important since the magnetic field lines have grazing angle with the probe surface. These methods only apply to the flush-mounted circular geometry and are sufficiently complex that they have not seen widespread use. In Ref [9], empirical formulas are derived from a numerical sheath model to provide an easier way of accounting for sheath expansion. This approach has been shown to work well [16] but is also limited to the specific geometry which has been modeled.
Since there was a need for a more general and less complex way of accommodating for sheath expansion, it has become common to subtract the effects of sheath expansion without calculating the sheath thickness. When the voltage is swept to a sufficiently negative value (V_{f} − V ≫ kT_{e}/e), one can assume that J_{sat} is constant as a function of V, and it is usually sufficient to fit and subtract the non-constant portion of the current using a 4th fitted parameter. One may use a linear function matching the slope of the non-saturating region [17,18],
which is either fit simultaneously with (1) or during a different step. ΔI/ΔV [A/V] is the slope of the non-saturating region. This term is sometimes normalized to generate a unit-less fit parameter [13,19].
Similarly, one can fit
to the non-saturating region with V_{p} estimated from a previous step [20].I_{Ø} [A] and C [A/V^{3/4}] are fitted constant.
These 4-parameter fits are an improvement on neglecting sheath expansion effects altogether, but since ΔI/ΔV is fitted to the data, the assigned value can be inconsistent with the theoretical rates of sheath expansion for the given plasma conditions, especially in conditions where the (V_{f} − V ≫ kT_{e}/e) criterion is not met or where the I-V characteristic is noisy. This, in turn, affects the extracted T_{e} and n_{e} values as we will demonstrate in Sec. IV.
We thus propose a fitting method to account for sheath expansion based on the Child-Langmuir law and an effective expansion perimeter l_{p}. It is therefore referred to as the “perimeter sheath expansion method,” or the “perimeter method” for short. This method is straightforward to implement, is general to multiple electrode geometries, and we will show that the method accounts for sheath expansion more completely than the 4-parameter fit while reducing scatter in the extracted J_{sat} values.
While the method described in this paper should apply to all Langmuir probes, this paper focuses on the case of proud Langmuir probes which are mounted on reciprocating actuators in tokamaks. A proud Langmuir probe has an electrode that extends pasts its support structure into the volume of the plasma, i.e., any probe that is not mounted flush to the wall. Reciprocating probes are rapidly moved across the confining magnetic flux surfaces such that the plasma temperatures and densities can change by more than a factor of 10 over the tens of milliseconds it typically takes to travel from the plasma periphery to the point of deepest insertion. These electrodes are kept small to increase spatial resolution and to decrease power supply requirements at the highest densities, with typical dimensions 0.5-3 mm [21–25]. The Debye sheath is often large enough to significantly increase the collection area of the electrode, especially in the lower density conditions at the outermost magnetic flux surfaces. Tokamak plasmas are highly turbulent, adding additional difficulties to Langmuir probe analysis. Finally, Eq. (1) is typically understood to be valid for V < V_{p}, but in magnetic confinement fusion devices, the region of validity is reduced since electron to ion saturation current ratios as low as 1:1 are sometimes observed [26,27]. In this paper, we will ignore most of the net electron collecting side of the characteristic, as is common practice.
II. THE PERIMETER SHEATH EXPANSION METHOD
Rather than fitting the excess non-saturating current, we assume that the collection area of the electrode satisfies
where A_{0} is the collection area of the electrode with a sheath of zero thickness, l_{p} is the effective perimeter along which the sheath is able to grow, and l_{sh} is the thickness of the Debye sheath, which is determined using the Child-Langmuir Law [28],
where ΔV_{sh} is the potential drop across the sheath which can be estimated as
where Λ is a numerical factor that depends on the ion species and the ion temperature [28]. The Debye length λ_{D} is
where n_{se} is the density at the sheath edge, which we evaluate using the Bohm criterion,
where e is the electron charge, Z is the charge of the ions, k is the Boltzmann constant, γ is the adiabatic constant, T_{i} is the ion temperature, and m_{i} is the mass of the ions.
To implement the method, a curve fitting program is run using a parametric function consisting of a Langmuir I-V function [e.g., the standard function (1)] and Eqs. (4)–(8) with the constants set depending on the plasma to be measured, and with A_{0} and l_{p} set depending on the geometry of the electrode. Examples will be followed in Sec. III.
Although the perimeter sheath expansion method increases the complexity of the fitting function, it was found that the process time per iteration and the number of iterations necessary for the standard Langmuir I-V fitting function, the 4-parameter method, and for the perimeter method all matched within 10% when run in MATLAB and IDL, suggesting that the computational cost of running the fitting function is small compared to the overhead. One would expect the simpler fitting methods to gain a significant advantage in faster programming languages.
III. MODEL EXAMPLE AND VALIDATION
We will test the model using example data taken from a low-density deuterium discharge from the Tokamak à Configuration Variable (TCV) where the effects of sheath expansion were found to be strong. The magnetic geometry and location of the reciprocating probe together with the electrode arrangement are shown in Fig. 1.
We take Λ = 2.5, γ = 2, Z = 1, and m_{i} = 2m_{p}. Unfortunately, in the tokamak boundary, T_{i} is generally not known, and measurements show a wide scatter such that one cannot deduce a typical T_{i}/T_{e} ratio [29]. This places a significant uncertainty on the calculated values of C_{s}, which in turn affects n_{se}, n_{e}, and l_{sh}. For this example, we will follow standard practice and assume that T_{i} = T_{e}.
We treat a cylindrical electrode operated as a swept Langmuir probe and part of a Mach system [6] mounted on a reciprocating drive. The electrode (the right Mach probe in Fig. 1) is 1.5 mm in height h, with a radius r of 0.75 mm, and is facing into the plasma flow and towards the outboard midplane. The electrode is only exposed to the plasma from one side.
Usually, the electrode is large compared to the ion gyroradius, and A_{0} is set to the projected area of the magnetic flux-tube subtended by the electrode. In this case, l_{p} is the physical perimeter of the surface, excluding the base where the electrode meets the supporting structure See Fig. 2(a) showing the projected surface area A_{0} and the surrounding collection area due to sheath expansion. Essentially, the model assumes that the Debye sheath grows perpendicular to the magnetic field with no magnetic pre-sheath. This is not correct [30,31], but our goal is only to estimate an A_{coll}(V) function that is consistent with the I-V characteristics. It will be shown below that these assumptions are sufficiently accurate for these purposes and for the equipment used in this example.
We also consider the example where the electrode is small compared to the ion Larmor radius. In this weakly magnetized case, the effective collection area can increase up to the geometric surface area [32], and the electrode does not have a physical perimeter. The electrode surface area is calculated by taking the full areas of all surfaces that face away from the boron nitride insulator, i.e., the full area of the circle plus half of the curved surface,
In this regime, we define l_{p} as the derivative of A_{coll} with l_{sh},
l_{p} is calculated by taking the total derivative in A_{0} (with r and h) and substituting ∂l_{sh} for ∂r and ∂h,
We substitute h = 2r, dr = dh = dl_{sh}, and
and solve Eq. (10),
This is depicted in Fig. 2(b), where the shaded surface represents the A_{coll} when l_{sh} = 0.25 mm.
An I-V trace is shown in Fig. 3(a) that clearly does not saturate (I is not constant for V < −100 V) with the matching fitting parameters shown in Table I for the perimeter method (red line), the standard Langmuir fitting method (dashed cyan line), and the 4-parameter method (dotted-dashed blue line). The uncertainties reported in Table I and throughout this paper are taken as the 2σ parametric uncertainty values computed from the curve fitting program. Figure 3(b) shows the collection area as determined by the perimeter method. Even at V = V_{f}, A_{coll} is larger than A_{0} by a non-negligible amount, and A_{coll} continues to evolve as I crosses through zero, with a consequent effect on the determination of J_{sat} and T_{e}.
Considering that the voltage is swept to −350 V, the non-saturating ΔI/ΔV (−36 ± 4 μA/V) is modest. As expected, both I_{sat} and T_{e} are over-estimated by the standard Langmuir fitting function, and the fitted line (dashed cyan) does not follow the data points. The perimeter method and the 4-parameter fits (solid red and dotted-dashed blue lines, respectively) almost lie overtop of one another. In this example, the perimeter method and the 4-parameter fit generate ΔI/ΔV values that agree.
The profiles from the I-V fits during a probe reciprocation are shown in Fig. 4 as the electrode moves across the boundary flux surfaces. The probe position (R-R_{LCFS}) is its distance from the Last Closed Flux Surface (LCFS) mapped to the outer midplane, so the probe’s motion shown in (a) account for both the movement of the electrode and the movement of the plasma. The electrode crosses ∼10 cm in 40 ms with T_{e} (b) and J_{sat} (c) increasing rapidly as the electrode moves deeper into the plasma.
To demonstrate that the perimeter method correctly predicts the slope of the non-saturating region of the I-V data, a linear function (I=a^{*}V+b) is applied for V < V_{f} to the residual of each fit. The residual slopes are plotted in Fig. 4(d). The mean residual slope is 7 μA/V with a standard deviation of 36 μA/V, suggesting that our basic approximations accurately predict the non-saturating ΔI/ΔV slope due to sheath expansion. The y-intercept (−b/a) was usually −150 V ± 20 V, roughly in the middle of the fitted region.
We find therefore that the perimeter method correctly compensates for the non-saturating curve in this example. One may select l_{p} in order to further minimize the residual slope rather than estimating it using geometrical calculations. It is worthwhile to note however that the fit parameters are insensitive to changes in l_{p}, e.g., in the example from Fig. 1 and Table I: increasing l_{p} by 10% is found to decrease T_{e} and J_{sat} by ∼1% and increase χred2 by 0.02. If the goal is to fit T_{e}, V_{f}, and J_{sat} reliably, rather than study the physics of sheath expansion, then the geometrical approximations used here are sufficient.
IV. COMPARISONS WITH THE 4-PARAMETER FIT, OVERFITTING AND ERROR TRAPPING
The plasma in this example is sufficiently turbulent that there are perturbed I-V characteristics. If the turbulent events that take place during a voltage sweep are sufficiently large, it becomes impossible to extract meaningful values of T_{e} and n_{e}, and the fit should be rejected.
In Fig. 4, fits were rejected if the least squares fitter failed to converge, if the ΔI/ΔV > 0 (for the 4-parameter method only), or if the χred2 > 1.5 (details to follow).
Consider the I-V characteristic in Fig. 5, which is taken in a highly turbulent plasma discharge. The fitting parameters are shown in Table II. A low-density variation (a “hole”) passes over the electrode with the current in the ion-saturated region. This extreme example is taken as a proxy for the more common situations where a high density turbulent structure (a “blob”) passes over the electrode, as it sidesteps the debate whether the ΔI/ΔV slope is caused by sheath expansion or by turbulence. In that case, ΔI/ΔV would be negative and it would not be obvious from the sign of the parameter that the fit should be rejected. [Outside of this example, results from fits with ΔI/ΔV > 0 have been rejected. Such fits are not shown in Figs. 4(b)–4(d) or 4(f).]
We attempt to evaluate overfitting and the goodness of fit by using the reduced chi-squared [33],
see Ref [33] for variable definitions. The numerator represents the variance in the residual, while σ^{2} is the variance in the current measurement, i.e., the “background noise.” In ideal situations when σ^{2} is known precisely, a perfect fit will reduce the variance in the residual down precisely to the background noise and χred2 = 1. χred2 > 1 implies a poor fit or an inappropriate model.
In this example, the background noise is due to the plasma turbulence, which occurs intermittently, so σ changes between each I-V characteristic. We estimated σ from the residuals of the previous two and subsequent two I-V characteristics, which were taken within 1-2 ms of the current fit. If a neighbouring fit failed to converge or had ΔI/ΔV > 0, this time slice was skipped and the next one was taken instead. For Fig. 5, σ was estimated to be ∼0.03 A.
The perimeter method produces a fit with χred2 = 1.96, flagging it for rejection. The 4-parameter method produces a fit with χred2 ≅ 1, and with small parametric uncertainties (see Table II), so no indication is given that the fit results are not trustworthy. It is, therefore, necessary to post-process the results from 4-parameter fitting using case-specific error traps to detect and reject data from these outlying cases. With the perimeter method, we find that no such error-trapping is needed, as all poor fits can be captured by specifying a threshold to the goodness of fit values.
In Fig. 4, fits were first rejected if the curve-fitting tool failed to converge. Both the perimeter method and the 4-parameter method rejected 7/100 fits. Next, 4-parameter method fits were screened for ΔI/ΔV > 0, with 18 fits being rejected. These ΔI/ΔV values are shown by the red “x”s in Fig. 4(e). Finally, both methods had χred2 evaluated, and fits with χred2 > 1.5 were rejected: 12 for the perimeter method and 3 for the 4-parameter method as shown in part (f). Rejected fits are not shown in subplots (b)–(d). The perimeter method has 70 good data points (black diamonds), while the 4-parameter method has 66 (small red squares).
The large variation in χred2 values is representative of the fact that the background noise varies dramatically from characteristic to characteristic, where some fits have very little noise compared to the others, resulting in χred2 ≪ 1. A large χred2 is, therefore, a sign that the I-V data is perturbed, rather than being a sign that the least-squares fitting process ran into difficulties. Note however that the 4-parameter method has relatively fewer fits with large χred2. This is because the 4-parameter fit is “overfitting” the data. Specifically, we mean the 4-parameter method produces a fit that corresponds too closely to the I-V characteristic data. It can therefore unknowingly extract the residual variation from the turbulence-induced noise. This, in turn, corrupts the extracted T_{e} and j_{sat} variables not because the fit is bad but because the model is unable to reject curves that do not correspond to the Langmuir probe model. This explains why the 4-parameter fits have considerably more scatter than the perimeter method, in T_{e} (b) and J_{sat} (c) as well as ΔI/ΔV (e).
The perturbations caused by turbulence can be treated by averaging the I-V profiles over multiple voltage sweeps, at the cost of temporal resolution. The multi-sweep averaged data points (2 ms instead of 0.5 ms) are shown as the large red squares. The spatial resolution has been reduced from ∼1 mm^{−1} to ∼1/4 mm^{−1}. The spatial resolution is not constant due to the fact that both the plasma and the probe are moving at non-constant velocities and because some fits were rejected. While this reduces the effects of the turbulence, it does not address the shortcomings of the 4-parameter method when the (V_{f} − V ≫ kT_{e}/e) criterion is not met.
In the region R-R_{LCFS} < 0, where T_{e} > 50 eV, and V_{f} ≪ 0, the exponential term in Eq. (1) can contribute significantly to the slope at −300 V, i.e., the I-V profile is not saturating at −300 V because the bias voltage is not sufficiently negative. This can be seen in Fig. 4(e) where ΔI/ΔV for the perimeter method is calculated at −300 V using the finite difference method. The black diamonds show the portion of the slope which is due to sheath expansion, and the total ΔI/ΔV including the exponential term is shown by the cyan triangles. These two datasets agree except for R-R_{LCFS} < 0.
The black diamonds are directly comparable with the fitted ΔI/ΔV from the 4-parameter method (small red squares or large red squares for the multi-sweep averaging), which also excludes the exponential term. However, the ΔI/ΔV fitting parameter does not distinguish between these two effects and acts to suppress them both, resulting in an underestimation of T_{e} and J_{sat} as seen in subplots (a) and (b) at R-R_{LCFS} ≅ −1.5 cm.
An example I-V characteristic where the ΔI/ΔV fitted parameter interferes with the determination of T_{e} is shown in Fig. 6(a) with the fit parameters shown in Table III. Note that the slope from the 4-parameter fit (dotted-dashed blue) does indeed match that of the data. One cannot tell from the fit alone that the slope is not due to sheath expansion.
Since (ΔI/ΔV)/I_{sat} is small, one would expect that these effects can be mitigated by turning off the 4th parameter (i.e., switching to the standard Langmuir probe fitting function and neglecting sheath expansion) above a certain T_{e}, but we will show in Sec. V that sheath expansion effects are still important for the cases where (ΔI/ΔV)/I_{sat} is small.
We have shown that the perimeter method requires little user-intervention in the form of pre-processing the I-V data or in post-processing the fitted parameters. The method is resilient enough to handle unsmoothed input data, and the fitting model is accurate enough that the standard goodness of fit parameters may be used to reject outliers.
V. COMPARISONS TO THE STANDARD LANGMUIR FIT – SATURATED I-V PROFILES
The T_{e} and J_{sat} profiles of the perimeter method and the standard Langmuir probe fitting method are shown in Fig. 7. We see that the T_{e} values from the perimeter method are lower than those from the standard method especially for R-R_{LCFS} > 5 cm (avg T_{e} ∼27 eV for standard, ∼10 eV for perimeter). J_{sat} is ∼60% lower for the perimeter method, and this difference remains approximately constant with R-R_{LCFS}. For low values of T_{e} and low collisionality, many of the drawbacks of the standard Langmuir fits can be overcome by decreasing the voltage range and fitting less of the ion-saturation region, in which case better agreement with the perimeter method and better χred2 values can be obtained. Of course, without a model for the sheath expansion, this must be done on a case by case basis. In this paper, the standard Langmuir fits were applied to the full voltage range to provide a fair comparison.
At high T_{e}, the effects of the non-saturating slope become less apparent as (ΔI/ΔV)/I_{sat} decreases due to the T_{e} term in the denominator of Eq. (5). However, the effects of sheath expansion remain important since the V_{p} term in Eq. (6) becomes large as V_{p} increases with T_{e}. Here, A_{coll} remains approximately constant as a function of V but is consistently larger than A_{0} [see Fig. 6(b)]. This explains the lower J_{sat} at R-R_{LCFS} < 0 when comparing the perimeter method against the standard Langmuir probe fits. The standard Langmuir function fit (dashed cyan line) in Fig. 6(a) follows the I-V data well. One cannot tell from the fit alone that sheath expansion effects are non-negligible in these conditions.
We have shown that sheath expansion effects can be significant even in conditions where the standard Langmuir probe fits appear to be satisfactory and that the perimeter method continues to account for the effects of sheath expansion in these cases. In higher density conditions where sheath expansion is negligible, the model enforces A_{coll} ≅ A_{0}, so there is no need to disable the sheath expansion corrections.
VI. EXTENSIONS TO THE PERIMETER METHOD
The perimeter sheath expansion method can be easily combined with other Langmuir probe fitting techniques. For example, the iterative voltage cut-off methods first discussed in Ref [34] such as the “minimum T_{e} method” are useful if the electron saturation current is small. Increasing the fitting weight to data points close to V = V_{f} is an effective way to avoid local-minima with higher T_{e}.
Since the increase in collection area for any given electrode is set for a given T_{e} and n_{e}, the perimeter method can be applied without a full I-V characteristic. This allows the method to be used with discrete voltage systems such as the triple probe. Normally, corrections for sheath expansion in these probe systems must be performed using look-up tables; see, e.g., Ref [19].
A symmetric double probe consists of electrically isolated power supplies that drive a voltage between two identical electrodes that are placed close enough to sample plasmas with near-identical conditions [6]. The double probe geometry is shown in Fig. 1. This setup reduces the power supply requirements since the entire system maintains a voltage at the floating potential of the plasma, and the current passes smoothly from the ion-saturation regime of one electrode to that of the other, bypassing the electron branch. The double probe fit function is given as [6]
where V_{d} is the potential difference between the two electrodes. I_{off} and V_{off} are fitted offsets that are included to ensure that the tanh function is applied to symmetric data. If two identical electrodes are inserted into plasmas with identical conditions, then when V_{d} = 0, both electrodes have V = V_{f} and the fits should have V_{off} = 0 and I_{off} = 0.
To apply the perimeter method to double probes, we replace Eq. (6) with an estimate of the potential drop across the sheath of the negatively biased electrode,
An example I-V trace is shown in Fig. 8 with the fit parameters shown in Table IV.
We have shown that the thickness of the sheath can significantly affect the collection area of the electrode at V = V_{f} or at V = 0 (see Fig. 6). This implies that the sheath of the supporting structure would also have an effect on the collection area of the electrode in those conditions. The perimeter method may be extended to account for the sheath of the support structure by replacing Eq. (4) with
where l_{struct} represents the perimeter from the parts of the structure where the sheath blocks plasma from reaching the electrode and l_{sh}(V = V_{0}) is the length of the Debye sheath at the potential of that structure, i.e., V_{0} = V_{f} for an insulated structure and V_{0} = 0 for a grounded structure. For example, in Fig. 2, the support structure is represented by the white plane at Z = 0, and l_{struct} would be set to subtract the area blocked by the sheath of the support structure. l_{struct} = 2r for the base of the rectangle in the strongly magnetized case shown in Fig. 2(a) and l_{struct} = πr for the base of the cylinder in the weakly magnetized case shown in Fig. 2(b).
This correction increases the reported J_{sat} values slightly in the examples shown in this paper. The magnitude of the effect is small compared to the uncertainties present in the calculations of n_{e}. However, the extension may be useful for wall Langmuir probes that do not extend significantly into the plasma volume.
Accounting for the electron and ion collection areas separately was tested and found to have little effect on the fit parameters.
VII. CONCLUSION
A Child-Langmuir law based method for accounting for sheath expansion while extracting T_{e} and j_{sat} from I-V profiles in proud Langmuir probes has been described using an effective expansion perimeter l_{p} that is calculated along with A_{0} based on the geometry of the electrode. Methods that do not account for sheath expansion can overestimate J_{sat} and T_{e} by up to 60% compared to the perimeter method when using Langmuir probes of a typical size in tokamak fusion plasmas.
The perimeter method predicts the ΔI/ΔV slope of the ion-saturation region in the I-V profiles by calculating the change in the collection area due to the expansion of the Debye sheath. The predicted non-saturating slope has been found to match measurements for cold low-density plasmas where the sheath expansion effect is large and for hot high-density plasmas where sheath expansion effects are not obvious.
The perimeter method operates reliably in turbulent plasmas without averaging or smoothing the I-V data, and without case-specific error checking to identify outliers. At high T_{e}, the high energy electron tail can contribute significantly to the slope at the minimum V. Since the perimeter method calculates the slope contributions from sheath expansion and from the temperature exponential separately, it continues to produce trustworthy fits for these conditions.
We demonstrated that there are conditions where the Debye sheath significantly increases the electrode collection area even though the standard Langmuir function fits appear to be good. This affects both the J_{sat} and the T_{e} fitted parameters and can only be accounted for by calculating the change in A_{coll} due to sheath expansion.
TABLE I. 
Resulting parameters from the fittings shown in Fig. 3(a). χred2 is the reduced chi squared [33].
TABLE II. 
Resulting fit parameters from the two fittings shown in Fig. 5.
TABLE III. 
Resulting parameters from the fittings shown in Fig. 6.
TABLE IV. 
Resulting fit parameters from Fig. 8.
TABLE I. -body
	Standard Langmuir Eq. (1)	4-parameter fit [18]
Perimeter method (red)	(dashed cyan)	(dotted-dashed blue)
J_{sat} = 3280 ± 50 A/m^{2}	J_{sat} = 5450 ± 80 A/m^{2}	J_{sat} = 4089 ± 140 A/m^{2}
I_{sat} = 17 ± 0.2 mA	I_{sat} = 29 ± 0.5 mA	I_{sat} = 22 ± 0.8 mA
T_{e} = 11.0 ± 0.6 eV	T_{e} = 17.6 ± 1.1 eV	T_{e} = 12.3 ± 0.7 eV
V_{f} = −1.2 ± 0.7 V	V_{f} = −3.5 ± 0.8 V	V_{f} = −1.4 ± 0.7 V
A_{0} = 5.3 mm^{2}	A_{coll} = 5.3 mm^{2}	A_{coll} = 5.3 mm^{2}
l_{p} = 12 mm	l_{p} = 0 mm	
ΔI/ΔV (−300 V) = −38 μA/V		ΔI/ΔV = −36 ± 4 μA/V
χred2 = 0.74	χred2 = 1.23	χred2 = 0.75
TABLE II. -body
Perimeter method (red)	4-parameter fit [18] (dashed cyan)
J_{sat} = 8745 ± 400 A/m^{2}	J_{sat} = 21 050 ± 670 A/m^{2}
I_{sat} = 46 ± 2 mA	I_{sat} = 110 ± 4 mA
T_{e} = 6.3 ± 0.4 eV	T_{e} = 8.7 ± 0.4 eV
V_{f} = −2.5 ± 0.9 V	V_{f} = −1.8 ± 0.4 V
A_{0} = 5.3 mm^{2}	A_{coll} = 5.3 mm^{2}
l_{p} = 12 mm	ΔI/ΔV = 285 ± 20 μA/V
χred2 = 1.96	χred2 = 0.96
TABLE III. -body
	Standard Langmuir Eq. (1)	4-parameter fit [18]
Perimeter method (red)	(dashed cyan)	(dotted-dashed blue)
J_{sat} = 19 040 ± 330 A/m^{2}	J_{sat} = 27 070 ± 440 A/m^{2}	J_{sat} = 15 600 ± 1500 A/m^{2}
I_{sat} = 100 ± 2 mA	I_{sat} = 140 ± 2 mA	I_{sat} = 82 ± 8 mA
T_{e} = 72 ± 1 eV	T_{e} = 81 ± 1 eV	T_{e} = 65 ± 2 eV
V_{f} = −110 ± 1 V	V_{f} = −110 ± 1 V	V_{f} = −109 ± 1 V
A_{0} = 5.3 mm^{2}	A_{coll} = 5.3 mm^{2}	A_{coll} = 5.3 mm^{2}
l_{p} = 12 mm	l_{p} = 0 mm	
ΔI/ΔV (−300 V) = −211 μA/V		ΔI/ΔV = −303 ± 54 μA/V
χred2 = 0.68	χred2 = 0.69	χred2 = 0.64
TABLE IV. -body
Perimeter method (red)	Standard double Eq. (13) (dashed cyan)
J_{sat} = 7035 ± 99 A/m^{2}	J_{sat} = 12,290 ± 250 A/m^{2}
I_{sat} = 62 ± 1 mA	I_{sat} = 110 ± 2 mA
n_{e} = 1.18 ± 0.1 × 10^{18} m^{−3}	n_{e} = 1.8 ± 0.1 × 10^{18} m^{−3}
T_{e} = 57 ± 3 eV	T_{e} = 76 ± 3 eV
V_{off} = −3.4 ± 3.2 V	V_{off} = −3.2 ± 3.2 V
I_{off} = −17 ± 2 mA	I_{off} = −17 ± 2 A
A_{0} = 8.84 mm^{2}	A_{0} = 8.84 mm^{2}
l_{p} = 19 mm	l_{p} = 0 mm
FIG. 1. 
A poloidal cross section of the TCV tokamak (left) showing the magnetic geometry and the location of the reciprocating probe. The insets (right) show the reciprocating probe head geometry. The graphite electrodes extend out of a boron nitride insulator (in white) which is held in place and protected by a graphite shroud. The Mach probe array is shaded red, and the double probe array is shaded teal.
FIG. 2. 
A diagram of the effective collection areas defined for (a) the strongly magnetized case and (b) the weakly magnetized case. The collection areas are expanded by the thickness of the Debye sheath l_{sh} = 0.25 mm.
FIG. 3. 
(a) An I-V fitting with no smoothing applied. The perimeter method fit is shown by the red line, where the dotted red line represents the same parameters with l_{p} = 0. The standard Langmuir fit is shown by the cyan dashed line, and the 4-parameter fit is shown by the dotted-dashed blue line. The collection area A_{coll} from the perimeter method is shown (b) as a sum of the electrode area A_{0} (dotted line) and the additional collection area of the sheath.
FIG. 4. 
(a) Position of the electrode is shown as time vs. the distance between the electrode and the Last Closed Flux Surface (LCFS) mapped to the outer midplane (R-R_{LCFS}). Fits to the I-V curves using the perimeter method (black diamonds) and the 4-parameter fit (red squares) produce profiles of T_{e} (b) and j_{sat} (c). Linear functions (I = aV + b) were fitted to the residuals from the perimeter method with the slopes plotted in (d). The ΔI/ΔV slopes are compared in (e), where the squares represent the 4-parameter fits, the black diamonds show ΔI/ΔV due to sheath expansion from the perimeter method at −300 V, and the cyan triangles show the total ΔI/ΔV including the contribution from the exponential term in Eq. (1). The red “x”s show the positive values of ΔI/ΔV from rejected 4-parameter fits. The χred2 values are shown in (f), with a rejection cutoff of 1.5. Rejected points are not shown in the other subplots.
FIG. 5. 
An I-V trace from a highly turbulent plasma where a density hole passes over the electrode. The fits from the perimeter method (solid red) and the 4-parameter fit [18] (cyan dashed line) are shown. The rule on the left marks off 1σ intervals calculated from the residuals of the previous two and subsequent two I-V characteristics.
FIG. 6. 
An example I-V fitting (a) taken from inside the LCFS of TCV with no smoothing applied. The perimeter method fit is shown in solid red, where the red dotted line represents the same parameters with l_{p} = 0. The standard Langmuir fit is shown by the cyan dashed line, and the 4-parameter fit is shown by the dotted-dashed blue line. The collection area A_{coll} from the perimeter method (b) is shown as a sum of the electrode area A_{0} (dotted line) and the additional collection area of the sheath as a function of bias voltage.
FIG. 7. 
The profiles in T_{e} (a) and j_{sat} (b) comparing the results from the standard Langmuir fits (blue circles) and the perimeter method fits (black diamonds).
FIG. 8. 
An I-V trace (a) from a double-probe close to the LCFS in the edge of the TCV plasma. The perimeter method fit is shown in solid red, and the red dotted line represents the same parameters without sheath expansion. The standard I-V fit is shown in dashed cyan. The collection area from the perimeter method (b) is 30% larger than A_{0} when V = V_{off} and 70% larger when V = 300 V.

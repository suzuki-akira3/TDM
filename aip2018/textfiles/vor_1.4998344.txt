Multi-objective particle swarm optimization of component size and long-term operation of hybrid energy systems under multiple uncertainties
In real-world operation conditions, Hybrid Energy Systems (HESs) are exposed to a wide variety of uncertainties, which cause an unexpected operation and performance in the case of neglecting the effects of uncertainties in design and operation processes. This paper presents a multi-objective optimization of the component size and long-term operation of the HES in the presence of multiple uncertainties, considering the Net Present Cost and Energy Not Served as the objective functions. Uncertainties related to load forecasting, wind speed, and components' outage are probabilistically modeled and incorporated into the Multi-Objective Particle Swarm Optimization approach using the Monte Carlo Simulation (MCS) method. MCS generates samples (future scenarios) of uncertain variables based on the probabilistic models of the uncertainties. The optimization algorithm determines the optimal values of component's size as well as the operation parameters to efficiently optimize the HES operation. The applicability and effectiveness of the proposed method are investigated through some numerical analyses. The proposed method can be a useful stochastic optimization tool to consider important uncertainties in the practical design and operation of the HES.
I. INTRODUCTION
Electricity is essential to achieve a sustainable human development in remote rural areas. Standalone Hybrid Energy Systems (HESs) compete with existing alternatives such as grid extension and diesel-only systems to supply energy demands of remote areas. Both reliability and economics play important roles in this competition. Therefore, optimal design of the HES is essential to achieve reliable and cost-effective configurations. Considerable research has been conducted on the single objective or multi-objective optimization of the HES [1]. Different approaches have been utilized in the literature to solve single objective optimization problems of the HES. In Refs [2] and  [3], the authors have proposed optimization approaches based on the PSO algorithm to achieve the optimal design and operation strategy of the HES.
Optimization of the HES with multiple objectives such as cost and reliability gives a set of non-dominated configurations of the HES, which helps to reach a compromise between conflicting objective functions. There are some studies in multi-objective optimization of HESs considering different objective functions using various optimization approaches. Pelet et_al have proposed a multi-objective evolutionary algorithm for optimizing the cost and CO_{2} emissions of the HES in a remote community in the Tunisian Sahara [4]. Genetic algorithm has been used to optimize the size of the components and control strategies of the HES in Refs [5–7]. A multi-objective optimization method using an advanced ε-constraint approach based on Hammersley Sequence Sampling has been presented in Ref [8] to optimize cost, electricity efficiency, and energy supply reliability of a wind, solar, and fuel cell hybrid system. A multi-objective PSO algorithm has been utilized in Ref [9] to find the optimal system configuration and the optimal component size of a hybrid micro-grid system consisting of photovoltaic (PV) panels, wind turbines, diesel generators, and battery storage.
The aforementioned references have focused on the deterministic optimization of the HES without considering uncertainties involved in the problem. The amount of energy produced by renewable resources is an uncertain quantity due to their intermittent nature. In addition, random variations in electricity demand as well as random outages of the system components are other sources of uncertainty. Therefore, investigating the effects of uncertainties is crucial in the case of design and operation of autonomous HESs.
Some researchers have used analytical approaches to incorporate uncertainties in the HES design and operation processes. A probabilistic approach, based on the convolution technique, has been introduced to incorporate the fluctuating nature of renewable resources and electrical loads in Refs [10] and  [11].
Uncertainties related to wind speed, solar radiation, load fluctuations, and components' outage have been considered in Ref [12] using an analytical approach. It divides the generating system into a subsystem that includes the conventional units and a set of subsystems each of which contains a fluctuating unconventional power source. However, analytical approaches only consider the Probability Distribution Functions (PDFs) assigned to renewable energy variations and neglect other statistical characteristics, which may create important errors in uncertainty analysis [13]. Statistical characteristics such as diurnal profiles of the renewable energies and autocorrelation between their consecutive observations can be incorporated using the Monte Carlo Simulation (MCS) approach [13]. They have modeled uncertainties related to the wind speed and electrical load using autoregressive moving average (ARMA) models for stochastic optimization of a wind/battery hybrid system [13]. In Ref [14], a model combining Fourier series and ARMA has been proposed to generate synthetic wind speed data. To perform probabilistic analysis of a HES, a Fourier series has been used to characterize the seasonal trend in historical wind data, while ARMA has been used to capture the autocorrelation in residual time series of wind data. A grid-connected PV/fuel cell/battery HES has been employed in Ref [15] to supply electrical and thermal loads considering the load uncertainty. The authors have used the information gap decision theory technique to model the electrical load uncertainty.
A stochastic approach using MCS has been used to consider the uncertainties of irradiation and electrical loads in Refs [16] and  [17]. In Refs [18] and  [19], a design space approach has been utilized to optimally design a wind/battery system in which the hourly wind speed is treated as a Weibull random variable, while MCS has been used to validate the reliability estimated by the model.
MCS has also been used to perform sensitivity analyses on various parameters of the HES in Ref [20]. A stochastic simulated annealing method, which employs MCS, has been used in Ref [21] to minimize the cost of the HES. References  [22] and  [23] have considered several scenarios for uncertain variables using their PDF and run an optimization algorithm for each scenario to attain probability distributions of the objective functions. The authors in Ref [24] have utilized the PSO algorithm to maximize the net present worth of a wind farm, while MCS has used to model wind speed uncertainties. In Ref [25], multi-objective optimization of a Wind/PV/battery hybrid system has been presented using the NSGA-II algorithm. A method based on the Chance Constrained Programming (CCP) and MCS has been proposed in which the uncertainties are related to wind speed and solar irradiance [25].
However, most of the mentioned works have not considered diurnal profiles and/or autocorrelations assigned to renewable energy variations in their uncertainty models. In addition, outages of the system components have not been considered in the previous studies, while they are investigated in the current paper. Furthermore, the impact of load growth on the HES design and operation has not been considered in the previous studies. Load growth is investigated in this paper to ensure acceptable reliability in practical applications, where the electrical demand increases over time. Another contribution of the current study which could be mentioned is that the proposed scheme supplies the electrical and thermal demands of remote areas, while the previous studies have only focused on serving electrical loads.
The objective of the current paper is to achieve optimal design and operation of the HES at a minimum Net Present Cost (NPC) and ENS in the presence of uncertainties subject to physical and practical constraints. A two-stage multi-objective optimization method is proposed to determine optimal solutions of the HES in the presence of uncertainties associated with the load forecasting, wind speed fluctuations, and components' outage. The primary stage of the algorithm includes a Multi-Objective Particle Swarm Optimization (MOPSO) approach, and the secondary stage incorporates the uncertainties into the optimization process to achieve optimal Pareto curves in an uncertain environment. Uncertainties are probabilistically modeled, and future scenarios of uncertain parameters are generated via the MCS method using these models. In order to decrease the execution time of the proposed method, a scenario reduction technique is used to reduce the number of future scenarios.
Numerical studies were conducted—using the load profile and wind speed data of an area in the eastern part of Iran—on a wind/diesel/battery hybrid system to demonstrate the applicability and effectiveness of the proposed method. Sensitivity analyses are also carried out on the fuel price, load growth, and other uncertainty parameters to investigate their impacts on the optimization results. In addition, using the MCS method, various uncertain conditions are implemented to the solutions obtained from the proposed approach to verify their robustness against uncertainties.
II. HYBRID ENERGY SYSTEM MODELING PROCEDURE
In this section, the modeling procedure of the HES components is briefly described. Figure 1 shows the schematic of the HES investigated in this paper.
A. Wind turbine
The output power of a wind turbine is a nonlinear function of the wind speed given by the power curve. Figure 2 depicts the normalized power curve of the Atlantic Orient AOC 15/50 wind turbine utilized in the current study [26].
B. Diesel generator
The fuel consumption characteristics of a diesel generator can be assumed as a linear function of its output power, which is expressed in in the following equation [27]:
where Pgt is the output power of the diesel generator, which is obtained using the following equation:
where Pct is the converter's output power that is positive in the inverter mode and negative in the rectifier mode.
C. Battery bank
The Kinetic Battery Model (KiBaM) has been used in this study. It considers the battery as a system containing available and bound energies [28]. The available energy Q1t is immediately available to be used, and the bound energy Q2t is chemically limited. The following equation gives the State of Charge (SOC) of the battery:
where P_{b,r} represents the rated capacity of the battery bank (kWh). Pbt is the battery power; it is negative when charging and positive when discharging. The rate constant, k, is the rate at which the bound energy becomes available. The capacity ratio, c, is the ratio of available energy to total battery capacity. Parameters k and c can be obtained from the manufacturer's data [29]. At each time step, the operation strategy determines the amount of battery power, which should be limited by its maximum value as follows:
where CI is the charge indicator, which is −1 or 0 for charge or discharge modes, respectively.
The Ah-throughput method is used to estimate the battery lifetime [30]. It assumes that a fixed amount of energy, designated as the lifetime throughput, can be cycled through a battery before its replacement. In addition, the battery model considers the battery float life in its lifetime estimation.
D. Power converter
It is assumed that the converter has a constant no load loss and a loss proportional to the converted power [31]. The following equation gives the converter efficiency ηct as a function of its output power:
E. Heat recovery system
Thermal loads can be supplied using the recovered thermal energy from the dump load as well as the exhaust gases and cooling water of the diesel generator. In generators with reciprocating engines, 49% of input energy of the fuel can be approximately recovered in the form of thermal energy [32]. In addition, a dump load (a bank of resistors) absorbs surplus energy produced by renewable power resources to avoid instability and converts it into useful thermal energy. The efficiency of the conversion is assumed to be 90%.
F. The proposed power management strategy
The entire operation period of the HES is divided into equal time steps, and the power management strategy is consecutively run for all time steps. We developed an operation strategy that employs control set points and other system parameters to select the most cost-effective dispatch strategy at each time step. Dispatch strategies are rules that control the energy flow among components of the hybrid system. The following dispatch strategies have been proposed in Ref [33].
1. Battery charging: When renewable power exceeds the load, the surplus energy charges the battery.
2. Battery discharging: When renewable power is less than the load, the difference is defined as the net load. In this strategy, the battery discharges to meet the net load.
3. Load following: The diesel generator produces enough power to serve the net load, but it does not charge the battery; however, renewable resources can charge it.
4. Cycle charging: The diesel generator not only serves the net load but also charges the battery as much as possible.
5. Peak-shaving: Whenever the diesel generator cannot meet the net load alone, it operates at full power, and the battery serves the remaining load.
The operation strategy considers component ratings, minimum loading of the diesel generator, minimum battery SOC, and maximum battery charge and discharge powers to manage power flow among components. It utilizes renewable resources as much as possible to serve the load and, if necessary, chooses an economical combination of dispatchable power sources—battery and diesel generator—using the critical discharge load (L_{d}). As can be seen in Fig. 3, L_{d} is the net load at which the marginal cost of the battery is equal to the sum of fixed and marginal costs of the generator. Therefore, the generator is preferred if netload > L_{d}; otherwise, the battery is chosen. The following equation gives the critical discharge load:
where C_{g,fix} ($/h) and C_{g,mar} ($/kWh) are the fixed and marginal costs of the generator, respectively [34]
In Eq. (8), C_{bw} ($/kWh) is the cost of battery lifetime reduction because of cycling energy—which is named the battery wear cost [34]—and C_{be} represents the energy cost of the battery at time step t ($/kWh). The battery marginal cost is the sum of its wear and energy costs.
In the charging mode, the battery energy cost can be calculated from Eq. (12). In the discharging mode, the energy cost remains unchanged.
The following control set points are integrated into the proposed power management strategy. The optimization algorithm searches for optimal values of the control set points to achieve an optimal power management strategy.
• Diesel starting threshold,P_{trs,g}: Once the diesel generator is off and both the renewable and battery powers are unable to meet the load, it may be more economical to keep the generator off and accept some unmet loads as long as the unmet load is less than P_{trs,g}.
• Battery maximum SOC,soc_{max}: The charge controller prevents the diesel generator to charge the battery when soc^{t}≥soc_{max}.
• SOC threshold,soc_{trs}: The control system prevents the battery from supplying electrical loads when soc^{t}<soc_{trs}. In this case, the generator meets the load even if the battery is more economical than the generator.
• SOC set point,soc_{sp}: This set point is used as a criterion to choose the cycle charging or load following strategies [35]. If soc^{t}>soc_{sp}, the load following is selected; otherwise, cycle charging will be employed.
At each time step, the highest priority to supply the electrical load is given to renewable power resources, and surplus energy from the renewables (if any) is used to charge the battery and/or serve the dump load. If renewable power resources are unable to meet the load, the remaining load, namely, the net load, is met by employing the battery or diesel generator. The cost per kilowatt-hour of the energies supplied by the battery and the diesel generator is used as a criterion to choose the most cost-effective option, either the battery or the diesel generator.
During peak hours, when the diesel generator or the battery cannot meet the net load, dispatching both of them may cover the net load. In this situation, the diesel generator is run at its rated power and the battery is dispatched to meet the net load. Finally, if the renewable power resources, diesel generator, and the battery cannot meet the load, the amount of unmet energy is estimated.
III. PROBLEM STATEMENT
In this study, the HES has been optimized in the presence of multiple uncertainties using a proposed multi-objective optimization procedure to simultaneously minimize the cost and reliability objective functions. The aforementioned objective functions are affected by both the components' size and the power management strategy of the HES. Hence, to effectively minimize the objective functions, the proposed optimization scheme optimizes the HES from both unit-sizing and power management strategy points of view. In this study, it is assumed that the HES is designed and optimized to supply the growing demands of the study area during an optimization horizon. The optimization horizon is considered to be five years, and the HES can be upgraded after this period if necessary.
The following decision variables are included in the proposed optimization procedure as expressed in the following equation:
• Components' size: Four decision variables (the first four elements of vector X) are dedicated to the sizes of the wind turbine, diesel generator, power converter, and battery bank to achieve an optimal unit-sizing scheme.
• Control set points: Another four decision variables (the last four elements of vector X) are dedicated to the control set points, which were described in Sec. II F. The optimization algorithm sets them to appropriate values to attain an optimal power management strategy.
It deserves to mention that the designer of the HES can utilize the proposed method to determine optimal values of the components' size and control set points. Once the HES starts operating, an online optimization method can be utilized to perform further modifications to the control set points to compensate impacts of various uncertainties on the HES operation.
A. Objective functions
The Net Present Cost (NPC) of the HES during the optimization horizon is considered as the first objective function. The following equation gives the cost function:
It is assumed that the salvage worth of component m is proportional to the percentage of its remaining lifetime RL_{m} at the end of the optimization horizon.
In addition, the Loss of Energy Expectation (LOEE) of the HES over the optimization horizon is considered as the second objective function, which is expressed by the following equation:
B. Constraints
To satisfy the physical and practical limitations, each decision variable must satisfy the following inequality constraint:
where xdmin and xdmax are lower and upper limits of the d-th decision variable. The lower and upper limits on the decision variables are given in Table I.
IV. PROBABILISTIC MODELS OF THE UNCERTAINTIES
Uncertainties related to load forecasting, wind speed variations, and components' outage have been modeled in the current paper as follows:
A. Uncertainty in load forecasting
The uncertainty in load forecasting is modeled in three levels:
• Uncertainty in the hourly load data is modeled by applying a random noise with normal distribution N(0,α_{1}) to the load of each hour. It disturbs the shape of the hourly load profile without changing its average value [36].
• The average load of each day is scaled upwards or downwards using a random noise with normal distribution N(0,α_{2}). It does not affect the shape of the hourly load profile [36].
• Uncertainty in annual load growth is modeled by applying a random noise with normal distribution N(0,α_{3}) to the peak load of each year.
Parameters α_{1}, α_{2}, and α_{3} are uncertainties related to the fluctuations of hourly, daily, and annual peak loads, respectively. Figure 4 depicts the forecasted and synthetic loads in the first week of July.
B. Wind speed uncertainty modeling
Statistical characteristics of historical wind data are used to probabilistically synthesize wind speed scenarios, which are utilized to incorporate the wind speed uncertainty into the proposed approach via the MCS method. The following steps are considered in the wind speed uncertainty model:
Step 1. A sequence of 8760 autocorrelated numbers is generated for one year using an autoregressive model as follows:
where A_{1} is the autocorrelation factor of historical wind data at a lag of 1 and β^{t} is a white noise with normal probability distribution N(0,1).
Step 2. The diurnal profile of historical wind data is obtained from averaging wind speed of each hour of the day over the entire year. The following equation is fitted to the obtained profile (Fig. 5) to calculate coefficients D_{s} and D_{h} [36]:
where D_{s} shows the dependence of wind speed data on the time of day and D_{h} represents the hour of day with the maximum wind speed. V_{w}¯ is the average of historical wind speeds.
Step 3. Monthly average wind speeds are probabilistically generated using the same Weibull probability distribution as historical data. A time series for the wind speed of a month is generated using Eq. (18) by substituting V_{w}¯ with the generated monthly average wind speed. Then, using a probability transformation, the obtained time series for the entire year is transformed to the same normal distribution as the sequence generated in step 1.
Step 5. The sum of time series generated in steps 1 and 3 is transformed to a time series with the same Weibull distribution as the historical wind speed data.
The synthetic wind data have similar autocorrelation, diurnal profile, and Weibull distribution as the historical wind data, as shown in Fig. 6.
C. Components' outage modeling
Outages of the system components are one of the uncertainties involved in HES operation. Uncertainties related to failures of the diesel generator, wind turbine, and power converter are considered in the current study. Due to no moving parts and indoor installation, the battery is expected to have a negligible failure rate. Therefore, failures of the battery bank have not been considered in this paper. Each component is represented by a two-state Markov model. The up state denotes the healthy mode of the component, and the down state means its failure. It is assumed that the component cannot operate in derated states. This section aims to probabilistically determine the time to failure TTF and time to repair TTR of each component. The following equations express TTF and TTR of components, respectively [37]:
where U_{1} and U_{2} are random numbers in the range of (0,1). λ and μ are the failure and repair rate, respectively. A sequence of operating-repair cycles is deduced for each component by sequentially sampling TTF and TTR values. Then, these sequences are incorporated into the power management algorithm of the HES to simulate the outages of components similar to those of the real world.
D. MCS and scenario reduction technique
At each iteration of the MCS, future scenarios for the load, wind speed, and components' outage are generated based on the above-mentioned uncertainty models. In the MCS method, the higher number of generated scenarios leads to better modeling of uncertainties, but at the cost of higher computation time. To overcome this issue, a scenario reduction technique has been used to decrease the number of scenarios, while keeping the stochastic characteristic of the uncertainties as much as possible. First, a large set of uncertain scenarios are generated, and their corresponding objective functions are obtained by running the power management strategy of the HES for all scenarios. Then, the scenario reduction technique assigns higher probabilities of being removed to scenarios in which their corresponding objective functions are very close to each other. It continues removing unnecessary scenarios, according to the assigned probability, until the desired number of scenarios is reached.
V. THE PROPOSED PROBABILISTIC MOPSO PROCEDURE
Optimization of the HES with multiple objectives such as cost and reliability achieves a Pareto curve or a set of non-dominated configurations of the HES, which helps the decision-maker to make a rational decision based on the requirements of the study case. In this paper, a two-stage multi-objective optimization algorithm is proposed to optimize the HES in an uncertain environment. The proposed algorithm leads to a Pareto curve, which is optimal in the presence of multiple uncertainties. The primary stage of the algorithm includes a multi-objective version of PSO introduced in Ref [38]. PSO has been successfully applied in many research and application areas. Reference  [39] provides a comprehensive overview of PSO and its applications in power systems and discusses its advantages over the other optimization methods. The secondary stage of the algorithm is a MCS procedure embedded in the primary algorithm to incorporate the stochastic nature of uncertainties into the optimization process.
A. The primary optimization algorithm
The MOPSO algorithm aims to converge to true Pareto-optimal solutions in a way that the constraints are satisfied, and non-dominated solutions are uniformly distributed over the Pareto curve. The MOPSO algorithm maintains a population of particles, where the position vector of each particle in the search space represents the vector of decision variables [Eq. (13)]. In other words, each particle represents a potential solution associated with the components' size and control set points of the HES.
At each iteration, particles move in the search space to explore non-dominated solutions, which are stored in a repository. The h-th member of the repository at iteration k is shown by Rep^{k}(h). At subsequent iterations, new non-dominated solutions are compared with the solutions previously stored in the repository. Then, dominated solutions in the repository are eliminated, and new non-dominated ones are added to the repository. Whenever the repository gets full, solutions located in highly populated regions of the Pareto curve are given a higher probability of being eliminated from the repository. A roulette-wheel selection is used to eliminate some solutions from the repository, which will be replaced with new non-dominated solutions to achieve a well-distributed Pareto curve [38]. At iteration k of the MOPSO algorithm, each particle i updates its velocity and position vectors using the following equations [38]:
where parameter h is selected in a way that the solutions located in less densely populated regions of the Pareto curve are given higher probabilities of being selected, which leads to a well-distributed Pareto curve [38]. Parameter χ is the constriction factor, which limits the velocity of particles to the following equation [39]:
To avoid premature convergence to local minima, a mutation operator is used [38]. It affects all particles at the beginning, while the number of affected particles is rapidly decreased in the subsequent iterations. Figure 7 (left) depicts the flowchart of the proposed primary optimization algorithm.
The following steps are considered in the primary stage of the algorithm:
Step 1. Initialize the particles with random position vectors. All particles must satisfy constraints according to Eq. (16). Set the initial velocity of the particles as zero. For each particle i, set Pbesti1 as the initial position of particle i (Xi1),run the secondary stage of the algorithm [as shown in Fig. 7 (Right)], and consider the obtained objective functions as fitness values of each particle. Compare all particles and store non-dominated particles in the repository.
Repeat steps 2–6 until the maximum number of iterations is being reached:
Step 2. Update the velocity and the position of each particle according to Eqs. (21) and (22), respectively.
Step 3. Check the constraints for new particles to maintain the particles within the search space. If the particles go beyond their boundaries, the decision variable takes the value of its corresponding boundary (either the lower or the upper boundary) and its velocity is multiplied by (−1) so that it searches in the opposite direction.
Step 4. Evaluate the fitness values of the new particles using the secondary stage of the proposed algorithm.
Step 5. Update Pbest as follows: For each particle i, compare Pbestik−1 and Xik and set the value of Pbestik to the non-dominated one. If none of them dominates the other, set the value of Pbestik to a randomly selected value between Pbestik−1 and Xik.
Step 6. Update the repository to store the non-dominated particles as discussed before.
B. The secondary MCS algorithm
At each iteration of the primary optimization algorithm and for each particle, the MCS algorithm is run to generate objective functions' values corresponding to the uncertain scenarios. In other words, we obtained a set of objective functions' values for each particle, which reflects the effects of the uncertainties. In this paper, the following approaches are proposed to dedicate fitness values to each particle, based on its objective functions' values corresponding to the uncertain scenarios. Particles of the swarm are compared with each other using their dedicated fitness values to determine non-dominated particles in the presence of uncertainties. Figure 7 (right) shows the flowchart of the secondary MCS algorithm.
1. Average-best approach
In this proposed approach, for each particle, each objective function is averaged over the entire set of objective functions' values corresponding to the uncertain scenarios, and the average values are used as the fitness criteria of that particle to determine non-dominated (the best) particles. In other words, in an uncertain environment, particles are compared with each other considering the most likely uncertain conditions. Figure 8 shows a set of objective functions and their PDF obtained by running the MCS algorithm for 1000 uncertain scenarios. As can be seen in this figure, the objective functions' values have approximately a normal probability distribution. Consequently, the average values of the objective functions represent the most likely uncertain conditions.
2. The worst-best approach
In this proposed approach, the objective functions' values of the worst uncertain scenario among the entire set of scenarios are considered as the fitness values of each particle. In other words, particles are compared with each other in the worst uncertainty conditions, and particles with the best values of objective functions in the worst uncertain scenario are identified as non-dominated particles. This approach achieves solutions with higher robustness against uncertainties at the cost of higher NPC. To determine the worst uncertain scenarios, the objective functions' values corresponding to each scenario are compared with those associated with the other scenarios, and scenarios with the highest objective functions' values are selected as the worst scenarios. Then, the values of objective functions corresponding to a randomly selected scenario among the worst scenarios are considered as the fitness values assigned to each particle. Figure 8 depicts the worst scenarios among 1000 uncertain scenarios.
VI. STUDY RESULTS
The proposed simulation and optimization algorithms have been implemented in MATLAB. A 1-h time step is used to simulate the wind/diesel/battery system. Table II summarizes specifications of the HES [36].
The study area is a rural district in the eastern part of Iran (latitude: 32°47′, longitude: 58°47′, and altitude: 1000 m). Monthly load data are estimated for the study area with a peak of 149 kW, which are shown in Fig. 8. Then, the hourly load data are estimated using typical daily load profiles for each month. Historical wind data are available for the study area as depicted in Fig. 9 [40]. Moreover, the monthly averaged wind speed data of the study area over 15 years are used to model wind speed uncertainties (Sec. IV B). The annual load growth is also estimated to be around 4%.
A. Deterministic optimization results
The MOPSO parameters have been experimentally determined. The population size, repository size, and the maximum number of iterations have been set to 100, 80, and 300, respectively. The mutation rate has been selected to be 0.5, and c1 and c2 have been set to 2.05.
Figure 10 shows the hourly power management of the HES on July 6. Charge and discharge powers of the battery are illustrated as negative and positive values, respectively. Clearly, the battery is charged when the wind power is greater than the load, whereas the diesel generator operates when there is a shortage of the wind power (8–20 h). During hours 3, 6, and 7, using the battery has been preferred to the diesel generator when the battery is more economical than the generator. Despite running the generator at full power and dispatching the battery, there are some unmet loads at hour 19.
Figure 11 depicts the optimization results of the HES for various load growth and fuel prices. It can be seen that the NPC of the system increases as the load growth and fuel price increase. Additionally, the NPC is more sensitive to the fuel price variations than load growth variations.
Table III shows the optimization results of the base case (load growth 4% and fuel price 0.4 $) for the selected solutions of the Pareto curve. It is clear that as LOEE decreases, components' sizes increase, whereas the efficiency of the diesel generator decreases. The underlying reason is that in solutions with lower LOEE values, larger components' sizes are needed to cover the required reliability level. Furthermore, to keep the LOEE value below the required level, running the diesel generator at low efficiencies may be necessary to avoid load curtailments.
Table III also shows the annual average thermal energy acquired from recovering the waste heat of the diesel generator and dump load. The last column of Table III shows the overall Combined Heat and Power (CHP) efficiency of the HES. The optimized CHP system achieves more than 79% efficiency, which reveals efficient utilization of the energy resources.
B. Probabilistic optimization results
In this section, optimization results of the HES in the presence of multiple uncertainties—using the proposed approaches, average-best and worst-best—are presented and compared with those of the conventional deterministic method.
As previously mentioned, the uncertainties related to the load forecasting, wind speed variations, and components' outage have been considered in the proposed model. In addition, the outages of the wind turbine, diesel generator, and power converter have been taken into consideration. Table IV shows failure and repair rates of the HES components. The uncertainty parameters of load forecasting, e.g., α1, α2, and α3 (Sec. IV A) are assumed to be 5%. In order to attain appropriate uncertain scenarios, 5000 scenarios are generated using the uncertainty models. Then, the scenario reduction technique is used to select 300 scenarios while preserving the stochastic characteristics of the uncertainties.
Figure 12 depicts the optimization results of the HES using the proposed average-best and worst-best approaches. It can be seen that the optimization results of the probabilistic approaches lead to higher NPC compared to the results obtained from the deterministic method. Furthermore, as expected, the worst-best approach leads to higher NPC than the average-best approach. The reason is that the worst-best approach optimizes the HES under the worst uncertain conditions, leading to solutions with larger components' size to guarantee the required level of reliability, which incurs higher NPC. Obviously, in solutions with LOEE ≤ 1%, the NPC value obtained from the proposed probabilistic methods is much higher than that obtained from the deterministic method. The reason is that in solutions with lower LOEE values, the HES operation is very sensitive to the components' outages and fluctuations in the electrical load and wind turbine power. Therefore, the proposed probabilistic approaches consider larger components' size to compensate these fluctuations, leading to higher NPC values.
Figure 13 shows the optimum size of the HES components at various LOEE values attained by the deterministic and proposed optimization approaches. For each LOEE value, the distance between the sizes of each component in the deterministic and probabilistic Pareto curves indicates the required capacity reserve of that component to maintain the desired level of reliability in uncertain environments. In other words, the proposed average-best and worst-best approaches optimally allocate required capacity reserve to each component of the HES to maintain the system reliability in the presence of uncertainties. In addition, for each component, a larger size has been selected in the worst-best approach compared to the components' size, which is recommended by the average-best approach. The underlying reason is that in the worst-best approach, more capacity reserve is required for each component to guarantee that the desired level of reliability is preserved even if the worst uncertain conditions occur. As a result, the worst-best approach allocates higher capacity reserve to the system components, which leads to robust configurations of the HES against multiple uncertainties.
Figure 14 shows the optimum control set points at various LOEE values. As can be seen, the optimum values of the control set points are approximately constant in various LOEE values.
C. Sensitivity analysis on the uncertainty parameters
A sensitivity analysis is conducted on the uncertainty parameters to investigate their impacts on the optimization results of the proposed average-best and worst-best approaches. In this regard, a high uncertain condition is assumed by considering the following uncertainty parameters. The load forecasting uncertainty parameters (α_{1}, α_{2}, and α_{3}) are considered to be 15%. In addition, the failure and repair rates of the wind turbine, diesel generator, and power converter (given in Table IV) are multiplied by 3. Finally, to model high uncertain conditions for the wind speed variations, the shape parameter of the Weibull distribution of wind speed is divided by 2. It leads to a broader range of variations of the synthesized wind speed and consequently increases the uncertainty [36].
Figure 15 compares the optimization results of the HES under the high uncertainties with those previously obtained in the normal uncertain condition. The acquired Pareto curves demonstrate that in both approaches, average-best, and worst-best, high uncertainties lead to higher NPC compared to the normal uncertainties. Under high uncertainties, the proposed approaches allocate more capacity reserve to the components to maintain the reliability of the system.
Optimal sizes of the HES components under high and normal uncertain conditions are depicted in Fig. 16. Obviously, the proposed probabilistic approaches, average-best and worst-best, have allocated more capacity reserve in the case of high uncertainties compared to the allocated reserve associated with the normal uncertainties to ensure maintaining the required level of reliability. It can be concluded that deterministic optimization approaches, particularly in the case of high uncertain conditions, cannot guarantee the required level of reliability. Hence, appropriate methods, which consider uncertainties in the optimization process of the HES, would be essential.
VII. CONCLUSION
This paper presents a two-stage multi-objective optimization method to optimize the HES in the presence of uncertainties associated with the load forecasting, wind speed, and components' outage. The proposed optimization algorithm minimizes the NPC and LOEE objective functions, while it maintains the physical constraints of the HES components.
The primary stage of the proposed method includes a multi-objective version of the PSO, whereas the secondary algorithm incorporates the uncertainties into the optimization process to attain an optimal Pareto curve in an uncertain environment. Two procedures, average-best and worst-best, are proposed for incorporating uncertainties into the proposed optimization algorithm. Uncertain parameters and components' outage are probabilistically modeled, and their future scenarios are generated via the MCS method. In order to decrease the execution time of the proposed method, a scenario reduction technique is used to reduce the number of future scenarios.
Numerical studies were conducted on a wind/diesel/battery system to show the effectiveness of the proposed method. The results presented verify that the proposed two-stage optimization approach could be utilized in practical applications as an appropriate method to achieve optimal solutions of the HES in the presence of multiple uncertainties. The average-best approach optimizes the HES under the most likely uncertain conditions, while in the worst-best approach, the worst uncertain conditions are considered in the optimization process. In addition, the proposed average-best and worst-best approaches are capable of optimally determining the required capacity reserve of each component to maintain the system reliability in the presence of uncertainties. From the results presented, it can be concluded that in order to achieve optimum solutions of the HES with acceptable reliability in practical conditions, uncertainties should be included in the optimization process.
In this study, it is assumed that the HES is designed and optimized to supply the growing demands of the study area during an optimization horizon (5 years). Due to load growth, the HES may need to be upgraded after this period, which can be considered in future works. This model can also be extended to consider more components such as PV panels, fuel cells, and hydrogen backup and to incorporate their related uncertainties to the model. Moreover, other objective functions like environmental emissions can be taken into account.
The present study focuses on an off-grid HES to supply electrical and thermal demands of a remote area, while grid-connected HESs can be studied in future works. MCS and MOPSO have been used in the proposed two-stage algorithm, while other uncertainty modelling tools like fuzzy logic and other optimization methods like genetic algorithm can be applied instead, and the outcomes can be compared with the results obtained in this work. As another future work, the proposed method can be applied to a micro-grid, where its components are distributed in an area. In this case, other constraints are needed to keep the power flows and bus voltages within acceptable limits.
TABLE I. 
Lower and upper limits on the decision variables.
TABLE II. 
Techno-economic data of the HES.
TABLE III. 
Deterministic optimization results for the selected solutions.
TABLE IV. 
Failure and repair rates of the components.
TABLE I. -body
	P_{w,r}	P_{g,r}	P_{c,r}	P_{b,r}	P_{trs,g}	soc_{max}	soc_{sp}	soc_{trs}
Decision variable	(kW)	(kW)	(kW)	(kWh)	(kW)	(%)	(%)	(%)
Lower limit	0	0	0	0	0	80	80	30
Upper limit	500	600	600	5000	20	100	100	70
TABLE II. -body
	Description	Value	Unit
Wind turbine	Lifetime	20	yr
Initial/replacement costs	3000/2700	$/kW
O&M cost	50	$/kW/yr
Hub height	40	m
Cut-in/cut-out/rated wind speeds	4.6/22.4/11.3	m/s
Diesel generator	Useful lifetime	20 000	h
Initial/replacement costs	600/500	$/kW
O&M cost	0.05	$/kW/h
Minimum load ratio	30	%
No load fuel consumption	0.08	L/h/kW_{rated}
Incremental fuel consumption	0.25	L/kWh_{out}
Fuel price	0.4	$/L
Battery	Initial/replacement costs	300/280	$/kWh
O&M cost	4	$/kWh/yr
Round-trip efficiency	85	%
Minimum SOC	30	%
Converter	Lifetime	25	yr
Initial/replacement costs	1010/1000	$/kW
O&M cost	10	$/kW/h
Rated efficiency	90	%
No load loss	0.5	%
Hybrid system	Project lifetime	25	yr
Optimization horizon	5	yr
Real interest rate	6	%
TABLE III. -body
	P_{w,r}	P_{g,r}	P_{b,r}	P_{c,r}	P_{trs,g}	soc_{max}	soc_{sp}	soc_{trs}	Net present cost	LOEE	Diesela efficiency	Recovereda thermal energy	CHPa efficiency
Solution	(kW)	(kW)	(kWh)	(kW)	(kW)	(%)	(%)	(%)	(1000 $)	(%)	(%)	(MWh/yr)	(%)
1	123.1	75.9	260.7	33.5	15.9	90.4	94.1	54.2	548.6	0.1	28.1	508.9	79.3
2	96.2	64.7	178.3	25.9	22.8	92.7	91.5	54	519.3	1.04	28.7	488.8	79.9
3	91.6	60.6	147.1	13.8	24.4	92.9	91.4	55.1	492.8	3.06	28.92	467.4	80.4
4	89.1	59.9	98.6	7.9	25.7	93.6	91.3	54.8	470.3	4.97	28.94	455.1	80.6
^{a} The last three columns have been averaged over the optimization horizon (5 years).
TABLE IV. -body
Component	Failure rate	Repair rate
f/h	r/h
Wind turbine	5 × 10^{−5}	0.02
Power converter	3 × 10^{−5}	0.025
Diesel generator	10 × 10^{−5}	0.025
FIG. 1. 
General schematic of the HES.
FIG. 2. 
Normalized power curve of the AOC 15/50 wind turbine [26].
FIG. 3. 
Comparison between the energy cost of the battery and the diesel generator at different net load values.
FIG. 4. 
Measured and synthesized electrical loads.
FIG. 5. 
Diurnal profile of real wind speed and the fitted curve.
FIG. 6. 
Real and synthesized wind speed in the first week of July.
FIG. 7. 
Flowchart of the primary optimization algorithm (left) and the secondary MCS algorithm (right).
FIG. 8. 
MCS results for 1000 uncertain scenarios.
FIG. 9. 
Monthly peak load and average wind speed.
FIG. 10. 
Operation results of the HES on 6 July.
FIG. 11. 
Deterministic optimization results in various load growth rates and fuel prices.
FIG. 12. 
Optimization results of the HES using deterministic and proposed approaches (normal uncertainty condition).
FIG. 13. 
Optimum components' size of the HES using deterministic and proposed approaches (normal uncertainty condition).
FIG. 14. 
Optimum control set points of the HES optimized by deterministic and proposed approaches (normal uncertainty condition).
FIG. 15. 
Optimization results of the HES using deterministic and proposed approaches (H.U.: high uncertainty; N.U.: normal uncertainty).
FIG. 16. 
Optimum components' size of the HES using deterministic and proposed approaches (high uncertainty condition).
